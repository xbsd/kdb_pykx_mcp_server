define(["backbone","Handlebars","moment","QuickBase","Forms","Pager","select2","BasicComponents","DataFilter","xlsx","css!./css/app.css"],function(w,o,wa,v,B,H,G,z,W,U){var K,e=this&&this.__extends||(K=function(e,t){return(K=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}K(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),j=(q.ColumnConfigDialog=o.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="pnlSource">\n    <span>'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Available Columns",{name:"t",hash:{},data:n,loc:{start:{line:2,column:10},end:{line:2,column:35}}}))+'</span>\n    <div class="pnlGrid"></div>\n</div>\n\n<div class="pnlTarget">\n    <span>'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Visible Columns",{name:"t",hash:{},data:n,loc:{start:{line:7,column:10},end:{line:7,column:33}}}))+'</span>\n    <div class="pnlGrid"></div>\n</div>\n\n<div class="pnlActionButtons">\n    <button class="btnMoveToSource">move to source</button><br><br>\n    <button class="btnMoveToTarget">move to target</button><br><br><br>\n    <button class="btnMoveUp">move up</button><br><br>\n    <button class="btnMoveDown">move down</button><br>\n</div>\n\n<label class="lblRetainColumnWidths">\n    <input type="checkbox" class="chkRetainColumnWidths" checked="checked"/>\n    Retain relative column widths on reload\n</label>'},useData:!0}),q.DateFilter=o.template({1:function(e,t,i,o,n){var a=e.escapeExpression,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <option value="'+a("function"==typeof(i=null!=(i=r(i,"key")||n&&r(n,"key"))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"key",hash:{},data:n,loc:{start:{line:6,column:23},end:{line:6,column:31}}}):i)+'">'+a(e.lambda(t,t))+"</option>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="dp1"></div>\n<div class="dp2"></div>\n\n<select class="cmbOperator">\n'+(null!=(i=a(i,"each").call(null!=t?t:e.nullContext||{},null!=t?a(t,"operators"):t,{name:"each",hash:{},fn:e.program(1,n,0),inverse:e.noop,data:n,loc:{start:{line:5,column:4},end:{line:7,column:13}}}))?i:"")+"</select>\n\n\n"},useData:!0}),q.app=o.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="Datagrid">\n    <div class="title"></div>\n\n    <div class="datagridFrame">\n        <div class="pnlGrid"></div>\n        <div class="pnlSummaryRow"></div>\n\n        <div class="pnlPager"></div>\n        <input class="txtGlobalFilter" type="text" />\n\n        <div class="pnlButtons" style="position:absolute; top:0; right: 0; z-index: 8;">\n            <div class="instantButtons" style="display:none;">\n                <button class="submitInstant">\n                    <i class="fa fa-fw fa-upload"></i>Apply Changes\n                </button>\n                <button class="cancelInstant"><i class="fa fa-fw fa-ban"></i>Cancel Editing</button>\n            </div>\n            <a class="lnkSubmitChanges" style="display: none;"\n                ><i class="fa fa-fw fa-upload"></i>'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Submit Changes",{name:"t",hash:{},data:n,loc:{start:{line:19,column:51},end:{line:19,column:73}}}))+'</a\n            >\n            <a class="lnkToggleEditable" style="display:none;"\n                ><i class="fa fa-fw fa-edit"></i>'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Edit",{name:"t",hash:{},data:n,loc:{start:{line:22,column:49},end:{line:22,column:61}}}))+'</a\n            >\n            <a class="lnkToggleFilters"\n                ><i class="fa fa-fw fa-filter"></i><span>'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Hide Filters",{name:"t",hash:{},data:n,loc:{start:{line:25,column:57},end:{line:25,column:77}}}))+'</span></a\n            >\n            <a class="lnkResetFilters"><i class="fa fa-fw fa-times"></i>'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Reset Filters",{name:"t",hash:{},data:n,loc:{start:{line:27,column:72},end:{line:27,column:93}}}))+'</a>\n            <span class="lnksExport link-disabled">\n                <i class="fa fa-fw fa-download" title="'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Download",{name:"t",hash:{},data:n,loc:{start:{line:29,column:55},end:{line:29,column:71}}}))+'"></i>\n                <a\n                    class="lnkExcelExport"\n                    title="'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Download the current dataset in Excel format",{name:"t",hash:{},data:n,loc:{start:{line:32,column:27},end:{line:32,column:79}}}))+'"\n                    >'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Excel",{name:"t",hash:{},data:n,loc:{start:{line:33,column:21},end:{line:33,column:34}}}))+'</a\n                >\n                <a class="lnkCsvExport" title="'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Download the current dataset in CSV format",{name:"t",hash:{},data:n,loc:{start:{line:35,column:47},end:{line:35,column:97}}}))+'"\n                    >'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"CSV",{name:"t",hash:{},data:n,loc:{start:{line:36,column:21},end:{line:36,column:32}}}))+'</a\n                >\n                <a class="lnkFullExport" title="'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Download the full dataset from the server",{name:"t",hash:{},data:n,loc:{start:{line:38,column:48},end:{line:38,column:97}}}))+'"\n                    >'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Full",{name:"t",hash:{},data:n,loc:{start:{line:39,column:21},end:{line:39,column:33}}}))+'</a\n                >\n            </span>\n            <a class="lnkConfiguration" style="display:none"\n                ><i class="fa fa-fw fa-wrench"></i>'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Configuration",{name:"t",hash:{},data:n,loc:{start:{line:43,column:51},end:{line:43,column:72}}}))+'</a\n            >\n            <button class="btnShowHugeData">&infin;</button>\n        </div>\n\n        <div class="pnlProgressBar">\n            <div class="divProgressBar"></div>\n            <div class="lblProgressBar">'+l((e(i,"t")||t&&e(t,"t")||r).call(a,"Please wait, generating huge dataset",{name:"t",hash:{},data:n,loc:{start:{line:50,column:40},end:{line:50,column:84}}}))+'</div>\n        </div>\n    </div>\n\n    <div class="updateStatusFeedback">\n        <i class="successIcon fa fa-fw fa-check"></i>\n        <i class="errorIcon fa fa-fw fa-exclamation-circle"></i>\n        <span class="feedbackText"></span>\n    </div>\n</div>\n'},useData:!0}),q);function q(){}Y=w.DeepModel,e(n,Y),n.prototype.isLazyDataLoadingOn=function(){return _.includes(["cached","uncached"],this.get(n.KEY_LAZY_DATA_LOADING))},n.prototype.getDeltaPagingType=function(){return{cached:"OFFSET",uncached:"OFFSET_NOCACHE"}[this.get(n.KEY_LAZY_DATA_LOADING)]},n.KEY_LAZY_DATA_LOADING="Basics.LazyDataLoading";var Y,X=n;function n(e){return Y.call(this,e)||this}J="^(#([\\da-fA-F]{3}){1,2}|rgba\\(\\s*(0|[1-9]\\d?|1\\d\\d?|2[0-4]\\d|25[0-5])%?\\s*,\\s*(0|[1-9]\\d?|1\\d\\d?|2[0-4]\\d|25[0-5])%?\\s*,\\s*(0|[1-9]\\d?|1\\d\\d?|2[0-4]\\d|25[0-5])%?\\s*,\\s*((0.[1-9])|[01])\\s*\\))$";var Q,J,Z={JSON_STRING:'{\n    "type": "line"\n}',JSON_SCHEMA:function(){var e,t,i,o,n,a,r,l;return Q||(l={BOOLEAN:{type:"boolean"},INTEGER:{type:"integer"},NUMBER:{type:"number",minimum:0},NUMBER_NULL:{oneOf:[{type:"number"},{type:"null"}]},NUMBER_AUTO:{oneOf:[{type:"number"},{type:"string",enum:["auto"]}]},CSS_NUMBER_AUTO:{oneOf:[{type:"number"},{type:"string",pattern:"^(auto|\\d+px|\\d+%)$"}]},STRING:{type:"string"},COLOR:{pattern:J,type:"string"},COLOR_NULL:{oneOf:[{pattern:J,type:"string"},{type:"null"}]}},e={lineColor:_.defaults({default:"#00f"},l.COLOR),fillColor:_.defaults({default:"#cdf"},l.COLOR),defaultPixelsPerValue:_.defaults({default:3},l.NUMBER),width:_.defaults({default:"auto"},l.CSS_NUMBER_AUTO),height:_.defaults({default:"auto"},l.CSS_NUMBER_AUTO),composite:_.defaults({default:!1},l.BOOLEAN),tagValuesAttribute:_.defaults({default:"values"},l.STRING),tagOptionsPrefix:_.defaults({default:"spark"},l.STRING),enableTagOptions:_.defaults({default:!1},l.BOOLEAN),disableHighlight:_.defaults({default:!1},l.BOOLEAN),highlightLighten:_.defaults({default:1.4},l.NUMBER),tooltipClassname:_.defaults({default:"jqstooltip"},l.STRING),tooltipOffsetX:_.defaults({default:10},l.NUMBER),tooltipOffsetY:_.defaults({default:12},l.NUMBER),tooltipChartTitle:_.defaults({default:""},l.STRING),tooltipSkipNull:_.defaults({default:!0},l.BOOLEAN),tooltipPrefix:_.defaults({default:""},l.STRING),tooltipSuffix:_.defaults({default:""},l.STRING),disableHiddenCheck:_.defaults({default:!1},l.BOOLEAN),numberFormatter:_.defaults({default:!1},l.BOOLEAN),numberDigitGroupCount:_.defaults({default:3},l.INTEGER),numberDigitGroupSep:_.defaults({default:","},l.STRING),numberDecimalMark:_.defaults({default:"."},l.STRING),disableTooltips:_.defaults({default:!1},l.BOOLEAN),disableInteraction:_.defaults({default:!1},l.BOOLEAN),className:_.defaults({default:""},l.STRING)},t={type:_.defaults({default:"line",enum:["line"]},l.STRING),spotColor:_.defaults({default:"#f80"},l.COLOR),highlightSpotColor:_.defaults({default:"#5f5"},l.COLOR),highlightLineColor:_.defaults({default:"#f22"},l.COLOR),spotRadius:_.defaults({default:1.5},l.NUMBER),minSpotColor:_.defaults({default:"#f80"},l.COLOR),maxSpotColor:_.defaults({default:"#f80"},l.COLOR),lineWidth:_.defaults({default:1},l.NUMBER),normalRangeMin:_.defaults({default:null},l.NUMBER_NULL),normalRangeMax:_.defaults({default:null},l.NUMBER_NULL),normalRangeColor:_.defaults({default:"#ccc"},l.COLOR),drawNormalOnTop:_.defaults({default:!1},l.BOOLEAN),chartRangeMin:_.defaults({default:null},l.NUMBER_NULL),chartRangeMax:_.defaults({default:null},l.NUMBER_NULL),chartRangeMinX:_.defaults({default:null},l.NUMBER_NULL),chartRangeMaxX:_.defaults({default:null},l.NUMBER_NULL),tooltipFormat:_.defaults({default:"<span style='color: {{color}}'>&#9679;</span> {{prefix}}{{y}}{{suffix}}"},l.STRING),valueSpots:{oneOf:[{type:"array",default:[],items:l.COLOR},{type:"object",default:{}}]}},i={type:_.defaults({default:"bar",enum:["bar"]},l.STRING),barColor:_.defaults({default:"#3366cc"},l.COLOR),negBarColor:_.defaults({default:"#f44"},l.COLOR),stackedBarColor:{type:"array",default:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],items:l.COLOR},zeroColor:_.defaults({default:null},l.COLOR_NULL),nullColor:_.defaults({default:null},l.COLOR_NULL),zeroAxis:_.defaults({default:!0},l.BOOLEAN),barWidth:_.defaults({default:4},l.NUMBER),barSpacing:_.defaults({default:1},l.NUMBER),chartRangeMax:_.defaults({default:null},l.NUMBER_NULL),chartRangeMin:_.defaults({default:null},l.NUMBER_NULL),chartRangeClip:_.defaults({default:!1},l.BOOLEAN),colorMap:{oneOf:[{type:"array",default:[],items:l.COLOR},{type:"object",default:{}}]},tooltipFormat:_.defaults({default:"<span style='color: {{color}}'>&#9679;</span> {{prefix}}{{value}}{{suffix}}"},l.STRING)},o={type:_.defaults({default:"pie",enum:["pie"]},l.STRING),offset:_.defaults({default:0},l.NUMBER),sliceColors:{type:"array",default:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],items:l.COLOR},borderWidth:_.defaults({default:0},l.NUMBER),borderColor:_.defaults({default:"#000"},l.COLOR),tooltipFormat:_.defaults({default:"<span style='color: {{color}}'>&#9679;</span> {{value}} ({{percent.1}}%)"},l.STRING)},n={type:_.defaults({default:"tristate",enum:["tristate"]},l.STRING),barWidth:_.defaults({default:4},l.NUMBER),barSpacing:_.defaults({default:1},l.NUMBER),posBarColor:_.defaults({default:"#6f6"},l.COLOR),negBarColor:_.defaults({default:"#f44"},l.COLOR),zeroBarColor:_.defaults({default:"#999"},l.COLOR),colorMap:{oneOf:[{type:"array",default:[],items:l.COLOR},{type:"object",default:{}}]},tooltipFormat:_.defaults({default:"<span style='color: {{color}}'>&#9679;</span> {{value:map}}"},l.STRING),tooltipValueLookups:{type:"object",default:{map:{"-1":"Loss",0:"Draw",1:"Win"}}}},a={type:_.defaults({default:"discrete",enum:["discrete"]},l.STRING),lineHeight:_.defaults({default:"auto"},l.NUMBER_AUTO),thresholdColor:_.defaults({default:null},l.COLOR_NULL),thresholdValue:_.defaults({default:0},l.NUMBER),chartRangeMax:_.defaults({default:null},l.NUMBER_NULL),chartRangeMin:_.defaults({default:null},l.NUMBER_NULL),chartRangeClip:_.defaults({default:!1},l.BOOLEAN),tooltipFormat:_.defaults({default:"{{prefix}}{{value}}{{suffix}}"},l.STRING)},r={type:_.defaults({default:"bullet",enum:["bullet"]},l.STRING),targetColor:_.defaults({default:"#f33"},l.COLOR),targetWidth:_.defaults({default:3},l.NUMBER),performanceColor:_.defaults({default:"#f33"},l.COLOR),rangeColors:{type:"array",default:["#d3dafe","#a8b6ff","#7f94ff"],items:l.COLOR},base:_.defaults({default:null},l.NUMBER_NULL),tooltipFormat:_.defaults({default:"{{fieldkey:fields}} - {{value}}"},l.STRING),tooltipValueLookups:{type:"object",default:{fields:{r:"Range",p:"Performance",t:"Target"}}}},l={type:_.defaults({default:"box",enum:["box"]},l.STRING),raw:_.defaults({default:!1},l.BOOLEAN),boxLineColor:_.defaults({default:"#000"},l.COLOR),boxFillColor:_.defaults({default:"#cdf"},l.COLOR),whiskerColor:_.defaults({default:"#000"},l.COLOR),outlierLineColor:_.defaults({default:"#333"},l.COLOR),outlierFillColor:_.defaults({default:"#fff"},l.COLOR),medianColor:_.defaults({default:"#f00"},l.COLOR),showOutliers:_.defaults({default:!0},l.BOOLEAN),outlierIQR:_.defaults({default:1.5},l.NUMBER),spotRadius:_.defaults({default:1.5},l.NUMBER),target:_.defaults({default:null},l.NUMBER_NULL),targetColor:_.defaults({default:"#4a2"},l.COLOR),chartRangeMin:_.defaults({default:null},l.NUMBER_NULL),chartRangeMax:_.defaults({default:null},l.NUMBER_NULL),tooltipFormat:_.defaults({default:"{{field:fields}}: {{value}}"},l.STRING),tooltipFormatFieldlistKey:_.defaults({default:"field"},l.STRING),tooltipValueLookups:{type:"object",default:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}},(Q={required:["type"],oneOf:[{type:"object",additionalProperties:!1,properties:_.extend({},e,t)},{type:"object",additionalProperties:!1,properties:_.extend({},e,i)},{type:"object",additionalProperties:!1,properties:_.extend({},e,o)},{type:"object",additionalProperties:!1,properties:_.extend({},e,n)},{type:"object",additionalProperties:!1,properties:_.extend({},e,a)},{type:"object",additionalProperties:!1,properties:_.extend({},e,r)},{type:"object",additionalProperties:!1,properties:_.extend({},e,l)}]}).oneOf.push({type:"array",default:[],items:Q})),Q}},b=v.Tools,a={UserDefined:{type:"boolean",title:"User Defined",format:"checkbox",default:!1},Field:{title:"Data Field Name",type:"customDropdown",default:"",data:"possible_columns",watch:{possible_columns:"root.datagridPossibleColumns"}},DisplayName:{title:"Display Name",type:"string",default:""},Tooltip:{title:"Header Tooltip",type:"string",default:""},Sortable:{type:"boolean",format:"checkbox",default:!0},Format:{type:"string",enum:["General","Number","Formatted Number","Smart Number","Date","Time","DateTime","Percentage","Boolean","Sparkline"],default:"General"},Precision:{type:"number",title:"Precision",format:"number",minimum:0,maximum:10,default:2},HideTrailingZeroes:{type:"boolean",title:"Hide Trailing Zeroes",format:"checkbox",default:!1},Currency:{title:"Currency Symbol",type:"string",enum:["none","USD","GBP","EUR"],default:"none"},DateFormat:{title:"Date Format",type:"string",enum:b.Formats.Date,default:"YYYY-MM-DD"},TimeFormat:{title:"Time Format",type:"string",enum:b.Formats.Time,default:"HH:mm:ss"},HighlightNegativeColor:{options:{noColor:!0},type:"gradient",title:"Negative Color",default:""},HighlightChanges:{type:"boolean",title:"Highlight Changes",format:"checkbox",default:!1},HighlightChangeDuration:{title:"Highlight Change Duration",minimum:50,maximum:1e3,type:"number",step:10,format:"range",default:200},ShowArrowsOnChange:{type:"boolean",title:"Show arrows on Change",format:"checkbox",default:!1},HighlightMinValueColor:{options:{noColor:!0},type:"gradient",title:"Min Value Color",default:""},HighlightMaxValueColor:{options:{noColor:!0},type:"gradient",title:"Max Value Color",default:""},RangeHighlightColor:{options:{noColor:!0},type:"gradient",title:"Range Color",default:""},IsRangeHighlightColorInverted:{type:"boolean",title:"Invert Range Color",format:"checkbox",default:!1},WidthWeight:{title:"Width (relative)",minimum:0,type:"number",default:1},MinWidthAbsolute:{title:"Min Width (px)",minimum:0,type:"number",default:1},PercentageColorOverride:{options:{noColor:!0},type:"gradient",default:"",title:"Percentage Color"},IsReadonly:{type:"boolean",title:"Read Only",format:"checkbox",default:!1},IsSelectable:{type:"boolean",title:"Selectable",format:"checkbox",default:!0},TextAlign:{title:"Text Align",type:"string",enum:["left","center","right"],default:"center"},Template:{type:"handlebar",data:[],default:"",columnsFieldName:"datagridPossibleColumns",templateItems:{values:{type:"object",items:_.keyBy(["thisField","thisValue","thisRawValue"])}}},SparklineOptions:{type:"json",title:"Sparkline Options",options:{jsonSchema:Z.JSON_SCHEMA},default:Z.JSON_STRING},Hidden:{type:"boolean",format:"checkbox",default:!1},Footer:{type:"string",enumSource:"footer_possible_values",watch:{footer_possible_values:"root.footerPossibleValues"},default:"None",options:{enum_titles:["None","Average","Count","Sum","Weighted Average"]}},FooterWeights:{title:"Footer Weights",type:"string",enumSource:"possible_columns",watch:{possible_columns:"root.datagridPossibleColumns"},options:{hidden:!1},default:""},Header:{title:"Header",type:"string",enumSource:"possible_columns",watch:{possible_columns:"root.datagridPossibleHeaderColumns"},default:"none"},Filter:{title:"Filter",type:"viewstate",default:""},RawCopy:{type:"boolean",title:"Raw Copy",format:"checkbox",default:!1}},ee={},te=(_.each(["UserDefined","Field","DisplayName","Tooltip","WidthWeight","MinWidthAbsolute","TextAlign","Sortable","Format","Precision","HideTrailingZeroes","Currency","DateFormat","TimeFormat","HighlightNegativeColor","HighlightChanges","HighlightChangeDuration","ShowArrowsOnChange","HighlightMinValueColor","HighlightMaxValueColor","RangeHighlightColor","IsRangeHighlightColorInverted","PercentageColorOverride","IsReadonly","IsSelectable","Template","SparklineOptions","Hidden","Footer","FooterWeights","Header","Filter","RawCopy"],function(e,t){a[e].propertyOrder=1010+t,ee[e]=a[e].default}),{Name:{title:"Name",type:"string",default:""},Enabled:{type:"boolean",format:"checkbox",default:!0,options:{hidden:!0}},Target:{type:"customDropdown",data:"possible_columns",watch:{possible_columns:"root.highlightTargetPossibleValues"},default:"*"},ConditionSource:{title:"Condition Source",type:"string",enumSource:"possible_columns",watch:{possible_columns:"root.datagridPossibleColumnsWithItself"},default:"<this>"},ConditionOperator:{title:"Condition Operator",type:"string",enum:["","search","contains","starts with","ends with","==","<",">","<=",">=","!=","Fill Left-to-Right","Fill Right-to-Left"],default:""},ConditionValue:{title:"Condition Value",type:"string",default:"previous value"},Color:{type:"gradient",options:{noColor:!0},default:""},BackgroundColor:{title:"Background Color",type:"gradient",options:{noColor:!0,gradient:!0},default:""},BorderColor:{title:"Border Color",type:"gradient",options:{noColor:!0},default:""},Icon:{type:"icon",title:"Icon",default:""},IconColor:{title:"Icon Color",type:"gradient",options:{noColor:!0},default:""},RuleType:{type:"string",title:"Rule Type",enum:["gradient","discrete"],default:"discrete",options:{hidden:!0}},RuleMin:{type:"number",title:"Rule Min",format:"number",default:0},RuleMax:{type:"number",title:"Rule Max",format:"number",default:1},RuleLimitEnabled:{type:"boolean",title:"Rule Limit",format:"checkbox",default:!1},TargetElement:{type:"string",title:"Apply Palette To",enum:["background","text","border","icon"],default:"background"},PaletteTheme:{default:"",title:"Palette Theme",type:"string",enumSource:"possible_palettes",watch:{possible_palettes:"root.possiblePalettes"}},Palette:{type:"array",format:"table",title:"Color Palette",options:{collapsed:!1},uniqueItems:!1,items:{type:"object",title:"Palette Color",properties:{color:{type:"gradient",options:{gradient:!1},title:"color",default:"#ffa500"}}},default:[{color:"#b71c1c"},{color:"#F57F17"},{color:"#33691E"}]}}),ie={},oe=(_.each(["RuleType","Name","Enabled","Target","ConditionSource","ConditionOperator","ConditionValue","Color","BackgroundColor","BorderColor","RuleMin","RuleMax","RuleLimitEnabled","TargetElement","Icon","IconColor","PaletteTheme","Palette"],function(e,t){te[e].propertyOrder=1010+t,ie[e]=te[e].default}),{type:"object",title:"Highlight Rule",headerTemplate:"Rule {{ i1 }} {{self.Name}}",oneOf:[{title:"Discrete",options:{linked_oneof_property:{property:"RuleType",value:"discrete"}},properties:_.mapValues(te,function(e,t){e=_.cloneDeep(e);return _.set(e,"options.hidden",["Name","Target","ConditionSource","ConditionOperator","ConditionValue","Color","BackgroundColor","BorderColor","Icon","IconColor"].indexOf(t)<0),e})},{title:"Gradient",options:{additionalProperties:!1,linked_oneof_property:{property:"RuleType",value:"gradient"}},properties:_.mapValues(te,function(e,t){e=_.cloneDeep(e);return _.set(e,"options.hidden",["Name","Target","ConditionSource","Icon","RuleMin","RuleMax","RuleLimitEnabled","TargetElement","PaletteTheme","Palette"].indexOf(t)<0),e})}]}),ne={type:"array",title:"Custom Filters",options:{collapsed:!0},items:{type:"object",title:"Filter",uniqueItems:!0,properties:{Name:{type:"customDropdown",default:"",data:"possible_columns",watch:{possible_columns:"root.datagridPossibleColumns"}},Type:{type:"string",default:"Disabled",enum:["Selection","Server Selection","Number","DateTime","Disabled"]},Data:{type:"data",title:"Data Source",default:""},UseRaw:{type:"boolean",title:"Filter on raw data",default:!0,format:"checkbox",tooltip:"When Checked filter on Raw Data otherwise filter on Display Data"}},_transform:function(e,t,i,o){"Type"===i?(_.set(t,"properties.Data.options.hidden","Server Selection"!==e.Type),_.set(t,"properties.UseRaw.options.hidden","Number"!==e.Type),o(e,t)):o()}}},u=(r.getRegex=function(e){var t,i=/\/[gimsuy]*$/,e=e.Field,o=!1;if(0===e.indexOf("/")){var o=!0,n=e.substring(1).replace(i,""),i=e.match(i),i=i?i[0].substring(1):"";try{t=new RegExp(n,i)}catch(e){v.Log.Error("Datagrid: invalid regex.",e),t=new RegExp("^$")}}else t=new RegExp("^"+e.replace(/\*/g,"(.*)")+"$","i");return{isExact:o,regex:t}},r.isDynamic=function(e){e=e.Field||"";return 0===e.indexOf("/")||0<=e.indexOf("*")},r.isFieldMatched=function(e,t){var i="*"===e||e===t;return i=!i&&r.isDynamic({Field:e})?r.getRegex({Field:e}).regex.test(t):i},r);function r(){}var d,ae,re,le,se,de,l=["None","Average","Count","Sum","WeightedAverage"],ue=[{title:"Column Rule Boolean",options:{linked_oneof_property:{property:"RuleType",value:"ColumnRuleBoolean"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleSource:{default:"UserDefined",title:"Rule Source",enum:["UserDefined","Sortable","HideTrailingZeroes","HighlightChanges","IsReadonly","IsSelectable","ShowArrowsOnChange","IsRangeHighlightColorInverted","Hidden","Filter"],type:"string"},RuleTarget:{title:"Rule Target (Column Name)",type:"customDropdown",default:"",data:"possible_columns",watch:{possible_columns:"root.datagridPossibleColumns"}},RuleValue:{default:!1,title:"Rule Value",type:"boolean"}}},{title:"Column Rule String",options:{linked_oneof_property:{property:"RuleType",value:"ColumnRuleString"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleSource:{default:"DisplayName",title:"Rule Source",enum:["DisplayName","Tooltip","TextAlign","Format","Currency","DateFormat","TimeFormat","Template","SparklineOptions","Footer","FooterWeights","Header"],type:"string"},RuleTarget:{title:"Rule Target (Column Name)",type:"customDropdown",default:"",data:"possible_columns",watch:{possible_columns:"root.datagridPossibleColumns"}},RuleValue:{default:"",title:"Rule Value",type:"string"}}},{title:"Column Rule Number",options:{linked_oneof_property:{property:"RuleType",value:"ColumnRuleNumber"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleSource:{default:"WidthWeight",title:"Rule Source",enum:["WidthWeight","MinWidthAbsolute","Precision"],type:"string"},RuleTarget:{title:"Rule Target",type:"customDropdown",default:"",data:"possible_columns",watch:{possible_columns:"root.datagridPossibleColumns"}},RuleValue:{default:0,title:"Rule Value",type:"number"}}},{title:"Column Rule Color",options:{linked_oneof_property:{property:"RuleType",value:"ColumnRuleColor"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleSource:{default:"HighlightNegativeColor",title:"Rule Source",enum:["HighlightNegativeColor","HighlightMinValueColor","HighlightMaxValueColor","RangeHighlightColor","PercentageColorOverride"],type:"string"},RuleTarget:{title:"Rule Target (Column Name)",type:"customDropdown",default:"",data:"possible_columns",watch:{possible_columns:"root.datagridPossibleColumns"}},RuleValue:{default:"#F8F8F8",options:{gradient:!1,noColor:!1},title:"Rule Color",type:"gradient"}}}],s={SAMPLE_DATA:"Samples/Sample Grid Data Query",getComponentDefinition:function(e){var t,i,o,n;if(e=e||{websiteUrl:"",settingsModel:new w.Model,dataModel:{getByPath:$.noop}},i={id:21,componentName:"data grid",componentDescription:"See results from your data queries.",appKey:"Datagrid",listViewThumb:e.websiteUrl+"Images/data-table.png",ghostViewThumb:null,buildViewThumb:null,appArgs:{quickStart:[{path:"Basics.Data",message:"populate Data Source"}],json:{version:"v2.12.0",notificationEvent:null,datagridPossibleColumns:[],datagridPossibleHeaderColumns:[],datagridPossibleColumnsWithItself:["<this>"],selectedColumnPossibleValues:[""],highlightTargetPossibleValues:[],sortingPossibleValues:[""],footerPossibleValues:l,Basics:{Name:"",Data:"",Filtering:"Quick Search",IsFilterVisible:!0,ShowPagingControl:!0,ShowPageState:!(t={TriggerColumn:{title:"Trigger Column",type:"string",enumSource:"possible_columns",watch:{possible_columns:"root.highlightTargetPossibleValues"},default:"",propertyOrder:1},Trigger:{type:"string",enum:["Click","Double Click","Mouse In","Mouse Out","Right Click"],default:"Click",title:"Trigger Action",propertyOrder:2}}),EnableGrouping:!0,GroupingAutoCollapse:!1,EnableCustomLayoutConfiguration:!1,ShowSampleGridData:!1,KeepNonExistentColumns:!1,EditMode:"disabled",IsInsertable:!1,SortColumn:"",SortOrder:"ascending",KdbFilterString:"",FilterOnEnterHit:!1,ScrollValueV:0,ExperimentalMode:!1,LazyDataLoading:"disabled",ExpandOnPdf:!1,FooterData:"",FrozenColumnCount:0,AutosaveMode:"enabled",UseHierarchicalRules:!0},ColumnsConfiguration:[],Selection:{Mode:"Area",RowSelectionColumn:"",SelectedValue:"",SelectedCellValue:"",SelectedField:"",FollowSelectedValue:!1,DefaultFallbackOnDeselect:!0,CheckboxAlignment:"none",SelectOnCheckOnly:!1,Actions:[]},FileExport:{ShowExportCsvButton:!0,ShowExportExcelButton:!0,ShowFullExportButton:!1,FileName:[],Actions:[],CsvExportDelimiter:"",RawFormat:!1,PreserveKDBTypes:!1,IncludeRowSummary:!1},Tooltip:{Position:"none",Template:ce,UseFormattedCellValue:!1},GroupingConfiguration:[],SummaryRow_Groupings:[],HighlightRules:[],CustomFilters:[],HeaderGroup:[],CustomLayout:{IgnoreCustomLayoutViewstate:!1,IncludeHiddenColumns:!0},OverrideRules:[],Style:{Theme:"Dark",EvenRowBackgroundColorOverride:"#282828",OddRowBackgroundColorOverride:"#303030",SelectedRowBackgroundColor:"",RowHeight:30,HeaderRowHeight:30,HeaderTextTransformation:"none",HeaderFontWeight:"",FontFamily:"",FontSize:"",advanced:""}},schema:{type:"object",title:"Properties",_transform:function(t,e,i,o){var n,a;"Basics.Data"===i?(a=t.Basics.Data)?"disabled"!==t.Basics.LazyDataLoading?(n=_.uniqueId("getMeta_"),a.subscribe(n,{onData:function(e){t.datagridPossibleColumnsWithItself=_.concat("<this>",t.datagridPossibleColumns=e.columns.collection.map("id")),a.unsubscribe(n),o(t)}})):a.getMeta(function(e){t.datagridPossibleColumnsWithItself=_.concat("<this>",t.datagridPossibleColumns=e.columns.collection.map("id")),o(t)}):(t.datagridPossibleColumns=[],t.datagridPossibleColumnsWithItself=["<this>"],o(t)):"Basics.ShowPagingControl"===i?(_.set(e,"properties.Basics.properties.ShowPageState.options.hidden",!_.get(t,i)),o(t,e)):"Selection.CheckboxAlignment"===i?(_.set(e,"properties.Selection.properties.SelectOnCheckOnly.options.hidden","none"===_.get(t,i)),"none"===_.get(t,i)&&_.set(t,"Selection.SelectOnCheckOnly",!1),o(t,e)):"Basics.FooterData"===i?(a=t.Basics.FooterData)?t.Basics.FooterData.getMeta(function(e){t.footerPossibleValues=_.concat(l,t.footerPossibleValues=e.columns.collection.map("id")),o(t)}):(t.footerPossibleValues=l,o(t)):o()},properties:{notificationEvent:{type:"array",items:{type:"string"},default:null,options:{collapsed:!0,hidden:!0}},datagridPossibleColumns:{type:"readOnlyArray",items:{type:"string"},default:[],options:{collapsed:!0,hidden:!0}},datagridPossibleHeaderColumns:{type:"readOnlyArray",items:{type:"string"},default:[],options:{collapsed:!0,hidden:!0}},datagridPossibleColumnsWithItself:{type:"readOnlyArray",items:{type:"string"},default:["<this>"],options:{collapsed:!0,hidden:!0}},selectedColumnPossibleValues:{type:"readOnlyArray",items:{type:"string"},default:[],options:{collapsed:!0,hidden:!0}},possiblePalettes:{propertyOrder:2,type:"array",format:"table",default:[""],options:{collapsed:!0,hidden:!0}},highlightTargetPossibleValues:{type:"readOnlyArray",items:{type:"string"},default:[],options:{collapsed:!0,hidden:!0}},sortingPossibleValues:{type:"readOnlyArray",items:{type:"string"},default:[""],options:{collapsed:!0,hidden:!0}},footerPossibleValues:{type:"readOnlyArray",items:{type:"string"},default:l,options:{collapsed:!0,hidden:!0}},Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{Name:{propertyOrder:1010,type:"string",title:"Name",default:""},Data:{propertyOrder:1010,type:"data",title:"Data Source",default:"",format:"data"},Filtering:{propertyOrder:1020,type:"string",title:"Filtering",default:"Quick Search",enum:["Quick Search","Column Filters","Advanced Column Filters","disabled"]},IsFilterVisible:{propertyOrder:1021,type:"boolean",title:"Filter Visible",default:!0,format:"checkbox"},ShowPagingControl:{propertyOrder:1030,type:"boolean",title:"Show Paging Control",default:!0,format:"checkbox"},ShowPageState:{propertyOrder:1031,type:"boolean",title:"Show Paging State",default:!1,format:"checkbox"},EnableGrouping:{propertyOrder:1040,type:"boolean",title:"Enable Grouping",default:!0,format:"checkbox"},GroupingAutoCollapse:{propertyOrder:1050,type:"boolean",title:"Auto Collapse Grouping",default:!1,format:"checkbox"},ShowSampleGridData:{propertyOrder:1070,type:"boolean",title:"Show Sample Grid Data",default:!1,format:"checkbox",options:{hidden:!0}},KeepNonExistentColumns:{propertyOrder:1071,type:"boolean",title:"Keep NonExistent Columns",default:!1,format:"checkbox"},EnableCustomLayoutConfiguration:{propertyOrder:1075,type:"boolean",title:"Custom Layout",default:!1,format:"checkbox"},EditMode:{propertyOrder:1095,type:"string",title:"Edit Mode",default:"disabled",enum:["enabled","disabled","instant"]},IsInsertable:{propertyOrder:1096,type:"boolean",title:"Enable Insert/Delete",default:!1,format:"checkbox"},SortColumn:{propertyOrder:1099,type:"string",title:"Sort Column",default:"",enumSource:"sorting_possible_values",watch:{sorting_possible_values:"root.sortingPossibleValues"}},SortOrder:{propertyOrder:1100,type:"string",title:"Sort Order",default:"ascending",enum:["ascending","descending"]},KdbFilterString:{propertyOrder:1110,type:"string",title:"KDB Filter String",default:""},FilterOnEnterHit:{propertyOrder:1120,type:"boolean",title:"Filter On Enter",default:!1,format:"checkbox"},ScrollValueV:{propertyOrder:1140,type:"number",title:"Scroll Row",default:0},ExperimentalMode:{propertyOrder:1200,type:"boolean",title:"Experimental Mode",default:!1,format:"checkbox"},LazyDataLoading:{propertyOrder:1210,type:"string",title:"Virtual Scroll",default:"disabled",enum:["cached","uncached","disabled"]},ExpandOnPdf:{propertyOrder:1220,type:"boolean",title:"Expand When Creating Pdf",default:!1,format:"checkbox"},FooterData:{propertyOrder:1230,type:"data",title:"Footer Data Source",default:"",format:"data"},FrozenColumnCount:{propertyOrder:1240,type:"number",title:"Frozen Column Count",default:0},AutosaveMode:{propertyOrder:1250,type:"string",title:"Autosave",default:"enabled",enum:["enabled","disable filter"],tooltip:"If enabled, the filter is saved and applied after the dashboard is reloaded."},UseHierarchicalRules:{title:"Inherit Hierarchical Rules",type:"boolean",default:!0}}},ColumnsConfiguration:{type:"array",format:"object",title:"Columns",options:{collapsed:!0,bulkEditor:!0},items:{type:"object",title:"Column",headerTemplate:"Column {{ i1 }}   {{#if self.DisplayName}}{{ self.DisplayName }}{{else}}{{ self.Field }}{{/if}}",options:{collapsed:!0},properties:a,watch:{DisplayName:"DisplayName",Field:"Field"},_transform:function(e,t,i,o){var n;"Field"===i?(n=e.Field,e.DisplayName=_.isString(n)&&0!==n.indexOf("/")?n:"",o(e)):"Footer"===i?(_.set(t,"properties.FooterWeights.options.hidden","WeightedAverage"!==e.Footer),o(e,t)):o()}}},HeaderGroup:{type:"array",format:"table",title:"Header Groups",options:{collapsed:!0},items:{type:"object",title:"Group",properties:{ColumnProperty:{title:"Header",type:"string"}}}},Selection:{type:"object",title:"Selection & Routing",options:{collapsed:!0},properties:{Mode:{type:"string",title:"Selection Mode",default:"Area",enum:["Single Row","Multi Row","Area","Cell","None"]},RowSelectionColumn:{title:"Row ID Column",type:"string",enumSource:"possible_selected_columns",watch:{possible_selected_columns:"root.selectedColumnPossibleValues"},default:""},SelectedValue:{type:"viewstate",title:"Selected Row",default:""},SelectedField:{type:"viewstate",title:"Selected Column",default:""},SelectedCellValue:{type:"viewstate",title:"Selected Cell Value",default:""},FollowSelectedValue:{type:"boolean",title:"Follow Selected Row",format:"checkbox",default:!1},DefaultFallbackOnDeselect:{type:"boolean",title:"Default Fallback on Deselect",default:!0,format:"checkbox"},CheckboxAlignment:{type:"string",title:"Checkbox Alignment",default:"none",enum:["none","left","right"]},SelectOnCheckOnly:{type:"boolean",title:"Select on checkbox only",default:!1,format:"checkbox"},Actions:{type:"actions",fields:{map:_.extend({Current:{title:"Source Column",type:"string",enumSource:"possible_columns",watch:{possible_columns:"root.highlightTargetPossibleValues"},default:"",propertyOrder:10}},t),nav:t,query:t,url:t}}}},FileExport:{type:"object",title:"File Export",options:{collapsed:!0},properties:{ShowExportCsvButton:{type:"boolean",title:"Show Export Csv Button",default:!0,format:"checkbox"},ShowExportExcelButton:{type:"boolean",title:"Show Export Excel Button",default:!0,format:"checkbox"},ShowFullExportButton:{type:"boolean",title:"Show Full Export Button",default:!1,format:"checkbox"},CsvExportDelimiter:{title:"CSV Export Delimiter",type:"string",format:"delimiter",default:""},RawFormat:{type:"boolean",title:"Export with Raw Format",default:!1,format:"checkbox"},PreserveKDBTypes:{type:"boolean",title:"Preserve KDB Types",default:!1,format:"checkbox"},IncludeRowSummary:{type:"boolean",title:"Include Row Summary",default:!1,format:"checkbox"},FileName:{type:"array",format:"table",title:"FileName",options:{hidden:!1,collapsed:!0},items:{type:"object",title:"Filename Part",options:{collapsed:!0},properties:{FileNamePart:{title:"FileName Part",type:"string"}}}},Actions:{type:"array",format:"table",title:"Actions",options:{collapsed:!0},items:{type:"object",title:"Action",options:{collapsed:!0},properties:{EventType:{title:"Event Type",type:"string",default:"all",enum:["all","onSuccess","onFail"]},Result:{title:"Last Result",type:"string",default:""}}}}}},Tooltip:{type:"object",title:"Tooltip",options:{collapsed:!0},properties:{Position:{propertyOrder:1,type:"string",title:"Position",default:"none",enum:["none","right","left","cursor"]},Template:{propertyOrder:12,type:"handlebar",title:"Template",data:[],default:"",columnsFieldName:"datagridPossibleColumns",templateItems:{values:{type:"object",items:_.keyBy(["thisField","thisValue","thisRawValue"])}}},UseFormattedCellValue:{propertyOrder:22,type:"boolean",title:"Use Formatted Cell Value",default:"false",format:"checkbox"}}},GroupingConfiguration:{type:"array",format:"table",title:"Grouping Columns",options:{hidden:!1,collapsed:!0},items:{type:"object",title:"Grouping Column",properties:{ColumnProperty:{title:"Column",type:"string",enumSource:"possible_selected_columns",watch:{possible_selected_columns:"root.selectedColumnPossibleValues"}}}}},SummaryRow_Groupings:{type:"array",format:"object",title:"Summary Row for Groupings",options:{hidden:!1,collapsed:!0},items:{type:"object",title:"Summary",options:{collapsed:!0},properties:{Function:{title:"Aggregate Function",type:"string",propertyOrder:1,enum:["SUM","AVG","MIN","MAX","WAVG"],default:""},Column:{type:"string",propertyOrder:2,enumSource:"possible_columns",watch:{possible_columns:"root.selectedColumnPossibleValues"}},Column2:{title:"Column 2",propertyOrder:3,type:"string",enumSource:"possible_columns",watch:{possible_columns:"root.sortingPossibleValues"},default:void 0},Label:{type:"string",propertyOrder:4,default:""},Color:{type:"gradient",propertyOrder:5,options:{noColor:!0},default:""}}}},HighlightRules:{type:"array",format:"object",title:"Highlight Rules",options:{hidden:!1,collapsed:!0},items:oe},CustomFilters:ne,CustomLayout:{type:"object",title:"Custom Configuration Layout",options:{collapsed:!0},properties:{IgnoreCustomLayoutViewstate:{propertyOrder:1076,type:"boolean",title:"Ignore Custom Layout Viewstate",default:!1,format:"checkbox"},IncludeHiddenColumns:{propertyOrder:1077,type:"boolean",title:"Include Hidden Columns",default:!0,format:"checkbox"}}},OverrideRules:{title:"Override Rules",type:"array",options:{collapsed:!0},items:{title:"Override Rule",type:"object",oneOf:ue}},HierarchicalRules:{title:"Hierarchical Rules",type:"array",options:{collapsed:!0,hidden:!0},items:{title:"Hierarchical Rule",type:"object",oneOf:ue}},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{Theme:{type:"string",title:"Theme",default:"Dark",options:{hidden:!0},enum:["Light","Dark"]},DashboardTheme:{options:{hidden:!0}},EvenRowBackgroundColorOverride:{propertyOrder:100,type:"gradient",options:{noColor:!1,gradient:!1},default:"#282828",title:"Even Row Background"},OddRowBackgroundColorOverride:{propertyOrder:102,type:"gradient",options:{noColor:!1,gradient:!1},default:"#303030",title:"Odd Row Background"},SelectedRowBackgroundColor:{propertyOrder:104,type:"gradient",options:{noColor:!0,gradient:!1},default:"",title:"Selected Row Background"},RowHeight:{propertyOrder:110,type:"number",format:"number",title:"Row Height",default:30},HeaderRowHeight:{propertyOrder:115,type:"number",format:"number",title:"Header Row Height",default:30},HeaderTextTransformation:{propertyOrder:120,title:"Header Text Transformation",type:"string",enum:["uppercase","lowercase","capitalize","none"]},HeaderFontWeight:{propertyOrder:125,title:"Header Font Weight",type:"string",enum:["","normal","bold"],default:""},FontFamily:{propertyOrder:140,title:"Font Family",type:"string",enum:["","monospace","fantasy"],default:""},FontSize:{propertyOrder:145,title:"Font Size",type:"string",default:""},advanced:{propertyOrder:160,type:"css",title:"Advanced CSS",default:""}}}}}}},0<_.keys(e.settingsModel.attributes).length)for(o=s.upgrades.indexOf(_.find(s.upgrades,{version:e.settingsModel.get("version")}))+1;o<s.upgrades.length;o+=1)(n=s.upgrades[o]).fn(e.settingsModel),e.settingsModel.set("version",n.version);return e.dataModel.getByPath(s.SAMPLE_DATA)&&(i.appArgs.json.Basics.Data=s.SAMPLE_DATA),_.each(["Basics","ColumnsConfiguration","Selection","FileExport","Tooltip","GroupingConfiguration","SummaryRow_Groupings","HighlightRules","CustomFilters","Style"],function(e,t){i.appArgs.schema.properties[e].propertyOrder=990+t}),i},getColumnSettingsModel:function(e){return _.extend({},ee,e)},getSettingsModel:function(e){var t=s.getComponentDefinition().appArgs.json;return $.extend(!0,t,{Basics:{ExperimentalMode:!1}},e),new w.DeepModel(t)},upgrades:[{version:"4.0.0_d14a",fn:function(e){_.each(e.get("Selection.SelectedObjectRouting"),function(e){e.IsSetOnDoubleClick=!1}),e.set({"Basics.SortColumn":"","Basics.SortOrder":"ascending",sortingPossibleValues:[""]}),e.set("FileExport.ShowExportExcelButton",!1)}},{version:"4.0.0p1",fn:function(e){e.set("FileExport.ShowFullExportButton",!1)}},{version:"4.0.0p2",fn:function(e){_.each(e.get("ColumnsConfiguration"),function(e){"#606060"===e.PercentageColorOverride&&(e.PercentageColorOverride="")})}},{version:"4.0.1s1",fn:function(e){_.each(e.get("ColumnsConfiguration"),function(e){e.Tooltip=""})}},{version:"4.0.1s1a",fn:function(e){e.set("FileExport.ShowFullExportButton",!1)}},{version:"4.1.0s3",fn:function(e){e.set("CustomFilters",[])}},{version:"4.1.1s1",fn:function(e){var t=e.get("Selection");e.set("Selection.Mode",t.RowSelectionMode?"Multi Row":"Area"),delete t.RowSelectionMode}},{version:"4.1.1s2",fn:function(e){e.set("Selection.SelectedCellValue",""),e.set("Selection.SelectedField",""),_.each(e.get("ColumnsConfiguration"),function(e){e.IsSelectable=!0})}},{version:"4.1.1s2a",fn:function(e){e.set("Style.HeaderRowHeight",30)}},{version:"4.1.1s2b",fn:function(e){e.set("Tooltip.Position","none"),e.set("Tooltip.Template",ce)}},{version:"4.1.1s2c",fn:function(e){void 0===e.get("FileExport").CsvExportDelimiter&&e.set("FileExport.CsvExportDelimiter",""),e.set("Selection.CheckboxAlignment","none")}},{version:"4.3.0s1",fn:function(e){e.set("Basics.KdbFilterString","")}},{version:"4.3.0s2",fn:function(e){e.set("Basics.FilterOnEnterHit",!1)}},{version:"4.3.0s3",fn:function(e){var t=e.get("Selection.SelectedObjectRouting"),t=_.map(t,function(e){var t={_Type:"map",TriggerColumn:"*"};return t.Trigger=e.IsSetOnDoubleClick?"Double Click":"Click",t.Current=e.ColumnProperty,t.Target=e.ViewstateProperty,t});e.set("Selection.Actions",t),e.unset("Selection.SelectedObjectRouting")}},{version:"4.3.0s4",fn:function(e){e.set("Basics.ScrollValueV",0),_.each(e.get("ColumnsConfiguration"),function(e){e.IsRangeHighlightColorInverted=!1}),e.set("Basics.ExperimentalMode",!1)}},{version:"4.3.0s5",fn:function(e){e.set("Basics.IsFilterVisible",!0)}},{version:"4.3.1",fn:function(e){_.each(e.get("ColumnsConfiguration"),function(e){e.SparklineOptions=Z.JSON_STRING})}},{version:"4.4.1",fn:function(e){e.set("Basics.LazyDataLoading","disabled")}},{version:"4.5.0",fn:function(e){_.each(e.get("Selection.Actions"),function(e){"Hover"===e.Trigger&&(e.Trigger="Mouse In")}),_.each(e.get("HighlightRules"),function(e){_.defaultsDeep(e,ie)}),e.set("datagridPossibleColumnsWithItself",_.concat("<this>",e.get("datagridPossibleColumns")||[]))}},{version:"4.5.0a",fn:function(o){var n=v.Tools.getDefaultThemeColors("Light"),a=["Style.EvenRowBackgroundColorOverride","Style.OddRowBackgroundColorOverride"];_.forEach(["#f0f0f0","#e0e0e0"],function(e,t){var i=a[t];o.get(i)===e&&o.set(i,n[t])})}},{version:"4.7.0",fn:function(e){e.set("Basics.EditMode",e.get("Basics.IsEditable")?"enabled":"disabled"),e.unset("Basics.IsEditable"),_.each(e.get("ColumnsConfiguration"),function(e){e.Footer="None",e.FooterWeights=""})}},{version:"4.7.1",fn:function(e){e.set("Tooltip.UseFormattedCellValue",!1)}},{version:"4.7.3",fn:function(e){_.each(e.get("ColumnsConfiguration"),function(e){e.Header=_.isNil(e.Header)?"none":e.Header}),_.isNil(e.get("datagridPossibleHeaderColumns"))&&e.set("datagridPossibleHeaderColumns",[]),_.isNil(e.get("HeaderGroup"))&&e.set("HeaderGroup",[]);e=e.get("Basics");e.IgnoreCustomLayoutViewstate=!_.isNil(e.IgnoreCustomLayoutViewstate)&&e.IgnoreCustomLayoutViewstate}},{version:"4.7.3a",fn:function(e){_.isNil(e.get("Basics.ExpandOnPdf"))&&e.set("Basics.ExpandOnPdf",!1)}},{version:"4.7.4",fn:function(e){_.isNil(e.get("Selection.SelectOnCheckOnly"))&&e.set("Selection.SelectOnCheckOnly",!1)}},{version:"4.7.4.1",fn:function(e){var t=e.get("Basics.IgnoreCustomLayoutViewstate");e.set("CustomLayout.IgnoreCustomLayoutViewstate",t),_.isNil(e.get("CustomLayout.IncludeHiddenColumns"))&&e.set("CustomLayout.IncludeHiddenColumns",!0)}},{version:"4.7.4.4",fn:function(e){e=e.get("FileExport");e.RawFormat=!_.isNil(e.RawFormat)&&e.RawFormat}},{version:"4.7.5",fn:function(e){e=e.get("FileExport");e.Actions=_.isNil(e.Actions)?[]:e.Actions}},{version:"4.7.6",fn:function(e){var t=e.get("Basics");t.ShowPageState=!_.isNil(t.ShowPageState)&&t.ShowPageState,e.set("Basics.FooterData",""),e.set("footerPossibleValues",l)}},{version:"4.7.7",fn:function(e){e.get("Basics.Name")||e.set("Basics.Name","")}},{version:"4.7.8",fn:function(e){var t,i="Style.advanced",i=((t=e.get(i))&&""!==t&&e.set(i,t.replace(/(div)?\.slick-(viewport|header(?!-))/g,".slick-pane>.slick-$2")),"Basics.FrozenColumnCount");e.get(i)||e.set(i,0)}},{version:"4.7.9",fn:function(e){_.each(e.get("ColumnsConfiguration"),function(e){e.Filter=""})}},{version:"v2.2.1",fn:function(i){_.each(i.get("HighlightRules"),function(e,t){_.isNil(i.get("HighlightRules."+t+".PaletteTheme")&&"gradient"===i.get("HighlightRules."+t+".RuleType"))&&i.set("HighlightRules."+t+".PaletteTheme","")})}},{version:"v2.2.8",fn:function(e){var t="Basics.AutosaveMode";e.get(t)||e.set(t,"enabled")}},{version:"v2.5.0",fn:function(e){e.set("FileExport.IncludeRowSummary",!1)}},{version:"v2.5.1",fn:function(e){_.each(e.get("ColumnsConfiguration"),function(e){e.RawCopy=!1})}},{version:"v2.11.0",fn:function(e){e=e.get("FileExport");e.PreserveKDBTypes=!_.isNil(e.PreserveKDBTypes)&&e.PreserveKDBTypes}},{version:"v2.12.0",fn:function(e){_.each(e.get("CustomFilters"),function(e){_.isNil(e.UseRaw)&&(e.UseRaw=!0)})}}]},ce='<div style="padding:10px; background: #f0f0f0; color: #101010; font-size:11px; border:1px solid #c0c0c0; border-radius: 2px;">\r\n  {{#each this}}{{#isnt @key "thisValue"}}{{#isnt @key "thisRawValue"}}{{#isnt @key "thisField"}}<b>{{@key}}</b> : {{this}}<br>{{/isnt}}{{/isnt}}{{/isnt}}{{/each}}\r\n</div>';function he(e,t){var i=this.event=e,o=t,n=!1,a=!1,r=!1,l=[],s=void 0;if(e)for(var d=0,u=["altKey","ctrlKey","metaKey","shiftKey","key","keyCode","clientX","clientY","offsetX","offsetY","pageX","pageY","bubbles","type","which","x","y"];d<u.length;d++){var c=u[d];this[c]=e[c]}this.target=i?i.target:void 0,this.stopPropagation=function(){n=!0,i&&i.stopPropagation()},this.isPropagationStopped=function(){return n},this.stopImmediatePropagation=function(){a=!0,i&&i.stopImmediatePropagation()},this.isImmediatePropagationStopped=function(){return a},this.getNativeEvent=function(){return i},this.preventDefault=function(){i&&i.preventDefault(),r=!0},this.isDefaultPrevented=function(){return i?i.defaultPrevented:r},this.addReturnValue=function(e){l.push(e),void 0===s&&void 0!==e&&(s=e)},this.getReturnValue=function(){return s},this.getArguments=function(){return o}}function pe(){this.__nonDataRow=!0}function ge(){this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.selectChecked=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=null}function fe(){this.__groupTotals=!0,this.group=null,this.initialized=!1}function me(){var t=null;this.isActive=function(e){return e?t===e:null!==t},this.activate=function(e){if(e!==t){if(null!==t)throw new Error("SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController");if(!e.commitCurrentEdit)throw new Error("SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()");if(!e.cancelCurrentEdit)throw new Error("SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()");t=e}},this.deactivate=function(e){if(t){if(t!==e)throw new Error("SlickGrid.EditorLock.deactivate: specified editController is not the currently active one");t=null}},this.commitCurrentEdit=function(){return!t||t.commitCurrentEdit()},this.cancelCurrentEdit=function(){return!t||t.cancelCurrentEdit()}}function ve(e){var t;if(e&&e.getBoundingClientRect)return e=e.getBoundingClientRect(),t=document.documentElement,{top:e.top+d.pageYOffset-t.clientTop,left:e.left+d.pageXOffset-t.clientLeft}}function Ce(e,t,i){"function"==typeof i?i():e.style[t]="string"==typeof i?i:i+"px"}function we(e){return 0===e.offsetWidth&&0===e.offsetHeight}function be(e,t){for(var i=[],o=":visible"==t,n=":hidden"==t;(e=e.parentNode)&&e!==document;)n?we(e)&&i.push(e):o?we(e)||i.push(e):t&&!e.matches(t)||i.push(e);return i}function ye(e,t){t=t||"",Array.isArray(e)?e.forEach(function(e){e.style.display=t}):e.style.display=t}function Se(e){Array.isArray(e)?e.forEach(function(e){e.style.display="none"}):e.style.display="none"}function _e(e,t,i){void 0!==d.jQuery?d.jQuery(e)[t]("fast",i):(("slideUp"===t?Se:ye)(e),i())}function Re(e){return!(!e||"[object Object]"!==re.call(e)||(e=ae(e))&&("function"!=typeof(e=le.call(e,"constructor")&&e.constructor)||se.call(e)!==de))}_.extend(s,{getDefaultJSONTemplates:function(){return{Defaults:s.getComponentDefinition().appArgs.json,ColumnsConfiguration:{ColumnsConfiguration:_.cloneDeep(ee)}}},mergeWithDefault:function(e){return e&&e.attributes&&(_.defaultsDeep(e.attributes,s.getComponentDefinition().appArgs.json),_.each(e.attributes.ColumnsConfiguration,function(e){_.defaultsDeep(e,ee)})),e}}),d=window,(ge.prototype=new pe).equals=function(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title},fe.prototype=new pe,ae=Object.getPrototypeOf,re=(e={}).toString,se=(le=e.hasOwnProperty).toString,de=se.call(Object),d.Slick={Event:function(){var a=[];this.subscribe=function(e){a.push(e)},this.unsubscribe=function(e){for(var t=a.length-1;0<=t;t--)a[t]===e&&a.splice(t,1)},this.notify=function(e,t,i){t instanceof he||(t=new he(t,e)),i=i||this;for(var o=0;o<a.length&&!t.isPropagationStopped()&&!t.isImmediatePropagationStopped();o++){var n=a[o].call(i,t,e);t.addReturnValue(n)}return t}},EventData:he,EventHandler:function(){var o=[];this.subscribe=function(e,t){return o.push({event:e,handler:t}),e.subscribe(t),this},this.unsubscribe=function(e,t){for(var i=o.length;i--;)if(o[i].event===e&&o[i].handler===t)return o.splice(i,1),void e.unsubscribe(t);return this},this.unsubscribeAll=function(){for(var e=o.length;e--;)o[e].event.unsubscribe(o[e].handler);return o=[],this}},Range:function(e,t,i,o){void 0===i&&void 0===o&&(i=e,o=t),this.fromRow=Math.min(e,i),this.fromCell=Math.min(t,o),this.toRow=Math.max(e,i),this.toCell=Math.max(t,o),this.isSingleRow=function(){return this.fromRow==this.toRow},this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},this.contains=function(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell},this.toString=function(){return this.isSingleCell()?"("+this.fromRow+":"+this.fromCell+")":"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}},NonDataRow:pe,Group:ge,GroupTotals:fe,RegexSanitizer:function(e){return e.replace(/(\b)(on[a-z]+)(\s*)=|javascript:([^>]*)[^>]*|(<\s*)(\/*)script([<>]*).*(<\s*)(\/*)script(>*)|(&lt;)(\/*)(script|script defer)(.*)(&gt;|&gt;">)/gi,"")},EditorLock:me,BindingEventService:function(){this.boundedEvents=[],this.destroy=function(){this.unbindAll(),this.boundedEvents=[]},this.bind=function(e,t,i,o){e.addEventListener(t,i,o),this.boundedEvents.push({element:e,eventName:t,listener:i})},this.unbind=function(e,t,i){e&&e.removeEventListener&&e.removeEventListener(t,i)},this.unbindByEventName=function(t,i){var e=this.boundedEvents.find(function(e){return e.element===t&&e.eventName===i});e&&this.unbind(e.element,e.eventName,e.listener)},this.unbindAll=function(){for(;0<this.boundedEvents.length;){var e=this.boundedEvents.pop(),t=e.element,i=e.eventName,e=e.listener;this.unbind(t,i,e)}}},Utils:{generateUid:function(){return _.uniqueId()},debounce:function(i,o){var n=null;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0<=o?(clearTimeout(n),n=setTimeout(function(){return i.apply(null,e)},o)):i.apply(null)}},extend:function e(){var t,i,o,n,a,r,l=arguments[0],s=1,d=arguments.length,u=!1;for("boolean"==typeof l?(u=l,l=arguments[s]||{},s++):l=l||{},"object"==typeof l||"function"==typeof(r=l)&&"number"!=typeof r.nodeType&&"function"!=typeof r.item||(l={}),s===d&&(l=this,s--);s<d;s++)if(null!=(t=arguments[s]))for(i in t)o=t[i],"__proto__"!==i&&l!==o&&(u&&o&&(Re(o)||(n=Array.isArray(o)))?(a=l[i],a=n&&!Array.isArray(a)?[]:n||Re(a)?a:{},n=!1,l[i]=e(u,a,o)):void 0!==o&&(l[i]=o));return l},calculateAvailableSpace:function(e){var t=0,i=0,o=0,n=0,a=d.innerHeight||0,r=d.innerWidth||0,l=(s={left:d.pageXOffset||document.documentElement.scrollLeft||0,top:d.pageYOffset||document.documentElement.scrollTop||0}).top,s=s.left;return(e=ve(e))&&(t=a-(i=(e.top||0)-l),n=r-(o=(e.left||0)-s)),{top:i,bottom:t,left:o,right:n}},createDomElement:function(e,i,t){var o=document.createElement(e);return i&&Object.keys(i).forEach(function(e){var t=i[e];"object"==typeof t?Object.assign(o[e],t):o[e]=i[e]}),t&&t.appendChild&&t.appendChild(o),o},emptyElement:function(e){if(e&&e.firstChild)for(;e.firstChild;)e.lastChild&&e.removeChild(e.lastChild);return e},innerSize:function(e,t){var i=0;if(e)for(var i=e["height"===t?"clientHeight":"clientWidth"],o=0,n="height"===t?["top","bottom"]:["left","right"];o<n.length;o++)i-=parseFloat(function(e,t){if(e&&e.getComputedStyle)return d.getComputedStyle(e,null).getPropertyValue(t);return null}(e,"padding-".concat(n[o])))||0;return i},isEmptyObject:function(e){return null==e||0===Object.entries(e).length},noop:function(){},offset:ve,height:function(e,t){if(e)return void 0===t?e.getBoundingClientRect().height:void Ce(e,"height",t)},width:function(e,t){if(e&&e.getBoundingClientRect)return void 0===t?e.getBoundingClientRect().width:void Ce(e,"width",t)},setStyleSize:Ce,contains:function(t,e){return!(!t||!e||be(e).every(function(e){return t!=e}))},toFloat:function(e){return e=parseFloat(e),isNaN(e)?0:e},parents:be,show:ye,hide:Se,slideUp:function(e,t){return _e(e,"slideUp",t)},slideDown:function(e,t){return _e(e,"slideDown",t)},storage:{_storage:new WeakMap,put:function(e,t,i){this._storage.has(e)||this._storage.set(e,new Map),this._storage.get(e).set(t,i)},get:function(e,t){e=this._storage.get(e);return e?e.get(t):null},remove:function(e,t){t=this._storage.get(e).delete(t);return 0===!this._storage.get(e).size&&this._storage.delete(e),t}}},GlobalEditorLock:new me,keyCode:{SPACE:32,BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,TAB:9,UP:38,A:65},preClickClassName:"slick-edit-preclick",GridAutosizeColsMode:{KxRatio:"KXR",None:"NOA",LegacyOff:"LOF",LegacyForceFit:"LFF",IgnoreViewport:"IGV",FitColsToViewport:"FCV",FitViewportToCols:"FVC"},ColAutosizeMode:{Locked:"LCK",Guide:"GUI",Content:"CON",ContentExpandOnly:"CXO",ContentIntelligent:"CTI"},RowSelectionMode:{FirstRow:"FS1",FirstNRows:"FSN",AllRows:"ALL",LastRow:"LS1"},ValueFilterMode:{None:"NONE",DeDuplicate:"DEDP",GetGreatestAndSub:"GR8T",GetLongestTextAndSub:"LNSB",GetLongestText:"LNSC"},WidthEvalMode:{Auto:"AUTO",TextOnly:"CANV",HTML:"HTML"}},"undefined"!=typeof global&&(global.Slick=d.Slick);c.prototype.addItem=function(e){var t=e[this.app.SLICKGRID_ROW_UNIQUE_ID];this.data[t]=e,this.addedPKS.push(t)},c.prototype.clear=function(){for(var e in this.data)delete this.data[e];this.data.length=0},c.prototype.deleteItem=function(e){this.selectionSyncHelper&&this.selectionSyncHelper.isIdSelected(e)||delete this.data[e]},c.prototype.destroy=function(){this.stopListening()},c.prototype.endUpdate=function(){this.grid.invalidateRows(this.addedPKS),this.grid.render(),this.addedPKS=[]},c.prototype.getFilteredItems=function(){for(var e,t=[],i=0;i<this.data.length;i++)(e=this.data[i])&&t.push(e);return t},c.prototype.getInternalMap_idxById=function(){var e=_.mapValues(this.data,function(e,t){return t});return delete e.length,e},c.prototype.getItem=function(e){e=this.data[e]||void 0;return e=e&&this.config.populateItem?this.config.populateItem(e):e},c.prototype.getItemById=function(e){return this.getItem(e)},c.prototype.getItemByIdx=function(e){return this.getItem(e)},c.prototype.getItems=function(){return{length:0}},c.prototype.getLength=function(){return this.data.length},c.prototype.initEvents=function(){var e=this;this.grid=this.app.grid,this.grid.onViewportChanged.subscribe(this.onViewportChanged.bind(this)),this.listenTo(this.app,"data-loaded",function(){e.isLoadingMissingData=!1})},c.prototype.mapIdsToRows=function(e){return _.map(e,function(e){return Number(e)})},c.prototype.mapRowsToIds=function(e){var i=this,o=this.app.SLICKGRID_ROW_UNIQUE_ID;return _.map(e,function(e){var t;return(i.data[e]||((t={})[o]=e,t))[o]})},c.prototype.onViewportChanged=function(){var e,t=this.grid.getViewport(),i=0;if(!this.isLoadingMissingData&&((t=_.pick(t,"top","bottom")).bottom=Math.min(this.data.length-1,t.bottom),this.lastVisibleTop!==t.top||this.lastVisibleBottom!==t.bottom)){t.top>this.lastVisibleTop&&t.bottom>this.lastVisibleBottom?i=1:t.top<this.lastVisibleTop&&t.bottom<this.lastVisibleBottom&&(i=-1);for(var o=t.top;o<=t.bottom;o++)if(!this.data[o]&&void 0===e){e=o;break}if(void 0!==e){var n,a=this.viewModel.get("Style"),r=Math.max(1,Math.ceil((this.app.$pnlGrid.height()-a.HeaderRowHeight)/a.RowHeight)),l=Math.ceil(3*r);switch(i){case-1:n=Math.max(0,t.bottom-l);break;case 1:n=Math.min(this.data.length-l,t.top);break;default:n=Math.max(0,t.top-Math.ceil(2*r))}this.isLoadingMissingData=!0,this.api.page(this.model,{_pagingNum:n,_pageSize:l})}this.lastVisibleTop=t.top,this.lastVisibleBottom=t.bottom}},c.prototype.refresh=function(){},c.prototype.reSort=function(){},c.prototype.setItems=function(e,t){this.updateLength(),this.updateScrollbar();for(var i=this.app.SLICKGRID_ROW_UNIQUE_ID,o=0;o<e.length;o++){var n=e[o];this.data[n[i]]=n}this.grid=this.app.grid;var a=this.app.viewModel.get("Basics.ScrollValueV")||0,a=(this.app.grid.scrollRowToTop(a),this.grid.getViewport());this.lastVisibleTop=a.top,this.lastVisibleBottom=a.bottom,this.initEvents_once()},c.prototype.syncGridSelection=function(i){var o,t=new Slick.Event,n=[],a={},r=this;function l(e){n.join(",")!=e.join(",")&&(n=e,a=_.reduce(n,function(e,t){return e[t]=!0,e},{}),t.notify({grid:i,ids:n},new Slick.EventData,r))}function s(){o=!0;var e=r.mapIdsToRows(n);i.setSelectedRows(e),o=!1}return i.onSelectedRowsChanged.subscribe(function(e,t){o||l(r.mapRowsToIds(i.getSelectedRows()))}),this.onRowsChanged.subscribe(s),this.onRowCountChanged.subscribe(s),this.selectionSyncHelper={getSelectedIds:function(){return n},isIdSelected:function(e){return!!a[e]},onSelectedRowIdsChanged:t,setSelectedIds:function(e){l(e),s()}},t},c.prototype.updateItem_unchecked_noRefresh=function(e,t){this.addItem(t)},c.prototype.updateLength=function(){this.app.currentPagingInfo&&(this.data.length=Number(this.app.currentPagingInfo.totalNumRows))},c.prototype.updateScrollbar=function(){this.app.currentPagingInfo&&this.app.grid.updateRowCount()};var Ee,y,Me,ke=c;function c(e,t){this.data={},this.isLoadingMissingData=!1,this.lastVisibleTop=0,this.lastVisibleBottom=0,this.onPagingInfoChanged=new Slick.Event,this.onRowCountChanged=new Slick.Event,this.onRowsChanged=new Slick.Event,this.addedPKS=[],this.data={},this.app=e,this.model=e.model,this.viewModel=e.viewModel,this.api=e.api,this.config=t,_.each(["beginUpdate","collapseAllGroups","expandAllGroups","reactivateIndexing","setFilter","setFilterArgs","setGrouping","suspendIndexing"],function(e){this[e]=function(){}}.bind(this)),_.extend(this,w.Events),this.initEvents_once=_.once(this.initEvents)}if(e=this,L=function(){"use strict";function t(t,e){var i,o=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,i)),o}function I(o){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?t(Object(n),!0).forEach(function(e){var t,i=o;e=n[t=e],t in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(n,e))})}return o}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i,o=arguments[t];for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e}).apply(this,arguments)}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}function e(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var w=e(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),_=e(/Edge/i),g=e(/firefox/i),f=e(/safari/i)&&!e(/chrome/i)&&!e(/android/i),i=e(/iP(ad|od|hone)/i),m=e(/chrome/i)&&e(/android/i),R={capture:!1,passive:!1};function s(e,t,i){e.addEventListener(t,i,!w&&R)}function a(e,t,i){e.removeEventListener(t,i,!w&&R)}function E(e,t){if(t&&(">"===t[0]&&(t=t.substring(1)),e))try{return e.matches?e.matches(t):e.msMatchesSelector?e.msMatchesSelector(t):e.webkitMatchesSelector&&e.webkitMatchesSelector(t)}catch(e){}}function T(e,t,i,o){if(e){i=i||document;do{if(null!=t&&(">"!==t[0]||e.parentNode===i)&&E(e,t)||o&&e===i)return e}while(e!==i&&(e=(n=e).host&&n!==document&&n.host.nodeType?n.host:n.parentNode))}var n;return null}var M,j=/\s+/g;function F(e,t,i){var o;e&&t&&(e.classList?e.classList[i?"add":"remove"](t):(o=(" "+e.className+" ").replace(j," ").replace(" "+t+" "," "),e.className=(o+(i?" "+t:"")).replace(j," ")))}function O(e,t,i){var o=e&&e.style;if(o){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];o[t=t in o||-1!==t.indexOf("webkit")?t:"-webkit-"+t]=i+("string"==typeof i?"":"px")}}function p(e,t){var i="";if("string"==typeof e)i=e;else do{var o=O(e,"transform")}while(o&&"none"!==o&&(i=o+" "+i),!t&&(e=e.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(i)}function q(e,t,i){if(e){var o=e.getElementsByTagName(t),n=0,a=o.length;if(i)for(;n<a;n++)i(o[n],n);return o}return[]}function k(){return document.scrollingElement||document.documentElement}function N(e,t,i,o,n){if(e.getBoundingClientRect||e===window){var a,r,l,s,d,u,c=e!==window&&e.parentNode&&e!==k()?(r=(a=e.getBoundingClientRect()).top,l=a.left,s=a.bottom,d=a.right,u=a.height,a.width):(l=r=0,s=window.innerHeight,d=window.innerWidth,u=window.innerHeight,window.innerWidth);if((t||i)&&e!==window&&(n=n||e.parentNode,!w))do{if(n&&n.getBoundingClientRect&&("none"!==O(n,"transform")||i&&"static"!==O(n,"position"))){var h=n.getBoundingClientRect();r-=h.top+parseInt(O(n,"border-top-width")),l-=h.left+parseInt(O(n,"border-left-width")),s=r+a.height,d=l+a.width;break}}while(n=n.parentNode);return o&&e!==window&&(o=(t=p(n||e))&&t.a,e=t&&t.d,t)&&(s=(r/=e)+(u/=e),d=(l/=o)+(c/=o)),{top:r,left:l,bottom:s,right:d,width:c,height:u}}}function Y(e,t,i){for(var o=x(e,!0),n=N(e)[t];o;){var a=N(o)[i];if(!("top"===i||"left"===i?a<=n:n<=a))return o;if(o===k())break;o=x(o,!1)}return!1}function X(e,t,i,o){for(var n=0,a=0,r=e.children;a<r.length;){if("none"!==r[a].style.display&&r[a]!==K.ghost&&(o||r[a]!==K.dragged)&&T(r[a],i.draggable,e,!1)){if(n===t)return r[a];n++}a++}return null}function Q(e,t){for(var i=e.lastElementChild;i&&(i===K.ghost||"none"===O(i,"display")||t&&!E(i,t));)i=i.previousElementSibling;return i||null}function A(e,t){var i=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===K.clone||t&&!E(e,t)||i++;return i}function J(e){var t=0,i=0,o=k();if(e)do{var n=(a=p(e)).a,a=a.d}while(t+=e.scrollLeft*n,i+=e.scrollTop*a,e!==o&&(e=e.parentNode));return[t,i]}function x(e,t){if(e&&e.getBoundingClientRect){var i=e,o=!1;do{if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var n=O(i);if(i.clientWidth<i.scrollWidth&&("auto"==n.overflowX||"scroll"==n.overflowX)||i.clientHeight<i.scrollHeight&&("auto"==n.overflowY||"scroll"==n.overflowY)){if(!i.getBoundingClientRect||i===document.body)return k();if(o||t)return i;o=!0}}}while(i=i.parentNode)}return k()}function Z(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function ee(t,i){return function(){var e;M||(1===(e=arguments).length?t.call(this,e[0]):t.apply(this,e),M=setTimeout(function(){M=void 0},i))}}function te(e,t,i){e.scrollLeft+=t,e.scrollTop+=i}function ie(e){var t=window.Polymer,i=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):i?i(e).clone(!0)[0]:e.cloneNode(!0)}function oe(e,t){O(e,"position","absolute"),O(e,"top",t.top),O(e,"left",t.left),O(e,"width",t.width),O(e,"height",t.height)}function ne(e){O(e,"position",""),O(e,"top",""),O(e,"left",""),O(e,"width",""),O(e,"height","")}var P="Sortable"+(new Date).getTime();var ae=[],re={initializeByDefault:!0},le={mount:function(t){for(var e in re)!re.hasOwnProperty(e)||e in t||(t[e]=re[e]);ae.forEach(function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")}),ae.push(t)},pluginEvent:function(t,i,o){var e=this,n=(this.eventCanceled=!1,o.cancel=function(){e.eventCanceled=!0},t+"Global");ae.forEach(function(e){i[e.pluginName]&&(i[e.pluginName][n]&&i[e.pluginName][n](I({sortable:i},o)),i.options[e.pluginName])&&i[e.pluginName][t]&&i[e.pluginName][t](I({sortable:i},o))})},initializePlugins:function(i,o,n,e){for(var t in ae.forEach(function(e){var t=e.pluginName;(i.options[t]||e.initializeByDefault)&&((e=new e(i,o,i.options)).sortable=i,e.options=i.options,i[t]=e,l(n,e.defaults))}),i.options){var a;i.options.hasOwnProperty(t)&&void 0!==(a=this.modifyOption(i,t,i.options[t]))&&(i.options[t]=a)}},getEventProperties:function(t,i){var o={};return ae.forEach(function(e){"function"==typeof e.eventProperties&&l(o,e.eventProperties.call(i[e.pluginName],t))}),o},modifyOption:function(t,i,o){var n;return ae.forEach(function(e){t[e.pluginName]&&e.optionListeners&&"function"==typeof e.optionListeners[i]&&(n=e.optionListeners[i].call(t[e.pluginName],o))}),n}};function se(e){var t=e.sortable,i=e.rootEl,o=e.name,n=e.targetEl,a=e.cloneEl,r=e.toEl,l=e.fromEl,s=e.oldIndex,d=e.newIndex,u=e.oldDraggableIndex,c=e.newDraggableIndex,h=e.originalEvent,p=e.putSortable,g=e.extraEventProperties;if(t=t||i&&i[P]){var f,m=t.options,e="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||w||_?(f=document.createEvent("Event")).initEvent(o,!0,!0):f=new CustomEvent(o,{bubbles:!0,cancelable:!0}),f.to=r||i,f.from=l||i,f.item=n||i,f.clone=a,f.oldIndex=s,f.newIndex=d,f.oldDraggableIndex=u,f.newDraggableIndex=c,f.originalEvent=h,f.pullMode=p?p.lastPutMode:void 0;var v,C=I(I({},g),le.getEventProperties(o,t));for(v in C)f[v]=C[v];i&&i.dispatchEvent(f),m[e]&&m[e].call(t,f)}}function L(e,t,i){var o=(i=2<arguments.length&&void 0!==i?i:{}).evt,i=function(e,t){if(null==e)return{};var i,o=function(e,t){if(null==e)return{};for(var i,o={},n=Object.keys(e),a=0;a<n.length;a++)i=n[a],0<=t.indexOf(i)||(o[i]=e[i]);return o}(e,t);if(Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(e),a=0;a<n.length;a++)i=n[a],0<=t.indexOf(i)||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i]);return o}(i,de);le.pluginEvent.bind(K)(e,t,I({dragEl:B,parentEl:H,ghostEl:G,rootEl:z,nextEl:ge,lastDownEl:fe,cloneEl:r,cloneHidden:n,dragStarted:Re,putSortable:U,activeSortable:K.active,originalEvent:o,oldIndex:me,oldDraggableIndex:ve,newIndex:W,newDraggableIndex:$,hideGhostForTarget:he,unhideGhostForTarget:pe,cloneNowHidden:function(){n=!0},cloneNowShown:function(){n=!1},dispatchSortableEvent:function(e){V({sortable:t,name:e,originalEvent:o})}},i))}var de=["evt"];function V(e){se(I({putSortable:U,cloneEl:r,targetEl:B,rootEl:z,oldIndex:me,oldDraggableIndex:ve,newIndex:W,newDraggableIndex:$},e))}function ue(e,t){var i=O(e),o=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),n=X(e,0,t),a=X(e,1,t),r=n&&O(n),l=a&&O(a),s=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+N(n).width,e=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+N(a).width;return"flex"===i.display?"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal":"grid"===i.display?i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal":n&&r.float&&"none"!==r.float?(t="left"===r.float?"left":"right",!a||"both"!==l.clear&&l.clear!==t?"horizontal":"vertical"):n&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||o<=s&&"none"===i[Ve]||a&&"none"===i[Ve]&&o<s+e)?"vertical":"horizontal"}function ce(e){function l(a,r){return function(e,t,i,o){var n=e.options.group.name&&t.options.group.name&&e.options.group.name===t.options.group.name;return!(null!=a||!r&&!n)||null!=a&&!1!==a&&(r&&"clone"===a?a:"function"==typeof a?l(a(e,t,i,o),r)(e,t,i,o):(t=(r?e:t).options.group.name,!0===a||"string"==typeof a&&a===t||a.join&&-1<a.indexOf(t)))}}var t={},i=e.group;i&&"object"==o(i)||(i={name:i}),t.name=i.name,t.checkPull=l(i.pull,!0),t.checkPut=l(i.put),t.revertClone=i.revertClone,e.group=t}function he(){!He&&G&&O(G,"display","none")}function pe(){!He&&G&&O(G,"display","")}var B,H,G,z,ge,fe,r,n,me,W,ve,$,Ce,U,we,d,be,ye,Se,_e,Re,Ee,Me,ke,u,xe=!1,De=!1,Ie=[],Te=!1,Fe=!1,Oe=[],Ne=!1,Ae=[],Pe="undefined"!=typeof document,Le=i,Ve=_||w?"cssFloat":"float",Be=Pe&&!m&&!i&&"draggable"in document.createElement("div"),He=function(){var e;if(Pe)return!w&&((e=document.createElement("x")).style.cssText="pointer-events:auto","auto"===e.style.pointerEvents)}();function Ge(e){if(B){e=e.touches?e.touches[0]:e;n=e.clientX,a=e.clientY,Ie.some(function(e){var t,i,o=e[P].options.emptyInsertThreshold;if(o&&!Q(e))return t=N(e),i=n>=t.left-o&&n<=t.right+o,o=a>=t.top-o&&a<=t.bottom+o,i&&o?r=e:void 0});var t=r;if(t){var i,o={};for(i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);o.target=o.rootEl=t,o.preventDefault=void 0,o.stopPropagation=void 0,t[P]._onDragOver(o)}}var n,a,r}function ze(e){B&&B.parentNode[P]._isOutsideThisEl(e.target)}function K(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=l({},t),e[P]=this;var i,o,n,a,r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return ue(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==K.supportPointer&&"PointerEvent"in window&&!f,emptyInsertThreshold:5};for(i in le.initializePlugins(this,e,r),r)i in t||(t[i]=r[i]);for(o in ce(t),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!t.forceFallback&&Be,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?s(e,"pointerdown",this._onTapStart):(s(e,"mousedown",this._onTapStart),s(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(s(e,"dragover",this),s(e,"dragenter",this)),Ie.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),l(this,(a=[],{captureAnimationState:function(){a=[],this.options.animation&&[].slice.call(this.el.children).forEach(function(e){var t,i;"none"!==O(e,"display")&&e!==K.ghost&&(a.push({target:e,rect:N(e)}),t=I({},a[a.length-1].rect),e.thisAnimationDuration&&(i=p(e,!0))&&(t.top-=i.f,t.left-=i.e),e.fromRect=t)})},addAnimationState:function(e){a.push(e)},removeAnimationState:function(e){a.splice(function(e,t){for(var i in e)if(e.hasOwnProperty(i))for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[i][o])return Number(i);return-1}(a,{target:e}),1)},animateAll:function(e){var d,u,c=this;this.options.animation?(d=!1,u=0,a.forEach(function(e){var t=0,i=e.target,o=i.fromRect,n=N(i),a=i.prevFromRect,r=i.prevToRect,l=e.rect,s=p(i,!0);s&&(n.top-=s.f,n.left-=s.e),i.toRect=n,i.thisAnimationDuration&&Z(a,n)&&!Z(o,n)&&(l.top-n.top)/(l.left-n.left)==(o.top-n.top)/(o.left-n.left)&&(e=l,s=a,a=r,r=c.options,t=Math.sqrt(Math.pow(s.top-e.top,2)+Math.pow(s.left-e.left,2))/Math.sqrt(Math.pow(s.top-a.top,2)+Math.pow(s.left-a.left,2))*r.animation),Z(n,o)||(i.prevFromRect=o,i.prevToRect=n,t=t||c.options.animation,c.animate(i,l,n,t)),t&&(d=!0,u=Math.max(u,t),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout(function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null},t),i.thisAnimationDuration=t)}),clearTimeout(n),d?n=setTimeout(function(){"function"==typeof e&&e()},u):"function"==typeof e&&e(),a=[]):(clearTimeout(n),"function"==typeof e&&e())},animate:function(e,t,i,o){var n,a;o&&(O(e,"transition",""),O(e,"transform",""),n=(a=p(this.el))&&a.a,a=a&&a.d,n=(t.left-i.left)/(n||1),a=(t.top-i.top)/(a||1),e.animatingX=!!n,e.animatingY=!!a,O(e,"transform","translate3d("+n+"px,"+a+"px,0)"),this.forRepaintDummy=e.offsetWidth,O(e,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),O(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout(function(){O(e,"transition",""),O(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},o))}}))}function We(e,t,i,o,n,a,r,l){var s,d,u=e[P],c=u.options.onMove;return!window.CustomEvent||w||_?(s=document.createEvent("Event")).initEvent("move",!0,!0):s=new CustomEvent("move",{bubbles:!0,cancelable:!0}),s.to=t,s.from=e,s.dragged=i,s.draggedRect=o,s.related=n||t,s.relatedRect=a||N(t),s.willInsertAfter=l,s.originalEvent=r,e.dispatchEvent(s),c?c.call(u,s,r):d}function $e(e){e.draggable=!1}function Ue(){Ne=!1}function Ke(e){return setTimeout(e,0)}function je(e){return clearTimeout(e)}Pe&&!m&&document.addEventListener("click",function(e){if(De)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),De=!1},!0),K.prototype={constructor:K,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Ee=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,B):this.options.direction},_onTapStart:function(t){if(t.cancelable){var i=this,o=this.el,e=this.options,n=e.preventOnFilter,a=t.type,r=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,l=(r||t).target,s=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||l,d=e.filter,u=o;Ae.length=0;for(var c=u.getElementsByTagName("input"),h=c.length;h--;){var p=c[h];p.checked&&Ae.push(p)}if(!B&&!(/mousedown|pointerdown/.test(a)&&0!==t.button||e.disabled)&&!s.isContentEditable&&(this.nativeDraggable||!f||!l||"SELECT"!==l.tagName.toUpperCase())&&!((l=T(l,e.draggable,o,!1))&&l.animated||fe===l)){if(me=A(l),ve=A(l,e.draggable),"function"==typeof d){if(d.call(this,t,l,this))return V({sortable:i,rootEl:s,name:"filter",targetEl:l,toEl:o,fromEl:o}),L("filter",i,{evt:t}),void(n&&t.cancelable&&t.preventDefault())}else if(d=d&&d.split(",").some(function(e){if(e=T(s,e.trim(),o,!1))return V({sortable:i,rootEl:e,name:"filter",targetEl:l,fromEl:o,toEl:o}),L("filter",i,{evt:t}),!0}))return void(n&&t.cancelable&&t.preventDefault());e.handle&&!T(s,e.handle,o,!1)||this._prepareDragStart(t,r,l)}}},_prepareDragStart:function(e,t,i){var o,n=this,a=n.el,r=n.options,l=a.ownerDocument;i&&!B&&i.parentNode===a&&(o=N(i),z=a,H=(B=i).parentNode,ge=B.nextSibling,fe=i,Ce=r.group,we={target:K.dragged=B,clientX:(t||e).clientX,clientY:(t||e).clientY},Se=we.clientX-o.left,_e=we.clientY-o.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,B.style["will-change"]="all",o=function(){L("delayEnded",n,{evt:e}),K.eventCanceled?n._onDrop():(n._disableDelayedDragEvents(),!g&&n.nativeDraggable&&(B.draggable=!0),n._triggerDragStart(e,t),V({sortable:n,name:"choose",originalEvent:e}),F(B,r.chosenClass,!0))},r.ignore.split(",").forEach(function(e){q(B,e.trim(),$e)}),s(l,"dragover",Ge),s(l,"mousemove",Ge),s(l,"touchmove",Ge),s(l,"mouseup",n._onDrop),s(l,"touchend",n._onDrop),s(l,"touchcancel",n._onDrop),g&&this.nativeDraggable&&(this.options.touchStartThreshold=4,B.draggable=!0),L("delayStart",this,{evt:e}),!r.delay||r.delayOnTouchOnly&&!t||this.nativeDraggable&&(_||w)?o():K.eventCanceled?this._onDrop():(s(l,"mouseup",n._disableDelayedDrag),s(l,"touchend",n._disableDelayedDrag),s(l,"touchcancel",n._disableDelayedDrag),s(l,"mousemove",n._delayedDragTouchMoveHandler),s(l,"touchmove",n._delayedDragTouchMoveHandler),r.supportPointer&&s(l,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(o,r.delay)))},_delayedDragTouchMoveHandler:function(e){e=e.touches?e.touches[0]:e,Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){B&&$e(B),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;a(e,"mouseup",this._disableDelayedDrag),a(e,"touchend",this._disableDelayedDrag),a(e,"touchcancel",this._disableDelayedDrag),a(e,"mousemove",this._delayedDragTouchMoveHandler),a(e,"touchmove",this._delayedDragTouchMoveHandler),a(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?s(document,"pointermove",this._onTouchMove):s(document,t?"touchmove":"mousemove",this._onTouchMove):(s(B,"dragend",this),s(z,"dragstart",this._onDragStart));try{document.selection?Ke(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){var i;xe=!1,z&&B?(L("dragStarted",this,{evt:t}),this.nativeDraggable&&s(document,"dragover",ze),i=this.options,e||F(B,i.dragClass,!1),F(B,i.ghostClass,!0),K.active=this,e&&this._appendGhost(),V({sortable:this,name:"start",originalEvent:t})):this._nulling()},_emulateDragOver:function(){if(d){this._lastX=d.clientX,this._lastY=d.clientY,he();for(var e=document.elementFromPoint(d.clientX,d.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(d.clientX,d.clientY))!==t;)t=e;if(B.parentNode[P]._isOutsideThisEl(e),t)do{if(t[P]&&t[P]._onDragOver({clientX:d.clientX,clientY:d.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}while(t=(e=t).parentNode);pe()}},_onTouchMove:function(e){if(we){var t=(l=this.options).fallbackTolerance,i=l.fallbackOffset,o=e.touches?e.touches[0]:e,n=G&&p(G,!0),a=G&&n&&n.a,r=G&&n&&n.d,l=Le&&u&&J(u),a=(o.clientX-we.clientX+i.x)/(a||1)+(l?l[0]-Oe[0]:0)/(a||1),r=(o.clientY-we.clientY+i.y)/(r||1)+(l?l[1]-Oe[1]:0)/(r||1);if(!K.active&&!xe){if(t&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<t)return;this._onDragStart(e,!0)}G&&(n?(n.e+=a-(be||0),n.f+=r-(ye||0)):n={a:1,b:0,c:0,d:1,e:a,f:r},n="matrix(".concat(n.a,",").concat(n.b,",").concat(n.c,",").concat(n.d,",").concat(n.e,",").concat(n.f,")"),O(G,"webkitTransform",n),O(G,"mozTransform",n),O(G,"msTransform",n),O(G,"transform",n),be=a,ye=r,d=o),e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!G){var e=this.options.fallbackOnBody?document.body:z,t=N(B,!0,Le,!0,e),i=this.options;if(Le){for(u=e;"static"===O(u,"position")&&"none"===O(u,"transform")&&u!==document;)u=u.parentNode;u!==document.body&&u!==document.documentElement?(u===document&&(u=k()),t.top+=u.scrollTop,t.left+=u.scrollLeft):u=k(),Oe=J(u)}F(G=B.cloneNode(!0),i.ghostClass,!1),F(G,i.fallbackClass,!0),F(G,i.dragClass,!0),O(G,"transition",""),O(G,"transform",""),O(G,"box-sizing","border-box"),O(G,"margin",0),O(G,"top",t.top),O(G,"left",t.left),O(G,"width",t.width),O(G,"height",t.height),O(G,"opacity","0.8"),O(G,"position",Le?"absolute":"fixed"),O(G,"zIndex","100000"),O(G,"pointerEvents","none"),K.ghost=G,e.appendChild(G),O(G,"transform-origin",Se/parseInt(G.style.width)*100+"% "+_e/parseInt(G.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,o=e.dataTransfer,n=i.options;L("dragStart",this,{evt:e}),K.eventCanceled?this._onDrop():(L("setupClone",this),K.eventCanceled||((r=ie(B)).removeAttribute("id"),r.draggable=!1,r.style["will-change"]="",this._hideClone(),F(r,this.options.chosenClass,!1),K.clone=r),i.cloneId=Ke(function(){L("clone",i),K.eventCanceled||(i.options.removeCloneOnHide||z.insertBefore(r,B),i._hideClone(),V({sortable:i,name:"clone"}))}),t||F(B,n.dragClass,!0),t?(De=!0,i._loopId=setInterval(i._emulateDragOver,50)):(a(document,"mouseup",i._onDrop),a(document,"touchend",i._onDrop),a(document,"touchcancel",i._onDrop),o&&(o.effectAllowed="move",n.setData)&&n.setData.call(i,o,B),s(document,"drop",i),O(B,"transform","translateZ(0)")),xe=!0,i._dragStartId=Ke(i._dragStarted.bind(i,t,e)),s(document,"selectstart",i),Re=!0,f&&O(document.body,"user-select","none"))},_onDragOver:function(u){var i,o,n,e,a=this.el,r=u.target,t=this.options,l=t.group,s=K.active,d=Ce===l,c=t.sort,h=U||s,p=this,g=!1;if(!Ne){if(void 0!==u.preventDefault&&u.cancelable&&u.preventDefault(),r=T(r,t.draggable,a,!0),M("dragOver"),K.eventCanceled)return g;if(B.contains(u.target)||r.animated&&r.animatingX&&r.animatingY||p._ignoreWhileAnimating===r)return x(!1);if(De=!1,s&&!t.disabled&&(d?c||(o=H!==z):U===this||(this.lastPutMode=Ce.checkPull(this,s,B,u))&&l.checkPut(this,s,B,u))){if(n="vertical"===this._getDirection(u,r),i=N(B),M("dragOverValid"),K.eventCanceled)return g;if(o)return H=z,k(),this._hideClone(),M("revert"),K.eventCanceled||(ge?z.insertBefore(B,ge):z.appendChild(B)),x(!0);if((C=Q(a,t.draggable))&&(b=u,y=n,E=N(Q((E=this).el,E.options.draggable)),!(y?b.clientX>E.right+10||b.clientX<=E.right&&b.clientY>E.bottom&&b.clientX>=E.left:b.clientX>E.right&&b.clientY>E.top||b.clientX<=E.right&&b.clientY>E.bottom+10)||C.animated)){if(C&&(y=u,b=n,E=N(X((E=this).el,0,E.options,!0)),b?y.clientX<E.left-10||y.clientY<E.top&&y.clientX<E.right:y.clientY<E.top-10||y.clientY<E.bottom&&y.clientX<E.left)){if((_=X(a,0,t,!0))===B)return x(!1);if(w=N(r=_),!1!==We(z,a,B,i,r,w,u,!1))return k(),a.insertBefore(B,_),H=a,D(),x(!0)}else if(r.parentNode===a){var f,m,v,C,w=N(r),b=B.parentNode!==a,y=(y=B.animated&&B.toRect||i,E=r.animated&&r.toRect||w,S=(e=n)?y.left:y.top,l=e?y.right:y.bottom,C=e?y.width:y.height,_=e?E.left:E.top,y=e?E.right:E.bottom,E=e?E.width:E.height,!(S===_||l===y||S+C/2===_+E/2)),S=n?"top":"left",_=(C=Y(r,"top","top")||Y(B,"top","top"))?C.scrollTop:void 0;if(Ee!==r&&(m=w[S],Te=!1,Fe=!y&&t.invertSwap||b),0!==(f=function(e,t,i,o,n,a,r,l){var s=o?u.clientY:u.clientX,d=o?i.height:i.width,e=o?i.top:i.left,o=o?i.bottom:i.right,i=!1;if(!r)if(l&&ke<d*n){if(Te=!Te&&(1===Me?e+d*a/2<s:s<o-d*a/2)||Te)i=!0;else if(1===Me?s<e+ke:o-ke<s)return-Me}else if(e+d*(1-n)/2<s&&s<o-d*(1-n)/2)return l=t,A(B)<A(l)?1:-1;return(i=i||r)&&(s<e+d*a/2||o-d*a/2<s)?e+d/2<s?1:-1:0}(0,r,w,n,y?1:t.swapThreshold,null==t.invertedSwapThreshold?t.swapThreshold:t.invertedSwapThreshold,Fe,Ee===r)))for(var R=A(B);(v=H.children[R-=f])&&("none"===O(v,"display")||v===G););if(0===f||v===r)return x(!1);Me=f;var E=(Ee=r).nextElementSibling,b=!1;if(!1!==(y=We(z,a,B,i,r,w,u,b=1===f)))return 1!==y&&-1!==y||(b=1===y),Ne=!0,setTimeout(Ue,30),k(),b&&!E?a.appendChild(B):r.parentNode.insertBefore(B,b?E:r),C&&te(C,0,_-C.scrollTop),H=B.parentNode,void 0===m||Fe||(ke=Math.abs(m-N(r)[S])),D(),x(!0)}}else{if(C===B)return x(!1);if((r=C&&a===u.target?C:r)&&(w=N(r)),!1!==We(z,a,B,i,r,w,u,!!r))return k(),C&&C.nextSibling?a.insertBefore(B,C.nextSibling):a.appendChild(B),H=a,D(),x(!0)}if(a.contains(B))return x(!1)}return!1}function M(e,t){L(e,p,I({evt:u,isOwner:d,axis:n?"vertical":"horizontal",revert:o,dragRect:i,targetRect:w,canSort:c,fromSortable:h,target:r,completed:x,onMove:function(e,t){return We(z,a,B,i,e,N(e),u,t)},changed:D},t))}function k(){M("dragOverAnimationCapture"),p.captureAnimationState(),p!==h&&h.captureAnimationState()}function x(e){return M("dragOverCompleted",{insertion:e}),e&&(d?s._hideClone():s._showClone(p),p!==h&&(F(B,(U||s).options.ghostClass,!1),F(B,t.ghostClass,!0)),U!==p&&p!==K.active?U=p:p===K.active&&(U=U&&null),h===p&&(p._ignoreWhileAnimating=r),p.animateAll(function(){M("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==h)&&(h.animateAll(),h._ignoreWhileAnimating=null),(r===B&&!B.animated||r===a&&!r.animated)&&(Ee=null),t.dragoverBubble||u.rootEl||r===document||(B.parentNode[P]._isOutsideThisEl(u.target),e)||Ge(u),!t.dragoverBubble&&u.stopPropagation&&u.stopPropagation(),g=!0}function D(){W=A(B),$=A(B,t.draggable),V({sortable:p,name:"change",toEl:a,newIndex:W,newDraggableIndex:$,originalEvent:u})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){a(document,"mousemove",this._onTouchMove),a(document,"touchmove",this._onTouchMove),a(document,"pointermove",this._onTouchMove),a(document,"dragover",Ge),a(document,"mousemove",Ge),a(document,"touchmove",Ge)},_offUpEvents:function(){var e=this.el.ownerDocument;a(e,"mouseup",this._onDrop),a(e,"touchend",this._onDrop),a(e,"pointerup",this._onDrop),a(e,"touchcancel",this._onDrop),a(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;W=A(B),$=A(B,i.draggable),L("drop",this,{evt:e}),H=B&&B.parentNode,W=A(B),$=A(B,i.draggable),K.eventCanceled||(Te=Fe=xe=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),je(this.cloneId),je(this._dragStartId),this.nativeDraggable&&(a(document,"drop",this),a(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),f&&O(document.body,"user-select",""),O(B,"transform",""),e&&(Re&&(e.cancelable&&e.preventDefault(),i.dropBubble||e.stopPropagation()),G&&G.parentNode&&G.parentNode.removeChild(G),(z===H||U&&"clone"!==U.lastPutMode)&&r&&r.parentNode&&r.parentNode.removeChild(r),B)&&(this.nativeDraggable&&a(B,"dragend",this),$e(B),B.style["will-change"]="",Re&&!xe&&F(B,(U||this).options.ghostClass,!1),F(B,this.options.chosenClass,!1),V({sortable:this,name:"unchoose",toEl:H,newIndex:null,newDraggableIndex:null,originalEvent:e}),z!==H?(0<=W&&(V({rootEl:H,name:"add",toEl:H,fromEl:z,originalEvent:e}),V({sortable:this,name:"remove",toEl:H,originalEvent:e}),V({rootEl:H,name:"sort",toEl:H,fromEl:z,originalEvent:e}),V({sortable:this,name:"sort",toEl:H,originalEvent:e})),U&&U.save()):W!==me&&0<=W&&(V({sortable:this,name:"update",toEl:H,originalEvent:e}),V({sortable:this,name:"sort",toEl:H,originalEvent:e})),K.active)&&(null!=W&&-1!==W||(W=me,$=ve),V({sortable:this,name:"end",toEl:H,originalEvent:e}),this.save())),this._nulling()},_nulling:function(){L("nulling",this),z=B=H=G=ge=r=fe=n=we=d=Re=W=$=me=ve=Ee=Me=U=Ce=K.dragged=K.ghost=K.clone=K.active=null,Ae.forEach(function(e){e.checked=!0}),Ae.length=be=ye=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":B&&(this._onDragOver(e),(t=e).dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable)&&t.preventDefault();break;case"selectstart":e.preventDefault()}var t},toArray:function(){for(var e,t=[],i=this.el.children,o=0,n=i.length,a=this.options;o<n;o++)T(e=i[o],a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||function(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,o=0;i--;)o+=t.charCodeAt(i);return o.toString(36)}(e));return t},sort:function(e,t){var i={},o=this.el;this.toArray().forEach(function(e,t){T(t=o.children[t],this.options.draggable,o,!1)&&(i[e]=t)},this),t&&this.captureAnimationState(),e.forEach(function(e){i[e]&&(o.removeChild(i[e]),o.appendChild(i[e]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return T(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(void 0===t)return i[e];var o=le.modifyOption(this,e,t);i[e]=void 0!==o?o:t,"group"===e&&ce(i)},destroy:function(){L("destroy",this);var e=this.el;e[P]=null,a(e,"mousedown",this._onTapStart),a(e,"touchstart",this._onTapStart),a(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(a(e,"dragover",this),a(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Ie.splice(Ie.indexOf(this.el),1),this.el=e=null},_hideClone:function(){n||(L("hideClone",this),K.eventCanceled)||(O(r,"display","none"),this.options.removeCloneOnHide&&r.parentNode&&r.parentNode.removeChild(r),n=!0)},_showClone:function(e){"clone"===e.lastPutMode?n&&(L("showClone",this),K.eventCanceled||(B.parentNode!=z||this.options.group.revertClone?ge?z.insertBefore(r,ge):z.appendChild(r):z.insertBefore(r,B),this.options.group.revertClone&&this.animate(B,r),O(r,"display",""),n=!1)):this._hideClone()}},Pe&&s(document,"touchmove",function(e){(K.active||xe)&&e.cancelable&&e.preventDefault()}),K.utils={on:s,off:a,css:O,find:q,is:function(e,t){return!!T(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},throttle:ee,closest:T,toggleClass:F,clone:ie,index:A,nextTick:Ke,cancelNextTick:je,detectDirection:ue,getChild:X},K.get=function(e){return e[P]},K.mount=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];(t=t[0].constructor===Array?t[0]:t).forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(K.utils=I(I({},K.utils),e.utils)),le.mount(e)})},K.create=function(e,t){return new K(e,t)};var qe,Ye,Xe,Qe,Je,Ze,D=[],et=!(K.version="1.15.0");function tt(){D.forEach(function(e){clearInterval(e.pid)}),D=[]}function it(){clearInterval(Ze)}var c,ot=ee(function(i,e,t,o){if(e.scroll){var n,a=(i.touches?i.touches[0]:i).clientX,r=(i.touches?i.touches[0]:i).clientY,l=e.scrollSensitivity,s=e.scrollSpeed,d=k(),u=!1,c=0,h=qe=Ye!==t&&(Ye=t,tt(),qe=e.scroll,n=e.scrollFn,!0===qe)?x(t,!0):qe;do{var p=h,g=(E=N(p)).top,f=E.bottom,m=E.left,v=E.right,C=E.width,w=E.height,b=void 0,y=p.scrollWidth,S=p.scrollHeight,_=O(p),R=p.scrollLeft,E=p.scrollTop,_=p===d?(b=C<y&&("auto"===_.overflowX||"scroll"===_.overflowX||"visible"===_.overflowX),w<S&&("auto"===_.overflowY||"scroll"===_.overflowY||"visible"===_.overflowY)):(b=C<y&&("auto"===_.overflowX||"scroll"===_.overflowX),w<S&&("auto"===_.overflowY||"scroll"===_.overflowY)),R=b&&(Math.abs(v-a)<=l&&R+C<y)-(Math.abs(m-a)<=l&&!!R),E=_&&(Math.abs(f-r)<=l&&E+w<S)-(Math.abs(g-r)<=l&&!!E);if(!D[c])for(var M=0;M<=c;M++)D[M]||(D[M]={});D[c].vx==R&&D[c].vy==E&&D[c].el===p||(D[c].el=p,D[c].vx=R,D[c].vy=E,clearInterval(D[c].pid),0==R&&0==E)||(u=!0,D[c].pid=setInterval(function(){o&&0===this.layer&&K.active._onTouchMove(Je);var e=D[this.layer].vy?D[this.layer].vy*s:0,t=D[this.layer].vx?D[this.layer].vx*s:0;"function"==typeof n&&"continue"!==n.call(K.dragged.parentNode[P],t,e,i,Je,D[this.layer].el)||te(D[this.layer].el,t,e)}.bind({layer:c}),24)),c++}while(e.bubbleScroll&&h!==d&&(h=x(h,!1)));et=u}},30);function nt(){}function at(){}nt.prototype={startIndex:null,dragStart:function(e){e=e.oldDraggableIndex,this.startIndex=e},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState(),(e=X(this.sortable.el,this.startIndex,this.options))?this.sortable.el.insertBefore(t,e):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:m=function(e){var t=e.originalEvent,i=e.putSortable,o=e.dragEl,n=e.activeSortable,a=e.dispatchSortableEvent,r=e.hideGhostForTarget,e=e.unhideGhostForTarget;t&&(n=i||n,r(),t=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,t=document.elementFromPoint(t.clientX,t.clientY),e(),n)&&!n.el.contains(t)&&(a("spill"),this.onSpill({dragEl:o,putSortable:i}))}},l(nt,{pluginName:"revertOnSpill"}),at.prototype={onSpill:function(e){var t=e.dragEl;(e=e.putSortable||this.sortable).captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),e.animateAll()},drop:m},l(at,{pluginName:"removeOnSpill"});var rt,v,C,lt,st,b=[],y=[],dt=!1,S=!1,ut=!1;function ct(i,o){y.forEach(function(e,t){(t=o.children[e.sortableIndex+(i?Number(t):0)])?o.insertBefore(e,t):o.appendChild(e)})}function ht(){b.forEach(function(e){e!==C&&e.parentNode&&e.parentNode.removeChild(e)})}return K.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){e=e.originalEvent,this.sortable.nativeDraggable?s(document,"dragover",this._handleAutoScroll):this.options.supportPointer?s(document,"pointermove",this._handleFallbackAutoScroll):e.touches?s(document,"touchmove",this._handleFallbackAutoScroll):s(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){e=e.originalEvent,this.options.dragOverBubble||e.rootEl||this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?a(document,"dragover",this._handleAutoScroll):(a(document,"pointermove",this._handleFallbackAutoScroll),a(document,"touchmove",this._handleFallbackAutoScroll),a(document,"mousemove",this._handleFallbackAutoScroll)),it(),tt(),clearTimeout(M),M=void 0},nulling:function(){Je=Ye=qe=et=Ze=Xe=Qe=null,D.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(t,i){var o,n=this,a=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,e=document.elementFromPoint(a,r);Je=t,i||this.options.forceAutoScrollFallback||_||w||f?(ot(t,this.options,e,i),o=x(e,!0),!et||Ze&&a===Xe&&r===Qe||(Ze&&it(),Ze=setInterval(function(){var e=x(document.elementFromPoint(a,r),!0);e!==o&&(o=e,tt()),ot(t,n.options,e,i)},10),Xe=a,Qe=r)):this.options.bubbleScroll&&x(e,!0)!==k()?ot(t,this.options,x(e,!1),!1):tt()}},l(e,{pluginName:"scroll",initializeByDefault:!0})}),K.mount(at,nt),K.mount(new function(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(e){e=e.dragEl,c=e},dragOverValid:function(e){var t=e.completed,i=e.target,o=e.onMove,n=e.activeSortable,a=e.changed,r=e.cancel;n.options.swap&&(e=this.sortable.el,n=this.options,i&&i!==e&&(e=c,c=!1!==o(i)?(F(i,n.swapClass,!0),i):null,e)&&e!==c&&F(e,n.swapClass,!1),a(),t(!0),r())},drop:function(e){var t,i,o=e.activeSortable,n=e.putSortable,a=e.dragEl,r=n||this.sortable,l=this.options;c&&F(c,l.swapClass,!1),c&&(l.swap||n&&n.options.swap)&&a!==c&&(r.captureAnimationState(),r!==o&&o.captureAnimationState(),i=c,e=(t=a).parentNode,l=i.parentNode,e&&l&&!e.isEqualNode(i)&&!l.isEqualNode(t)&&(n=A(t),a=A(i),e.isEqualNode(l)&&n<a&&a++,e.insertBefore(i,e.children[n]),l.insertBefore(t,l.children[a])),r.animateAll(),r!==o)&&o.animateAll()},nulling:function(){c=null}},l(e,{pluginName:"swap",eventProperties:function(){return{swapItem:c}}})}),K.mount(new function(){function e(o){for(var e in this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this));o.options.avoidImplicitDeselect||(o.options.supportPointer?s(document,"pointerup",this._deselectMultiDrag):(s(document,"mouseup",this._deselectMultiDrag),s(document,"touchend",this._deselectMultiDrag))),s(document,"keydown",this._checkKeyDown),s(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(e,t){var i="";b.length&&v===o?b.forEach(function(e,t){i+=(t?", ":"")+e.textContent}):i=t.textContent,e.setData("Text",i)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){e=e.dragEl,C=e},delayEnded:function(){this.isMultiDrag=~b.indexOf(C)},setupClone:function(e){var t=e.sortable,e=e.cancel;if(this.isMultiDrag){for(var i=0;i<b.length;i++)y.push(ie(b[i])),y[i].sortableIndex=b[i].sortableIndex,y[i].draggable=!1,y[i].style["will-change"]="",F(y[i],this.options.selectedClass,!1),b[i]===C&&F(y[i],this.options.chosenClass,!1);t._hideClone(),e()}},clone:function(e){var t=e.sortable,i=e.rootEl,o=e.dispatchSortableEvent,e=e.cancel;this.isMultiDrag&&!this.options.removeCloneOnHide&&b.length&&v===t&&(ct(!0,i),o("clone"),e())},showClone:function(e){var t=e.cloneNowShown,i=e.rootEl,e=e.cancel;this.isMultiDrag&&(ct(!1,i),y.forEach(function(e){O(e,"display","")}),t(),st=!1,e())},hideClone:function(e){var t=this,i=(e.sortable,e.cloneNowHidden),e=e.cancel;this.isMultiDrag&&(y.forEach(function(e){O(e,"display","none"),t.options.removeCloneOnHide&&e.parentNode&&e.parentNode.removeChild(e)}),i(),st=!0,e())},dragStartGlobal:function(e){e.sortable,!this.isMultiDrag&&v&&v.multiDrag._deselectMultiDrag(),b.forEach(function(e){e.sortableIndex=A(e)}),b=b.sort(function(e,t){return e.sortableIndex-t.sortableIndex}),ut=!0},dragStarted:function(e){var t,i=this,e=e.sortable;this.isMultiDrag&&(this.options.sort&&(e.captureAnimationState(),this.options.animation)&&(b.forEach(function(e){e!==C&&O(e,"position","absolute")}),t=N(C,!1,!0,!0),b.forEach(function(e){e!==C&&oe(e,t)}),dt=S=!0),e.animateAll(function(){dt=S=!1,i.options.animation&&b.forEach(function(e){ne(e)}),i.options.sort&&ht()}))},dragOver:function(e){var t=e.target,i=e.completed,e=e.cancel;S&&~b.indexOf(t)&&(i(!1),e())},revert:function(e){var i,o,t=e.fromSortable,n=e.rootEl,a=e.sortable,r=e.dragRect;1<b.length&&(b.forEach(function(e){a.addAnimationState({target:e,rect:S?N(e):r}),ne(e),e.fromRect=r,t.removeAnimationState(e)}),S=!1,i=!this.options.removeCloneOnHide,o=n,b.forEach(function(e,t){(t=o.children[e.sortableIndex+(i?Number(t):0)])?o.insertBefore(e,t):o.appendChild(e)}))},dragOverCompleted:function(e){var t,i=e.sortable,o=e.isOwner,n=e.insertion,a=e.activeSortable,r=e.parentEl,l=e.putSortable,e=this.options;n&&(o&&a._hideClone(),dt=!1,e.animation&&1<b.length&&(S||!o&&!a.options.sort&&!l)&&(t=N(C,!1,!0,!0),b.forEach(function(e){e!==C&&(oe(e,t),r.appendChild(e))}),S=!0),o||(S||ht(),1<b.length?(o=st,a._showClone(i),a.options.animation&&!st&&o&&y.forEach(function(e){a.addAnimationState({target:e,rect:lt}),e.fromRect=lt,e.thisAnimationDuration=null})):a._showClone(i)))},dragOverAnimationCapture:function(e){var t=e.dragRect,i=e.isOwner,e=e.activeSortable;b.forEach(function(e){e.thisAnimationDuration=null}),e.options.animation&&!i&&e.multiDrag.isMultiDrag&&(lt=l({},t),t=p(C,!0),lt.top-=t.f,lt.left-=t.e)},dragOverAnimationComplete:function(){S&&(S=!1,ht())},drop:function(e){var t=e.originalEvent,i=e.rootEl,o=e.parentEl,n=e.sortable,a=e.dispatchSortableEvent,r=e.oldIndex,l=e.putSortable,s=l||this.sortable;if(t){var d,u,c,h=this.options,p=o.children;if(!ut)if(h.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),F(C,h.selectedClass,!~b.indexOf(C)),~b.indexOf(C))b.splice(b.indexOf(C),1),rt=null,se({sortable:n,rootEl:i,name:"deselect",targetEl:C,originalEvent:t});else{if(b.push(C),se({sortable:n,rootEl:i,name:"select",targetEl:C,originalEvent:t}),t.shiftKey&&rt&&n.el.contains(rt)){var g=A(rt),e=A(C);if(~g&&~e&&g!==e)for(var f,m=g<e?(f=g,e):(f=e,g+1);f<m;f++)~b.indexOf(p[f])||(F(p[f],h.selectedClass,!0),b.push(p[f]),se({sortable:n,rootEl:i,name:"select",targetEl:p[f],originalEvent:t}))}else rt=C;v=s}ut&&this.isMultiDrag&&(S=!1,(o[P].options.sort||o!==i)&&1<b.length&&(d=N(C),u=A(C,":not(."+this.options.selectedClass+")"),!dt&&h.animation&&(C.thisAnimationDuration=null),s.captureAnimationState(),dt||(h.animation&&(C.fromRect=d,b.forEach(function(e){var t;e.thisAnimationDuration=null,e!==C&&(t=S?N(e):d,e.fromRect=t,s.addAnimationState({target:e,rect:t}))})),ht(),b.forEach(function(e){p[u]?o.insertBefore(e,p[u]):o.appendChild(e),u++}),r===A(C)&&(c=!1,b.forEach(function(e){e.sortableIndex!==A(e)&&(c=!0)}),c)&&a("update")),b.forEach(function(e){ne(e)}),s.animateAll()),v=s),(i===o||l&&"clone"!==l.lastPutMode)&&y.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})}},nullingGlobal:function(){this.isMultiDrag=ut=!1,y.length=0},destroyGlobal:function(){this._deselectMultiDrag(),a(document,"pointerup",this._deselectMultiDrag),a(document,"mouseup",this._deselectMultiDrag),a(document,"touchend",this._deselectMultiDrag),a(document,"keydown",this._checkKeyDown),a(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(!(void 0!==ut&&ut||v!==this.sortable||e&&T(e.target,this.options.draggable,this.sortable.el,!1)||e&&0!==e.button))for(;b.length;){var t=b[0];F(t,this.options.selectedClass,!1),b.shift(),se({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:t,originalEvent:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},l(e,{pluginName:"multiDrag",utils:{select:function(e){var t=e.parentNode[P];t&&t.options.multiDrag&&!~b.indexOf(e)&&(v&&v!==t&&(v.multiDrag._deselectMultiDrag(),v=t),F(e,t.options.selectedClass,!0),b.push(e))},deselect:function(e){var t=e.parentNode[P],i=b.indexOf(e);t&&t.options.multiDrag&&~i&&(F(e,t.options.selectedClass,!1),b.splice(i,1))}},eventProperties:function(){var e,i=this,o=[],n=[];return b.forEach(function(e){var t;o.push({multiDragElement:e,index:e.sortableIndex}),t=S&&e!==C?-1:S?A(e,":not(."+i.options.selectedClass+")"):A(e),n.push({multiDragElement:e,index:t})}),{items:function(e){if(Array.isArray(e))return h(e)}(e=b)||function(){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}()||function(e){var t;if(e)return"string"==typeof e?h(e,void 0):"Map"===(t="Object"===(t=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h(e,void 0):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),clones:[].concat(y),oldIndicies:o,newIndicies:n}},optionListeners:{multiDragKey:function(e){return"ctrl"===(e=e.toLowerCase())?e="Control":1<e.length&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}),K},"object"==typeof exports&&"undefined"!=typeof module?module.exports=L():(e=e||self).Sortable=L(),Slick.Utils.extend(Slick,{Draggable:function(n){var a,r,l,s,d,i,u,e=n.containerElement,c=n.onDragInit,o=n.onDragStart,h=n.onDrag,p=n.onDragEnd;if((e=e||document)&&"function"==typeof e.addEventListener)return u={dragSource:e,dragHandle:null},e&&(e.addEventListener("mousedown",t),e.addEventListener("touchstart",t)),{destroy:function(){e&&(e.removeEventListener("mousedown",t),e.removeEventListener("touchstart",t))}};throw new Error("[Slick.Draggable] You did not provide a valid container html element that will be used for dragging.");function g(e,t,i){"function"==typeof e&&e(t,i)}function t(e){a=e.target;var t=e.touches?e.touches[0]:e,i=t.target,o=!1;(!n.allowDragFrom||n.allowDragFrom&&(a.matches(n.allowDragFrom)||a.parentElement&&(o=a.parentElement.matches(n.allowDragFrom))))&&(o&&(a=a.parentElement),u.dragHandle=a,o={left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0},r=o.left+t.clientX,l=o.top+t.clientY,s=t.clientX-t.clientX,d=t.clientY-t.clientY,u=Object.assign(u,{deltaX:s,deltaY:d,startX:r,startY:l,target:i}),g(c,e,u),document.addEventListener("mousemove",f),document.addEventListener("touchmove",f),document.addEventListener("mouseup",m),document.addEventListener("touchend",m),document.addEventListener("touchcancel",m))}function f(e){var t=e.touches?e.touches[0]:e,t=(s=t.clientX-r,d=t.clientY-l,t.target);i||(u=Object.assign(u,{deltaX:s,deltaY:d,startX:r,startY:l,target:t}),g(o,e,u),i=!0),u=Object.assign(u,{deltaX:s,deltaY:d,startX:r,startY:l,target:t}),g(h,e,u)}function m(e){var t=e.target;u=Object.assign(u,{target:t}),g(p,e,u),document.removeEventListener("mousemove",f),document.removeEventListener("touchmove",f),document.removeEventListener("mouseup",m),document.removeEventListener("touchend",m),document.removeEventListener("touchcancel",m),i=!1}},MouseWheel:function(e){var t=e.element,a=e.onMouseWheel;function i(e){var t=e||window.event,i=0,o=0,n=0;t.wheelDelta&&(i=t.wheelDelta/120),n=i=t.detail?-t.detail/3:i,void 0!==t.axis&&t.axis===t.HORIZONTAL_AXIS&&(n=0,o=-1*i),void 0!==t.wheelDeltaY&&(n=t.wheelDeltaY/120),void 0!==t.wheelDeltaX&&(o=-1*t.wheelDeltaX/120),"function"==typeof a&&a(e,i,o,n)}return t.addEventListener("wheel",i),t.addEventListener("mousewheel",i),{destroy:function(){t.removeEventListener("wheel",i),t.removeEventListener("mousewheel",i)}}},Resizable:function(e){var i=e.resizeableElement,o=e.resizeableHandleElement,t=e.onResizeStart,n=e.onResize,a=e.onResizeEnd;if(o&&"function"==typeof o.addEventListener)return o.addEventListener("mousedown",l),o.addEventListener("touchstart",l),{destroy:function(){o&&"function"==typeof o.removeEventListener&&(o.removeEventListener("mousedown",l),o.removeEventListener("touchstart",l))}};throw new Error("[Slick.Resizable] You did not provide a valid html element that will be used for the handle to resize.");function r(e,t){"function"==typeof e&&e(t,{resizeableElement:i,resizeableHandleElement:o})}function l(e){e.preventDefault();e=e.touches?e.changedTouches[0]:e;r(t,e),document.addEventListener("mousemove",s),document.addEventListener("mouseup",d),document.addEventListener("touchmove",s),document.addEventListener("touchend",d)}function s(e){e.preventDefault&&"touchmove"!==e.type&&e.preventDefault();e=e.touches?e.changedTouches[0]:e;"function"==typeof n&&(n(e,{resizeableElement:i,resizeableHandleElement:o}),n(e,{resizeableElement:i,resizeableHandleElement:o}))}function d(e){e=e.touches?e.changedTouches[0]:e;r(a,e),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",d),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",d)}}}),Slick.Utils.extend(!0,Slick,{Data:{DataView:function(n){var o,a,r,B,H,s,d=this,u="id",l=[],c=[],h=new Map,p=null,g=null,f=null,G=!1,m=!1,z=new Map,v=!0,C={},W={},w=[],$=[],b=null,y=!1,i=null,U={getter:null,formatter:null,comparer:function(e,t){return e.value===t.value?0:e.value>t.value?1:-1},predefinedValues:[],aggregators:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0,lazyTotalsCalculation:!1},S=[],R=[],E=[],M=":|:",k=null,x=0,D=0,I=0,T=new Slick.Event,K=new Slick.Event,j=new Slick.Event,q=new Slick.Event,Y=new Slick.Event,X=new Slick.Event,Q=new Slick.Event,F=new Slick.Event,O=new Slick.Event,N=(n=Slick.Utils.extend(!0,{},{groupItemMetadataProvider:null,inlineFilters:!1},n)).atomizeTemporal||_.identity;function A(e){if(!y&&!m&&h)for(var t,i=e=e||0,o=l.length;i<o;i++){if(void 0===(t=l[i][u]))throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property");h.set(N(t),i)}}function J(){if(!m&&h)for(var e,t=0,i=l.length;t<i;t++)if(e=l[t][u],void 0===(e=N(e))||h.get(e)!==t)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property")}function P(){var e=x?Math.max(1,Math.ceil(I/x)):1;return{pageSize:x,pageNum:D,totalRows:I,totalPages:e,dataView:d}}function e(e,t){a=e,o=null,!1===(v=t)&&l.reverse(),l.sort(e),!1===t&&l.reverse(),h=new Map,A(),V()}function t(e,t){v=t,o=e,a=null;var i=Object.prototype.toString;Object.prototype.toString="function"==typeof e?e:function(){return this[e]},!1===t&&l.reverse(),l.sort(),Object.prototype.toString=i,!1===t&&l.reverse(),h=new Map,A(),V()}function Z(e){n.groupItemMetadataProvider||(n.groupItemMetadataProvider=new Slick.Data.GroupItemMetadataProvider),R=[],E=[],S=(e=e||[])instanceof Array?e:[e];for(var t=0;t<S.length;t++){for(var i=S[t]=Slick.Utils.extend(!0,{},U,S[t]),o=(i.getterIsAFn="function"==typeof i.getter,i.compiledAccumulators=[],i.aggregators.length);o--;)i.compiledAccumulators[o]=function(e){{var t;return e.accumulate?(e=ce(e.accumulate),e=new Function("_items","for (var "+e.params[0]+", _i=0, _il=_items.length; _i<_il; _i++) {"+e.params[0]+" = _items[_i]; "+e.body+"}"),t="compiledAccumulatorLoop",e.displayName=t,e.name=he(e,t),e):function(){}}}(i.aggregators[o]);E[t]={}}V()}function L(){if(!p){p={};for(var e=0,t=c.length;e<t;e++)p[c[e][u]]=e}}function ee(e){return l[h&&h.get(N(e))]}function te(e,t){if(h){var i=N(e);if(!h.has(i))throw new Error("[SlickGrid DataView] Invalid id");l[h.get(i)]=t,(f=f||{})[e]=!0}}function ie(e,t){te(e,t),V()}function oe(e,t){l.splice(e,0,t),A(e),V()}function ne(e){e=N(e);var t=h.get(e);void 0===t?console.log("slickgrid.deleteItem: Invalid id, item does not exist",e):(h.delete(e),y?i[t]=!0:l.splice(t,1),A(t),V())}function ae(e){if(!a)throw new Error("[SlickGrid DataView] sortedAddItem() requires a sort comparer, use sort()");oe(function(e){var t=0,i=l.length;for(;t<i;){var o=t+i>>>1;-1===a(l[o],e)?t=1+o:i=o}return t}(e),e)}function re(e,t){if(null==e)for(var i=0;i<S.length;i++)E[i]={},(!0===(S[i].collapsed=t)?O:F).notify({level:i,groupingKey:null});else E[e]={},(!0===(S[e].collapsed=t)?O:F).notify({level:e,groupingKey:null});V()}function le(e,t,i){E[e][t]=S[e].collapsed^i,V()}function se(e,t){for(var i,o,n,a=[],r={},l=t?t.level+1:0,s=S[l],d=0,u=s.predefinedValues.length;d<u;d++)(i=r[o=s.predefinedValues[d]])||((i=new Slick.Group).value=o,i.level=l,i.groupingKey=(t?t.groupingKey+M:"")+o,a[a.length]=i,r[o]=i);for(d=0,u=e.length;d<u;d++)n=e[d],(i=r[o=s.getterIsAFn?s.getter(n):n[s.getter]])||((i=new Slick.Group).value=o,i.level=l,i.groupingKey=(t?t.groupingKey+M:"")+o,a[a.length]=i,r[o]=i),i.rows[i.count++]=n;if(l<S.length-1)for(d=0;d<a.length;d++)(i=a[d]).groups=se(i.rows,i);return a.length&&function e(t,i){i=i||0;var o=S[i];var n=o.collapsed;var a=E[i];var r,l=t.length;for(;l--;)(r=t[l]).collapsed&&!o.aggregateCollapsed||(r.groups&&e(r.groups,i+1),o.aggregators.length&&(o.aggregateEmpty||r.rows.length||r.groups&&r.groups.length)&&ue(r),r.collapsed=n^a[r.groupingKey],r.title=o.formatter?o.formatter(r):r.value)}(a,l),a.sort(S[l].comparer),a}function de(e){var t,i=e.group,o=S[i.level],n=i.level==S.length,a=o.aggregators.length;if(!n&&o.aggregateChildGroups)for(var r=i.groups.length;r--;)i.groups[r].totals.initialized||de(i.groups[r].totals);for(;a--;)(t=o.aggregators[a]).init(),!n&&o.aggregateChildGroups?o.compiledAccumulators[a].call(t,i.groups):o.compiledAccumulators[a].call(t,i.rows),t.storeResult(e);e.initialized=!0}function ue(e){var t=S[e.level],i=new Slick.GroupTotals;(i.group=e).totals=i,t.lazyTotalsCalculation||de(i)}function ce(e){var t=0<=e.toString().indexOf("function")?/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/:/^[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/,e=e.toString().match(t);return{params:e[1].split(","),body:e[2]}}function he(t,i){try{Object.defineProperty(t,"name",{writable:!0,value:i})}catch(e){t.name=i}}function pe(e,t){for(var i=[],o=0,n=0,a=e.length;n<a;n++)g(e[n],t)&&(i[o++]=e[n]);return i}function ge(e,t,i){for(var o,n=[],a=0,r=0,l=e.length;r<l;r++)o=e[r],i[r]?n[a++]=o:g(o,t)&&(n[a++]=o,i[r]=!0);return n}function fe(e,t){var i,o;return g?(i=n.inlineFilters?B:pe,o=n.inlineFilters?H:ge,C.isFilterNarrowing?w=i(w,r):C.isFilterExpanding?w=o(e,r,$):C.isFilterUnchanged||(w=i(e,r))):w=x?e:e.concat(),o=!t&&x?(w.length<=D*x&&(D=0===w.length?0:Math.floor((w.length-1)/x)),w.slice(x*D,x*D+x)):w,{totalRows:w.length,rows:o}}function me(e){p=null,C.isFilterNarrowing==W.isFilterNarrowing&&C.isFilterExpanding==W.isFilterExpanding||($=[]);var e=fe(e),e=(I=e.totalRows,e.rows),t=(R=[],S.length&&(R=se(e)).length&&(e=function e(t,i){for(var o,n=S[i=i||0],a=[],r=0,l=0,s=t.length;l<s;l++){if(o=t[l],!(a[r++]=o).collapsed)for(var d,u=0,c=(d=o.groups?e(o.groups,i+1):o.rows).length;u<c;u++)a[r++]=d[u];o.totals&&n.displayTotalsRow&&(!o.collapsed||n.aggregateCollapsed)&&(a[r++]=o.totals)}return a}(R)),function(e,t){var i,o,n,a=[],r=0,l=Math.max(t.length,e.length);C&&C.ignoreDiffsBefore&&(r=Math.max(0,Math.min(t.length,C.ignoreDiffsBefore))),C&&C.ignoreDiffsAfter&&(l=Math.min(t.length,Math.max(0,C.ignoreDiffsAfter)));for(var s=r,d=e.length;s<l;s++)(d<=s||(i=t[s],o=e[s],!i)||S.length&&(n=i.__nonDataRow||o.__nonDataRow)&&i.__group!==o.__group||i.__group&&!i.equals(o)||n&&(i.__groupTotals||o.__groupTotals)||i[u]!=o[u]||f&&f[i[u]])&&(a[a.length]=s);return a}(c,e));return c=e,t}function V(){var e,t,i,o;!G&&(e=Slick.Utils.extend(!0,{},P()),t=c.length,i=I,o=me(l),x&&I<D*x&&(D=Math.max(0,Math.ceil(I/x)-1),o=me(l)),f=null,W=C,C={},i!==I&&!1!==X.notify(e,null,d)&&Q.notify(P(),null,d),t!==c.length&&j.notify({previous:t,current:c.length,itemCount:l.length,dataView:d,callingOnRowsChanged:0<o.length},null,d),0<o.length&&q.notify({rows:o,itemCount:l.length,dataView:d,calledOnRowCountChanged:t!==c.length},null,d),t!==c.length||0<o.length)&&Y.notify({rowsDiff:o,previousRowCount:t,currentRowCount:c.length,itemCount:l.length,rowCountChanged:t!==c.length,rowsChanged:0<o.length,dataView:d},null,d)}function ve(){return k}function Ce(){return Array.isArray(k)&&w.filter(function(t){return k.some(function(e){return t[u]===e})})||[]}Slick.Utils.extend(this,{beginUpdate:function(e){m=(G=!0)===e},endUpdate:function(){var e=m;if(G=m=!1,e){if(h){for(var t,i,o=0,n=0,a=l.length;n<a;n++){if(i=l[n],void 0===(t=i[u]))throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property");z.has(t)?h.delete(t):(l[o]=i,h.set(t,o),++o)}l.length=o,z=new Map}J()}V()},suspendIndexing:function(){y=!0,i={}},reactivateIndexing:function(e){y=!1,_.isEmpty(i)||(l=_.reject(l,function(e,t){return i[t]}),i=null),e||A()},destroy:function(){l=[],$=[],w=[],H=B=a=f=g=p=h=null,b&&b.onSelectedRowsChanged&&b.onCellCssStylesChanged&&(b.onSelectedRowsChanged.unsubscribe(),b.onCellCssStylesChanged.unsubscribe()),d.onRowsOrCountChanged&&d.onRowsOrCountChanged.unsubscribe()},setPagingOptions:function(e){!1!==X.notify(P(),null,d).getReturnValue()&&(null!=e.pageSize&&(x=e.pageSize,D=x?Math.min(D,Math.max(0,Math.ceil(I/x)-1)):0),null!=e.pageNum&&(D=Math.min(e.pageNum,Math.max(0,Math.ceil(I/x)-1))),Q.notify(P(),null,d),V())},getPagingInfo:P,getIdPropertyName:function(){return u},getItems:function(){return l},setItems:function(e,t){void 0!==t&&(u=t),l=w=e,K.notify({idProperty:t,itemCount:l.length},null,d),h=new Map,A(),J(),V()},filterRows:function(e){return fe(e,!0).rows},setFilter:function(e){var t,i;g=e,n.inlineFilters&&(e=ce(g),t="{ continue _coreloop; }$1",i="{ _retval[_idx++] = $item$; continue _coreloop; }$1",t=e.body.replace(/return false\s*([;}]|\}|$)/gi,t).replace(/return!1([;}]|\}|$)/gi,t).replace(/return true\s*([;}]|\}|$)/gi,i).replace(/return!0([;}]|\}|$)/gi,i).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),i=(i=(i=(i=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("")).replace(/\$filter\$/gi,t)).replace(/\$item\$/gi,e.params[0])).replace(/\$args\$/gi,e.params[1]),t=new Function("_items,_args",i),e="compiledFilter",t.displayName=e,t.name=he(t,e),B=t,i=ce(g),e="{ continue _coreloop; }$1",t="{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1",e=i.body.replace(/return false\s*([;}]|\}|$)/gi,e).replace(/return!1([;}]|\}|$)/gi,e).replace(/return true\s*([;}]|\}|$)/gi,t).replace(/return!0([;}]|\}|$)/gi,t).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),t=(t=(t=(t=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("")).replace(/\$filter\$/gi,e)).replace(/\$item\$/gi,i.params[0])).replace(/\$args\$/gi,i.params[1]),e=new Function("_items,_args,_cache",t),i="compiledFilterWithCaching",e.displayName=i,e.name=he(e,i),H=e),V()},getFilter:function(){return g},getFilteredItems:function(){return w},getFilteredItemCount:function(){return w.length},sort:e,fastSort:t,reSort:function(){a?e(a,v):o&&t(o,v)},setGrouping:Z,getGrouping:function(){return S},groupBy:function(e,t,i){Z(null==e?[]:{getter:e,formatter:t,comparer:i})},setAggregators:function(e,t){if(!S.length)throw new Error("[SlickGrid DataView] At least one grouping must be specified before calling setAggregators().");S[0].aggregators=e,S[0].aggregateCollapsed=t,Z(S)},collapseAllGroups:function(e){re(e,!0)},expandAllGroups:function(e){re(e,!1)},collapseGroup:function(e){var t,i=Array.prototype.slice.call(arguments),o=i[0];le(o=1===i.length&&-1!==o.indexOf(M)?(t=o).split(M).length-1:(t=i.join(M),i.length-1),t,!0),O.notify({level:o,groupingKey:t})},expandGroup:function(e){var t,i=Array.prototype.slice.call(arguments),o=i[0],o=1===i.length&&-1!==o.indexOf(M)?(t=o.split(M).length-1,o):(t=i.length-1,i.join(M));le(t,o,!1),F.notify({level:t,groupingKey:o})},getGroups:function(){return R},getAllSelectedIds:ve,getAllSelectedItems:function(){var t=[];return k.forEach(function(e){t.push(d.getItemById(e))}),t},getAllSelectedFilteredIds:function(){return Ce().map(function(e){return e[u]})},getAllSelectedFilteredItems:Ce,setSelectedIds:function(e,t){var i=t&&t.isRowBeingAdded,o=t&&t.shouldTriggerEvent,t=t&&t.applyRowSelectionToGrid,n=(!1!==i&&(i=!0),d.mapIdsToRows(e));s(e={grid:b,ids:e,rows:n,added:i,dataView:d}),e.ids=k,!1!==o&&T.notify(Object.assign(e,{selectedRowIds:k,filteredIds:d.getAllSelectedFilteredIds()}),new Slick.EventData,d),!1!==t&&b&&b.setSelectedRows(n)},getIdxById:function(e){return h&&h.get(N(e))},getInternalMap_idxById:function(){var i={};return h.forEach(function(e,t){i[t]=e}),i},getRowByItem:function(e){return L(),p[e[u]]},getRowById:function(e){return L(),p[e]},getItemById:ee,getItemByIdx:function(e){return l[e]},extractIds:function(e){for(var t=[],i=0,o=e.length;i<o;i++)t[t.length]=e[i][u];return t},getOptions:function(){return n},mapItemsToRows:function(e){var t=[];L();for(var i=0,o=e.length;i<o;i++){var n=p[e[i][u]];null!=n&&(t[t.length]=n)}return t},mapRowsToIds:function(e){for(var t,i=[],o=0,n=e.length;o<n;o++)e[o]<c.length&&(t=c[e[o]],i[i.length]=t&&t[u]);return i},mapIdsToRows:function(e){var t=[];L();for(var i=0,o=e.length;i<o;i++){var n=p[e[i]];null!=n&&(t[t.length]=n)}return t},setRefreshHints:function(e){C=e},setFilterArgs:function(e){r=e},refresh:V,updateItem:ie,updateItems:function(e,t){if(e.length!==t.length)throw new Error("[SlickGrid DataView] Mismatch on the length of ids and items provided to update");for(var i=0,o=t.length;i<o;i++)te(e[i],t[i]);V()},updateItem_unchecked_noRefresh:function(e,t){var i;t&&(i=N(e),l[h.get(i)]=t),(f=f||{})[e]=!0},insertItem:oe,insertItems:function(e,t){Array.prototype.splice.apply(l,[e,0].concat(t)),A(e),V()},addItem:function(e){l.push(e),A(l.length-1),V()},addItems:function(e){A((l=l.concat(e)).length-e.length),V()},deleteItem:ne,deleteItems:function(e){if(0!==e.length&&h)if(m)for(var t=0,i=e.length;t<i;t++){var o=e[t];if(void 0===(a=h.get(o)))throw new Error("[SlickGrid DataView] Invalid id");z.set(o,!0)}else{for(var n=[],t=0,i=e.length;t<i;t++){var a,o=e[t];if(void 0===(a=h.get(o)))throw new Error("[SlickGrid DataView] Invalid id");h.delete(o),n.push(a)}n.sort();for(t=n.length-1;0<=t;--t)l.splice(n[t],1);A(n[0]),V()}},sortedAddItem:ae,sortedUpdateItem:function(e,t){if(h){if(!h.has(e)||e!==t[u])throw new Error("[SlickGrid DataView] Invalid or non-matching id "+h.get(e));if(!a)throw new Error("[SlickGrid DataView] sortedUpdateItem() requires a sort comparer, use sort()");var i=ee(e);0!==a(i,t)?(ne(e),ae(t)):ie(e,t)}},syncGridSelection:function(i,o,e){var n,a=this;function r(e){k.join(",")!=e.join(",")&&(k=e)}function t(){var e,t;n||(n=!0,e=a.mapIdsToRows(k),o||(t={grid:b,ids:a.mapRowsToIds(e),rows:e,dataView:a},s(t),t.ids=k,T.notify(Object.assign(t,{selectedRowIds:k,filteredIds:a.getAllSelectedFilteredIds()}),new Slick.EventData,a)),i.setSelectedRows(e),n=!1)}function l(){T.notify({grid:b,ids:k,dataView:a},new Slick.EventData,a)}return b=i,k=a.mapRowsToIds(i.getSelectedRows()),i.onSelectedRowsChanged.subscribe(function(e,t){var i;n||(i=a.mapRowsToIds(t.rows),i={grid:b,ids:i,rows:t.rows,added:!0,dataView:a},e&&(e.event&&!(e.ctrlKey||e.shiftKey||e.metaKey)||!e.event&&"SlickRowSelectionModel.setSelectedRanges"===e.detail.caller)&&delete i.added,s(i),i.ids=k,T.notify(Object.assign(i,{selectedRowIds:k,filteredIds:a.getAllSelectedFilteredIds()}),new Slick.EventData,a))}),s=function(t){n||(n=!0,r(void 0===t.added?t.ids:t.added?e&&i.getOptions().multiSelect?k.filter(function(e){return void 0===a.getRowById(e)}).concat(t.ids):t.ids:e&&i.getOptions().multiSelect?k.filter(function(e){return-1===t.ids.indexOf(e)}):[]),n=!1)},this.onRowsOrCountChanged.subscribe(t),this.selectionSyncHelper={addSelectedIds:function(e){r(_.union(k,e)),l(),t()},getSelectedIds:function(){return k},onSelectedRowIdsChanged:T,removeSelectedIds:function(e){r(_.difference(k,e)),l(),t()},setSelectedIds:function(e){r(e),l(),t()}},T},syncGridCellCssStyles:function(o,n){var a,r;function i(e){for(var t in a={},e){var i=c[t][u];a[i]=e[t]}}function l(){if(a){r=!0,L();var e,t={};for(e in a){var i=p[e];null!=i&&(t[i]=a[e])}o.setCellCssStyles(n,t),r=!1}}i(o.getCellCssStyles(n)),o.onCellCssStylesChanged.subscribe(function(e,t){r||n==t.key&&(t.hash?i(t.hash):(o.onCellCssStylesChanged.unsubscribe(),d.onRowsOrCountChanged.unsubscribe(l)))}),this.onRowsOrCountChanged.subscribe(l)},getItemCount:function(){return l.length},getLength:function(){return c.length},getItem:function(e){var t;return(e=c[e])&&e.__group&&e.totals&&!e.totals.initialized?(t=S[e.level]).displayTotalsRow||(de(e.totals),e.title=t.formatter?t.formatter(e):e.value):e&&e.__groupTotals&&!e.initialized?de(e):!n.populateItem||e instanceof Slick.NonDataRow||(e=n.populateItem(e)),e},getItemMetadata:function(e){return void 0===(e=c[e])?null:e.__group?n.groupItemMetadataProvider.getGroupRowMetadata(e):e.__groupTotals?n.groupItemMetadataProvider.getTotalsRowMetadata(e):null},onSelectedRowIdsChanged:T,onSetItemsCalled:K,onRowCountChanged:j,onRowsChanged:q,onRowsOrCountChanged:Y,onBeforePagingInfoChanged:X,onPagingInfoChanged:Q,onGroupExpanded:F,onGroupCollapsed:O})},Aggregators:{}}}),"undefined"==typeof Slick)throw new Error('"slick.core.js" not loaded');function xe(i){var e,o,t,n,a,r={val:{title:""}},l=function(e){var t,i,o,n=e,a=void 0;if(t=n.column.field,i=n.item[t],_.isObject(i)&&i.class)a=i.class;else{for(o=0;o<n.grid.getDataLength();o++)if(i=n.grid.getDataItem(o)[t],_.isObject(i)&&i.class){a=i.class;break}void 0===a&&(a=""+(1200+n.grid.getOptions().kdbTypesColumnInfo.get(t).get("kdbType")))}return a}(i),s=b.Types.kdbToDashboard[l],s=B.RTTI.getByName(s).editor;_.extend(r.val,Me.extend(!0,{},s)),(n=new w.Model({})).schema=r,this.init=function(){t=n.schema.val.isReplacementForCheckbox,a=new B({model:n}).render(),e=a.$el.appendTo(i.container).bind("keydown.nav",function(e){e.keyCode!==Me.ui.keyCode.LEFT&&e.keyCode!==Me.ui.keyCode.RIGHT||e.stopImmediatePropagation()}).dblclick(function(e){e.stopPropagation()}),_.defer(function(){e&&e.is(":visible")&&e.find("input[type='text']").focus().select()}),"Select"===n.schema.val.type&&e.bind("keydown",function(e){13==e.which&&a.fields.val.editor.$el.select2("close")})},this.destroy=function(){e&&(e.off(),e.remove()),a&&a.remove()},this.loadValue=function(e){var t,e=e[i.column.field];e=e,b.Types.kdbToDashboard[l]?t=b.convertKDBTemporalToMoment(e).toDashString():(t=e,v.Log.Log("unknown type in CustomSlickEditor.js > convertToEditor()")),o=t,n.set("val",o)},this.serializeValue=function(){return n.get("val")},this.applyValue=function(e,t){e[i.column.field]=(e=t,t=l,b.Types.kdbToDashboard[t]?b.convertValueToMoment(e,t).toKdbObject():e)},this.isValueChanged=function(){var e;return a&&a.commit(),e=this.serializeValue(),t&&(e="true"===e),!_.isEqual(e,o)},this.validate=function(){var e;return i.column.validator&&(e=this.serializeValue(),!(e=i.column.validator(e)).valid)?e:{valid:!0,msg:null}},this.init()}!function(){"use strict";var va,Ca;Slick.Utils.extend(Slick,{Grid:function(e,E,z,W){var S,r,R,A,P,$,L,V,B,H,G,Y,X,Q,J,Z,ee,te,ie,oe,ne,ae,re,le,se,de,ue,ce,he,pe,U,ge,m,fe,me,ve,Ce,we,K,be,ye,Se,_e,M,k,Re,Ee,o,t,Me,ke,xe,De={alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,autoCommitEdit:!1,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showColumnHeader:!0,showHeaderRow:!1,isHeaderRowVisible:!0,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,showPreHeaderPanel:!1,preHeaderPanelHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:function(e,t,i,o,n,a){return null==i?"":(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,showCellSelection:!0,viewportClass:null,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,autosizeColsMode:Slick.GridAutosizeColsMode.LegacyOff,autosizeColPaddingPx:4,autosizeTextAvgToMWidthRatio:.75,viewportSwitchToScrollModeWidthPercent:void 0,viewportMinWidthPx:void 0,viewportMaxWidthPx:void 0,suppressCssChangesOnHiddenInit:!1,scrollDebounceDelay:-1,ffMaxSupportedCssHeight:6e6,maxSupportedCssHeight:1e9,sanitizer:void 0,logSanitizedHtml:!1},Ie={name:"",resizable:!0,sortable:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,headerCssClass:null,defaultSortAsc:!0,focusable:!0,selectable:!0,hidden:!1},Te={ignoreHeaderText:!1,colValueArray:void 0,allowAddlPercent:void 0,formatterOverride:void 0,autosizeMode:Slick.ColAutosizeMode.ContentIntelligent,rowSelectionModeOnInit:void 0,rowSelectionMode:Slick.RowSelectionMode.FirstNRows,rowSelectionCount:100,valueFilterMode:Slick.ValueFilterMode.None,widthEvalMode:Slick.WidthEvalMode.Auto,sizeToRemaining:void 0,widthPx:void 0,contentSizePx:0,headerWidthPx:0,colDataTypeOf:void 0},Fe=0,l=0,Oe=1,j=Slick.Utils,Ne=j.show,n=j.hide,v=new Slick.BindingEventService,Ae=!1,C="slickgrid_"+j.generateUid(),w=this,Pe=[],s=[],Le=[],Ve=0,Be=0,He=0,x=!1,Ge=0,D=-1,ze=0,We=0,$e=0,Ue=0,Ke=0,je=0,qe=1,I=null,d=null,T={},Ye=0,Xe=0,Qe=0,u=0,Je=0,Ze=0,et=0,a=0,tt=[],it=[],ot={},nt={},c=[],at=[],rt=[],lt=[],st=!1,dt=!1,ut=(t=q,{enqueue:function(){ke?xe=!0:ht()},dequeue:ct});function ct(){xe=!1}function ht(){ke=!0,setTimeout(pt,Me),t()}function pt(){xe?(ct(),ht()):ke=!1}var gt,ft,mt,vt,Ct,wt,bt,yt,St,_t,Rt,Et,Mt,kt,xt,Dt,It,Tt,Ft,Ot,Nt,At,h,Pt,Lt,Vt,Bt,Ht,Gt,zt,p,g,Wt,$t,Ut,Kt,jt,qt,Yt=null,Xt=null,Qt=null,Jt={},Zt=null,ei=null,ti=[],ii=0,oi=0,ni=0,ai={position:"absolute",visibility:"hidden",display:"block"},ri=[],li=xe=ke=!(Me=50),si=!1,di=null,ui=[],ci=[],hi=!1,pi=[];function gi(){if(!Ae){Ae=!0,xo(),ko();for(var e=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=s[0],i=(Ve=0,Be=He=0,j.createDomElement("div",{className:"ui-state-default slick-header-column",style:{visibility:"hidden"},textContent:"-"},i)),o=getComputedStyle(i),n=("border-box"!=o["box-sizing"]&&"border-box"!=o["-moz-box-sizing"]&&"border-box"!=o["-webkit-box-sizing"]&&(e.forEach(function(e){Ve+=j.toFloat(o[e])}),t.forEach(function(e){j.toFloat(o[e])})),i.remove(),j.createDomElement("div",{className:"slick-row"},se[0])),a=(i=j.createDomElement("div",{className:"slick-cell",id:"",style:{visibility:"hidden",textContent:"-"}},n),"border-box"!=(o=getComputedStyle(i))["box-sizing"]&&"border-box"!=o["-moz-box-sizing"]&&"border-box"!=o["-webkit-box-sizing"]&&(e.forEach(function(e){Be+=j.toFloat(o[e])}),t.forEach(function(e){He+=j.toFloat(o[e])})),n.remove(),be=Math.max(Ve,Be),s.forEach(function(e){e.setAttribute("unselectable","on"),e.style.MozUserSelect="none",v.bind(e,"selectstart",function(e){e.stopPropagation(),e.preventDefault()})}),W.enableTextSelectionOnCells||le.forEach(function(e){v.bind(e,"selectstart",function(e){e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||(e.stopPropagation(),e.preventDefault())})}),Vi(),Bi(),Gi(),Hi(),no(),Ni(),Ti(),s.forEach(function(e){v.bind(e,"click",function(e){if(!si&&!e.target.classList.contains("slick-resizable-handle")){var t=e.target.closest(".slick-header-column");if(t){var i=j.storage.get(t,"column");if(i.sortable&&y().commitCurrentEdit()){for(var t=c.slice(),o=null,n=0;n<c.length;n++)if(c[n].columnId==i.id){(o=c[n]).sortAsc=!o.sortAsc;break}var a=!!o;W.tristateMultiColumnSort?(o=o||{columnId:i.id,sortAsc:i.defaultSortAsc},a&&o.sortAsc&&(c.splice(n,1),o=null),W.multiColumnSort||(c=[]),!o||a&&W.multiColumnSort||c.push(o)):(a=e.metaKey||e.ctrlKey)&&W.multiColumnSort?o&&c.splice(n,1):((e.shiftKey||a)&&W.multiColumnSort||(c=[]),o?0===c.length&&c.push(o):(o={columnId:i.id,sortAsc:i.defaultSortAsc},c.push(o))),_.isEqual(c,at)||(at=_.cloneDeep(c),a=W.multiColumnSort?{multiColumnSort:!0,previousSortColumns:t,sortCols:c.map(function(e){return{columnId:z[f(e.columnId)].id,sortCol:z[f(e.columnId)],sortAsc:e.sortAsc}})}:{multiColumnSort:!1,previousSortColumns:t,columnId:0<c.length?i.id:null,sortCol:0<c.length?i:null,sortAsc:!(0<c.length)||c[0].sortAsc},!1!==b(w.onBeforeSort,a,e).getReturnValue()&&(io(c),b(w.onSort,a,e)))}}}})}),zi(),Do(),x&&!W.frozenBottom?Gt:Bt);(a=a.parentNode)!=document.body&&null!=a;)a!=h&&a.scrollWidth==a.clientWidth&&a.scrollHeight==a.clientHeight||(Le.push(a),v.bind(a,"scroll."+C,Fn));v.bind($,"resize.slickgrid",Do),le.forEach(function(e){v.bind(e,"scroll",Wo)}),W.enableMouseWheelScrollHandler&&le.forEach(function(e){ui.push(Slick.MouseWheel({element:e,onMouseWheel:Yo}))}),Pe.forEach(function(e){v.bind(e,"contextmenu",dn),v.bind(e,"click",un)}),H.forEach(function(e){v.bind(e,"scroll",Ho)}),W.createFooterRow&&(X.forEach(function(e){v.bind(e,"contextmenu",cn),v.bind(e,"click",hn)}),Q.forEach(function(e){v.bind(e,"scroll",Go)})),W.createPreHeaderPanel&&v.bind(te,"scroll",zo),v.bind(L,"keydown",en),v.bind(V,"keydown",en),se.forEach(function(e){v.bind(e,"keydown",en),v.bind(e,"mousedown",tn),v.bind(e,"dblclick",nn),v.bind(e,"contextmenu",on),v.bind(e,"mouseover",pn),v.bind(e,"mouseout",gn)}),Slick.Draggable&&(di=Slick.Draggable({containerElement:$,allowDragFrom:"div.slick-cell",onDragInit:Xo,onDragStart:Qo,onDrag:Jo,onDragEnd:Zo})),W.suppressCssChangesOnHiddenInit||mi()}}function fi(){for(var e=0,t=Kt=j.parents($,":hidden");e<t.length;e++){var i,o=t[e],n={};for(i in ai)n[i]=o.style[i],o.style[i]=ai[i];ri.push(n)}}function mi(){for(var e=0,t=0,i=Kt;t<i.length;t++){var o,n=i[t],a=ri[e++];for(o in ai)n.style[o]=a[o]}}function F(){return-1<W.frozenColumn}function vi(e){for(var t=it.length;0<=t;t--)if(it[t]===e){it[t].destroy&&it[t].destroy(),it.splice(t,1);break}}function Ci(){return o}function wi(e,t){return _i(se,e,t)}function bi(){return se}function yi(){return le}function Si(e){return e instanceof Slick.EventData&&(e=e.getNativeEvent()),Se=e.target.closest(".slick-viewport")}function _i(e,t,i){if(e)return i=i||0,t="number"==typeof(t=t||0)?t:f(t),e[(x&&i>=D+(W.frozenBottom?0:1)?2:0)+(F()&&t>W.frozenColumn?1:0)]}function Ri(){var e=j.createDomElement("div",{className:le.className,style:{position:"absolute",top:"-10000px",left:"-10000px",overflow:"auto",width:"100px",height:"100px"}},document.body),t=j.createDomElement("div",{style:{width:"200px",height:"200px",overflow:"auto"}},e),i={width:e.offsetWidth-e.clientWidth,height:e.offsetHeight-e.clientHeight};return t.remove(),e.remove(),i}function Ei(){me=ve=Ce=0;for(var e,t=!W.autoHeight,i=0,o=z.length;i<o;i++)z[i]&&!z[i].hidden&&(e=z[i].width,-1<W.frozenColumn&&i>W.frozenColumn?Ce+=e:ve+=e);return t&&(-1<W.frozenColumn&&i>W.frozenColumn?Ce+=va.width:ve+=va.width),F()?(ve+=1e3,Ce=Math.max(Ce,U)+ve,Ce+=va.width):(ve+=va.width,ve=Math.max(ve,U)+1e3),me=ve+Ce,Math.max(me,U)+1e3}function Mi(){var e=K?U-va.width:U,t=z.length;for(m=fe=0;t--;)z[t]&&!z[t].hidden&&(F()&&t>W.frozenColumn?fe+=z[t].width:m+=z[t].width);var i=m+fe;return W.fullWidthRows&&0<(e=Math.max(i,e)-i)&&(i+=e,F()?fe+=e:m+=e),i}function ki(e){var t=ge,i=m,o=fe;((t=(ge=Mi())!==t||m!==i||fe!==o)||F()||x)&&(j.width(Bt,m),Ei(),j.width(St,ve),j.width(_t,Ce),F()?(j.width($),j.width(Ht,fe),j.width(gt,m),j.setStyleSize(ft,"left",m),j.setStyleSize(ft,"width",U-m),j.width(mt,m),j.setStyleSize(vt,"left",m),j.width(vt,U-m),j.width(Rt,m),j.width(Et,U-m),j.width(xt,m),j.width(Dt,fe),W.createFooterRow&&(j.width(Mt,m),j.width(kt,U-m),j.width(It,m),j.width(Tt,fe)),W.createPreHeaderPanel&&j.width(ee,ge),j.width(h,m),j.width(Pt,U-m),x&&(j.width(Ct,m),j.setStyleSize(wt,"left",m),j.width(Lt,m),j.width(Vt,U-m),j.width(Gt,m),j.width(zt,fe))):(j.width(gt,"100%"),j.width(mt,"100%"),j.width(Rt,"100%"),j.width(xt,ge),W.createFooterRow&&(j.width(Mt,"100%"),j.width(It,ge)),W.createPreHeaderPanel&&j.width(ee,ge),j.width(h,"100%"),x&&(j.width(Lt,"100%"),j.width(Gt,m)))),we=ge>=U-va.width,j.width(G,ge+(K?va.width:0)),j.width(Y,ge+(K?va.width:0)),W.createFooterRow&&(j.width(J,ge+(K?va.width:0)),j.width(Z,ge+(K?va.width:0))),(t||e)&&eo()}function xi(){return C}function Di(e){return e?(e=f(e.id),!F()||e<=W.frozenColumn?St:_t):F()?s:St}function Ii(){return ee}function Ti(){if(W.createFooterRow){X.forEach(function(e){e.querySelectorAll(".slick-footerrow-column").forEach(function(e){var t=j.storage.get(e,"column");b(w.onBeforeFooterRowCellDestroy,{node:e,column:t,grid:w})})}),It.replaceChildren(),Tt.replaceChildren();for(var e=0;e<z.length;e++){var t,i,o=z[e];o&&!o.hidden&&(t=j.createDomElement("div",{className:"ui-state-default slick-footerrow-column l".concat(e," r").concat(e)},F()&&e>W.frozenColumn?Tt:It),(i=F()&&e<=W.frozenColumn?"frozen":null)&&t.classList.add(i),j.storage.put(t,"column",o),b(w.onFooterRowCellRendered,{node:t,column:o,grid:w}))}}}function Fi(e){e.target.classList.add("ui-state-hover")}function Oi(e){e.target.classList.remove("ui-state-hover")}function Ni(){s.forEach(function(e){e.querySelectorAll(".slick-header-column").forEach(function(e){var t=j.storage.get(e,"column");t&&b(w.onBeforeHeaderCellDestroy,{node:e,column:t,grid:w})})}),St.replaceChildren(),_t.replaceChildren(),Ei(),j.width(St,ve),j.width(_t,Ce),B.forEach(function(e){e.querySelectorAll(".slick-headerrow-column").forEach(function(e){e=j.storage.get(e,"column");e&&b(w.onBeforeHeaderRowCellDestroy,{node:this,column:e,grid:w})})}),xt.replaceChildren(),Dt.replaceChildren(),W.createFooterRow&&(It.querySelectorAll(".slick-footerrow-column").forEach(function(e){e=j.storage.get(e,"column");e&&b(w.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:w})}),It.replaceChildren(),F())&&(Tt.querySelectorAll(".slick-footerrow-column").forEach(function(e){e=j.storage.get(e,"column");e&&b(w.onBeforeFooterRowCellDestroy,{node:this,column:e,grid:w})}),Tt.replaceChildren());for(var r,e,t=0;t<z.length;t++){var i=z[t];if(i&&!i.hidden){var o=!F()||t<=W.frozenColumn?St:_t,n=!F()||t<=W.frozenColumn?xt:Dt,a=j.createDomElement("div",{id:"".concat(C+i.id),dataset:{id:i.id},className:"ui-state-default slick-header-column "+(i.field||""),title:i.toolTip||""},o),o=(j.createDomElement("span",{className:"slick-column-name",innerHTML:ma(i.name)},a),j.width(a,i.width-Ve),W.headerFontWeight&&(a.style.fontWeight=W.headerFontWeight),i.headerCssClass||null);if(o&&a.classList.add(o),(o=F()&&t<=W.frozenColumn?"frozen":null)&&a.classList.add(o),v.bind(a,"mouseenter",an),v.bind(a,"mouseleave",rn),j.storage.put(a,"column",i),(W.enableColumnReorder||i.sortable)&&(v.bind(a,"mouseenter",Fi),v.bind(a,"mouseleave",Oi)),i.hasOwnProperty("headerCellAttrs")&&i.headerCellAttrs instanceof Object)for(var l in i.headerCellAttrs)i.headerCellAttrs.hasOwnProperty(l)&&a.setAttribute(l,i.headerCellAttrs[l]);i.sortable&&(a.classList.add("slick-header-sortable"),j.createDomElement("div",{className:"slick-sort-indicator ".concat(W.numberedMultiColumnSort&&!W.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":"")},a),W.numberedMultiColumnSort)&&W.sortColNumberInSeparateSpan&&j.createDomElement("div",{className:"slick-sort-indicator-numbered"},a),b(w.onHeaderCellRendered,{node:a,column:i,grid:w}),W.showHeaderRow&&(o=j.createDomElement("div",{className:"ui-state-default slick-headerrow-column l".concat(t," r").concat(t)},n),(n=F()&&t<=W.frozenColumn?"frozen":null)&&o.classList.add(n),v.bind(o,"mouseenter",ln),v.bind(o,"mouseleave",sn),j.storage.put(o,"column",i),b(w.onHeaderRowCellRendered,{node:o,column:i,grid:w})),W.createFooterRow&&W.showFooterRow&&(n=!F()||t<=W.frozenColumn?X[0]:X[1],o=j.createDomElement("div",{className:"ui-state-default slick-footerrow-column l".concat(t," r").concat(t)},n),j.storage.put(o,"column",i),b(w.onFooterRowCellRendered,{node:o,column:i,grid:w}))}}io(c),Pi(),W.enableColumnReorder&&("function"==typeof W.enableColumnReorder?W.enableColumnReorder(w,s,Ve,ro,Pi,z,f,C,b):(jt&&(jt.destroy(),qt.destroy()),e={animation:50,direction:"horizontal",chosenClass:"slick-header-column-active",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dragoverBubble:!1,revertClone:!(r=null),scroll:!F(),onStart:function(e){clearInterval(r),r=null},onEnd:function(e){clearInterval(r),r=null;if(y().commitCurrentEdit()){var t=(t=jt.toArray()).concat(qt.toArray()),i=[],o=[];hi=!0,pi=_.map(pi,function(e,t){return 0!=e?z[t].width:z[t].minWidth});for(var n=0;n<t.length;n++){var a=f(t[n].replace(C,""));i.push(z[a]),o.push(pi[a])}pi=o,ro(i),b(w.onColumnsReordered,{impactedColumns:function(e){var t=[];if(e)for(var i=e.start;i<=e.end;i++)t.push(z[i]);else t=z;return t}(null)}),e.stopPropagation(),Pi()}}},jt=Sortable.create(St,e),qt=Sortable.create(_t,e)))}function Ai(e){e=e.target.parentElement.id.replace(C,"");b(w.onColumnsResizeDblClick,{triggeredByColumn:e})}function Pi(){if(void 0===Slick.Resizable)throw new Error('Slick.Resizable is undefined, make sure to import "slick.interactions.js"');for(var d,u,c,h,p,g,i,o,e,t,f=0,l=(e=Array.from(s[0].children),t=Array.from(s[1].children),e.concat(t)),n=0;n<l.length;n++)l[n].querySelectorAll(".slick-resizable-handle").forEach(function(e){e.remove()}),n>=z.length||!z[n]||z[n].hidden||z[n].resizable&&(void 0===i&&(i=n),o=n);if(void 0!==i)for(n=0;n<l.length;n++)!function(s){var e,t=l[s];s>=z.length||!z[s]||z[s].hidden||s<i||W.forceFitColumns&&o<=s||(e=j.createDomElement("div",{className:"slick-resizable-handle",role:"separator",ariaOrientation:"horizontal"},t),v.bind(e,"dblclick",Ai),ci.push(Slick.Resizable({resizeableElement:t,resizeableHandleElement:e,onResizeStart:function(e,t){e=e.touches?e.touches[0]:e;if(!y().commitCurrentEdit())return!1;h=e.pageX,f=0,t.resizeableElement.classList.add("slick-header-column-active");for(var i=null,o=null,n=0;n<l.length;n++)n>=z.length||!z[n]||z[n].hidden||(z[n].previousWidth=l[n].offsetWidth);if(W.forceFitColumns)for(o=i=0,d=s+1;d<z.length;d++)(c=z[d])&&c.resizable&&!c.hidden&&(null!==o&&(c.maxWidth?o+=c.maxWidth-c.previousWidth:o=null),i+=c.previousWidth-Math.max(c.minWidth||0,be));var a=0,r=0;for(d=0;d<=s;d++)(c=z[d])&&c.resizable&&!c.hidden&&(null!==r&&(c.maxWidth?r+=c.maxWidth-c.previousWidth:r=null),a+=c.previousWidth-Math.max(c.minWidth||0,be));null===i&&(i=1e5),null===a&&(a=1e5),null===o&&(o=1e5),null===r&&(r=1e5),g=h+Math.min(i,r),p=h-Math.min(a,o)},onResize:function(e,t){e=e.touches?e.touches[0]:e;si=!0;var i,o,n,a,e=Math.min(g,Math.max(p,e.pageX))-h,r=0,l=K?U-va.width:U;if(e<0){for(o=e,d=s;0<=d;d--)(c=z[d])&&c.resizable&&!c.hidden&&(i=Math.max(c.minWidth||0,be),o&&c.previousWidth+o<i?(o+=c.previousWidth-i,c.width=i):(c.width=c.previousWidth+o,o=0));for(u=0;u<=s;u++)(c=z[u])&&!c.hidden&&(F()&&u>W.frozenColumn?c.width:r+=c.width);if(W.forceFitColumns)for(o=-e,d=s+1;d<z.length;d++)(c=z[d])&&!c.hidden&&c.resizable&&(o&&c.maxWidth&&c.maxWidth-c.previousWidth<o?(o-=c.maxWidth-c.previousWidth,c.width=c.maxWidth):(c.width=c.previousWidth+o,o=0),F()&&d>W.frozenColumn?c.width:r+=c.width);else for(d=s+1;d<z.length;d++)(c=z[d])&&!c.hidden&&(F()&&d>W.frozenColumn?c.width:r+=c.width);if(W.forceFitColumns)for(o=-e,d=s+1;d<z.length;d++)(c=z[d])&&!c.hidden&&c.resizable&&(o&&c.maxWidth&&c.maxWidth-c.previousWidth<o?(o-=c.maxWidth-c.previousWidth,c.width=c.maxWidth):(c.width=c.previousWidth+o,o=0))}else{for(o=e,r=0,d=s;0<=d;d--)(c=z[d])&&!c.hidden&&c.resizable&&(o&&c.maxWidth&&c.maxWidth-c.previousWidth<o?(o-=c.maxWidth-c.previousWidth,c.width=c.maxWidth):(n=c.previousWidth+o,a=m+o,F()&&d<=W.frozenColumn?(f<n&&a<l-W.frozenRightViewportMinWidth&&(f=n),c.width=a+W.frozenRightViewportMinWidth>l?f:n):c.width=n,o=0));for(u=0;u<=s;u++)(c=z[u])&&!c.hidden&&(F()&&u>W.frozenColumn?c.width:r+=c.width);if(W.forceFitColumns)for(o=-e,d=s+1;d<z.length;d++)(c=z[d])&&!c.hidden&&c.resizable&&(i=Math.max(c.minWidth||0,be),o&&c.previousWidth+o<i?(o+=c.previousWidth-i,c.width=i):(c.width=c.previousWidth+o,o=0),F()&&d>W.frozenColumn?c.width:r+=c.width);else for(d=s+1;d<z.length;d++)(c=z[d])&&!c.hidden&&(F()&&d>W.frozenColumn?c.width:r+=c.width)}F()&&r!=m&&(j.width(St,r+1e3),j.setStyleSize(ft,"left",r)),Zi(),W.syncColumnCellResize&&eo(),b(w.onColumnsDrag,{triggeredByColumn:t.resizeableElement,resizeHandle:t.resizeableHandleElement})},onResizeEnd:function(e,t){t.resizeableElement.classList.remove("slick-header-column-active"),hi=!0;var i,t=t.resizeableElement.id.replace(C,"");for(!0===b(w.onBeforeColumnsResize,{triggeredByColumn:t}).getReturnValue()&&Zi(),d=0;d<z.length;d++)(c=z[d])&&!c.hidden&&(i=l[d].offsetWidth,c.previousWidth!==i)&&c.rerenderOnResize&&yo();ki(!0),q(),b(w.onColumnsResized,{triggeredByColumn:t}),setTimeout(function(){si=!1},300)}})))}(n)}function Li(e){var t=getComputedStyle(e),i=0;return["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"].forEach(function(e){i+=j.toFloat(t[e])}),i}function Vi(){var e;W.frozenColumn=0<=W.frozenColumn&&W.frozenColumn<z.length?parseInt(W.frozenColumn):-1,-1<W.frozenRow?(x=!0,Ge=W.frozenRow*W.rowHeight,e=O(),D=W.frozenBottom?e-W.frozenRow:W.frozenRow):x=!1}function Bi(){F()?(Ne(ft),Ne(vt),x?(Ne(Ct),Ne(wt)):(n(wt),n(Ct))):(n(ft),n(vt),n(wt),(x?Ne:(n(wt),n))(Ct))}function Hi(){h.style["overflow-x"]=F()?x&&!W.alwaysAllowHorizontalScroll?"hidden":"scroll":x&&!W.alwaysAllowHorizontalScroll?"hidden":"auto",h.style["overflow-y"]=!F()&&W.alwaysShowVerticalScroll?"scroll":F()?"hidden":x?"scroll":"auto",Pt.style["overflow-x"]=F()?x&&!W.alwaysAllowHorizontalScroll?"hidden":"scroll":x&&!W.alwaysAllowHorizontalScroll?"hidden":"auto",Pt.style["overflow-y"]=W.alwaysShowVerticalScroll||(F(),x)?"scroll":"auto",Lt.style["overflow-x"]=F()?x&&!W.alwaysAllowHorizontalScroll?"scroll":"auto":(x&&W.alwaysAllowHorizontalScroll,"auto"),Lt.style["overflow-y"]=!F()&&W.alwaysShowVerticalScroll?"scroll":F()?"hidden":x?"scroll":"auto",Vt.style["overflow-x"]=F()?x&&!W.alwaysAllowHorizontalScroll?"scroll":"auto":(x&&W.alwaysAllowHorizontalScroll,"auto"),Vt.style["overflow-y"]=W.alwaysShowVerticalScroll?"scroll":(F(),"auto"),W.viewportClass&&(h.classList.add(W.viewportClass),Pt.classList.add(W.viewportClass),Lt.classList.add(W.viewportClass),Vt.classList.add(W.viewportClass))}function Gi(){F()?(Wt=yt,$t=Et,Ut=kt,x?W.frozenBottom?(p=Vt,g=Pt):p=g=Vt:p=g=Pt):(Wt=bt,$t=Rt,Ut=Mt,x?W.frozenBottom?(p=Lt,g=h):p=g=Lt:p=g=h)}function zi(){for(var e=j.createDomElement("template",{innerHTML:'<style type="text/css" rel="stylesheet" />'}),e=(de=e.content.firstChild,document.head.appendChild(de),W.rowHeight-He),t=["."+C+" .slick-group-header-column { left: 1000px; }","."+C+" .slick-header-column { left: 1000px; }","."+C+" .slick-top-panel { height:"+W.topPanelHeight+"px; }","."+C+" .slick-preheader-panel { height:"+W.preHeaderPanelHeight+"px; }","."+C+" .slick-headerrow-columns { height:"+W.headerRowHeight+"px; }","."+C+" .slick-footerrow-columns { height:"+W.footerRowHeight+"px; }","."+C+" .slick-cell { height:"+e+"px; }","."+C+" .slick-row { height:"+W.rowHeight+"px; }","."+C+" .slick-header-column { height:"+W.headerRowHeight+"px; }","."+C+" .slick-cell { line-height:"+e+"px; }","."+C+" .slick-row { line-height:"+W.rowHeight+"px; }","."+C+" .slick-header-column { line-height:"+W.headerRowHeight+"px; }"],i=0;i<z.length;i++)z[i]&&!z[i].hidden&&(t.push("."+C+" .l"+i+" { }"),t.push("."+C+" .r"+i+" { }"));de.styleSheet?de.styleSheet.cssText=t.join(" "):de.appendChild(document.createTextNode(t.join(" ")))}function Wi(){de.remove(),ue=null}function $i(e){if(e)for(var t=Array.isArray(e)?e:[e],i=void 0;null!=(i=t.pop());)i&&"function"==typeof i.destroy&&i.destroy();return e=Array.isArray(e)?[]:null}var Ui=null,Ki=null;function ji(e){return!e.ignoreHeaderText&&!e.sizeToRemaining&&e.contentSizePx===e.headerWidthPx&&e.widthPx<100}function qi(e,L){fi();var V=L;if((e=e||W.autosizeColsMode)===Slick.GridAutosizeColsMode.KxRatio){var t,i,o,n,a,r,l={},s=!1;if(F=_.every(z,function(e){return _.get(e,"_dashboardConfig._RetainWidth",!1)}),a=K?U-va.width:U,r=_.reduce(pi,function(e,t){return e+t},0),F){if(s=!0,r<a)for(t=0;t<z.length;t++)z[t].width=a*pi[t]/r}else{for(t=0;t<z.length;t++)i=z[t],n=r?a*pi[t]/r:0,!hi&&i.minWidth>n&&!l[t]&&(n=i.minWidth,a=Math.max(0,a-n),r=Math.max(0,r-pi[t]),l[t]=!0,t=-1);for(t=0;t<z.length;t++)o=l[t]?z[t].minWidth:hi?z[t].width:a*pi[t]/r,z[t].rerenderOnResize&&z[t].width!=o&&(s=!0),z[t].width=o}Zi(),ki(!0),s&&(yo(),q())}else if(e===Slick.GridAutosizeColsMode.LegacyForceFit||e===Slick.GridAutosizeColsMode.LegacyOff){var d,u,c,h=[],p=0,g=0,f=K?U-va.width:U;for(d=0;d<z.length;d++)(u=z[d])&&!u.hidden&&(h.push(u.width),g+=u.width,u.resizable)&&(p+=u.width-Math.max(u.minWidth,be));for(c=g;f<g&&p;){var m,v,C,B=(g-f)/p;for(d=0;d<z.length&&f<g;d++)!(u=z[d])||u.hidden||(m=h[d],!u.resizable)||m<=u.minWidth||m<=be||(v=Math.max(u.minWidth,be),C=Math.floor(B*(m-v))||1,C=Math.min(C,m-v),g-=C,p-=C,h[d]-=C);if(c<=g)break;c=g}for(c=g;g<f;){var w,H=f/g;for(d=0;d<z.length&&g<f;d++)(u=z[d])&&!u.hidden&&(w=h[d],w=!u.resizable||u.maxWidth<=w?0:Math.min(Math.floor(H*w)-w,u.maxWidth-w||1e6)||1,h[d]+=(g+=w)<=f?w:0);if(g<=c)break;c=g}var b=!1;for(d=0;d<z.length;d++)u&&!u.hidden&&(z[d].rerenderOnResize&&z[d].width!=h[d]&&(b=!0),z[d].width=h[d]);Qi(b)}else if(e!==Slick.GridAutosizeColsMode.None){(Ui=document.createElement("canvas"))&&Ui.getContext&&(Ki=Ui.getContext("2d"));var y,S,R,E,G=wi(0,0),M=K?U-va.width:U,k=0,x=0,D=0,I=0,T=0;for(y=0;y<z.length;y++)Yi(S=z[y],y,G,V,y),T+=S.autoSize.autosizeMode===Slick.ColAutosizeMode.Locked?S.width:ji(S.autoSize)?S.autoSize.widthPx:0,I+=S.autoSize.autosizeMode===Slick.ColAutosizeMode.Locked?S.width:ji(S.autoSize)?S.autoSize.widthPx:S.minWidth,k+=S.autoSize.widthPx,x+=S.autoSize.sizeToRemaining?0:S.autoSize.widthPx,D+=S.autoSize.sizeToRemaining&&S.minWidth||0;var F,O,N=k-x;if(e===Slick.GridAutosizeColsMode.FitViewportToCols&&(F=k+va.width,e=Slick.GridAutosizeColsMode.IgnoreViewport,W.viewportMaxWidthPx&&F>W.viewportMaxWidthPx?(F=W.viewportMaxWidthPx,e=Slick.GridAutosizeColsMode.FitColsToViewport):W.viewportMinWidthPx&&F<W.viewportMinWidthPx&&(F=W.viewportMinWidthPx,e=Slick.GridAutosizeColsMode.FitColsToViewport),j.width($,F)),e===Slick.GridAutosizeColsMode.FitColsToViewport)if(0<N&&x<M-D)for(y=0;y<z.length;y++)(S=z[y])&&!S.hidden&&(O=M-x,R=S.autoSize.sizeToRemaining?O*S.autoSize.widthPx/N:S.autoSize.widthPx,S.rerenderOnResize&&S.width!=R&&(E=!0),S.width=R);else if(W.viewportSwitchToScrollModeWidthPercent&&x+D>M*W.viewportSwitchToScrollModeWidthPercent/100||M<I)e=Slick.GridAutosizeColsMode.IgnoreViewport;else{var A=x-T,P=M-T-D;for(y=0;y<z.length;y++)(S=z[y])&&!S.hidden&&(R=S.width,S.autoSize.autosizeMode===Slick.ColAutosizeMode.Locked||ji(S.autoSize)||(S.autoSize.sizeToRemaining?R=S.minWidth:((R=P/A*S.autoSize.widthPx-1)<S.minWidth&&(R=S.minWidth),A-=S.autoSize.widthPx,P-=R)),ji(S.autoSize)&&(R=S.autoSize.widthPx)<S.minWidth&&(R=S.minWidth),S.rerenderOnResize&&S.width!=R&&(E=!0),S.width=R)}if(e===Slick.GridAutosizeColsMode.IgnoreViewport)for(y=0;y<z.length;y++)z[y]&&!z[y].hidden&&(R=z[y].autoSize.widthPx,z[y].rerenderOnResize&&z[y].width!=R&&(E=!0),z[y].width=R);Qi(E)}mi()}function Yi(e,t,i,o,n){var a,r,l,s=e.autoSize;s.widthPx=e.width,s.autosizeMode!==Slick.ColAutosizeMode.Locked&&s.autosizeMode!==Slick.ColAutosizeMode.Guide&&(r=O(),l=new RegExp(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z/),s.autosizeMode===Slick.ColAutosizeMode.ContentIntelligent&&(a=s.colDataTypeOf,"boolean"===(a=0<r&&(r=N(0))&&(r=r[e.field],"object"===(a=typeof(r=l.test(r)?Date.parse(r):r)))&&(r instanceof Date&&(a="date"),void 0!==wa)&&r instanceof wa?"moment":a)&&(s.colValueArray=[!0,!1]),"number"===a&&(s.valueFilterMode=Slick.ValueFilterMode.GetGreatestAndSub,s.rowSelectionMode=Slick.RowSelectionMode.AllRows),"string"===a&&(s.valueFilterMode=Slick.ValueFilterMode.GetLongestText,s.rowSelectionMode=Slick.RowSelectionMode.AllRows,s.allowAddlPercent=5),"date"===a&&(s.colValueArray=[new Date(2009,8,30,12,20,20)]),"moment"===a)&&void 0!==wa&&(s.colValueArray=[wa([2009,8,30,12,20,20])]),l=(l=0===(l=s.contentSizePx=function(t,e,i,o,n){var a,r,l=t.autoSize,s=1,d=0,u=0;l.headerWidthPx=0,l.ignoreHeaderText||(l.headerWidthPx=function(e){var t=0,i=C+e.id,o=document.getElementById(i),i=i+"_";{var n,a;o?((n=o.cloneNode(!0)).id=i,n.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",o.parentNode.insertBefore(n,o),t=n.offsetWidth,n.parentNode.removeChild(n)):(a=Di(e),o=j.createDomElement("div",{id:i,className:"ui-state-default slick-header-column"},a),j.createDomElement("span",{className:"slick-column-name",innerHTML:ma(e.name)},o),n.style.cssText="position: absolute; visibility: hidden;right: auto;text-overflow: initial;white-space: nowrap;",o.classList.add(e.headerCssClass||""),t=o.offsetWidth,a.removeChild(o))}return t}(t));0===l.headerWidthPx&&(l.headerWidthPx=t.width||t.maxWidth||t.minWidth||20);if(l.colValueArray)u=Xi(t,i,l.colValueArray);else{var c={},e=(c.colIndex=e,c.rowCount=O(),c.startIndex=0,c.endIndex=c.rowCount-1,c.valueArr=null,c.getRowVal=function(e){return N(e)[t.field]},(o?l.rowSelectionModeOnInit:void 0)||l.rowSelectionMode);if(e===Slick.RowSelectionMode.FirstRow&&(c.endIndex=0),e===Slick.RowSelectionMode.LastRow&&(c.endIndex=c.startIndex=c.rowCount-1),e===Slick.RowSelectionMode.FirstNRows&&(c.endIndex=Math.min(l.rowSelectionCount,c.rowCount)-1),l.valueFilterMode===Slick.ValueFilterMode.DeDuplicate){var h={};for(a=c.startIndex;a<=c.endIndex;a++)h[c.getRowVal(a)]=!0;if(Object.keys)c.valueArr=Object.keys(h);else for(var p in c.valueArr=[],h)c.valueArr.push(p);c.startIndex=0,c.endIndex=c.length-1}if(l.valueFilterMode===Slick.ValueFilterMode.GetGreatestAndSub){var g,f=0;for(a=c.startIndex;a<=c.endIndex;a++)r=c.getRowVal(a),Math.abs(r)>f&&(g=r,f=Math.abs(r));g=""+g,g=Array(g.length+1).join("9"),c.valueArr=[g=+g],c.startIndex=c.endIndex=0}if(l.valueFilterMode===Slick.ValueFilterMode.GetLongestTextAndSub){for(a=c.startIndex;a<=c.endIndex;a++)((r=c.getRowVal(a))||"").length>d&&(d=r.length);r=Array(d+1).join("m"),s=W.autosizeTextAvgToMWidthRatio,c.maxLen=d,c.valueArr=[r],c.startIndex=c.endIndex=0}if(l.valueFilterMode===Slick.ValueFilterMode.GetLongestText){var m=d=0;for(a=c.startIndex;a<=c.endIndex;a++)((r=c.getRowVal(a))||"").length>d&&(d=r.length,m=a);r=c.getRowVal(m),c.maxLen=d,c.valueArr=[r],c.startIndex=c.endIndex=0}c.maxLen&&30<c.maxLen&&1<n&&(l.sizeToRemaining=!0),u=Xi(t,i,c)*s}return Math.max(l.headerWidthPx,u)}(e,t,i,o,n))?s.widthPx:l)*(s.allowAddlPercent?1+s.allowAddlPercent/100:1)+W.autosizeColPaddingPx,e.minWidth&&l<e.minWidth&&(l=e.minWidth),e.maxWidth&&l>e.maxWidth&&(l=e.maxWidth),(s.autosizeMode===Slick.ColAutosizeMode.ContentExpandOnly||e.editor&&e.editor.ControlFillsColumn)&&l<e.width&&(l=e.width),s.widthPx=l)}function Xi(e,t,i){var t=j.createDomElement("div",{className:"slick-row ui-widget-content"},t),o=j.createDomElement("div",{className:"slick-cell"},t);o.style.position="absolute",o.style.visibility="hidden",o.style["text-overflow"]="initial",o.style["white-space"]="nowrap";var n,a,r,l,s,d,u=0,c=e.autoSize.widthEvalMode===Slick.WidthEvalMode.TextOnly;if(e.autoSize.widthEvalMode===Slick.WidthEvalMode.Auto&&(h=!e.formatterOverride&&!e.formatter,d=e.formatterOverride&&e.formatterOverride.ReturnsTextOnly||!e.formatterOverride&&e.formatter&&e.formatter.ReturnsTextOnly,c=h||d),Ki&&c){var h=getComputedStyle(o);for(Ki.font=h["font-size"]+" "+h["font-family"],n=i.startIndex;n<=i.endIndex;n++)s=i.valueArr?i.valueArr[n]:i.getRowVal(n),u<(a=(l=e.formatterOverride?e.formatterOverride(n,i.colIndex,s,e,N(n),w):e.formatter?e.formatter(n,i.colIndex,s,e,N(n),w):""+s)?Ki.measureText(l).width:0)&&(u=a,r=l);return o.innerHTML=r,a=o.offsetWidth,t.remove(),a}for(n=i.startIndex;n<=i.endIndex;n++)s=i.valueArr?i.valueArr[n]:i.getRowVal(n),Eo(l=e.formatterOverride?e.formatterOverride(n,i.colIndex,s,e,N(n),w):e.formatter?e.formatter(n,i.colIndex,s,e,N(n),w):""+s,o),u<(a=o.offsetWidth)&&(u=a);return t.remove(),u}function Qi(e){Zi(),ki(!0),b(w.onAutosizeColumns,{columns:z}),e&&(yo(),q())}function Ji(){return z.filter(function(e){return!e.hidden})}function b(e,t,i){return i=i||new Slick.EventData(i,t),(t=t||{}).grid=w,e.notify(t,i,w)}function y(){return W.editorLock}function f(e){return nt[e]}function Zi(){var n,a;Ae&&(n=0,a=Ji(),s.forEach(function(e){for(var t=0;t<e.children.length;t++,n++){var i=e.children[t],o=((a[n]||{}).width||0)-Ve;j.width(i)!==o&&j.width(i,o)}}),no())}function eo(){for(var e,t,i=0,o=0;o<z.length;o++)z[o]&&z[o].hidden||(e=z[o].width,(t=function(e){if(!ue){for(var t=document.styleSheets,i=0;i<t.length;i++)if((t[i].ownerNode||t[i].owningElement)==de){ue=t[i];break}if(!ue)throw new Error("SlickGrid Cannot find stylesheet.");ce=[],he=[];var o,n,a=ue.cssRules||ue.rules;for(i=0;i<a.length;i++){var r=a[i].selectorText;(o=/\.l\d+/.exec(r))?(n=parseInt(o[0].substr(2,o[0].length-2),10),ce[n]=a[i]):(o=/\.r\d+/.exec(r))&&(n=parseInt(o[0].substr(2,o[0].length-2),10),he[n]=a[i])}}return{left:ce[e],right:he[e]}}(o)).left.style.left=i+"px",t.right.style.right=(-1!=W.frozenColumn&&o>W.frozenColumn?fe:m)-i-e+"px",W.frozenColumn!=o&&(i+=z[o].width)),W.frozenColumn==o&&(i=0)}function to(i){var o=null;return s.every(function(e){var t=e.children.length;return i<t?(o=e.children[i],!1):(i-=t,!0)}),o}function io(e){c=e;var i=W.numberedMultiColumnSort&&1<c.length,o=(s.forEach(function(e){var t=e.querySelectorAll(".slick-header-column-sorted");t.forEach(function(e){e.classList.remove("slick-header-column-sorted")}),(t=e.querySelectorAll(".slick-sort-indicator")).forEach(function(e){e.classList.remove("slick-sort-indicator-asc"),e.classList.remove("slick-sort-indicator-desc")}),(t=e.querySelectorAll(".slick-sort-indicator-numbered")).forEach(function(e){e.textContent=""})}),1);c.forEach(function(e){null==e.sortAsc&&(e.sortAsc=!0);var t=f(e.columnId);null!=t&&(t=to(t))&&(t.classList.add("slick-header-column-sorted"),t.querySelector(".slick-sort-indicator").classList.add(e.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),i)&&(t.querySelector(".slick-sort-indicator-numbered").textContent=o),o++})}function oo(e,t){for(var i,o,n=e.getNativeEvent(),a=tt.slice(0),r=(tt=[],{}),l=0;l<t.length;l++)for(var s=t[l].fromRow;s<=t[l].toRow;s++){r[s]||(tt.push(s),r[s]={});for(var d=t[l].fromCell;d<=t[l].toCell;d++)da(s,d)&&(r[s][z[d].id]=W.selectedCellCssClass)}qo(W.selectedCellCssClass,r),i=a,o=tt,Array.isArray(i)&&Array.isArray(o)&&!_.isEqual(i,o)&&(i=n&&n.detail&&n.detail.caller||"click",o=pa().filter(function(e){return a.indexOf(e)<0}),n=a.filter(function(e){return pa().indexOf(e)<0}),b(w.onSelectedRowsChanged,{rows:pa(),previousSelectedRows:a,caller:i,changedSelectedRows:o,changedUnselectedRows:n},e))}function no(){rt=[],lt=[];for(var e=0,t=0,i=z.length;t<i;t++)z[t]&&!z[t].hidden&&(rt[t]=e,lt[t]=e+z[t].width,W.frozenColumn==t?e=0:e+=z[t].width)}function ao(e){nt={};for(var t=0;t<z.length;t++){z[t].width&&(z[t].widthRequest=z[t].width);var i=z[t]=j.extend({},Ie,z[t]);i.autoSize=j.extend({},Te,i.autoSize),nt[i.id]=t,e?pi.push(i.width):i.minWidth&&i.width<i.minWidth&&(i.width=i.minWidth),i.maxWidth&&i.width>i.maxWidth&&(i.width=i.maxWidth)}}function ro(e){b(w.onBeforeSetColumns,{previousColumns:z,newColumns:e,grid:w}),z=e,lo()}function lo(){ao(),no(),Ae&&(Bi(),Hi(),yo(),Ni(),Ti(),Wi(),zi(),Do(),ki(),Zi(),eo(),Wo(),o)&&o.refreshSelections&&o.refreshSelections()}function so(){W.autoHeight&&(W.leaveSpaceForNewRows=!1),W.forceFitColumns&&(W.autosizeColsMode=Slick.GridAutosizeColsMode.LegacyForceFit,console.log("forceFitColumns option is deprecated - use autosizeColsMode"))}function O(){return E.getLength?E.getLength():E&&E.length||0}function uo(){return O()+(W.enableAddRow&&(!st||dt)?1:0)}function N(e){return E.getItem?E.getItem(e):E[e]}function co(e,t,i,o){o=!1!==o;W[e]!=i&&((W[e]=i)?o?j.slideDown(t,Do):(Ne(t),Do()):o?j.slideUp(t,Do):(n(t),Do()))}function ho(e,t){co("showColumnHeader",Pe,e,t)}function po(e){return W.rowHeight*e-l}function go(e){return Math.floor((e+l)/W.rowHeight)}function fo(e){e=Math.max(e,0),e=Math.min(e,S-j.height(g)+(we||F()?va.height:0));var t,i=l,e=(Fe=Math.min(A-1,Math.floor(e/R)),e-(l=Math.round(Fe*P)));if(l!=i)for(t in bo(To(e)),T){t=t?parseInt(t):0;j.setStyleSize("top",po(t))}Qe!=e&&(Oe=Qe+i<e+l?1:-1,Je=u=Qe=e,F()&&(h.scrollTop=e),x&&(Lt.scrollTop=Vt.scrollTop=e),g.scrollTop=e,b(w.onViewportChanged,{}))}function mo(e,t){var e=E.getItemMetadata&&E.getItemMetadata(e),i=e&&e.columns&&(e.columns[t.id]||e.columns[f(t.id)]);return i&&i.formatter||e&&e.formatter||t.formatter||W.formatterFactory&&W.formatterFactory.getFormatter(t)||W.defaultFormatter}function vo(e,t){var i=z[t],e=E.getItemMetadata&&E.getItemMetadata(e),e=e&&e.columns;return e&&e[i.id]&&void 0!==e[i.id].editor?e[i.id].editor:e&&e[t]&&void 0!==e[t].editor?e[t].editor:i.editor||W.editorFactory&&W.editorFactory.getEditor(i)}function Co(e,t){return W.dataItemColumnValueExtractor?W.dataItemColumnValueExtractor(e,t):e[t.field]}function wo(e,t,i,o,n){var a=z[i],r="slick-cell l"+i+" r"+Math.min(z.length-1,i+o-1)+(a.cssClass?" "+a.cssClass:"");for(c in F()&&i<=W.frozenColumn&&(r+=" frozen"),t===M&&i===k&&W.showCellSelection&&(r+=" active"),ot)ot[c][t]&&ot[c][t][a.id]&&(r+=" "+ot[c][t][a.id]);var l=null,s="";n&&(l=Co(n,a),null==(s=mo(t,a)(t,i,l,a,n,w)))&&(s="");var l=b(w.onBeforeAppendCell,{row:t,cell:i,value:l,dataContext:n}).getReturnValue()||"",d=(l+=s&&s.addClasses?(l?" ":"")+s.addClasses:"",s&&s.toolTip?"title='"+s.toolTip+"'":""),u="";if(a.hasOwnProperty("cellAttrs")&&a.cellAttrs instanceof Object)for(var c in a.cellAttrs)a.cellAttrs.hasOwnProperty(c)&&(u+=" "+c+'="'+a.cellAttrs[c]+'" ');e.push('<div class="'.concat(r+(l?" "+l:""),'" ').concat(d+u,">")),n&&e.push("[object Object]"!==Object.prototype.toString.call(s)?s:s.text),e.push("</div>"),T[t].cellRenderQueue.push(i),T[t].cellColSpans[i]=o}function bo(e){for(var t in T){var i=!0;x&&(W.frozenBottom&&D<=t||!W.frozenBottom&&t<=D)&&(i=!1),(t=parseInt(t,10))!==M&&(t<e.top||t>e.bottom)&&i&&So(t)}W.enableAsyncPostRenderCleanup&&Vo()}function yo(){for(var e in d&&Mn(),T)So(e);W.enableAsyncPostRenderCleanup&&Vo()}function So(e){var t=T[e];if(t){if(W.enableAsyncPostRenderCleanup&&Jt[e]){var i,o=t,n=Jt[e],a=e;for(i in ii++,n)n.hasOwnProperty(i)&&ti.push({actionType:"C",groupId:ii,node:o.cellNodesByColumnIdx[0|i],columnIdx:0|i,rowIdx:a});ti.push({actionType:"R",groupId:ii,node:o.rowNode}),o.rowNode.forEach(function(e){e.remove()})}else t.rowNode.forEach(function(e){e.parentElement&&e.parentElement.removeChild(e)});delete T[e],delete Jt[e],Ye--,ni++}}function _o(e){var t,i;if(e&&e.length){for(Oe=0,i=e.length,t=0;t<i;t++)d&&M===e[t]&&Mn(),T[e[t]]&&So(e[t]);W.enableAsyncPostRenderCleanup&&Vo()}}function Ro(e){!e&&0!==e||_o([e])}function Eo(e,t,i){null==e&&(e=""),"[object Object]"!==Object.prototype.toString.call(e)?t.innerHTML=ma(e):(t.innerHTML=ma(e.text),e.removeClasses&&!i&&e.removeClasses.split(" ").forEach(function(e){t.classList.remove(e)}),e.addClasses&&e.addClasses.split(" ").forEach(function(e){t.classList.add(e)}),e.toolTip&&t.setAttribute("title",e.toolTip))}function Mo(e){var t=T[e];if(t){Oo(e);var i,o,n,a=N(e);for(i in t.cellNodesByColumnIdx)t.cellNodesByColumnIdx.hasOwnProperty(i)&&(o=z[i|=0],n=t.cellNodesByColumnIdx[i],e===M&&i===k&&d?d.loadValue(a):a?Eo(mo(e,o)(e,i,Co(a,o),o,a,w),n):n.innerHTML="");Bo(e)}}function ko(){var e,t,i;W.autoHeight&&-1==W.frozenColumn||(Ue=W.showTopPanel?W.topPanelHeight+Li(ae[0]):0,Ke=W.showHeaderRow&&W.isHeaderRowVisible?W.headerRowHeight+Li(H[0]):0,je=W.showFooterRow?W.footerRowHeight+Li(Q[0]):0),pe=W.autoHeight?(e=gt.offsetHeight,e=(e=(e+=W.showHeaderRow&&W.isHeaderRowVisible?W.headerRowHeight+Li(H[0]):0)+(W.showFooterRow?W.footerRowHeight+Li(Q[0]):0))+(Mi()>U?va.height:0),W.rowHeight*uo()+(-1==W.frozenColumn?e:0)):(e=W.showColumnHeader?j.toFloat(j.height(Pe[0]))+Li(Pe[0]):0,t=W.createPreHeaderPanel&&W.showPreHeaderPanel?W.preHeaderPanelHeight+Li(te):0,i=getComputedStyle($),j.toFloat(i.height)-j.toFloat(i.paddingTop)-j.toFloat(i.paddingBottom)-e-Ue-Ke-je-t),Xe=Math.ceil(pe/W.rowHeight)}function xo(){U=parseFloat(j.innerSize($,"width"))}function Do(){var e;Ae&&($e=We=ze=0,xo(),ko(),x?We=W.frozenBottom?(ze=pe-Ge-va.height,Ge+va.height):pe-(ze=Ge):ze=pe,ze+=Ue+Ke+je,F()&&W.autoHeight&&(ze+=va.height),$e=ze-Ue-Ke-je,W.autoHeight&&(F()&&(e=getComputedStyle(bt),j.height($,ze+j.toFloat(e.height))),mt.style.position="relative"),j.setStyleSize(mt,"top",j.height(gt)||(W.showHeaderRow?W.headerRowHeight:0)+(W.showPreHeaderPanel?W.preHeaderPanelHeight:0)),j.height(mt,ze),e=mt.offsetTop+ze,W.autoHeight||j.height(h,$e),F()?(j.setStyleSize(vt,"top",j.height(gt)),j.height(vt,ze),j.height(Pt,$e),x&&(j.setStyleSize(Ct,"top",e),j.height(Ct,We),j.setStyleSize(wt,"top",e),j.height(wt,We),j.height(Vt,We))):x&&(j.width(Ct,"100%"),j.height(Ct,We),j.setStyleSize(Ct,"top",e)),x?(j.height(Lt,We),W.frozenBottom?(j.height(Gt,Ge),F()&&j.height(zt,Ge)):(j.height(Bt,Ge),F()&&j.height(Ht,Ge))):j.height(Pt,$e),va&&va.width||(va=Ri()),W.autosizeColsMode!==Slick.GridAutosizeColsMode.LegacyForceFit&&W.autosizeColsMode!==Slick.GridAutosizeColsMode.KxRatio||qi(),Io(),Wo(),Ze=-1,q())}function Io(){if(Ae){var e,t=O(),i=uo(),o=0,i=(x&&!W.frozenBottom?j.height(Gt):j.height(Bt),o=x?O()-W.frozenRow:i+(W.leaveSpaceForNewRows?Xe-1:0),j.height(g)),n=K,a=(K=W.alwaysShowVerticalScroll||!W.autoHeight&&o*W.rowHeight>i,Mn(),t-1);for(e in T)a<e&&So(e);W.enableAsyncPostRenderCleanup&&Vo(),I&&a<M&&bn();t=r,o=(W.autoHeight?r=W.rowHeight*o:(S=Math.max(W.rowHeight*o,i-va.height),P=S<Ca?(r=R=S,A=1,0):(R=(r=Ca)/100,A=Math.floor(S/R),(S-r)/(A-1))),r===t&&!li||(x&&!W.frozenBottom?(j.height(Gt,r),F()&&j.height(zt,r)):(j.height(Bt,r),j.height(Ht,r)),u=g.scrollTop,li=!1),u+l<=S-i);0==S||0==u?Fe=l=0:fo(o?u+l:S-i+va.height),r!=t&&W.autoHeight&&Do(),W.autosizeColsMode===Slick.GridAutosizeColsMode.LegacyForceFit&&n!=K&&qi(),ki(!1)}}function To(e,t){return null==t&&(t=a),{top:go(e=null==e?u:e),bottom:go(e+pe)+1,leftPx:t,rightPx:t+U}}function Fo(e,t){var e=To(e,t),t=Math.round(pe/W.rowHeight),i=W.minRowBuffer;return-1==Oe?(e.top-=t,e.bottom+=i):1==Oe?(e.top-=i,e.bottom+=t):(e.top-=i,e.bottom+=i),e.top=Math.max(0,e.top),e.bottom=Math.min(uo()-1,e.bottom),e.leftPx-=U,e.rightPx+=U,e.leftPx=Math.max(0,e.leftPx),e.rightPx=Math.min(ge,e.rightPx),e}function Oo(e){var t=T[e];if(t&&t.cellRenderQueue.length)for(var e=t.rowNode,i=Array.from(e[0].children),o=(i=1<e.length?i.concat(Array.from(e[1].children)):i).length-1;t.cellRenderQueue.length;){var n=t.cellRenderQueue.pop();t.cellNodesByColumnIdx[n]=i[o--]}}function No(e,t){if(!x||!(W.frozenBottom&&D<t||t<=D)){var i,o,n,a,r,l=T[t],s=[];for(i in l.cellNodesByColumnIdx)!l.cellNodesByColumnIdx.hasOwnProperty(i)||(i|=0)<=W.frozenColumn||Array.isArray(z)&&z[i]&&z[i].alwaysRenderColumn||(o=l.cellColSpans[i],!(rt[i]>e.rightPx||lt[Math.min(z.length-1,i+o-1)]<e.leftPx))||t==M&&i==k||s.push(i);for(;null!=(n=s.pop());)a=l.cellNodesByColumnIdx[n],W.enableAsyncPostRenderCleanup&&Jt[t]&&Jt[t][n]?(r=a,ti.push({actionType:"C",groupId:ii,node:r,columnIdx:n,rowIdx:t}),r.remove()):a.parentElement.removeChild(a),delete l.cellColSpans[n],delete l.cellNodesByColumnIdx[n],Jt[t]&&delete Jt[t][n],0}}function Ao(e){for(var t=[],i=[],o=e.top,n=e.bottom;o<=n;o++)if(m=T[o]){Oo(o),No(e,o);for(var a,r,l=0,s=(s=E.getItemMetadata&&E.getItemMetadata(o))&&s.columns,d=N(o),u=0,c=z.length;u<c;u++)if(z[u]&&!z[u].hidden){if(rt[u]>e.rightPx)break;null==(r=m.cellColSpans[u])&&(r=1,s&&"*"===(r=(a=s[z[u].id]||s[u])&&a.colspan||1)&&(r=c-u),lt[Math.min(c-1,u+r-1)]>e.leftPx)&&(wo(t,o,u,r,d),l++),u+=1<r?r-1:0}l&&i.push(o)}if(t.length)for(var h,p,g=j.createDomElement("div",{innerHTML:ma(t.join(""))});null!=(h=i.pop());)for(var f,m=T[h];null!=(f=m.cellRenderQueue.pop());)p=g.lastChild,(F()&&f>W.frozenColumn?m.rowNode[1]:m.rowNode[0]).appendChild(p),m.cellNodesByColumnIdx[f]=p}function Po(e){for(var t=[],i=[],o=[],n=!1,a=O(),r=e.top,l=e.bottom;r<=l;r++)if(!(T[r]||x&&W.frozenBottom&&r==O())){Ye++,o.push(r),T[r]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},w=S=y=s=b=C=v=m=f=g=p=h=c=u=d=void 0;var s,d=t,u=i,c=r,h=e,p=a,g=N(c),f="",m=c%2==1,p="slick-row"+(x&&c<=W.frozenRow?" frozen":"")+(c<p&&!g?" loading":"")+(c===M&&W.showCellSelection?" active":"")+(m?" odd":" even"),v=(g||(p+=" "+W.addNewRowCssClass),E.getItemMetadata&&E.getItemMetadata(c)),C=(v&&v.cssClasses&&(p+=" "+v.cssClasses),Cn(c)),m=(m?W.oddRowBackgroundColorOverride&&(f="background-color:"+W.oddRowBackgroundColorOverride):W.evenRowBackgroundColorOverride&&(f="background-color:"+W.evenRowBackgroundColorOverride),'<div class="ui-widget-content '.concat(p,'" style="top:').concat(po(c)-C,"px;").concat(f,'">'));d.push(m),F()&&u.push(m);for(var w,b,y=0,S=z.length;y<S;y++)if((s=z[y])&&!s.hidden){if(b=1,v&&v.columns&&"*"===(b=(w=v.columns[s.id]||v.columns[y])&&w.colspan||1)&&(b=S-y),lt[Math.min(S-1,y+b-1)]>h.leftPx){if(!s.alwaysRenderColumn&&rt[y]>h.rightPx)break;F()&&y>W.frozenColumn?wo(u,c,y,b,g):wo(d,c,y,b,g)}else(s.alwaysRenderColumn||F()&&y<=W.frozenColumn)&&wo(d,c,y,b,g);1<b&&(y+=b-1)}d.push("</div>"),F()&&u.push("</div>"),I&&M===r&&(n=!0),oi++}if(o.length){for(var _=j.createDomElement("div",{innerHTML:ma(t.join(""))}),R=j.createDomElement("div",{innerHTML:ma(i.join(""))}),r=0,l=o.length;r<l;r++)x&&D<=o[r]?F()?(T[o[r]].rowNode=[_.firstChild,R.firstChild],Gt.appendChild(_.firstChild),zt.appendChild(R.firstChild)):(T[o[r]].rowNode=[_.firstChild],Gt.appendChild(_.firstChild)):F()?(T[o[r]].rowNode=[_.firstChild,R.firstChild],Bt.appendChild(_.firstChild),Ht.appendChild(R.firstChild)):(T[o[r]].rowNode=[_.firstChild],Bt.appendChild(_.firstChild));n&&(I=la(M,k))}}function Lo(){W.enableAsyncPostRender&&(clearTimeout(Xt),Xt=setTimeout(Uo,W.asyncPostRenderDelay))}function Vo(){W.enableAsyncPostRenderCleanup&&(clearTimeout(Qt),Qt=setTimeout(Ko,W.asyncPostRenderCleanupDelay))}function Bo(e){for(var t in Jt[e])Jt[e].hasOwnProperty(t)&&(Jt[e][t]="C");ei=Math.min(ei,e),Zt=Math.max(Zt,e),Lo()}function q(){var e,t,i;Ae&&(ut.dequeue(),e=To(),bo(t=Fo()),Ze!=a&&(x&&(i=j.extend(!0,{},t),W.frozenBottom?(i.top=D,i.bottom=O()):(i.top=0,i.bottom=W.frozenRow),Ao(i)),Ao(t)),Po(t),x&&(W.frozenBottom?Po({top:D,bottom:O()-1,leftPx:t.leftPx,rightPx:t.rightPx}):Po({top:0,bottom:W.frozenRow-1,leftPx:t.leftPx,rightPx:t.rightPx})),ei=e.top,Zt=Math.min(uo()-1,e.bottom),Lo(),Je=u,Ze=a,b(w.onRendered,{startRow:e.top,endRow:e.bottom,grid:w}))}function Ho(){var e=$t.scrollLeft;e!=p.scrollLeft&&(p.scrollLeft=e)}function Go(){var e=Ut.scrollLeft;e!=p.scrollLeft&&(p.scrollLeft=e)}function zo(){var e=te;(e=e.scrollLeft)!=p.scrollLeft&&(p.scrollLeft=e)}function Wo(){return u=g.scrollTop,a=p.scrollLeft,$o(!1)}function $o(e){var t,i=g.scrollHeight-g.clientHeight,o=g.scrollWidth-g.clientWidth,i=Math.max(0,i),o=Math.max(0,o),i=(i<u&&(u=i),o<a&&(a=o),Math.abs(u-Qe)),o=Math.abs(a-et);return o&&(et=a,j.debounce(function(){p.scrollLeft=a,Wt.scrollLeft=a,ae[0].scrollLeft=a,W.createFooterRow&&(Ut.scrollLeft=a),W.createPreHeaderPanel&&(F()?ne.scrollLeft=a:te.scrollLeft=a),F()?(x&&(Pt.scrollLeft=a),Et.scrollLeft=a):(x&&(h.scrollLeft=a),Rt.scrollLeft=a)},W.scrollDebounceDelay)()),i&&!W.autoHeight&&(Oe=Qe<u?1:-1,Qe=u,e&&(g.scrollTop=u),F()&&(x&&!W.frozenBottom?Lt.scrollTop=u:h.scrollTop=u),i<pe?fo(u+l):(e=l,Fe=r==pe?0:Math.min(A-1,Math.floor(u*((S-pe)/(r-pe))*(1/R))),e!=(l=Math.round(Fe*P))&&yo())),(o||i)&&(e=Math.abs(Ze-a),t=Math.abs(Je-u),20<e||20<t)&&(W.forceSyncScrolling||t<pe&&e<U?q():ut.enqueue(),b(w.onViewportChanged,{})),b(w.onScroll,{scrollLeft:a,scrollTop:u}),!(!o&&!i)}function Uo(){for(var e=O();ei<=Zt;){var t,i,o,n=0<=Oe?ei++:Zt--,a=T[n];if(a&&!(e<=n)){for(var r in Jt[n]||(Jt[n]={}),Oo(n),a.cellNodesByColumnIdx)a.cellNodesByColumnIdx.hasOwnProperty(r)&&(t=z[r|=0],i=Jt[n][r],t.asyncPostRender)&&"R"!==i&&((o=a.cellNodesByColumnIdx[r])&&t.asyncPostRender(o,n,N(n),t,"C"===i),Jt[n][r]="R");return void(Xt=setTimeout(Uo,W.asyncPostRenderDelay))}}}function Ko(){if(0<ti.length){for(var e=ti[0].groupId;0<ti.length&&ti[0].groupId==e;){var t,i=ti.shift();"R"==i.actionType&&i.node.forEach(function(e){e.remove()}),"C"==i.actionType&&(t=z[i.columnIdx]).asyncPostRenderCleanup&&i.node&&t.asyncPostRenderCleanup(i.node,i.rowIdx,t)}Qt=setTimeout(Ko,W.asyncPostRenderCleanupDelay)}}function jo(e,t){var i,o,n,a,r;for(r in T){if(a=t&&t[r],n=e&&e[r],a)for(o in a)n&&a[o]==n[o]||(i=la(r,f(o)))&&i.classList.remove(a[o]);if(n)for(o in n)a&&a[o]==n[o]||(i=la(r,f(o)))&&i.classList.add(n[o])}}function qo(e,t){var i=ot[e];jo(ot[e]=t,i),b(w.onCellCssStylesChanged,{key:e,hash:t,grid:w})}function Yo(e,t,i,o){u=Math.max(0,g.scrollTop-o*W.rowHeight),a=p.scrollLeft+10*i,$o(!0)&&e.preventDefault()}function Xo(e,t){var i,o;return!y().isActive()&&!(!(i=wn(e))||!fn(i.row,i.cell)||!(o=b(w.onDragInit,t,e)).isImmediatePropagationStopped())&&o.getReturnValue()}function Qo(e,t){var i=wn(e);return!(!i||!fn(i.row,i.cell)||!(i=b(w.onDragStart,t,e)).isImmediatePropagationStopped())&&i.getReturnValue()}function Jo(e,t){return b(w.onDrag,t,e).getReturnValue()}function Zo(e,t){b(w.onDragEnd,t,e)}function en(e){var t=b(w.onKeyDown,{row:M,cell:k},e).isImmediatePropagationStopped(),i=Slick.keyCode;if(!t&&!e.shiftKey&&!e.altKey){if(W.editable&&d&&d.keyCaptureList&&-1<d.keyCaptureList.indexOf(e.which))return;e.which==i.HOME?t=(e.ctrlKey?Vn:na)():e.which==i.END&&(t=(e.ctrlKey?Bn:aa)())}if(!t)if(e.shiftKey||e.altKey||e.ctrlKey)e.which!=i.TAB||!e.shiftKey||e.ctrlKey||e.altKey||(t=oa());else{if(W.editable&&d&&d.keyCaptureList&&-1<d.keyCaptureList.indexOf(e.which))return;if(e.which==i.ESCAPE){if(!y().isActive())return;Dn()}else e.which==i.PAGE_DOWN?(Pn(),t=!0):e.which==i.PAGE_UP?(Ln(),t=!0):e.which==i.LEFT?t=Zn():e.which==i.RIGHT?t=Jn():e.which==i.UP?t=ta():e.which==i.DOWN?t=ea():e.which==i.TAB?t=ia():e.which==i.ENTER&&(W.editable&&(d?(M===O()?ea:xn)():y().commitCurrentEdit()&&kn(void 0,void 0,e)),t=!0)}if(b(w.onKeyDownDone,{row:M,cell:k},e),t){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(e){}}}function tn(e){0;var t,i=e,o=(i instanceof Slick.EventData?i=e.getNativeEvent():e=void 0,d||(i.target!=document.activeElement||i.target.classList.contains("slick-cell"))&&(t=function(){var e=null;{var t;window.getSelection&&0<(t=window.getSelection()).rangeCount&&(e=t.getRangeAt(0))}return e}(),yn(),t=t,window.getSelection)&&t&&((o=window.getSelection()).removeAllRanges(),o.addRange(t)),wn(i));!o||null!==d&&M==o.row&&k==o.cell||(e=b(w.onClick,{row:o.row,cell:o.cell},e||i),e.isImmediatePropagationStopped()||!sa(o.row,o.cell)||y().isActive()&&!y().commitCurrentEdit()||(Nn(o.row,!1),t=i.target&&i.target.className===Slick.preClickClassName,e=z[o.cell],e=!!(W.editable&&e&&e.editor&&W.suppressActiveCellChangeOnEdit),Rn(la(o.row,o.cell),null,t,e,i)),b(w.onClickDone,{row:o.row,cell:o.cell},i))}function on(e){var t=e.target.closest(".slick-cell");!t||I===t&&null!==d||b(w.onContextMenu,{},e)}function nn(e){var t=wn(e);!t||null!==d&&M==t.row&&k==t.cell||(b(w.onDblClick,{row:t.row,cell:t.cell},e),e.defaultPrevented)||W.editable&&ua(t.row,t.cell,!0,e)}function an(e){var t=j.storage.get(e.target.closest(".slick-header-column"),"column");t&&b(w.onHeaderMouseEnter,{column:t,grid:w},e)}function rn(e){var t=j.storage.get(e.target.closest(".slick-header-column"),"column");t&&b(w.onHeaderMouseLeave,{column:t,grid:w},e)}function ln(e){var t=j.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&b(w.onHeaderRowMouseEnter,{column:t,grid:w},e)}function sn(e){var t=j.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&b(w.onHeaderRowMouseLeave,{column:t,grid:w},e)}function dn(e){var t=e.target.closest(".slick-header-column"),t=t&&j.storage.get(t,"column");b(w.onHeaderContextMenu,{column:t},e)}function un(e){var t;si||(t=(t=e.target.closest(".slick-header-column"))&&j.storage.get(t,"column"))&&b(w.onHeaderClick,{column:t},e)}function cn(e){var t=e.target.closest(".slick-footerrow-column"),t=t&&j.storage.get(t,"column");b(w.onFooterContextMenu,{column:t},e)}function hn(e){var t=e.target.closest(".slick-footerrow-column"),t=t&&j.storage.get(t,"column");b(w.onFooterClick,{column:t},e)}function pn(e){b(w.onMouseEnter,{},e)}function gn(e){b(w.onMouseLeave,{},e)}function fn(e,t){return!(e<0||e>=O()||t<0||t>=z.length)}function mn(e,t){for(var t=go(t),i=0,o=0,n=0;n<z.length&&o<e;n++)z[n]&&!z[n].hidden&&(o+=z[n].width,i++);return{row:t,cell:(i=i<0?0:i)-1}}function vn(e){var t=/l\d+/.exec(e.className);if(t)return parseInt(t[0].substr(1,t[0].length-1),10);throw new Error("SlickGrid getCellFromNode: cannot get cell - "+e.className)}function Cn(e){return x?W.frozenBottom?D<=e?r<$e?D*W.rowHeight:r:0:D<=e?Ge:0:0}function wn(e){var t,i,o,n=e.target.closest(".slick-cell");return!n||(e=(e=e instanceof Slick.EventData?e.getNativeEvent():e).touches?e.touches[0]:e,o=function(e){for(var t in T)for(var i in T[t].rowNode)if(T[t].rowNode[i]===e)return t?parseInt(t):0;return null}(n.parentNode),x&&(t=j.offset(j.parents(n,".grid-canvas")[0]),i=0,j.parents(n,".grid-canvas-bottom").length&&(i=W.frozenBottom?j.height(Bt):Ge),o=mn(e.clientX-t.left,e.clientY-t.top+i+document.documentElement.scrollTop).row),e=vn(n),null==o)||null==e?null:{row:o,cell:e}}function bn(){Rn(null,!1)}function yn(){(-1==qe?L:V).focus()}function Sn(e,t,i){Nn(e,i),t<=W.frozenColumn||(i=Gn(e,t),_n(rt[t],lt[t+(1<i?i-1:0)]))}function _n(e,t){var i=a+j.width(p)-(K?va.width:0);e<a?(p.scrollLeft=e,Wo(),q()):i<t&&(p.scrollLeft=Math.min(e,t-p.clientWidth),Wo(),q())}function Rn(e,t,i,o,n){null!==I&&(Mn(),I.classList.remove("active"),T[M])&&T[M].rowNode.forEach(function(e){e.classList.remove("active")});var a,r;null!=(I=e)?(e=j.offset(I),a=Math.floor(j.offset(j.parents(I,".grid-canvas")[0]).top),r=j.parents(I,".grid-canvas-bottom").length,x&&r&&(a-=W.frozenBottom?j.height(Bt):Ge),r=mn(e.left,Math.ceil(e.top)-a),M=r.row,k=_e=k=_e=vn(I),null==t&&(t=M==O()||W.autoEdit),W.showCellSelection&&(I.classList.add("active"),T[M])&&T[M].rowNode.forEach(function(e){e.classList.add("active")}),W.editable&&t&&En(M,k)&&(clearTimeout(Yt),W.asyncEditorLoading?Yt=setTimeout(function(){kn(void 0,i,n)},W.asyncEditorLoadDelay):kn(void 0,i,n))):M=k=null,o||b(w.onActiveCellChanged,On())}function En(e,t){var i=O();return!(e<i&&!N(e)||z[t].cannotTriggerInsert&&i<=e||!z[t]||z[t].hidden||!vo(e,t))}function Mn(){if(d){var e,t;if(b(w.onBeforeCellEditorDestroy,{editor:d}),d.destroy(),d=null,I&&(e=N(M),I.classList.remove("editable"),I.classList.remove("invalid"),e)&&(t=z[k],Eo(mo(M,t)(M,k,Co(e,t),t,e,w),I),Bo(M)),navigator.userAgent.toLowerCase().match(/msie/))if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(e){}else window.getSelection&&(t=window.getSelection())&&t.removeAllRanges&&t.removeAllRanges();y().deactivate(Ee)}}function kn(e,t,i){if(I){if(!W.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when options.editable is false");var o,n,a;clearTimeout(Yt),En(M,k)&&(o=z[k],n=N(M),!1===b(w.onBeforeEditCell,{row:M,cell:k,item:n,column:o,target:"grid"}).getReturnValue()?yn():(y().activate(Ee),I.classList.add("editable"),a=e||vo(M,k),e||a.suppressClearOnEdit||(I.innerHTML=""),e=(e=(e=E.getItemMetadata&&E.getItemMetadata(M))&&e.columns)&&(e[o.id]||e[k]),d=new a({grid:w,gridPosition:In($),position:In(I),container:I,column:o,columnMetaData:e,item:n||{},event:i,commitChanges:xn,cancelChanges:Dn}),n&&(d.loadValue(n),t)&&d.preClick&&d.preClick(),Re=d.serializeValue(),d.position&&Fn()))}}function xn(){y().commitCurrentEdit()&&(yn(),W.autoEdit)&&!W.autoCommitEdit&&ea()}function Dn(){y().cancelCurrentEdit()&&yn()}function In(e){for(var t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:e.offsetWidth,height:e.offsetWidth,visible:!0},i=(t.bottom=t.top+t.height,t.right=t.left+t.width,e.offsetParent);(e=e.parentNode)!=document.body&&null!=e;){var o=getComputedStyle(e);t.visible&&e.scrollHeight!=e.offsetHeight&&"visible"!=o.overflowY&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!=e.offsetWidth&&"visible"!=o.overflowX&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===i&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,i=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width}return t}function Tn(){return In(I)}function Fn(){var e;I&&(b(w.onActiveCellPositionChanged,{}),d)&&(e=Tn(),d.show&&d.hide&&(e.visible?d.show():d.hide()),d.position)&&d.position(e)}function On(){return I?{row:M,cell:k}:null}function Nn(e,t){var i,o,n;(!x||!W.frozenBottom&&D-1<e||W.frozenBottom&&e<D-1)&&(i=j.height(g),o=(e=x&&!W.frozenBottom?e-W.frozenRow:e)*W.rowHeight,n=(e+1)*W.rowHeight-i+(we?va.height:0),(e+1)*W.rowHeight>u+i+l?(fo(t?o:n),q()):e*W.rowHeight<u+l&&(fo(t?n:o),q()))}function An(e){e*=Xe;if(fo((go(u+W.rowHeight-1)+e)*W.rowHeight),q(),W.enableCellNavigation&&null!=M){for(var t=M+e,e=uo(),i=((t=e<=t?e-1:t)<0&&(t=0),0),o=null,e=_e;i<=_e;)sa(t,i)&&(o=i),i+=Gn(t,i);null!==o?(Rn(la(t,o)),_e=e):bn()}}function Pn(){An(1)}function Ln(){An(-1)}function Vn(){Hn(0)}function Bn(){Hn(O()-1)}function Hn(e){var t=O();if(t&&(e<0?e=0:t<=e&&(e=t-1),Sn(e,0,!0),W.enableCellNavigation)&&null!=M){for(var i=0,o=null,t=_e;i<=_e;)sa(e,i)&&(o=i),i+=Gn(e,i);null!==o?(Rn(la(e,o)),_e=t):bn()}}function Gn(e,t){var e=E.getItemMetadata&&E.getItemMetadata(e);return e&&e.columns?"*"===(e=(e=e.columns[z[t].id]||e.columns[t])&&e.colspan)?z.length-t:e||1:1}function zn(e){for(var t=0;t<z.length;){if(sa(e,t))return t;t+=Gn(e,t)}return null}function Wn(e){for(var t=0,i=null;t<z.length;)sa(e,t)&&(i=t),t+=Gn(e,t);return i}function $n(e,t,i){if(t>=z.length)return null;for(;(t+=Gn(e,t))<z.length&&!sa(e,t););return t<z.length?{row:e,cell:t,posX:t}:null}function Un(e,t,i){if(t<=0)return null;var o=zn(e);if(null===o||t<=o)return null;for(var n,a={row:e,cell:o,posX:o};;){if(!(n=$n(a.row,a.cell,a.posX)))return null;if(n.cell>=t)return a;a=n}}function Kn(e,t,i){for(var o,n=uo();;){if(++e>=n)return null;for(o=t=0;t<=i;)t+=Gn(e,o=t);if(sa(e,o))return{row:e,cell:o,posX:i}}}function jn(e,t,i){for(var o;;){if(--e<0)return null;for(o=t=0;t<=i;)t+=Gn(e,o=t);if(sa(e,o))return{row:e,cell:o,posX:i}}}function qn(e,t,i){if(null==e&&null==t&&sa(e=t=0,t))return{row:e,cell:t,posX:t};t=$n(e,t);if(t)return t;var o,n=uo();for(e===n-1&&e--;++e<n;)if(null!==(o=zn(e)))return{row:e,cell:o,posX:o};return null}function Yn(e,t,i){if(null==e&&null==t&&sa(e=uo()-1,t=z.length-1))return{row:e,cell:t,posX:t};for(var o,n;!o&&!(o=Un(e,t));){if(--e<0)return null;t=0,null!==(n=Wn(e))&&(o={row:e,cell:n,posX:n})}return o}function Xn(e,t,i){var o=zn(e);return null===o?null:{row:e,cell:o,posX:o}}function Qn(e,t,i){var o=Wn(e);return null===o?null:{row:e,cell:o,posX:o}}function Jn(){return ra("right")}function Zn(){return ra("left")}function ea(){return ra("down")}function ta(){return ra("up")}function ia(){return ra("next")}function oa(){return ra("prev")}function na(){return ra("home")}function aa(){return ra("end")}function ra(e){if(!W.enableCellNavigation)return!1;if(!I&&"prev"!=e&&"next"!=e)return!1;if(!y().commitCurrentEdit())return!0;yn();qe={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1}[e];var t,e=(0,{up:jn,down:Kn,left:Un,right:$n,prev:Yn,next:qn,home:Xn,end:Qn}[e])(M,k,_e);return e?x&&W.frozenBottom&e.row==O()?void 0:(t=e.row==O(),(!W.frozenBottom&&e.row>=D||W.frozenBottom&&e.row<D)&&Sn(e.row,e.cell,!t&&W.emulatePagingWhenScrolling),Rn(la(e.row,e.cell)),_e=e.posX,!0):(Rn(la(M,k)),!1)}function la(t,i){if(T[t]){Oo(t);try{return T[t].cellNodesByColumnIdx.length>i?T[t].cellNodesByColumnIdx[i]:null}catch(e){return T[t].cellNodesByColumnIdx[i]}}return null}function sa(e,t){return!(!W.enableCellNavigation||e>=uo()||e<0||t>=z.length||t<0||!z[t]||z[t].hidden||((e=E.getItemMetadata&&E.getItemMetadata(e))&&void 0!==e.focusable?!e.focusable:(e=e&&e.columns)&&e[z[t].id]&&void 0!==e[z[t].id].focusable?!e[z[t].id].focusable:e&&e[t]&&void 0!==e[t].focusable?!e[t].focusable:!z[t].focusable))}function da(e,t){return!(e>=O()||e<0||t>=z.length||t<0||!z[t]||z[t].hidden||((e=E.getItemMetadata&&E.getItemMetadata(e))&&void 0!==e.selectable?!e.selectable:(e=e&&e.columns&&(e.columns[z[t].id]||e.columns[t]))&&void 0!==e.selectable?!e.selectable:!z[t].selectable))}function ua(e,t,i,o){var n;Ae&&sa(e,t)&&y().commitCurrentEdit()&&(Sn(e,t,!1),n=la(e,t),t=z[t],t=!!(W.editable&&t&&t.editor&&W.suppressActiveCellChangeOnEdit),Rn(n,i||e===O()||W.autoEdit,null,t,o),d||yn())}function ca(){var e,t,i=N(M),o=z[k];if(d){if(d.isValueChanged())return(e=d.validate()).valid?(M<O()?(t={row:M,cell:k,editor:d,serializedValue:d.serializeValue(),prevSerializedValue:Re,execute:function(){this.editor.applyValue(i,this.serializedValue),Mo(this.row),b(w.onCellChange,{command:"execute",row:this.row,cell:this.cell,item:i,column:o})},undo:function(){this.editor.applyValue(i,this.prevSerializedValue),Mo(this.row),b(w.onCellChange,{command:"undo",row:this.row,cell:this.cell,item:i,column:o})}},W.editCommandHandler?(Mn(),W.editCommandHandler(i,o,t)):(t.execute(),Mn())):(d.applyValue(t={},d.serializeValue()),Mn(),b(w.onAddNewRow,{item:t,column:o})),!y().isActive()):(I.classList.remove("invalid"),j.width(I),I.classList.add("invalid"),b(w.onValidationError,{editor:d,cellNode:I,validationResults:e,row:M,cell:k,column:o}),d.focus(),!1);Mn()}return!0}function ha(){return Mn(),!0}function pa(){if(o)return tt.slice(0);throw new Error("SlickGrid Selection model is not set")}var ga=0,fa=30;function ma(e,t){var i;return W.sanitizer&&"string"==typeof e?(i=W.sanitizer(e),!t&&W.logSanitizedHtml&&ga<=fa&&i!==e&&(console.log("sanitizer altered html: "+e+" --\x3e "+i),ga===fa&&console.log("sanitizer: silencing messages after first "+fa),ga++),i):e}if(this.debug=function(){var e="",e=(e=(e=(e=(e+="\ncounter_rows_rendered:  "+oi)+("\ncounter_rows_removed:  "+ni)+("\nrenderedRows:  "+Ye))+("\nnumVisibleRows:  "+Xe)+("\nmaxSupportedCssHeight:  "+Ca))+("\nn(umber of pages):  "+A)+("\n(current) page:  "+Fe))+("\npage height (ph):  "+R)+("\nvScrollDir:  "+Oe);alert(e)},Slick.Utils.extend(this,{slickGridVersion:"4.0.0",onScroll:new Slick.Event,onBeforeSort:new Slick.Event,onSort:new Slick.Event,onHeaderMouseEnter:new Slick.Event,onHeaderMouseLeave:new Slick.Event,onHeaderRowMouseEnter:new Slick.Event,onHeaderRowMouseLeave:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onHeaderCellRendered:new Slick.Event,onBeforeHeaderCellDestroy:new Slick.Event,onHeaderRowCellRendered:new Slick.Event,onFooterRowCellRendered:new Slick.Event,onFooterContextMenu:new Slick.Event,onFooterClick:new Slick.Event,onBeforeHeaderRowCellDestroy:new Slick.Event,onBeforeFooterRowCellDestroy:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onClickDone:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,onKeyDown:new Slick.Event,onKeyDownDone:new Slick.Event,onAddNewRow:new Slick.Event,onBeforeAppendCell:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsDrag:new Slick.Event,onColumnsResized:new Slick.Event,onColumnsResizeDblClick:new Slick.Event,onBeforeColumnsResize:new Slick.Event,onCellChange:new Slick.Event,onCompositeEditorChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,onSelectedRowsChanged:new Slick.Event,onCellCssStylesChanged:new Slick.Event,onAutosizeColumns:new Slick.Event,onBeforeSetColumns:new Slick.Event,onBeforeUpdateColumns:new Slick.Event,onRendered:new Slick.Event,onSetOptions:new Slick.Event,registerPlugin:function(e){it.unshift(e),e.init(w)},unregisterPlugin:vi,getPluginByName:function(e){for(var t=it.length-1;0<=t;t--)if(it[t].pluginName===e)return it[t]},getColumns:function(){return z},setColumns:ro,updateColumns:function(){b(w.onBeforeUpdateColumns,{columns:z,grid:w}),lo()},getVisibleColumns:Ji,getColumnIndex:f,updateColumnHeader:function(e,t,i){var o,n;Ae&&null!=(e=f(e))&&(o=z[e],n=to(e))&&(void 0!==t&&(z[e].name=t),void 0!==i&&(z[e].toolTip=i),b(w.onBeforeHeaderCellDestroy,{node:n,column:o,grid:w}),n.setAttribute("title",i||""),void 0!==t&&(n.children[0].innerHTML=ma(t)),b(w.onHeaderCellRendered,{node:n,column:o,grid:w}))},setSortColumn:function(e,t){io([{columnId:e,sortAsc:t}])},setSortColumns:io,getSortColumns:function(){return c},autosizeColumns:qi,autosizeColumn:function(e,t){var o=null,n=-1;if("number"==typeof e)o=z[e],n=e;else if("string"==typeof e)for(i=0;i<z.length;i++)z[i].Id===e&&(o=z[i],n=i);o&&Yi(o,n,wi(0,0),t,n)},getOptions:function(){return W},setOptions:function(e,t,i,o){var n;y().commitCurrentEdit()&&(Mn(),void 0!==e.showColumnHeader&&ho(e.showColumnHeader),W.enableAddRow!==e.enableAddRow&&Ro(O()),n=j.extend(!0,{},W),W=j.extend(W,e),b(w.onSetOptions,{optionsBefore:n,optionsAfter:W}),so(),Vi(),void 0!==e.frozenBottom&&(li=!0),le.forEach(function(e){e.style["overflow-y"]=W.autoHeight?"hidden":"auto"}),t||q(),Gi(),o||Hi(),i||ro(z),!W.enableMouseWheelScrollHandler||!le||ui&&0!==ui.length?!1===W.enableMouseWheelScrollHandler&&$i(ui):le.forEach(function(e){ui.push(Slick.MouseWheel({element:e,onMouseWheel:Yo}))}))},getData:function(){return E},getDataLength:O,getDataItem:N,setData:function(e,t){E=e,yo(),Io(),t&&fo(0)},getSelectionModel:Ci,setSelectionModel:function(e){o&&(o.onSelectedRangesChanged.unsubscribe(oo),o.destroy)&&o.destroy(),(o=e)&&(o.init(w),o.onSelectedRangesChanged.subscribe(oo))},getSelectedRows:pa,setSelectedRows:function(e,t){if(!o)throw new Error("SlickGrid Selection model is not set");w&&w.getEditorLock&&!w.getEditorLock().isActive()&&o.setSelectedRanges(function(e){for(var t=[],i=z.length-1,o=0;o<e.length;o++)t.push(new Slick.Range(e[o],0,e[o],i));return t}(e),t||"SlickGrid.setSelectedRows")},getContainerNode:function(){return $},updatePagingStatusFromView:function(e){st=0!==e.pageSize,dt=e.pageNum==e.totalPages-1},applyFormatResultToCellNode:Eo,reset_prevScrollLeft:function(){et=-1},render:q,reRenderColumns:Qi,invalidate:function(){Io(),yo(),q()},invalidateRow:Ro,invalidateRows:_o,invalidateAllRows:yo,updateCell:function(e,t){var i,o,n=la(e,t);n&&(i=z[t],o=N(e),d&&M===e&&k===t?d.loadValue(o):(Eo(o?mo(e,i)(e,t,Co(o,i),i,o,w):"",n),Bo(e)))},updateRow:Mo,getViewport:To,getRenderedRange:Fo,resizeCanvas:Do,updateRowCount:Io,scrollRowIntoView:Nn,scrollRowToTop:function(e){fo(e*W.rowHeight),q()},scrollCellIntoView:Sn,scrollColumnIntoView:function(e){_n(rt[e],lt[e])},getCanvasNode:wi,getUID:xi,getNumVisibleRows:function(){return Xe},getHeaderColumnWidthDiff:function(){return Ve},getScrollbarDimensions:function(){return va},getHeadersWidth:Ei,getCanvasWidth:Mi,getCanvases:bi,getActiveCanvasNode:function(e){return void 0!==e&&(e instanceof Slick.EventData&&(e=e.getNativeEvent()),ye=e.target.closest(".grid-canvas")),ye},getViewportNode:function(e,t){return _i(le,e,t)},getViewports:yi,getActiveViewportNode:function(e){return Si(e),Se},setActiveViewportNode:Si,focus:yn,scrollTo:fo,cacheCssForHiddenInit:fi,restoreCssFromHiddenInit:mi,getCellFromPoint:mn,getCellFromEvent:wn,getActiveCell:On,setActiveCell:function(e,t,i,o,n){!Ae||e>O()||e<0||t>=z.length||t<0||W.enableCellNavigation&&(Sn(e,t,!1),Rn(la(e,t),i,o,n))},setActiveRow:function(e,t,i){!Ae||e>O()||e<0||t>=z.length||t<0||(M=e,i)||Sn(e,t||0,!1)},getActiveCellNode:function(){return I},getActiveCellPosition:Tn,resetActiveCell:bn,editActiveCell:kn,getCellEditor:function(){return d},getCellNode:la,getCellNodeBox:function(e,t){if(!fn(e,t))return null;for(var i=Cn(e),i=(e=po(e)-i)+W.rowHeight-1,o=0,n=0;n<t;n++)z[n]&&!z[n].hidden&&(o+=z[n].width,W.frozenColumn==n)&&(o=0);return{top:e,left:o,bottom:i,right:o+z[t].width}},canCellBeSelected:da,canCellBeActive:sa,navigatePrev:oa,navigateNext:ia,navigateUp:ta,navigateDown:ea,navigateLeft:Zn,navigateRight:Jn,navigatePageUp:Ln,navigatePageDown:Pn,navigateTop:Vn,navigateBottom:Bn,navigateRowStart:na,navigateRowEnd:aa,gotoCell:ua,getTopPanel:function(){return re[0]},getTopPanels:function(){return re},setTopPanelVisibility:function(e,t){co("showTopPanel",ae,e,t)},getPreHeaderPanel:Ii,getPreHeaderPanelLeft:Ii,getPreHeaderPanelRight:function(){return oe},setPreHeaderPanelVisibility:function(e,t){co("showPreHeaderPanel",[te,ne],e,t)},getHeader:Di,getHeaderColumn:function(e){var e="number"==typeof e?e:f(e),t=!F()||e<=W.frozenColumn?St:_t,e=!F()||e<=W.frozenColumn?e:e-W.frozenColumn-1;return t.children[e]},setHeaderRowVisibility:function(e,t){co("showHeaderRow",H,e,t)},getHeaderRow:function(){return F()?B:B[0]},getHeaderRowColumn:function(e){var t,e="number"==typeof e?e:f(e);return!F()||e<=W.frozenColumn?t=xt:(t=Dt,e-=W.frozenColumn+1),t.children[e]},setFooterRowVisibility:function(e,t){co("showFooterRow",Q,e,t)},getFooterRow:function(){return F()?X:X[0]},getFooterRowColumn:function(e){var t,e="number"==typeof e?e:f(e);return!F()||e<=W.frozenColumn?t=It:(t=Tt,e-=W.frozenColumn+1),t.children[e]},getGridPosition:function(){return In($)},flashCell:function(e,t,o){o=o||250,T[e]&&(e=la(e,t))&&function e(t,i){i<1||setTimeout(function(){i%2==0?t.classList.add(W.cellFlashingCssClass):t.classList.remove(W.cellFlashingCssClass),e(t,i-1)},o)}(e,5)},addCellCssStyles:function(e,t){if(ot[e])throw new Error("SlickGrid addCellCssStyles: cell CSS hash with key '"+e+"' already exists.");jo(ot[e]=t,null),b(w.onCellCssStylesChanged,{key:e,hash:t,grid:w})},setCellCssStyles:qo,removeCellCssStyles:function(e){ot[e]&&(jo(null,ot[e]),delete ot[e],b(w.onCellCssStylesChanged,{key:e,hash:null,grid:w}))},getCellCssStyles:function(e){return ot[e]},getFrozenRowOffset:Cn,setColumnHeaderVisibility:ho,sanitizeHtmlString:ma,getDisplayedScrollbarDimensions:function(){return{width:K?va.width:0,height:we?va.height:0}},getAbsoluteColumnMinWidth:function(){return be},init:gi,destroy:function(e){v.unbindAll(),di=$i(di),ui=$i(ui),ci=$i(ci),y().cancelCurrentEdit(),b(w.onBeforeDestroy,{});for(var t=it.length;t--;)vi(it[t]);W.enableColumnReorder&&jt&&"function"==typeof jt.destroy&&(jt.destroy(),qt.destroy()),Le.forEach(function(e){v.unbindByEventName(e,"scroll."+C)}),Le=[],v.unbindByEventName($,"resize.slickgrid",Do),Wi(),se.forEach(function(e){v.unbindByEventName(e,"keydown",en),v.unbindByEventName(e,"mousedown",tn),v.unbindByEventName(e,"dblclick",nn),v.unbindByEventName(e,"contextmenu",on),v.unbindByEventName(e,"mouseover",pn),v.unbindByEventName(e,"mouseout",gn)}),le.forEach(function(e){v.unbindByEventName(e,"scroll",Wo)}),Pe.forEach(function(e){v.unbindByEventName(e,"contextmenu",dn),v.unbindByEventName(e,"click",un)}),H.forEach(function(e){v.unbindByEventName(e,"scroll",Ho)}),X&&X.forEach(function(e){v.unbindByEventName(e,"contextmenu",cn),v.unbindByEventName(e,"click",hn)}),Q&&Q.forEach(function(e){v.unbindByEventName(e,"scroll",Go)}),te&&v.unbindByEventName(te,"scroll",zo),v.unbindByEventName(L,"keydown",en),v.unbindByEventName(V,"keydown",en);var i=$.querySelectorAll(".slick-resizable-handle"),i=([].forEach.call(i,function(e){v.unbindByEventName(e,"dblclick",Ai)}),$.querySelectorAll(".slick-header-column"));[].forEach.call(i,function(e){v.unbindByEventName(e,"mouseenter",an),v.unbindByEventName(e,"mouseleave",rn),v.unbindByEventName(e,"mouseenter",Fi),v.unbindByEventName(e,"mouseleave",Oi)}),$.replaceChildren(),$.classList.remove(C),e&&(g=p=Vt=Lt=Pt=h=le=wt=Ct=vt=mt=ft=gt=At=Nt=Ot=Ft=de=ae=re=ie=ne=te=oe=ee=Ut=kt=Mt=Q=Z=J=Tt=It=X=Kt=yt=bt=Pe=Wt=Et=Rt=H=$t=Y=G=Dt=xt=B=s=_t=St=V=L=$=zt=Gt=Ht=Bt=se=Le=Se=ye=null)},getEditorLock:y,getEditController:function(){return Ee}}),!($="string"==typeof e?document.querySelector(e):e))throw new Error("SlickGrid requires a valid container, "+e+" does not exist in the DOM.");if(Ca=Ca||function(){var e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?W.ffMaxSupportedCssHeight:W.maxSupportedCssHeight,i=j.createDomElement("div",{style:{display:"hidden"}},document.body);for(;;){var o=2*e,n=(j.height(i,o),j.height(i));if(t<o||n!==o)break;e=o}return i.remove(),e}(),W=j.extend(!0,{},De,W),so(),Ie.width=W.defaultColumnWidth,W.suppressCssChangesOnHiddenInit||fi(),ao(!0),W.enableColumnReorder&&!Sortable)throw new Error("SlickGrid requires Sortable.js module to be loaded");Ee={commitCurrentEdit:ca,cancelCurrentEdit:ha},$.replaceChildren(),$.style.overflow="hidden",$.style.outline=0,$.classList.add(C),$.classList.add("ui-widget"),$.style.fontFamily=W.fontFamily||"",$.style.fontSize=W.fontSize||"",e=window.getComputedStyle($),/relative|absolute|fixed/.test(e.position)||($.style.position="relative"),L=j.createDomElement("div",{tabIndex:0,style:{position:"fixed",width:"0px",height:"0px",top:"0px",left:"0px",outline:"0px"}},$),gt=j.createDomElement("div",{className:"slick-pane slick-pane-header slick-pane-left",tabIndex:0},$),ft=j.createDomElement("div",{className:"slick-pane slick-pane-header slick-pane-right",tabIndex:0},$),mt=j.createDomElement("div",{className:"slick-pane slick-pane-top slick-pane-left",tabIndex:0},$),vt=j.createDomElement("div",{className:"slick-pane slick-pane-top slick-pane-right",tabIndex:0},$),Ct=j.createDomElement("div",{className:"slick-pane slick-pane-bottom slick-pane-left",tabIndex:0},$),wt=j.createDomElement("div",{className:"slick-pane slick-pane-bottom slick-pane-right",tabIndex:0},$),W.createPreHeaderPanel&&((te=j.createDomElement("div",{className:"slick-preheader-panel ui-state-default",style:{overflow:"hidden",position:"relative"}},gt)).appendChild(document.createElement("div")),ee=j.createDomElement("div",null,te),ie=j.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},te),ne=j.createDomElement("div",{className:"slick-preheader-panel ui-state-default",style:{overflow:"hidden",position:"relative"}},ft),oe=j.createDomElement("div",null,ne),j.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},ne),W.showPreHeaderPanel||(n(te),n(ne))),bt=j.createDomElement("div",{className:"slick-header ui-state-default slick-header-left"},gt),yt=j.createDomElement("div",{className:"slick-header ui-state-default slick-header-right"},ft),Pe.push(bt),Pe.push(yt),St=j.createDomElement("div",{className:"slick-header-columns slick-header-columns-left",style:{left:"-1000px"}},bt),_t=j.createDomElement("div",{className:"slick-header-columns slick-header-columns-right",style:{left:"-1000px"}},yt),s=[St,_t],Rt=j.createDomElement("div",{className:"slick-headerrow ui-state-default"},mt),Et=j.createDomElement("div",{className:"slick-headerrow ui-state-default"},vt),H=[Rt,Et],G=j.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},Rt),Y=j.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},Et),xt=j.createDomElement("div",{className:"slick-headerrow-columns slick-headerrow-columns-left"},Rt),Dt=j.createDomElement("div",{className:"slick-headerrow-columns slick-headerrow-columns-right"},Et),B=[xt,Dt],Ft=j.createDomElement("div",{className:"slick-top-panel-scroller ui-state-default"},mt),Ot=j.createDomElement("div",{className:"slick-top-panel-scroller ui-state-default"},vt),ae=[Ft,Ot],Nt=j.createDomElement("div",{className:"slick-top-panel",style:{width:"10000px"}},Ft),At=j.createDomElement("div",{className:"slick-top-panel",style:{width:"10000px"}},Ot),re=[Nt,At],W.showColumnHeader||Pe.forEach(function(e){n(e)}),W.showTopPanel||ae.forEach(function(e){n(e)}),W.showHeaderRow&&(!W.showHeaderRow||W.isHeaderRowVisible)||H.forEach(function(e){n(e)}),h=j.createDomElement("div",{className:"slick-viewport slick-viewport-top slick-viewport-left",tabIndex:0},mt),Pt=j.createDomElement("div",{className:"slick-viewport slick-viewport-top slick-viewport-right",tabIndex:0},vt),Lt=j.createDomElement("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-left",tabIndex:0},Ct),Vt=j.createDomElement("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-right",tabIndex:0},wt),le=[h,Pt,Lt,Vt],W.viewportClass&&le.forEach(function(e){e.classList.add(W.viewportClass)}),Se=h,Bt=j.createDomElement("div",{className:"grid-canvas grid-canvas-top grid-canvas-left",tabIndex:0},h),Ht=j.createDomElement("div",{className:"grid-canvas grid-canvas-top grid-canvas-right",tabIndex:0},Pt),Gt=j.createDomElement("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-left",tabIndex:0},Lt),zt=j.createDomElement("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-right",tabIndex:0},Vt),se=[Bt,Ht,Gt,zt],va=va||Ri(),ye=Bt,ie&&j.width(ie,Mi()+va.width),s.forEach(function(e){j.width(e,Ei())}),j.width(G,Mi()+va.width),j.width(Y,Mi()+va.width),W.createFooterRow&&(kt=j.createDomElement("div",{className:"slick-footerrow ui-state-default"},vt),Mt=j.createDomElement("div",{className:"slick-footerrow ui-state-default"},mt),Q=[Mt,kt],J=j.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},Mt),j.width(J,Mi()+va.width),Z=j.createDomElement("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},kt),j.width(Z,Mi()+va.width),It=j.createDomElement("div",{className:"slick-footerrow-columns slick-footerrow-columns-left"},Mt),Tt=j.createDomElement("div",{className:"slick-footerrow-columns slick-footerrow-columns-right"},kt),X=[It,Tt],W.showFooterRow||Q.forEach(function(e){n(e)})),V=L.cloneNode(!0),$.append(V),W.explicitInitialization||gi()}})}(),e=window,Slick.Utils.extend(!0,e,{Slick:{AutoTooltips:function(i){var o,t={enableForCells:!0,enableForHeaderCells:!1,maxToolTipLength:null,replaceExisting:!0};function n(){var e,t=o.getCellFromEvent(event);t&&(t=o.getCellNode(t.row,t.cell),e=void 0,i)&&t&&(!t.title||i&&i.replaceExisting)&&(t.clientWidth<t.scrollWidth?(e=t.textContent&&t.textContent.trim()||"",i&&i.maxToolTipLength&&e.length>i.maxToolTipLength&&(e=e.substring(0,i.maxToolTipLength-3)+"...")):e="",t.title=e)}function a(e,t){var i,t=t.column,e=e.target;!e||!(i=".slick-header-column"<(e.closest<HTMLDivElement))||t&&t.toolTip||(i.title=e.clientWidth<i.clientWidth&&t&&t.name||"")}Slick.Utils.extend(this,{init:function(e){i=Slick.Utils.extend(!0,{},t,i),o=e,i.enableForCells&&o.onMouseEnter.subscribe(n),i.enableForHeaderCells&&o.onHeaderMouseEnter.subscribe(a)},destroy:function(){i.enableForCells&&o.onMouseEnter.unsubscribe(n),i.enableForHeaderCells&&o.onHeaderMouseEnter.unsubscribe(a)},pluginName:"AutoTooltips"})}}}),Ee=window,Slick.Utils.extend(!0,Ee,{Slick:{CellExternalCopyManager:function(e){var C,w,b=this,y=e||{},r=y.copiedCellStyleLayerKey||"copy-manager",l=y.copiedCellStyle||"copied",s=0,S=y.bodyElement||document.body,R=y.onCopyInit||null,E=y.onCopySuccess||null,M={C:67,V:86,ESC:27,INSERT:45};function t(e,t){var i;if(!C.getEditorLock().isActive()||C.getOptions().autoEdit){if(e.which==M.ESC&&w&&(e.preventDefault(),x(),b.onCopyCancelled.notify({ranges:w}),w=null),(e.which===M.C||e.which===M.INSERT)&&(e.ctrlKey||e.metaKey)&&!e.shiftKey&&(R&&R.call(),0!==(r=C.getSelectionModel().getSelectedRanges()).length)){k(w=r),b.onCopyCells.notify({ranges:r});for(var o=C.getColumns(),n="",a=!1,r=_.sortBy(r,["fromRow","toRow"]),l=0;l<r.length;l++){for(var s=r[l],d=[],u=s.fromRow;u<s.toRow+1;u++){var c=[],h=C.getDataItem(u);if(y.includeHeaderWhenCopying&&!a&&e.altKey){for(var a=!0,p=[],g=s.fromCell;g<s.toCell+1;g++)0<o[g].name.length&&!o[g].hidden&&"_checkbox_selector"!==o[g].id&&p.push(function(e){if(y.headerColumnValueExtractor){var t=y.headerColumnValueExtractor(e);if(t)return t}return e.name}(o[g]));d.push(p.join("\t"))}for(g=s.fromCell;g<s.toCell+1;g++)0<o[g].name.length&&!o[g].hidden&&"_checkbox_selector"!==o[g].id&&c.push(function(e,t){if("function"==typeof y.dataItemColumnValueExtractor){var i=y.dataItemColumnValueExtractor(e,t);if(i)return i}return i=e[t.field],i=_.get(t,"_dashboardConfig.RawCopy",!1)?i:$(t.formatter(null,null,i,t,e)).text()}(h,o[g]));d.push(c.join("\t"))}n+=d.join("\r\n")+"\r\n"}if(Ee.clipboardData)return Ee.clipboardData.setData("Text",n),!0;var f,m=document.activeElement,v=(f=n,(i=document.createElement("textarea")).style.position="absolute",i.style.left="-10000px",i.style.top=document.body.scrollTop+"px",i.value=f,0<(f=$(".ui-dialog.ui-widget-content:visible")).length?$(i).appendTo(f.last()):S.appendChild(i),i.select(),i);if(v.focus(),a&&document.queryCommandSupported&&document.queryCommandSupported("copy"))try{document.execCommand("copy")}catch(e){return console.warn("Copy to clipboard failed.",e),!1}return setTimeout(function(){v.parentNode.removeChild(v),m?m.focus():console.log("Not element to restore focus to after copy?")},100),E&&(f=0,f=1===r.length?r[0].toRow+1-r[0].fromRow:r.length,E.call(this,f)),!1}y.readOnlyMode||e.which===M.V&&(e.ctrlKey||e.metaKey)&&!e.shiftKey||e.which===M.INSERT&&e.shiftKey&&e.ctrlKey}}function k(e){x();for(var t=C.getColumns(),i={},o=0;o<e.length;o++)for(var n=e[o].fromRow;n<=e[o].toRow;n++){i[n]={};for(var a=e[o].fromCell;a<=e[o].toCell&&a<t.length;a++)i[n][t[a].id]=l}C.setCellCssStyles(r,i),clearTimeout(s),s=setTimeout(function(){b.clearCopySelection()},2e3)}function x(){C.removeCellCssStyles(r)}Slick.Utils.extend(this,{init:function(e){if((C=e).onKeyDown.subscribe(t),!e.getSelectionModel())throw new Error("Selection model is mandatory for this plugin. Please set a selection model on the grid before adding this plugin: grid.setSelectionModel(new Slick.CellSelectionModel())")},destroy:function(){C.onKeyDown.unsubscribe(t)},pluginName:"CellExternalCopyManager",clearCopySelection:x,handleKeyDown:t,onCopyCells:new Slick.Event,onCopyCancelled:new Slick.Event,onPasteCells:new Slick.Event,setIncludeHeaderWhenCopying:function(e){y.includeHeaderWhenCopying=e}})}}}),L=window,Slick.Utils.extend(!0,L,{Slick:{CellRangeSelector:function(d){var a,n,r,l,s,u,c,h,o,p,g,f,m,v,C,w,b,y,i,S,_,R=this,t=new Slick.EventHandler,E={autoScroll:!0,minIntervalToShowNextCell:30,maxIntervalToShowNextCell:600,accelerateInterval:5,selectionCss:{border:"2px dashed blue"}},M=!1,k=0,x=0;function D(e){return a.getCellFromPoint(h?1e10:e.pageX-$(r).offset().left,e.pageY-$(r).offset().top)}function I(e,t){var i=a.getActiveCell();e.shiftKey?(e.stopImmediatePropagation(),null===i&&t&&(i={row:t.row,cell:t.cell}),e={start:o||i,end:i},R.onCellRangeSelected.notify({range:new Slick.Range(e.start.row,e.start.cell,e.end.row,e.end.cell),desc:e.end.row<e.start.row})):o=i}function T(e,t){k=t.scrollTop,x=t.scrollLeft}function F(e){s=a.getActiveCanvasNode(e),v=a.getActiveViewportNode(e);var t=a.getDisplayedScrollbarDimensions();C=v.offsetWidth-t.width,w=v.offsetHeight-t.height,y={x:a.getAbsoluteColumnMinWidth()/2,y:a.getOptions().rowHeight/2},M=!(!a.getPluginByName("RowMoveManager")&&!a.getPluginByName("CrossGridRowMoveManager")),g=p=0,m=s.classList.contains("grid-canvas-bottom"),-1<l.frozenRow&&m&&(t=".".concat(a.getUID()," .grid-canvas-").concat(l.frozenBottom?"bottom":"top"),t=document.querySelector(t))&&(p=t.clientHeight||0),f=s.classList.contains("grid-canvas-right"),-1<l.frozenColumn&&f&&(t=document.querySelector(".".concat(a.getUID()," .grid-canvas-left")))&&(g=t.clientWidth||0),e.stopImmediatePropagation(),e.preventDefault()}function O(e,t){var i,o=a.getCellFromEvent(e);if(!1!==R.onBeforeCellRangeSelected.notify(o)&&a.canCellBeSelected(o.row,o.cell)&&(u=!0,e.stopImmediatePropagation()),u)return a.focus(),o=Slick.Utils.offset(r),i=t.startX-(o.left||0),0<=l.frozenColumn&&f&&(i+=x),o=t.startY-(o.top||0),0<=l.frozenRow&&m&&(o+=k),i=a.getCellFromPoint(h?1:i,o),t.range={start:i,end:{}},o=D(e),n={start:i,end:o},c.show(new Slick.Range(i.row,i.cell,o.row,o.cell))}function N(e,t){if(u||M){M||e.stopImmediatePropagation();var l,s,e=e.getNativeEvent();if(d.autoScroll)if((b=function(e,t){var i=e.touches?e.touches[0]:e,o=v.scrollLeft,n=v.scrollTop,a=o+C,r=n+w,l=Slick.Utils.offset(v),s=l.left||0,l=l.top||0,d=s+C,u=l+w,e={e:e,dd:t,viewport:{left:o,top:n,right:a,bottom:r,offset:{left:s,top:l,right:d,bottom:u}},offset:{x:0,y:0},isOutsideViewport:!1};i.pageX<s?e.offset.x=i.pageX-s:i.pageX>d&&(e.offset.x=i.pageX-d);i.pageY<l?e.offset.y=l-i.pageY:i.pageY>u&&(e.offset.y=u-i.pageY);return e.isOutsideViewport=!!e.offset.x||!!e.offset.y,e}(e,t)).isOutsideViewport)return S=d.maxIntervalToShowNextCell-Math.abs(b.offset.x)*d.accelerateInterval,_=d.maxIntervalToShowNextCell-Math.abs(b.offset.y)*d.accelerateInterval,void(i||(s=l=0,i=setInterval(function(){var e,t,i,o,n,a=!1,r=!1;b.offset.x?(l+=d.minIntervalToShowNextCell,a=S<=l):l=0,b.offset.y?(s+=d.minIntervalToShowNextCell,r=_<=s):s=0,(a||r)&&(a&&(l=0),r&&(s=0),a=a,r=r,e=b.e.pageX,t=b.e.pageY,i=b.offset.x,o=b.offset.y,n=b.viewport.offset,a&&i&&(e=0<i?n.right+y.x:n.left-y.x),r&&o&&(t=0<o?n.top-y.y:n.bottom+y.y),P({pageX:e,pageY:t},b.dd))},d.minIntervalToShowNextCell)));A(),P(e,t)}}function A(){clearInterval(i),i=null}function P(e,t){var i=e.touches?e.touches[0]:e,o=Slick.Utils.offset(s),i=a.getCellFromPoint(i.pageX-(o&&o.left||0)+g,i.pageY-(o&&o.top||0)+p);if(!(0<=l.frozenColumn&&!f&&i.cell>l.frozenColumn||f&&i.cell<=l.frozenColumn||0<=l.frozenRow&&!m&&i.row>=l.frozenRow||m&&i.row<l.frozenRow)){if(d.autoScroll&&b){var o=a.getCellNodeBox(i.row,i.cell);if(!o)return;var n=b.viewport;(o.left<n.left||o.right>n.right||o.top<n.top||o.bottom>n.bottom)&&a.scrollCellIntoView(i.row,i.cell)}a.canCellBeSelected(i.row,i.cell)&&(h&&(i.cell=D(e).cell),t)&&t.range&&(t.range.end=i,o=new Slick.Range(t.range.start.row,t.range.start.cell,i.row,i.cell),c.show(o),R.onCellRangeSelecting.notify({range:o}))}}function L(e,t){u&&(u=!1,e.stopImmediatePropagation(),A(),c.hide(),void 0===t.range.end.row&&(t.range.end=a.getCellFromEvent(e)),R.onCellRangeSelected.notify({range:new Slick.Range(t.range.start.row,t.range.start.cell,t.range.end.row,t.range.end.cell),desc:t.range.end.row<t.range.start.row}))}Slick.Utils.extend(this,{init:function(e){if(void 0===Slick.Draggable)throw new Error('Slick.Draggable is undefined, make sure to import "slick.interactions.js"');d=Slick.Utils.extend(!0,{},E,d),c=d.cellDecorator||new Slick.CellRangeDecorator(e,d),r=(a=e).getCanvasNode(),l=a.getOptions(),t.subscribe(a.onScroll,T).subscribe(a.onDragInit,F).subscribe(a.onDragStart,O).subscribe(a.onDrag,N).subscribe(a.onDragEnd,L),(h=!!d.rowMode)||t.subscribe(a.onClickDone,I)},destroy:function(){t.unsubscribeAll(),r=v=s=null,c&&c.destroy&&c.destroy()},pluginName:"CellRangeSelector",getCellDecorator:function(){return c},getCurrentRange:function(){return n},onBeforeCellRangeSelected:new Slick.Event,onCellRangeSelected:new Slick.Event,onCellRangeSelecting:new Slick.Event})}}}),(y=jQuery).extend(!0,window,{Slick:{ColumnGroup:function(){var r,o,t,n,a,l,s,d=this,u=!1,i=new Slick.EventHandler,c=!0,h=9;function p(){u=!0,e()}function e(){var t,e=r.getHeader(),e=(_.isArray(e)||(c=!1,e=[e,null]),n=y(e[0]),a=y(e[1]),o.find(".groupedHeaderColumn").remove(),'<div class="groupedHeaderColumn slick-group-header-columns ui-state-default"></div>'),e=(l=y(e).css({width:n.width()+"px",left:n.position().left+"px"}),c&&(s=y(e).css({width:a.width()+"px",left:a.position().left+"px"})),r.getColumns());i=e,t=Object.keys(C(i)),i.forEach(function(e){e._groupIndex=t.indexOf(e.groupName),e._groupIndex=-1===e._groupIndex?t.length:e._groupIndex}),g(e),e.sort(v),r.setColumns(e);var i=function(e){var i="",o="",n=-1,a=r.getOptions().frozenColumn;-1===a&&(a=Number.MAX_VALUE);return y.each(e,function(e,t){t='<div class="ui-state-default slick-header-column" data-group-name="'+e+'"style="width:'+(t.reduce(function(e,t){return n++,e+t.width},0)-h)+'px"> <div class="slick-column-name">'+("-"===e?" ":e)+"</div></div>";a<n?o+=t:i+=t}),[i,o]}(C(e));l.append(i[0]),l.insertBefore(n),c&&(s.append(i[1]),s.insertBefore(a)),r.resizeCanvas()}function g(e){e.forEach(function(e,t){e._index=t})}function f(){var i,e=r.getColumns();u&&(l.css({width:n.width()+"px"}),i=l,c&&(s.css({width:a.width()+"px"}),i=i.add(s)),y.each(C(e),function(e,t){t=t.reduce(function(e,t){return e+t.width},0);i.find("[data-group-name='"+e+"']").css("width",t-h)})),d.onColumnsResized.notify(e)}function m(){var e,i,t=r.getColumns();g(t),u&&(e=l,e=(e=c?l.add(s):e).find(".slick-header-column"),i=C(t),e.each(function(t,e){e=i[y(e).data("group-name")];_.isNil(e)||e.forEach(function(e){e._groupIndex=t})}),t.sort(v),r.setColumns(t),g(t)),d.onColumnsReordered.notify(t)}function v(e,t){return e._groupIndex-t._groupIndex||e._index-t._index}function C(e){var i={};return e.forEach(function(e){var t=e.groupName||"-";i[t]=i[t]||[],i[t].push(e)}),i}return this.onColumnsReordered=new Slick.Event,this.onColumnsResized=new Slick.Event,{init:function(e){o=y((r=e).getContainerNode()),i.subscribe(r.onColumnsResized,f),i.subscribe(r.onColumnsReordered,m),(t=_.debounce(p,300))()},destroy:function(){t.cancel(),i.unsubscribeAll()},onColumnsReordered:this.onColumnsReordered,onColumnsResized:this.onColumnsResized,enableColumnGrouping:function(){u||(u=!0,e())},forceColumnGrouping:p,removeColumnGrouping:function(){u&&(u=!1,l&&l.remove(),s&&s.remove(),r.resizeCanvas())}}}}}),(Me=jQuery).extend(!0,window,{Slick:{Editors:{Date:xe,Time:xe,DateTime:xe}}});var h={contains:function(e,t){return h.containsRegex(e)?h.isRegexMatch(e,t):0<=t.indexOf(e)},containsRegex:function(e){return 0===e.indexOf("/")},escapeRegexCharacters:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g,"\\$&")},isMatch:function(e,t){if(h.containsRegex(e))return h.isRegexMatch(e,t);var i,o,n=!1,a=e.split(/ +and +| +/);for(_.includes(a,"or")&&(a=_.without(a,"or"),n=!0),i=0;i<a.length;i++)0!==a[i].indexOf("-")&&a[i].indexOf("*")<0&&(a[i]="*"+a[i]+"*");return o=n||_.every(a,function(e){return 0===e.indexOf("-")}),_[n?"some":"every"](a,function(e){return h.isSimpleMatch(e,t,o)})},isRegexMatch:function(e,t){var i;if(h.regexMap.has(e))i=h.regexMap.get(e);else{var o=/\/[gimsu]*$/,n=e.substring(1).replace(o,""),o=e.match(o),o=o?o[0].substring(1):"";try{i=new RegExp(n,o)}catch(e){v.Log.Error("Datagrid: invalid filter regex.",e),i=new RegExp("^$")}h.regexMap.set(e,i),setTimeout(function(){h&&h.regexMap.delete(e)},1e4)}return i.test(t)},isSimpleMatch:function(e,t,i){var o=!1;if(i||0!==e.indexOf("-")||(e=e.replace("-",""),o=!0),""===t){if("null"===e||"*null*"===e)return!o}else if("-null"===e)return!0;return i=0<=e.indexOf("**")?h.contains(e,t):new RegExp("^"+h.escapeRegexCharacters(e).replace(/\*/g,".*")+"$","m").test(t),o?!i:i},regexMap:new Map},O={CURRENCY_SYMBOL_MAP:{GBP:"&pound;",EUR:"&euro;",USD:"$"},_convertKdbValueforComparison:function(e){var t=b.convertKDBToViewstateValue(e);return t="1216"===e.class?t.replace(/(.*T)(\d+)(.*)/,function(e,t,i,o){return t+(i=99<parseInt(i,10)?":"+i:i)+o}):t},_OPERATORS_FOR_CONVERTION:_.reduce(["contains","starts with","ends with","search"],function(e,t){return e[t]=!0,e},{}),_getConditionResult:function(e,t,i){var o,n,a=!1;if(O._OPERATORS_FOR_CONVERTION[i]&&(o=(""+e).toLowerCase(),n=(""+t).toLowerCase()),""!==n)switch(i){case"contains":a=0<=o.indexOf(n);break;case"starts with":a=0===o.indexOf(n);break;case"ends with":a=-1!==o.indexOf(n,o.length-n.length);break;case"==":a=e==t;break;case"<":a=e<t;break;case">":a=t<e;break;case"<=":a=e<=t;break;case">=":a=t<=e;break;case"!=":a=e!=t;break;case"search":a=h.isMatch(n,o);break;default:console.log("GRID: highlight rule with unknown operator: ",i)}return a},getStyledCell:function(e,b,y,S,R){var t,E,M,k,x,D,I,T=document.createElement("div"),F=[],i=S.highlightingModule.getHighlightRuleChain(R);return b&&(D=b[S.SLICKGRID_ROW_UNIQUE_ID],D=S.atomizeTemporal(D),S.previousValuesMap&&(I=S.previousValuesMap[D]),_.each(i,function(e){var t,i=e.BorderColor,o=e.BackgroundColor,n=e.Color,a=e.Icon,r=e.IconColor,l=e.ConditionSource,s=e.ConditionOperator,d=e.ConditionValue,u=!1,c=_.includes(["Fill Left-to-Right","Fill Right-to-Left"],s),h="gradient"===e.RuleType,p=b[l="<this>"===l?R:l];if((t=(t=S.columnInfo.get(l))&&7===t.get("kdbType"))&&_.isString(p)&&(p=parseInt(p,10)),h){if(u=!0,o=r=n=i=null,_.isFinite(p)){var g,h=e.Palette||[],f=e.RuleMin,m=e.RuleMax,v=e.RuleLimitEnabled,C=!1,w=null;if(m<f&&(g=f,f=m,m=g,C=!0),!v||f<=p&&p<=m)switch(w=1===(h=0===h.length?[{color:"#888888"}]:h).length?(g=m===f?1:(p-f)/(m-f),g=_.clamp(Math.round(9*g),0,9),N.getColor(h[0].color,g=C?9-g:g)):(C&&(h=_.clone(h)).reverse(),N.interpolateColor(h,f,m,p)),e.TargetElement){case"text":n=w;break;case"border":i=w;break;case"icon":r=w;break;default:o=w}}}else c?_.isNumber(p)&&(E=s,k=o,M=i,x=Math.max(0,Math.min(100,p))):"previous value"===d?I&&(v=I[l],t&&_.isString(v)&&(v=parseInt(v,10)),"=="!==s&&_.isEqual(p,v)&&S.diffValuesMap&&S.diffValuesMap[D]&&void 0!==S.diffValuesMap[D][l]&&(v=S.diffValuesMap[D][l],t)&&_.isString(v)&&(v=parseInt(v,10)),p&&p.class&&(p=O._convertKdbValueforComparison(p)),v&&v.class&&(v=O._convertKdbValueforComparison(v)),u=O._getConditionResult(p,v,s)):u=p&&p.class?O._getConditionResult(O._convertKdbValueforComparison(p),d,s):O._getConditionResult(p,d,s);!y&&u&&(i&&(T.style.border="1px solid "+i),o&&(T.style.backgroundColor=o),n&&(T.style.color=n),a)&&r&&(g=0===a.indexOf("mi-")?"mi":"fa",F.push('<i class="'+g+" "+a+'" style="color: '+r+'" ></i>'))}),E&&(k||M)&&((t=document.createElement("div")).className=E.replace(" ","_"),t.style.width=x+"%",k&&(t.style.backgroundColor=k),M&&(t.style.border="1px solid "+M),T.appendChild(t)),F.length)&&(F.reverse(),(t=document.createElement("div")).className="cellIcons",t.innerHTML=F.join(""),T.appendChild(t)),T},getFormatter:function(g,f){var l,s,m=this,v=g.Field,h=!1,e=f.columnInfo.get(v);if(e&&(h=7===e.get("kdbType")),$.trim(g.Template))var C=o.compile(g.Template),t=function(i,o,e,n,t,a,r){var l,s,d,u,c,h,p=e;if(t){try{h=_.includes(["General","Percentage","Boolean"],g.Format)?t:(s=O.getFormatter($.extend({},g,{Template:"",HighlightNegativeColor:""}),{SLICKGRID_ROW_UNIQUE_ID:f.SLICKGRID_ROW_UNIQUE_ID,highlightingModule:{changedObjectCacheDictionary:{},getHighlightRuleChain:_.noop},viewModel:new w.Model({HighlightRules:[]}),columnInfo:f.columnInfo,atomizeTemporal:f.atomizeTemporal}),d=_.extend({thisValue:t[v]},t),u=g.Template.match(/\{\{(.*?)\}\}/g).join(" "),(c=_.union(Object.keys(d).filter(function(e){return u.match(new RegExp(e))}),["thisValue"])).unshift(d),h=_.pick.apply(_,c),_.mapValues(h,function(e,t){return s(i,o,e,n,d,void 0,r).replace("<div>","").replace("</div>","")})),h=_.extend({},t,{thisField:v,thisValue:h[v],thisRawValue:e},h,f.api.getTemplateViewStates(g.Template)),l=C(h)}catch(e){l=""}(c=m.getStyledCell(e,t,r,f,v)).innerHTML+=l,f.columnIsInstantEditable(n)&&f.editorModule.configureForInstantEdit(n,t,c,!0),g.HighlightNegativeColor&&_.isNumber(e)&&e<0&&(c.style.color=g.HighlightNegativeColor),p=c.outerHTML}return p};else if(_.includes(["Number","Formatted Number","Smart Number","Currency","SmartCurrency"],g.Format))t=function(e,t,i,o,n,a,r){var l=i,s=!1,l=null==i?"":"Smart Number"===g.Format?b.smartFormatNumber(i,g.Precision,!0):"Formatted Number"===g.Format?b.formatNumber(i,g.Precision):b.toFixedNumber(i,g.Precision);return l=_.escape(l),l=m.hideTralingZeroes(l,g.HideTrailingZeroes),g.Currency&&"none"!==g.Currency&&""!==l&&(l=O.CURRENCY_SYMBOL_MAP[g.Currency]+" "+l,s=!0),n&&(n=m.getStyledCell(i,n,r,f,v),g.HighlightNegativeColor&&_.isNumber(i)&&i<0&&(n.style.color=g.HighlightNegativeColor),s?n.innerHTML+=l:n.appendChild(document.createTextNode(l)),l=n.outerHTML),l};else if(_.includes(["Date","Time","DateTime"],g.Format))t=function(e,t,i,o,n,a,r){var l="Time"===g.Format,s="DateTime"===g.Format,d=b.convertKDBTemporalToMoment(i),l=_.isNull(i)||_.isUndefined(i)||_.isFunction(d.isValid)&&!d.isValid()?_.escape(i):l?d.formatNano(g.TimeFormat,{trim:!1,trimNano:!1}):s?d.formatNano(g.DateFormat+" "+g.TimeFormat,{trim:!1,trimNano:!1}):d.formatNano(g.DateFormat);return n&&((s=m.getStyledCell(i,n,r,f,v)).appendChild(document.createTextNode(l)),l=s.outerHTML),l};else if("Percentage"===g.Format)t=function(e,t,i,o,n,a,r){var l,s,d;if(h&&_.isString(i)&&(i=parseInt(i,10)),!_.isNumber(i))return d=null==i?"":i,n?((s=m.getStyledCell(d,n,r,f,v)).innerHTML=d,s.outerHTML):document.createTextNode(d).textContent;d=i,i*=100,l="",u=Math.max(0,i);var u=Math.min(100,u),c=g.PercentageColorOverride;return c&&(l="background-color:"+c+";"),i=i.toFixed(g.Precision),c='<div class="percentageFormatter"><p style="'+l+"width:"+u+'%"></p><span>'+(i=m.hideTralingZeroes(i,g.HideTrailingZeroes))+"%</span></div>",n?((s=m.getStyledCell(d,n,r,f,v)).innerHTML+=c,s.outerHTML):c};else if("CustomFormatter"===g.Format)t=function(e,t,i,o,n,a,r){var l,e=n?(l=m.getStyledCell(i,n,r,f,v),null!=i&&(l.innerHTML+=g.CustomFormatter(e,t,i,o,n,r)),l.outerHTML):document.createTextNode(i).textContent;return e};else if(_.includes(["General","Boolean"],g.Format))t=function(e,t,i,o,n,a,r){var l;return n?(r=m.getStyledCell(i,n,r,f,v),f.columnIsInstantEditable(o)?(l=f.editorModule.createCheckbox(i),f.editorModule.configureForInstantEdit(o,n,l),r.appendChild(l)):null!=i&&r.appendChild(document.createTextNode(i.toString())),r.outerHTML):document.createTextNode(i).textContent};else if("Sparkline"===g.Format){try{l=JSON.parse(g.SparklineOptions)}catch(e){console.warn("Datagrid > SparklineOptions parsing error",e),l={}}s=_.compact(["sparklinesRoot",l.className]).join(" "),t=function(e,t,i,o,n,a,r){n=m.getStyledCell(i,n,r,f,v);return n.className=s,n.id=_.uniqueId("sparklinesInstance_"),f.sparklinesManager.storeInitObjects(n.id,i,l),n.outerHTML}}return t},hideTralingZeroes:function(e,t){var i=e.toString();if(t&&0<=i.indexOf(".")){for(e="",(t=i[i.length-1]).match(/[kmbtpe]/i)&&(e=t,i=i.slice(0,-1));"0"===i[i.length-1];)i=i.slice(0,-1);"."===i[i.length-1]&&(i=i.slice(0,-1)),i+=e}return i},getSummaryRowHtml:function(m,e,v,C){var w="";return e&&e.length&&_.each(e,function(e){var t,i,o,n,a="",r="";function l(e){return _.isNumber(e)&&!_.isNaN(e)}function s(e,t){e=_.map(e,t),t=C.columnInfo.get(t);return e=t&&7===t.get("kdbType")?_.map(e,function(e){return _.isString(e)?parseInt(e,10):e}):e}if(!_.isEmpty(e)){if(n=e.Label,"WAVG"===e.Function){for(var d,u,c=s(m.rows,e.Column),h=s(m.rows,e.Column2),p=0,g=0,f=0;f<c.length;f++)d=c[f],u=h[f],l(d)&&l(u)&&(p+=d*u,g+=d);0!==g&&(a=p/g,(o=_.find(v,{field:e.Column2})).formatter)&&(a=o.formatter(void 0,void 0,a))}else if(t=s(m.rows,e.Column),(i=_.filter(t,function(e){return!_.isNull(e)&&!_.isUndefined(e)&&(_.isNumber(e)||_.has(e,"i"))})).length){if(_.has(i[0],"i"))switch(i.sort(function(e,t){return e.i===t.i?e.n-t.n:e.i-t.i}),e.Function){case"MIN":a=i[0];break;case"MAX":a=_.last(i)}else{switch(e.Function){case"MIN":a=_.min(i);break;case"MAX":a=_.max(i);break;case"AVG":case"SUM":a=_.reduce(i,function(e,t){return e+t},0)}"AVG"===e.Function&&(a/=i.length)}(o=_.find(v,{field:e.Column})).formatter&&(a=o.formatter(void 0,void 0,a))}n=n||e.Function+("WAVG"===e.Function?"":" "+e.Column),e.Color&&(r=" style='color:"+e.Color+"' "),w+="<span class='lblGroupSummary' "+r+"><i>"+n+":</i><b>"+a+"</b></span>"}}),w},isFormattersValueDifferentToRawValue:function(e){var t=!1;switch(e.Format){case"General":case"Boolean":t=!!e.Template;break;default:t=!0}return t}},De={generate:function(e,t,i){var o="General",n="center",a=100,r=De.generateDefaultColumnObject();switch(t){case 1:o="Boolean",a=40;break;case 2:a=280;break;case 4:o="Number",r.Precision=0,a=35,n="right";break;case 5:o="Number",r.Precision=0,a=50,n="right";break;case 6:o="Number",r.Precision=0,a=85,n="right";break;case 7:o="Formatted Number",r.Precision=0,a=165,n="right";break;case 8:o="Formatted Number",r.Precision=4,a=80,n="right";break;case 9:o="Formatted Number",r.Precision=4,a=140,n="right";break;case 12:o="DateTime",r.TimeFormat="HH:mm:ss.SSSSSSSSS",a=200,n="right";break;case 13:o="Date",a=60,r.DateFormat="YYYY-MM",n="right";break;case 14:o="Date",a=80,n="right";break;case 15:o="DateTime",a=130,n="right";break;case 16:o="Time",r.TimeFormat="HH:mm:ss.SSSSSSSSS",a=120,n="right";break;case 17:o="Time",r.TimeFormat="HH:mm",a=40,n="right";break;case 18:o="Time",a=60,n="right";break;case 19:o="Time",r.TimeFormat="HH:mm:ss.SSS",a=80,n="right";break;case 11:case 1001:n="left"}return i&&"percentage"===e&&(o="Percentage",a=100),r.Field=e,r.DisplayName=e,r.Format=o,r.MinWidthAbsolute=a,r.TextAlign=n,r.WidthWeight=r.MinWidthAbsolute,r},generateDefaultColumnObject:function(){return this.DEFAULT_COLUMN_OBJECT||(this.DEFAULT_COLUMN_OBJECT=_.chain(_.keys(a)).map(function(e){return[e,a[e].default]}).fromPairs().value()),_.clone(this.DEFAULT_COLUMN_OBJECT)}},p=(g.amendUserConfiguration=function(e,a,r){var l=[],s=_.filter(a,u.isDynamic),d=_.reduce(a,function(e,t){t=t.Field;return e[t]=(e[t]||0)+1,e},{});return _.each(e,function(e){var t=!1,i=null,o=_.clone(e),n=(o.Hidden=!!o.Hidden,_.find(a,{Field:o.Field,DisplayName:o.DisplayName}));n||(n=_.find(s,function(e){return(i=u.getRegex(e)).regex.test(o.Field)&&(0===r.length||r.get(o.Field))}))&&(t=!0),(n=n||1!==d[o.Field]?n:_.find(a,{Field:o.Field}))&&(_.each(n,function(e,t){_.includes(g.FIELDS_TO_IGNORE,t)||(o[t]=n[t])}),t?i.isExact&&!n.DisplayName||(o.DisplayName=o.Field.replace(i.regex,g.generateReplacementString(n.DisplayName,i))):o.DisplayName=n.DisplayName,l.push(o))}),l},g.injectViewstateValuesToUnpackedConfiguration=function(e,t,n){var a=["Hidden"];_.each(e,function(i){var o=_.findIndex(t,{Field:i.Field,DisplayName:i.DisplayName});0<=o&&_.each(a,function(e){var t=n("ColumnsConfiguration."+o+"."+e);t&&"viewstate"===t.type&&(i[e]=t.value)})})},g.unpackColumnConfiguration=function(e,t){var i=_.map(_.reject(e,u.isDynamic),"Field"),r=_.difference(t.pluck("id"),i),l=[];return _.each(e,function(i){var o,n,a;u.isDynamic(i)?(o=u.getRegex(i),n=o.regex,a=g.generateReplacementString(i.DisplayName,o),_.each(r,function(e,t){n.test(e)&&(e=_.extend({},i,{DisplayName:o.isExact&&!i.DisplayName?e:e.replace(n,a),Field:e}),l.push(e),r[t]=null)}),r=_.compact(r)):l.push(i)}),l},g.generateReplacementString=function(e,t){var i=0;return t.isExact?e:_.map(e,function(e){return"*"===e?"$"+(i+=1):e}).join("")},g.FIELDS_TO_IGNORE=(g.FIELDS_TO_SAVE=["Field","DisplayName","WidthWeight","MinWidthAbsolute","_RetainWidth"]).concat("Hidden"),g);function g(){}function f(e){this.app=e,this.pendingRows={},this.originalValues={},this.initialize()}_.extend(f,{KDB_2_SLICKGRID_EDITOR_MAP:{Boolean:"Checkbox",Date:"Date",DateTime:"DateTime","Formatted Number":"Float",General:"Text",Number:"Float",Percentage:"Float","Smart Number":"Float",Time:"Time"},BOOLEAN_TOGGLE_CSS:"boolean-toggle",BOOLEAN_CUSTOM_TOGGLE_CSS:"boolean-custom-toggle"}),_.extend(f.prototype,w.Events,{initialize:function(){this.$feedbackPanel=this.app.$(".updateStatusFeedback"),this.$lnkToggleEdit=this.app.$(".lnkToggleEditable"),this.$lnkSubmitChanges=this.app.$(".lnkSubmitChanges"),this.$instantButtons=this.app.$(".instantButtons"),this.$lnkToggleEdit.click(function(){this.toggleEditMode(!1)}.bind(this)),this.$lnkSubmitChanges.click(this.submitTableChanges.bind(this)),this.$instantButtons.find(".submitInstant").on("click",this.submitTableChanges.bind(this)),this.$instantButtons.find(".cancelInstant").on("click",this.onCancelInstant.bind(this)),this.app.$pnlGrid.on("click",".deleteIcon",_.bind(this.deleteGridRow,this)),this.listenTo(this.app.viewModel,"change:Basics.EditMode",this.onEditModeChange.bind(this))},addDeleteColumnIfNecessary:function(e){this.isEditable&&"enabled"===this.app.viewModel.get("Basics.EditMode")&&this.app.viewModel.get("Basics.IsInsertable")&&e.push({DisplayName:"Delete",Field:"DeleteIcon",Format:"DeleteIcon",Hidden:!1,WidthWeight:0,MinWidthAbsolute:60})},refreshSelectAllState:function(e){var o=this,n=this.app.$el.find(".slick-header-columns > .slick-header-column").not(".slick-sortable-placeholder");_.each(this.app.columnsConfig,function(t){var e,i;o.app.columnIsInstantEditable(t)&&((e=(i=n.filter(function(e){return e===o.app.grid.getColumnIndex(t.id)})).find(".column-toggle-all")).length||(e=$("<input type='checkbox' class='column-toggle-all'>"),i.prepend(e),e.on("click",function(e){e.stopPropagation(),o.updateBooleanColumn(t,e.target.checked)})),i=o.app.dataView.getFilteredItems(),e.prop("checked",_.every(i,function(e){return e[t.field]})))}),e&&this.app.dataView.onRowsChanged.subscribe(function(){o.refreshSelectAllState()})},checkUpdateQueryExists:function(){var e=this.app.viewModel.get("Basics.Data");return e&&_.isFunction(e.get)&&e.get("_hasUpdateQuery")&&e.get("_updateQueryString")&&0<e.get("_updateQueryString").length},checkIfEditable:function(){this.resetUnmodifiedData(),"enabled"===this.app.viewModel.get("Basics.EditMode")&&this.checkUpdateQueryExists()?this.$lnkToggleEdit.show():(this.$lnkToggleEdit.hide(),this.$lnkSubmitChanges&&this.$lnkSubmitChanges.hide()),this.app.layoutModule&&this.app.positionPanelWithDatagrid(),"instant"===this.app.viewModel.get("Basics.EditMode")&&this.$instantButtons.hide()},configureForInstantEdit:function(e,t,i,o){i.className=o?f.BOOLEAN_CUSTOM_TOGGLE_CSS:f.BOOLEAN_TOGGLE_CSS;o=this.pendingRows[t[this.app.primaryKey].toString()];o&&_.includes(_.keys(o),e.field)&&(i.className+=" pendingChange")},convertRowsToColumns:function(e){var i={};return _.each(e,function(e){_.each(e,function(e,t){_.has(i,t)||(i[t]=[]),e&&"string"==typeof e&&0===e.length&&(e=null),i[t].push(e)})}),i},createCheckbox:function(e){var t=document.createElement("input");return t.type="checkbox",(t.checked=e)&&t.setAttribute("checked","checked"),t},deleteGridRow:function(e){var t,e=$(e.currentTarget).data("rownumber"),e=this.app.dataView.getItem(e);e&&(t=e[this.app.SLICKGRID_ROW_UNIQUE_ID],this.app.dataView.deleteItem(t),0<=(t=_.indexOf(this.addedRows,e))?this.addedRows.splice(t,1):this.deletedRows.push(e),this.$lnkSubmitChanges)&&this.$lnkSubmitChanges.show()},handleInstantEditChange:function(e,t){var i,o=this.app.grid,n=o.getCellFromEvent(e),e=e.target;n&&(i=o.getDataItem(n.row),o=o.getColumns()[n.cell],n=t?!i[o.field]:e.checked,this.updatePendingChanges(o,i,n),this.refreshGrid())},hasUnmodifiedData:function(){return!!this.unmodifiedData},initializeGridListeners:function(){var n=this,e=n.app.grid;e.onCellChange.subscribe(function(e,t){var i,o={};n.app.customEditors?((i=n.app.model.dataSet.collection.get(t.item[n.app.SLICKGRID_ROW_UNIQUE_ID])).set(_.omit(t.item,"_rowIndex","idProperty")),n.app.model.trigger("rowObjectChanged",i,t)):(o[n.app.SLICKGRID_ROW_UNIQUE_ID]=t.item[n.app.SLICKGRID_ROW_UNIQUE_ID],n.editedRows.items=_.without(n.editedRows.items,_.find(n.editedRows.items,o)),((i=_.find(n.addedRows,o))?(n.addedRows=_.without(n.addedRows,i),n.addedRows):n.editedRows.items).push(t.item),n.$lnkSubmitChanges&&n.$lnkSubmitChanges.show())}),e.onAddNewRow.subscribe(function(e,t){var i=t.item;_.each(n.app.columnInfo.pluck("id"),function(e){_.has(i,e)||(i[e]=null)}),null!==i[n.app.SLICKGRID_ROW_UNIQUE_ID]&&void 0!==i[n.app.SLICKGRID_ROW_UNIQUE_ID]||(i[n.app.SLICKGRID_ROW_UNIQUE_ID]=v.Helpers.getGUID()),t.grid.getData().addItem(i),n.addedRows.push(i),n.$lnkSubmitChanges&&n.$lnkSubmitChanges.show()}),n.app.$pnlGrid.on("change",function(e){var t=e.target;t&&"checkbox"===t.type&&0<=t.className.indexOf(f.BOOLEAN_TOGGLE_CSS)&&n.handleInstantEditChange(e)}),e.onClickDone.subscribe(function(e){var t=e.event.target;t&&0<=t.className.indexOf(f.BOOLEAN_CUSTOM_TOGGLE_CSS)&&n.handleInstantEditChange(e,!0)})},isDataviewsLengthAffectedByDeletedRows:function(){var e=!1;return this.rowsDeleted&&(this.rowsDeleted=!(e=!0)),e},onCancelInstant:function(){this.pendingRows={},this.refreshGrid(),this.originalValues={},this.$instantButtons.hide()},onEditModeChange:function(){this.checkIfEditable(),this.app.generateDataGridFromReceivedData()},refreshGrid:function(){var e,t,o=this;this.app.RAW_MODE||(t=(e=this.app.model).dataSet,e.onExecuteBegin(),e.onExecuteSuccess({rows:_.reduce(t.collection.toJSON(),function(e,t){var i=t[o.app.primaryKey];return t=_.clone(o.originalValues[i])||t,o.pendingRows[i]&&_.extend(t,o.pendingRows[i]),e.concat(t)},[]),columns:_.keys(t.columnDict),meta:_.transform(t.columnDict,function(e,t,i){e[i]=t.kdbType})},!0))},remove:function(){this.$lnkToggleEdit.off(),this.$lnkSubmitChanges.off(),this.app.$pnlGrid.off("click",".deleteIcon"),this.removeGridListeners(),this.stopListening()},removeGridListeners:function(){this.app.$pnlGrid.off("change")},resetLists:function(){this.editedRows={typeConfig:{},items:[]},this.addedRows=[],this.deletedRows=[]},resetUnmodifiedData:function(){this.unmodifiedData=null},setUpdateTypeConfig:function(e){this.updateTypeConfig={},e.each(_.bind(function(e){this.updateTypeConfig[e.get("id")]=e.get("kdbType")},this))},showMessageSubmitError:function(e){var t=this.$feedbackPanel;t.removeClass("success"),t.find(".feedbackText").text("An error occurred executing the update query. Error text: "+e),t.addClass("show error"),_.delay(function(){t.removeClass("show")},5e3)},showMessageSubmitSuccess:function(){var e=this.$feedbackPanel;e.removeClass("error"),e.find(".feedbackText").text(t("Update query executed successfully")),e.addClass("show success"),_.delay(function(){e.removeClass("show")},3e3)},startListeningToCurrentDataModel:function(){this.listenTo(this.app.model,"change:_updateQueryString change:_hasUpdateQuery",this.checkIfEditable)},stopListeningToCurrentDataModel:function(){this.app.model&&this.stopListening(this.app.model)},submitTableChanges:function(){function e(e){return _.map(e,function(e){return _.omit(e,"_rowIndex","idProperty")})}var t,i,o=this,n="instant"===this.app.viewModel.get("Basics.EditMode"),a=this.app.viewModel.get("Basics.Data"),r=function(){this.addedRows&&this.addedRows.length&&(this.app.dataView.suspendIndexing(),this.app.removeItemsFromDataview(this.addedRows),this.app.dataView.reactivateIndexing()),this.deletedRows&&this.deletedRows.length&&(this.rowsDeleted=!0),this.resetLists(),this.resetUnmodifiedData(),n||(this.toggleEditMode(!0),this.showMessageSubmitSuccess())}.bind(this),l=function(e){this.showMessageSubmitError(_.isString(e)?e:e[0])}.bind(this);Slick.GlobalEditorLock.commitCurrentEdit(),n&&(i=_.reduce(this.originalValues,function(e,t,i){return o.pendingRows[i]&&e.push(_.extend(t,o.pendingRows[i])),e},[]),(t=this.editedRows.items).push.apply(t,i)),t={typeConfig:this.updateTypeConfig,addedDict:{items:this.convertRowsToColumns(e(this.addedRows))},updatedDict:{items:this.convertRowsToColumns(e(this.editedRows.items))},deletedDict:{items:this.convertRowsToColumns(e(this.deletedRows))}},this.app.api.updateTable(a,t,r,l),n&&(this.pendingRows={},this.originalValues={},this.$instantButtons.hide(),this.app.$el.find(".pendingChange").removeClass("pendingChange"))},toggleEditMode:function(e){var t="enabled"===this.app.viewModel.get("Basics.EditMode")&&this.app.viewModel.get("Basics.IsInsertable");this.isEditable=!this.isEditable,t?this.app.viewModel.trigger("change:ColumnsConfiguration"):(this.app.grid.setOptions({editable:this.isEditable}),this.app.grid.invalidate()),this.isEditable?(this.$lnkToggleEdit.html('<i class="fa fa-fw fa-ban"></i>Cancel Editing'),this.unmodifiedData=$.extend(!0,[],this.app.dataView.getItems()),this.app.RAW_MODE&&(this.app.rawModeModule.populateFields(_.keys(this.app.dataColsMap),"editMode"),this.app.rawModeModule.removePopulateItemFn())):(this.resetLists(),this.$lnkToggleEdit.html('<i class="fa fa-fw fa-edit"></i>Edit'),this.$lnkSubmitChanges&&this.$lnkSubmitChanges.hide(),e||!this.hasUnmodifiedData()||t||(e=this.useUnmodifiedData(),this.app.dataView.beginUpdate(),this.app.dataView.setItems(e),this.app.dataView.endUpdate(),this.app.grid.invalidate()),this.app.RAW_MODE&&this.app.rawModeModule.restorePopulateItemFn())},updateBooleanColumn:function(t,i){var o=this;_.each(this.app.dataView.getFilteredItems(),function(e){e[t.field]!==i&&o.updatePendingChanges(t,e,i)}),this.refreshGrid()},updatePendingChanges:function(e,t,i){var o=t[this.app.primaryKey],e=e.field,n=this.pendingRows[o]||{},a=_.includes(_.keys(n),e);this.pendingRows[o]=a?_.omit(n,e):_.extend(n,((a={})[e]=i,a)),_.isEmpty(this.pendingRows[o])&&(this.pendingRows=_.omit(this.pendingRows,o)),_.isEmpty(this.originalValues[o])&&(this.originalValues[o]=_.clone(t)),this.$instantButtons.toggle(!_.isEmpty(this.pendingRows))},useUnmodifiedData:function(){var e=this.unmodifiedData;return this.resetUnmodifiedData(),e}});var Ie,m=w.View.extend({initialize:function(e){this.app=e.app,this.kdbClass=e.kdbClass,this.$elActivator=e.$elActivator,this.dashboardType=b.Types.kdbToDashboard[this.kdbClass],this.$el.html(j.DateFilter({operators:m.COMBO_2_OPERATOR_MAP})),this.$cmbOperator=this.$(".cmbOperator"),this.$dp1=this.$(".dp1"),this.$dp2=this.$(".dp2"),this.initEvents(),this.renderDialog(),this.expressionsToVisualize=m._parseExpressions(e.filterValue),this.renderOperators(),this.renderDatepickers()},initEvents:function(){this.$cmbOperator.on("select2:select",this.onOperatorChanged.bind(this))},onApplyButtonClick:function(){var e,t,i=this.$cmbOperator.val(),o=this.dpSelection1.get("value"),n=m.COMBO_2_OPERATOR_MAP[i]+o;_.includes(["b","o"],i)&&(t=this.dpSelection2.get("value"),dt1=m.convertToKdbLikeObject(o,this.kdbClass),dt2=m.convertToKdbLikeObject(t,this.kdbClass),0<m._getComparisonResult(dt1,dt2)&&(e=o,o=t,t=e),n="b"===i?">="+o+" <="+t:"<"+o+" >"+t),this.trigger("filterApplied",n)},onClose:function(){this.$el.dialog("close")},onOperatorChanged:function(){var e=this.$cmbOperator.val();_.includes(["b","o"],e)?this.$dp2.show():this.$dp2.hide()},remove:function(){this.$cmbOperator.select2("destroy"),this.dpApp1&&this.dpApp1.remove(),this.dpApp2&&this.dpApp2.remove(),w.View.prototype.remove.apply(this,arguments),this.trigger("removed",this)},renderDialog:function(){var e=this;this.$dialog=this.$el.dialog(_.extend({classes:{"ui-dialog":"Datagrid date-filter-dialog"},title:t("Configure Filter"),resizable:!1,width:"350",height:"170",modal:!1,position:{of:this.$elActivator,my:"left top",at:"left top"},autoOpen:!0,draggable:!0,buttons:[{text:t("Apply"),click:$.proxy(e.onApplyButtonClick,e),icon:"fa fa-check"},{text:t("Close"),click:$.proxy(e.onClose,e),icon:"fa fa-times"}],resizeStop:function(){},close:function(){e.$dialog.dialog("destroy"),e.remove()}},this.options))},renderOperators:function(){var e=this.expressionsToVisualize;this.$cmbOperator.select2({minimumResultsForSearch:10,theme:"dashboards"}),e.length&&(e=1===e.length?m.OPERATOR_2_COMBO_MAP[e[0].operator]:0===e[0].operator.indexOf(">")?"b":"o",this.$cmbOperator.val(e).trigger("change")),this.onOperatorChanged()},renderDatepicker:function(t,e,i){var o,n=this,a=z.getComponentDefinition({componentId:15,settingsModel:new w.DeepModel});i=i||v.Helpers.convertRollingToDate("NOW",this.dashboardType),o=new v.DocumentViewModel({_default:i,_viewType:!0,_type:this.dashboardType}),(i=new w.DeepModel(a.appArgs.json)).set("Basics.Data",{}),i.set("Basics.Label",""),i.set("Basics.labelWidth",0),i.set("Basics.width",200),i.set("Basics.SelectedDate",o),this.app.api.loadApp("BasicComponents",e,i,{},function(e){n["dpApp"+t]=e,n["dpSelection"+t]=o})},renderDatepickers:function(){var e,t,i=this.expressionsToVisualize;i.length&&(e=i[0].date,1<i.length)&&(t=i[1].date),this.renderDatepicker(1,this.$dp1,e),this.renderDatepicker(2,this.$dp2,t)}},{COMBO_2_OPERATOR_MAP:{lt:"<",lte:"<=",gt:">",gte:">=",e:"==",ne:"!=",b:"between",o:"outside of"},generateFilterFunction:function(e,t){var i,o,n,e=m._parseExpressions(e),a=m.convertToKdbLikeObject(e[0].date,t),t=1<e.length?(o=m.convertToKdbLikeObject(e[1].date,t),0==e[0].operator.indexOf(">")?function(e){return null!==e&&0<=m._getComparisonResult(e,a)&&m._getComparisonResult(e,o)<=0}:function(e){return null===e||m._getComparisonResult(e,a)<0||0<m._getComparisonResult(e,o)}):(i=m._getOperatorFn(e[0].operator),n="!="===e[0].operator,function(e){return null===e?n:(e=m._getComparisonResult(e,a),i(e))});return t},_convertToKdb_FORMAT_MAP:{1214:"YYYY-MM-DD"},convertToKdbLikeObject:function(e,t){return(_.includes(["1214"],t)?b.convertUserInputToMoment(e,m._convertToKdb_FORMAT_MAP[t]):b.convertValueToMoment(e,t)).toKdbObject()},_getComparisonResult:function(e,t){var i=e.i-t.i;return i=0===i&&void 0!==e.n&&void 0!==t.n?e.n-t.n:i},_getOperatorFn:function(e){switch(e){case"<":return function(e){return e<0};case"<=":return function(e){return e<=0};case">":return function(e){return 0<e};case">=":return function(e){return 0<=e};case"==":return function(e){return 0===e};case"!=":return function(e){return 0!==e}}},_parseExpressions:function(e){for(var t,i=/(==|!=|<=|>=|>|<)(\S+)/g,o=[];t=i.exec(e);)o.push({operator:t[1],date:t[2]});return o}}),Te=(m.OPERATOR_2_COMBO_MAP=_.invert(m.COMBO_2_OPERATOR_MAP),Ie={is_null:"is_blank",is_not_null:"is_not_blank",">":"greater","<":"less","==":"equal","!=":"not_equal",">=":"greater_or_equal","<=":"less_or_equal"},{generateColumnGroupRule:function(e,t,i,o){var n=Le;switch(i){case 0:n=Ne;break;case 1:n=Fe;break;case 2:n=Oe;break;case 10:case 11:n=Ne;break;case 4:case 5:case 6:case 7:case 8:case 9:n=Ae;break;case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:n=Pe}return n(e,t,i,o)}});function C(e,t){return e.length?{active:!0,operator:t,children:e}:void 0}function Fe(t,e,i){var o=[],e=e.split(/ +or +| +/);return e=_.without(e,""),_.each(e,function(e){e="true"===e||"false"!==e&&void 0;void 0!==e&&o.push({active:!0,propertyName:t,propertyType:i,operator:"equal",value:e})}),C(o,"OR")}function Oe(o,e,n){var a=[],e=e.split(/ +or +| +/);return e=_.without(e,""),_.each(e,function(e){var t=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?e:void 0,i="equal";if(void 0===t){if(/[^a-f\d-]/gi.test(e))return;t="*"+e+"*",i="like"}void 0!==t&&a.push({active:!0,propertyName:o,propertyType:n,operator:i,value:t})}),C(a,"OR")}function Ne(a,e,r,t){var i,l=[],o="AND",s=!1;return t?(o="OR",s=!0,i=e.split("|")):(i=e.split(/ +and +| +/),_.includes(i,"or")&&(i=_.without(i,"or"),o="OR")),i=_.without(i,""),_.each(i,function(e){var t,i,o="like",n=!1;0!==(e=e.replace(/\[/g,"")).length&&(0===e.indexOf("-")&&1!==e.length&&(o="not_like",e=e.substr(1),n=!0),e.toLowerCase()===E.NULL_EMPTY_VALUE.toLowerCase()?o=n?"is_not_blank":"is_blank":s?o="equal":e=e.indexOf("*")<0?"*"+e+"*":(t=((n=e).match(/\*/g)||[]).length,i=!1,toReturn=n,toReturn=2<t||2===t&&(2===n.length||"*"!==_.first(n)||"*"!==_.last(n))?n.replace(/\*/g,function(){return i?"":(i=!0,"*")}):toReturn),10===r&&(e=e.replace(/\*/g,""),o="equal"),l.push({active:!0,propertyName:a,propertyType:r,operator:o,value:e}))}),C(l,o)}function Ae(t,e,i){e=E._getNumberFilterParts(e);return C(_.map(e.expressions,function(e){return{active:!0,propertyName:t,propertyType:i,operator:Ie[e.operator],value:e.number}}),e.isAndCondition?"AND":"OR")}function Pe(t,e,i){e=m._parseExpressions(e);return C(_.map(e,function(e){return{active:!0,propertyName:t,propertyType:i,operator:Ie[e.operator],value:e.date}}),1<e.length&&0==e[1].operator.indexOf(">")?"OR":"AND")}function Le(){}var Ve,Be,He,S,R,E=function(e){this.app=e,this.api=e.api,this.cachedDropdownItems=null,this.FILTER_SETTINGS_KEY="Grid.Basics.Filtering",this.BASICS_AUTOSAVE_MODE="Basics.AutosaveMode",this.BASICS_FILTERING="Basics.Filtering",this.BASICS_IS_FILTER_VISIBLE="Basics.IsFilterVisible",this.BASICS_KDB_FILTER_STRING="Basics.KdbFilterString",this.BASICS_FILTER_ON_ENTER_HIT="Basics.FilterOnEnterHit",this.CUSTOM_FILTERS_KEY="CustomFilters",this.COLUMNS_KEY="ColumnsConfiguration",this.initialize()};function Ge(e){var t=parseFloat(e);return t*=Be[e[e.length-1]]||1}function ze(e){var t,i,o,n,a,r=[],l=!1,s=!1,d=!1;for(e=e.toLowerCase().replace(/ /g,"");t=Ve.exec(e);)i=t[1],i=He[i]||i||"==",0<=t[2].indexOf("null")?"=="===i&&"null"===t[2]?s=!0:d=!0:r.push({operator:i,number:Ge(t[2])});return r=_.sortBy(r,"number"),1<(o=_.map(r,"operator")).length&&(l=_.some(o,function(e){return"!="===e})||(o=o,n=!1,a=_.findIndex(o,function(e){return 0===e.indexOf(">")}),n=0<=a?a<_.findLastIndex(o,function(e){return 0===e.indexOf("<")}):n)),s&&r.push({operator:"is_null",number:null}),d&&r.push({operator:"is_not_null",number:null}),{expressions:r,isAndCondition:l}}function M(i){var o,t,e,n=this;this.args=i,this.init=function(){e=i.grid.getOptions().editorCellNavOnLRKeys,(o=S.createDomElement("input",{type:"text",className:"editor-text"},i.container)).addEventListener(R,e?k:x),o.focus(),o.select(),i.compositeEditorOptions&&o.addEventListener("change",this.onChange)},this.onChange=function(){var e=i.grid.getActiveCell();n.validate().valid&&n.applyValue(n.args.item,n.serializeValue()),n.applyValue(n.args.compositeEditorOptions.formValues,n.serializeValue()),i.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:n.args.item,column:n.args.column,formValues:n.args.compositeEditorOptions.formValues})},this.destroy=function(){o.removeEventListener(R,e?k:x),o.removeEventListener("change",this.onChange),o.remove()},this.focus=function(){o.focus()},this.loadValue=function(e){t=e[i.column.field];e=(e=void 0===(e=i.column.editorFixedDecimalPlaces)?M.DefaultDecimalPlaces:e)||0===e?e:null;null!==e&&(t||0===t)&&t.toFixed&&(t=t.toFixed(e)),o.value=t,o.defaultValue=t,o.select()},this.serializeValue=function(){var e=o.value;return 0<e.length?parseFloat(e,10)||0:null},this.applyValue=function(e,t){e[i.column.field]=t},this.isValueChanged=function(){return!(""===o.value&&null==t)&&o.value!=t},this.validate=function(){var e=o.value.toLowerCase(),e=E.convertSmartNumberToNumber(e);if(isNaN(e))return{valid:!1,msg:"Please enter a valid float"};if(i.column.validator){var t=i.column.validator(o.value,i);if(!t.valid)return t}return o.value=e,{valid:!0,msg:null}},this.init()}function k(e){var t=this.selectionStart,i=this.value.length;(e.keyCode===Slick.keyCode.LEFT&&0<t||e.keyCode===Slick.keyCode.RIGHT&&t<i-1)&&e.stopImmediatePropagation()}function x(e){e.keyCode!==Slick.keyCode.LEFT&&e.keyCode!==Slick.keyCode.RIGHT||e.stopImmediatePropagation()}_.extend(E.prototype,w.Events,{initialize:function(){this.$txtGlobalFilter=this.app.$(".txtGlobalFilter"),this.$lnkResetFilters=this.app.$(".lnkResetFilters").hide(),this.$lnkToggleFilters=this.app.$(".lnkToggleFilters"),this.onHeaderRowCellRenderedScoped=_.bind(this.onHeaderRowCellRendered,this),this.debounced_searchboxChanged=_.debounce(this.searchboxChanged,500),this.debounced_refreshDataView=_.debounce(this.refreshDataView,500),this.listenTo(this.app.viewModel,"change:"+this.BASICS_IS_FILTER_VISIBLE,this.onChange_isFilterVisible),this.listenTo(this.app.viewModel,"change:"+this.BASICS_FILTERING,this.onChange_Filtering),this.listenTo(this.app.viewModel,"change:CustomFilters",this.onChange_CustomFilters),this.$txtGlobalFilter.on("change keyup",_.bind(this.debounced_searchboxChanged,this)),this.$lnkResetFilters.click(_.bind(this.resetFilters,this)),this.listenToOnce(this.app.viewModel,"change:"+this.BASICS_AUTOSAVE_MODE,this.loadFilterSettings),this.listenTo(this.app.viewModel,"change:"+this.BASICS_KDB_FILTER_STRING,this.onChange_KdbFilterString),this.listenTo(this.app.viewModel,"change:"+this.BASICS_FILTER_ON_ENTER_HIT,this.onChange_FilterOnEnterHit),this.$lnkToggleFilters.on(b.clickEvent(),this.onClick_lnkToggleFilters.bind(this)),this.showingFilters=!0,this.isProcessedServerSide=!1,this.filterOnEnterHit=!1,this.wasEnterHit=!1,this.dateFilterViewInstances=[],this.listenTo(_.get(this.app,"dashboardAppModel.attributes.router"),"route",this.removeDateFilters)},overrideFiltersToApplyIfViewstatesFound:function(){var e,t,i,o,n;this.api.getPropertyMeta&&(e=this.getValueOfViewState(this.app.viewModel.get(this.BASICS_FILTERING)),_.includes(["Column Filters","Advanced Column Filters"],e))&&(t=this.app.viewModel.get(this.COLUMNS_KEY),i=!1,o=this.app.grid.getColumns(),n={},_.each(t,function(e,t){var t="".concat(this.COLUMNS_KEY,".").concat(t,".Filter"),t=this.api.getPropertyMeta(t);t&&"viewstate"===t.type&&(i=!0,t=_.find(o,{name:e.DisplayName}))&&(n[t.id]=e.Filter)}.bind(this)),i)&&(this.filterSettingsToApply={type:e,value:n})},applyFilterSettingsIfReady:function(){var i,e,t=!1,o=this;this.app.grid&&this.overrideFiltersToApplyIfViewstatesFound(),(i=this.filterSettingsToApply)&&(i.type===this.getValueOfViewState(this.app.viewModel.get(this.BASICS_FILTERING))?"Quick Search"===i.type?(this.$txtGlobalFilter.val(i.value),this.$txtGlobalFilter.trigger("change"),this.filterSettingsToApply=null):_.includes(["Column Filters","Advanced Column Filters"],i.type)&&this.app.grid&&((e=_.keys(i.value||{})).length&&_.every(e,function(e){return o.app.grid.getHeaderRowColumn(e)})?_.each(e,function(e){var t=$(o.app.grid.getHeaderRowColumn(e)).find("input");t.val(i.value[e]),t.trigger("change")}):t=!0,this.filterSettingsToApply=null):t=!0,t)&&this.isAutosaveEnabled()&&this.app.api.saveSetting(this.FILTER_SETTINGS_KEY,null)},checkResetFiltersState:function(){var e=_.some(this.columnFilters);this.app.grid&&this.app.grid.resetActiveCell(),this.$lnkResetFilters[e?"show":"hide"]()},encodeInputFromArray:function(e){return 0===e.length?"":1===e.length?e[0]:e.length+" selected"},encodeInputValue:function(e){return e&&this.encodeInputFromArray(e.split("|"))},generateKdbFilterString:function(e){var t="";if("Advanced Column Filters"===e){var i,o,n,a,r=[],l=this.app.grid;for(i in this.columnFilters)void 0!==i&&""!==this.columnFilters[i]&&(columnIndex=l.getColumnIndex(i),colCfg=l.getColumns()[columnIndex])&&(o=colCfg.field,a=!!_.find(this.app.viewModel.get("CustomFilters"),{Name:o,Type:"Server Selection"}),n=this.app.columnInfo.get(o).get("kdbType"),columnGroupRule=Te.generateColumnGroupRule(o,this.columnFilters[i],n,a))&&r.push(columnGroupRule);e=1===r.length?r[0]:{active:!0,children:r,operator:"AND"},console.log("server side filter ipc message:",JSON.stringify(e)),t=W.generateIpcHexMessage(e)}return t},getDropdownItems:function(e,i){var e=this.app.grid.getColumnIndex(e),o=this.app.grid.getColumns()[e],e=o._dashboardConfig,n=!1,a=_.includes(["Number","Formatted Number","Smart Number","Percentage"],e.Format),r={},l=[],s={},t=this.cachedDropdownItems||this.app.dataView.getItems(),d=O.isFormattersValueDifferentToRawValue(e),e=this.app.columnInfo.get(i),e=e&&e.get("kdbType")||11;return t.forEach(function(e){var e=e[i],t=a?null===e?E.NULL_EMPTY_VALUE:e:(null===e?"":""+e)||E.NULL_EMPTY_VALUE;void 0!==e&&(t===E.NULL_EMPTY_VALUE&&(n=!0),void 0===s[t])&&(s[t]=e,t!==E.NULL_EMPTY_VALUE)&&l.push(t)}),t=l.sort(b.isKDBTemporal({class:"12"+_.padStart(e,2,"0")})?void 0:b.getComparator(e,_.identity)),n&&t.unshift(E.NULL_EMPTY_VALUE),t=_.map(t,function(e){var t;return d&&(r[i]=t=s[e],t=$(o.formatter(null,null,t,o,r)).text()),{Value:a?""+e:e,Text:t||e}})},getValueOfViewState:function(e){return e instanceof w.Model?e.get("value"):e},hideActiveDropdownPopup:function(){this.$selectionInputs&&this.$selectionInputs.each(function(){$(this).siblings("div").css("position","relative")})},isAutosaveEnabled:function(){return"enabled"===this.app.viewModel.get(this.BASICS_AUTOSAVE_MODE)},loadFilterSettings:function(){this.isAutosaveEnabled()&&(this.filterSettingsToApply=this.app.api.loadSetting(this.FILTER_SETTINGS_KEY))},modifyGridConfig:function(e){(this.showColumnFilters||this.showAdvancedColumnFilters)&&(e.showHeaderRow=!0,e.isHeaderRowVisible=this.isFilterVisible,e.explicitInitialization=!0)},onChange_CustomFilters:function(){var e,i=this;this.app.skipGridGeneration||(e=this.app.viewModel.get(this.CUSTOM_FILTERS_KEY),_.each(e,function(e,t){t=i.CUSTOM_FILTERS_KEY+"."+t+".Data";_.isEqual(e.Data,i.app.model)&&(v.ErrorDialog.ShowError("You must select a data source that is different from the one being used by the data grid."),e.Data=i.app.viewModel.previous(t),i.api.setProperty(t,i.app.viewModel.previous(t)))}),this.resetFilters(),this.app.generateDataGridFromReceivedData())},onChange_FilterOnEnterHit:function(){this.filterOnEnterHit=this.app.api.getProperty(this.BASICS_FILTER_ON_ENTER_HIT)},onChange_Filtering:function(e,t){this.filteringMode=this.getValueOfViewState(t),this.showColumnFilters="Column Filters"===this.filteringMode,this.showAdvancedColumnFilters="Advanced Column Filters"===this.filteringMode,this.showQuickSearch="Quick Search"===this.filteringMode,this.showColumnFilters&&this.checkResetFiltersState(),this.showingFilters&&(this.showColumnFilters||this.showAdvancedColumnFilters||this.showQuickSearch)?this.$lnkToggleFilters.show():this.$lnkToggleFilters.hide(),this.app.sortingModule.storeSortingSpec(),this.app.generateDataGridFromReceivedData()},onChange_isFilterVisible:function(){var e=this.app.viewModel.get(this.BASICS_FILTERING);switch(this.isFilterVisible=this.app.viewModel.get(this.BASICS_IS_FILTER_VISIBLE),this.$lnkToggleFilters.find("span").text((this.isFilterVisible?"Hide":"Show")+" Filters"),e){case"Column Filters":case"Advanced Column Filters":!this.skipGridGeneration&&this.app.grid&&(this.app.grid.getOptions().isHeaderRowVisible=this.isFilterVisible,this.app.$(".slick-headerrow")[this.isFilterVisible?"show":"hide"](),this.app.grid.reset_prevScrollLeft(),this.app.grid.resizeCanvas())}},onChange_KdbFilterString:function(){var e,t=!1;this.app.api.getPropertyMeta&&(t=!(!(e=this.app.api.getPropertyMeta(this.BASICS_KDB_FILTER_STRING))||"viewstate"!==e.type)),this.isProcessedServerSide=t},onClick_lnkToggleFilters:function(){var e,t=!this.app.viewModel.get(this.BASICS_IS_FILTER_VISIBLE);this.app.api.getPropertyMeta&&!(!(e=this.app.api.getPropertyMeta(this.BASICS_IS_FILTER_VISIBLE))||"viewstate"!==e.type)?this.app.api.setProperty(this.BASICS_IS_FILTER_VISIBLE,t):this.app.viewModel.set(this.BASICS_IS_FILTER_VISIBLE,t)},onHeaderRowCellRendered:function(e,t){var i,o,n,a=$(t.node),r=this.app.viewModel.get("CustomFilters");if(a.empty(),o=t.column.field,!(r=_.find(r,function(e){return u.isFieldMatched(e.Name,o)}))||"Disabled"!==r.Type){if(n=this.encodeInputValue(this.columnFilters[t.column.id]),i=$("<input type='text'></input>").data("columnId",t.column.id).data("field",o).val(n).appendTo(a),r)switch(this.customFilter$ElementsMap[t.column.id]=a,r.Type){case"DateTime":i.addClass("customFilterDateTime").prop("readonly",!0);break;case"Number":i.addClass("customFilterNumber");break;case"Selection":case"Server Selection":i.addClass("customFilterSelection"),this.$selectionInputs=this.$selectionInputs.add(i)}n&&i.after('<i class="fa fa-times" />')}},reapplyColumnFilters:function(){_.some(this.columnFilters)&&(this.app.dataView.setFilter(this.dataViewFilterFn),this.app.grid.invalidate())},refreshDataView:function(){if(this.filterOnEnterHit){if(!this.wasEnterHit)return;this.wasEnterHit=!1}this.app.viewModel.isLazyDataLoadingOn()&&this.app.model&&this.app.model.get("_lazyLoading")&&this.app.grid&&this.app.grid.scrollRowToTop(0),this.saveFilterSettings(),this.isProcessedServerSide&&this.showAdvancedColumnFilters?this.app.api.setProperty(this.BASICS_KDB_FILTER_STRING,this.generateKdbFilterString(this.filteringMode)):(this.app.RAW_MODE&&this.app.rawModeModule.populateFilterFields(),this.app.refreshDataView())},refreshDataviewIfFilterNotEmpty:function(){this.lastSearchValue&&this.refreshDataView()},registerColumnFilters:function(){var r=this;this.unsubscribeFromEvents(),this.$headerRow=$(r.app.grid.getHeaderRow()),this.customFilter$ElementsMap={},this.customFilterFunctions_Number=this.customFilterFunctions_Number||{},this.customFilterFunctions_Selection=this.customFilterFunctions_Selection||{},this.customFilterFunctions_DateTime=this.customFilterFunctions_DateTime||{},r.columnFilters||(r.columnFilters={}),this.$headerRow.on("blur",":input",function(){r.filterOnEnterHit&&(r.wasEnterHit=!0,$(this).trigger("change"))}),this.$headerRow.on("change keyup",":input",function(e){var t,i,o=$(this),n=o.val();!r.filterOnEnterHit||13!==e.which&&9!==e.which||(r.wasEnterHit=!0),null!=(i=o.data("columnId"))&&(n!==r.encodeInputValue(r.columnFilters[i])&&(r.columnFilters[i]=n,o.hasClass("customFilterDateTime")?n&&(t=o.data("field"),i="12"+r.app.columnInfo.get(t).get("kdbType"),r.customFilterFunctions_DateTime[t]=m.generateFilterFunction(n,i)):o.hasClass("customFilterNumber")?(t=o.data("field"),r.customFilterFunctions_Number[t]=E._generateNumberFilterFunction(n)):o.hasClass("customFilterSelection")&&(n&&"change"===e.type?(t=o.data("field"),o.val(r.encodeInputValue(n)),r.customFilterFunctions_Selection[t]=E._generateSelectionFilterFunction(n.split("|"))):n&&"keyup"===e.type&&(t=o.data("field"),o.val(n),r.customFilterFunctions_Selection[t]=E._generateSelectionFilterFunction(n.split("|"))))),r.refreshClearButton(o,n),r.checkResetFiltersState(),r.debounced_refreshDataView())}),this.$headerRow.on("click",".fa-times",function(e){var t=$(this),i=t.prev();t.remove(),r.filterOnEnterHit&&(r.wasEnterHit=!0),i.val("").trigger("change"),r.removeCustomFilterDropdowns()}),this.$headerRow.on("select2:close",function(e){r.hideActiveDropdownPopup()}),this.$headerRow.on("click",".customFilterSelection",function(e){var i,e=$(e.currentTarget),o=e.data("columnId"),n=e.data("field"),a=r.customFilter$ElementsMap[o];return r.removeCustomFilterDropdowns(),(i=_.find(r.app.viewModel.get("CustomFilters"),function(e){return"Server Selection"===e.Type&&u.isFieldMatched(e.Name,n)}))&&i.Data?r.api.subscribe(i.Data,function(e,t){r.cachedDropdownItems=t.collection.models.map(function(e){return e.attributes}),a.serverSelectionDataSource||r.renderDropdown(a,o,n),r.cachedDropdownItems=null,a.serverSelectionDataSource?r.removeCustomFilterDropdowns():a.serverSelectionDataSource=i.Data}):(r.cachedDropdownItems=null,r.app.RAW_MODE&&r.app.rawModeModule.populateFilterFields([n]),r.renderDropdown(a,o,n)),!1}),this.$headerRow.on("click",".customFilterDateTime",function(e){var e=$(e.currentTarget),t=e.data("columnId"),i=e.data("field");r.customFilter$ElementsMap[t];r.showDateFilter(e,t,i)}),this.app.grid.onHeaderRowCellRendered.subscribe(this.onHeaderRowCellRenderedScoped),this.$selectionInputs=$()},registerDataViewFilter:function(){var u=this,i=(u.columnId2field={},u.columnId2formatter={},_.each(this.app.grid.getColumns(),function(i){var e=i.id,t=i._dashboardConfig;t&&(u.columnId2field[e]=i.field,u.columnId2formatter[e]=t.Template||!_.includes(["Boolean","General"],t.Format)?function(e,t){return $(i.formatter(null,null,e,i,t)).text()}:function(e){return(null==e?"":e).toString()})}),!1);_.each(u.columnFilters,function(e,t){t in u.columnId2field||(delete u.columnFilters[t],i=!0)}),i&&(this.checkResetFiltersState(),this.saveFilterSettings()),u.dataViewFilterFn=u.dataViewFilterFn||function(i,e){var o,t,n,a,r,l;if(u.isProcessedServerSide)return!0;if(_.isFunction(u.app.dataViewFilter))return u.app.dataViewFilter.apply(u,[i,e]);if(u.showAdvancedColumnFilters||u.showColumnFilters){for(n in l=u.showAdvancedColumnFilters?h.isMatch:h.contains,u.columnFilters)if(void 0!==n&&""!==u.columnFilters[n]){if(r=u.columnId2field[n],a=i[r],u.app.RAW_MODE&&void 0===a)return!0;if(u.customFilterFunctions_DateTime[r]){if(!u.customFilterFunctions_DateTime[r](a))return!1}else if(u.customFilterFunctions_Number[r]){var s=a,d=_.last(u.api.getProperty("CustomFilters"),function(e){return e.Name===n});if(_.get(d,"UseRaw")||(s=(t=u.columnId2formatter[n])?t(a,i):s),!u.customFilterFunctions_Number[r](s))return!1}else if(u.customFilterFunctions_Selection[r]){if(!u.customFilterFunctions_Selection[r](a))return!1}else if(a=(t=u.columnId2formatter[n])?t(a,i).toLowerCase():"",!l(u.columnFilters[n].toLowerCase(),a))return!1}return!0}return!u.showQuickSearch||""===(o=(e._globalSearchString||"").toLowerCase())||_.some(u.app.grid.getColumns(),function(e){var t=i[e.field];return null!=t&&0<=$(e.formatter(null,null,i[e.field],e,i)).text().toLowerCase().indexOf(o)})},u.app.dataView.setFilterArgs({}),u.app.dataView.setFilter(u.dataViewFilterFn),u.applyFilterSettingsIfReady(),u.app.RAW_MODE&&u.app.rawModeModule.populateFilterFields()},remove:function(){this.debounced_refreshDataView.cancel(),this.debounced_searchboxChanged.cancel(),this.removeDateFilters(),this.unsubscribeFromEvents(),this.$txtGlobalFilter.off(),this.$lnkResetFilters.off(),this.stopListening()},removeCustomFilterDropdowns:function(){_.each(this.instantiatedCustomFilterDropdowns,function(e){e.remove()}),this.instantiatedCustomFilterDropdowns=[],_.each(this.customFilterSelectionModels,function(e){e.destroy({wait:!1})}),this.customFilterSelectionModels=[],_.forOwn(this.customFilter$ElementsMap,_.bind(function(e){this.unsubscribeFromFilterSource(e)},this)),this.dropdownId&&($("#"+this.dropdownId).closest(".select2-container").remove(),this.dropdownId=null)},removeDateFilters:function(){_.eachRight(this.dateFilterViewInstances,function(e){e.onClose()})},renderDropdown:function(n,a,r){for(var t,e,l=this,i=z.getComponentDefinition({componentId:16,settingsModel:new w.DeepModel}),i=new w.DeepModel(i.appArgs.json),o=(l.columnFilters[a]||"").split("|"),s=0;s<o.length;s++)if(""===o[s]){o.splice(s,1);break}e=new v.DocumentViewModel({_default:o,_viewType:!0,_type:"list"}),this.customFilterSelectionModels.push(e),this.listenTo(e,"change:value",function(e,t){var i=l.encodeInputFromArray(t),o=n.find("input");o.val(i),l.columnFilters[a]=0===t.length?"":t.join("|"),l.checkResetFiltersState(),l.debounced_refreshDataView(),this.customFilterFunctions_Selection[r]=E._generateSelectionFilterFunction(t),l.refreshClearButton(o,t)}),i.set({"Basics.AcceptEmptyValues":!0,"Basics.ShowSearch":!0,"Basics.MultiSelect":!0,"Basics.SelectedValue":e,"Basics.Items":this.getDropdownItems(a,r),"Basics.FieldSummaryThreshold":0}),(t=$("<div>")).appendTo(n),this.app.api.loadApp("BasicComponents",t,i,{onReadyCallback:function(e){t.find(".select2-selection").click(),l.dropdownId=e}},function(e){l.instantiatedCustomFilterDropdowns.push(e)})},resetColumnFiltersMap:function(){this.columnFilters={}},resetCustomFilters:function(){this.customFilterFunctions_Number={},this.customFilterFunctions_Selection={},this.customFilterFunctions_DateTime={}},resetFilters:function(){var e;_.isNil(this.app.grid)||((e=$(this.app.grid.getHeaderRow())).find("input").val(""),e.find(".slick-headerrow-column>i").remove(),_.each(this.customFilterSelectionModels,function(e){e.set("value",[])}),this.resetColumnFiltersMap(),this.resetCustomFilters(),this.resetFilterViewstates(),this.checkResetFiltersState(),this.filterOnEnterHit&&(this.wasEnterHit=!0),this.refreshDataView())},resetFilterViewstates:function(){for(var e=this.app.viewModel.get(this.COLUMNS_KEY).length,t=0;t<e;t++){var i="".concat(this.COLUMNS_KEY,".").concat(t,".Filter"),o=this.api.getPropertyMeta(i);o&&"viewstate"===o.type&&this.api.setProperty(i,"")}},resetGlobalFilter:function(){this.lastSearchValue="",this.searchboxChanged(this.filterOnEnterHit?{which:13}:null)},saveFilterSettings:function(){var e,t=this.getValueOfViewState(this.app.viewModel.get(this.BASICS_FILTERING));switch(t){case"Column Filters":case"Advanced Column Filters":e=$.extend(!0,{},this.columnFilters);break;case"Quick Search":e=this.lastSearchValue;break;default:e=null}var i={version:1,type:t,value:e};0<=["Column Filters","Advanced Column Filters"].indexOf(t)&&this.mapFilterValuesToViewstates(),this.isAutosaveEnabled()&&this.app.api.saveSetting(this.FILTER_SETTINGS_KEY,i)},mapFilterValuesToViewstates:function(){var o=this.app.grid.getColumns(),n=this.app.viewModel.get(this.COLUMNS_KEY);_.each(this.columnFilters,function(e,t){var i,t=this.app.grid.getColumnIndex(t);void 0!==t&&(t=o[t].name,t=_.findIndex(n,{DisplayName:t}),t="".concat(this.COLUMNS_KEY,".").concat(t,".Filter"),i=this.api.getPropertyMeta(t))&&"viewstate"===i.type&&(this.app.viewModel.set(t,e,{silent:!0}),this.api.setProperty(t,e))}.bind(this))},searchboxChanged:function(e){if(this.filterOnEnterHit&&e){if(13!==e.which&&9!==e.which)return;this.wasEnterHit=!0}this.app.dataView&&(e=$.trim(this.$txtGlobalFilter.val()),this.lastSearchValue!==e)&&(this.lastSearchValue=e,this.$txtGlobalFilter.addClass("busy"),this.app.dataView.setFilterArgs({_globalSearchString:e}),this.refreshDataView(),this.$txtGlobalFilter.removeClass("busy"))},setupKdbFilterIfServerside:function(){this.isProcessedServerSide&&this.showAdvancedColumnFilters&&this.filterSettingsToApply&&this.app.setProperty(this.BASICS_KDB_FILTER_STRING,this.generateKdbFilterString(this.filteringMode))},showDateFilter:function(i,e,t){var o=this,t="12"+this.app.columnInfo.get(t).get("kdbType");this.removeDateFilters(),t=new m({filterValue:i.val(),app:this.app,$elActivator:i,kdbClass:t}),this.dateFilterViewInstances.push(t),this.listenTo(t,"removed",function(e){_.pull(this.dateFilterViewInstances,e)}),this.listenTo(t,"filterApplied",function(e,t){o.filterOnEnterHit&&(o.wasEnterHit=!0),i.val(e).trigger("change")})},unsubscribeFromEvents:function(){this.removeCustomFilterDropdowns(),this.app.grid&&this.onHeaderRowCellRenderedScoped&&this.app.grid.onHeaderRowCellRendered.unsubscribe(this.onHeaderRowCellRenderedScoped),this.$headerRow&&this.$headerRow.off()},unsubscribeFromFilterSource:function(e){e.serverSelectionDataSource&&(this.api.unsubscribe(e.serverSelectionDataSource),e.serverSelectionDataSource=null)},refreshClearButton:function(e,t){0<t.length?0===e.next("i").length&&e.after('<i class="fa fa-times" style="z-index: 1"/>'):e.next("i").remove()}}),_.extend(E,(Ve=/(==|=>|=<|!=|<>|<=|>=|=|>|<|)((-?\d+(\.\d+)?[kmbtpe]?)|(-?null))/g,Be={e:1e18,p:1e15,t:1e12,b:1e9,m:1e6,k:1e3},He={"=":"==","<>":"!=","=>":">=","=<":"<="},{NULL_EMPTY_VALUE:"NULL",convertSmartNumberToNumber:Ge,_getNumberFilterParts:ze,_generateNumberFilterFunction:function(e){var t=(e=ze(e)).expressions,e=e.isAndCondition,i=_.map(t,function(t){switch(t.operator){case"is_null":return function(e){return null===e};case"is_not_null":return function(e){return null!==e};case"==":return function(e){return null!==e&&e==t.number};case"<":return function(e){return null!==e&&e<t.number};case">":return function(e){return null!==e&&e>t.number};case"<=":return function(e){return null!==e&&e<=t.number};case">=":return function(e){return null!==e&&e>=t.number};case"!=":return function(e){return null!==e&&e!=t.number}}});return 0===i.length?function(){return!0}:e?function(t){return!_.some(i,function(e){return!e(t)})}:function(t){return _.some(i,function(e){return e(t)})}},_generateSelectionFilterFunction:function(t){t=t.slice();for(var e=0;e<t.length;e++)if(t[e]===E.NULL_EMPTY_VALUE){t[e]="";break}return 0===t.length?function(){return!0}:function(e){return e=null===e?"":""+e,_.includes(t,e)}}})),e=window,S=Slick.Utils,R="keydown",M.DefaultDecimalPlaces=null,M.AllowEmptyValue=!1,Slick.Utils.extend(!0,e,{Slick:{Editors:{Text:function(i){var t,o,e,n=this;this.args=i,this.init=function(){e=i.grid.getOptions().editorCellNavOnLRKeys,(t=S.createDomElement("input",{type:"text",className:"editor-text"},i.container)).addEventListener(R,e?k:x),t.focus(),t.select(),i.compositeEditorOptions&&t.addEventListener("change",this.onChange)},this.onChange=function(){var e=i.grid.getActiveCell();n.validate().valid&&n.applyValue(n.args.item,n.serializeValue()),n.applyValue(n.args.compositeEditorOptions.formValues,n.serializeValue()),i.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:n.args.item,column:n.args.column,formValues:n.args.compositeEditorOptions.formValues})},this.destroy=function(){t.removeEventListener(R,e?k:x),t.removeEventListener("change",this.onChange),t.remove()},this.focus=function(){t.focus()},this.getValue=function(){return t.value},this.setValue=function(e){t.value=e},this.loadValue=function(e){o=e[i.column.field]||"",t.value=o,t.defaultValue=o,t.select()},this.serializeValue=function(){return t.value},this.applyValue=function(e,t){e[i.column.field]=t},this.isValueChanged=function(){return!(""===t.value&&null==o)&&t.value!=o},this.validate=function(){if(i.column.validator){var e=i.column.validator(t.value,i);if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},Integer:function(i){var t,o,e,n=this;this.args=i,this.init=function(){e=i.grid.getOptions().editorCellNavOnLRKeys,(t=S.createDomElement("input",{type:"text",className:"editor-text"},i.container)).addEventListener(R,e?k:x),t.focus(),t.select(),i.compositeEditorOptions&&t.addEventListener("change",this.onChange)},this.onChange=function(){var e=i.grid.getActiveCell();n.validate().valid&&n.applyValue(n.args.item,n.serializeValue()),n.applyValue(n.args.compositeEditorOptions.formValues,n.serializeValue()),i.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:n.args.item,column:n.args.column,formValues:n.args.compositeEditorOptions.formValues})},this.destroy=function(){t.removeEventListener(R,e?k:x),t.removeEventListener("change",this.onChange),t.remove()},this.focus=function(){t.focus()},this.loadValue=function(e){o=e[i.column.field],t.value=o,t.defaultValue=o,t.select()},this.serializeValue=function(){var e=t.value;return 0<e.length?parseInt(e,10)||0:null},this.applyValue=function(e,t){e[i.column.field]=t},this.isValueChanged=function(){return!(""===t.value&&null==o)&&t.value!=o},this.validate=function(){if(isNaN(t.value))return{valid:!1,msg:"Please enter a valid integer"};if(i.column.validator){var e=i.column.validator(t.value,i);if(!e.valid)return e}return{valid:!0,msg:null}},this.init()},Number:M,Float:M,Checkbox:function(i){var t,o,n=this;this.args=i,this.init=function(){(t=S.createDomElement("input",{className:"editor-checkbox",type:"checkbox",value:"true"},i.container)).focus(),i.compositeEditorOptions&&t.addEventListener("change",this.onChange)},this.onChange=function(){var e=i.grid.getActiveCell();n.validate().valid&&n.applyValue(n.args.item,n.serializeValue()),n.applyValue(n.args.compositeEditorOptions.formValues,n.serializeValue()),i.grid.onCompositeEditorChange.notify({row:e.row,cell:e.cell,item:n.args.item,column:n.args.column,formValues:n.args.compositeEditorOptions.formValues})},this.destroy=function(){t.removeEventListener("change",this.onChange),t.remove()},this.focus=function(){t.focus()},this.loadValue=function(e){o="string"==typeof e[i.column.field]?"true"===e[i.column.field]:!!e[i.column.field],t.checked=!!o},this.serializeValue=function(){return t.checked},this.applyValue=function(e,t){e[i.column.field]=t},this.isValueChanged=function(){return this.serializeValue()!==o},this.validate=function(){return{valid:!0,msg:null}},this.init()}}}});function D(){this.isActive=!1,this.instances=[],this.pendingInitObjects=[],this._refreshInternalDebounced=_.debounce(this._refreshInternal,50,{leading:!0})}function We(e){this.app=e,this.initialize(),this.setTheme()}function $e(e){this.app=e,this.initialize()}function Ue(e){this.app=e,this.initialize()}function Ke(e){this.app=e,this.initialize()}function je(e){this.app=e,this.depopulateDelay=1e4,this.initialize()}function qe(e){this.app=e,this.initialize()}function Ye(e){this.app=e,this.initialize()}function Xe(e){this.app=e,this.hasActions=!1,this.initialize()}function Qe(e){this.app=e,this.initialize()}function I(e){this.app=e,this.initialize()}function Je(e){this.app=e,this.api=e.api,this.initialize()}var T,Ze,et,tt,it,ot=function(e,t,i){var o,n,a,r=1;return _.isNumber(e.WidthWeight)&&0<=e.WidthWeight&&(r=e.WidthWeight),n=O.getFormatter(e,i),o=Slick.Editors[f.KDB_2_SLICKGRID_EDITOR_MAP[e.Format]],i.customEditors&&_.has(i.customEditors,e.Field)&&(o=i.customEditors[e.Field],e.IsReadonly=!1),"DeleteIcon"===e.Field&&(o=null,n=function(e,t,i,o,n){var a=document.createElement("i");return a.className="fa fa-remove deleteIcon",a.setAttribute("data-rownumber",e),a.outerHTML}),i=e.DisplayName||e.Field,a=((a=e.Tooltip||i)||"").replace(/(?:\\r\\n|\\r|\\n)/g,"\r\n"),t={id:e.Field+t,name:i,toolTip:a,field:e.Field,formatter:n,width:r,sortable:e.Sortable,selectable:e.IsSelectable,focusable:e.IsSelectable,editor:e.IsReadonly?null:o,cssClass:e.TextAlign,headerCssClass:e.TextAlign,_dashboardConfig:e},1<=e.MinWidthAbsolute&&(t.minWidth=e.MinWidthAbsolute),t},nt=(_.extend(D.prototype,{_addInstance:function(e){this.instances.push(e)},storeInitObjects:function(){D.loadSparklinesLib(this),D.prototype.storeInitObjects=D.prototype._storeInitObjects_AfterLibraryStartedToLoad,this.storeInitObjects.apply(this,arguments)},_storeInitObjects_AfterLibraryStartedToLoad:function(e,t,i){this.pendingInitObjects.push({elId:e,values:t,cfg:i}),this.isActive=!0},remove:function(){this._removeAllInstances(),this.pendingInitObjects=[]},_removeAllInstances:function(){_.each(this.instances,function(e){e.remove()}),this.instances=[]},_removeHiddenInstances:function(){this.instances=_.filter(this.instances,function(e){if(e.is(":visible"))return!0;e.remove()})},_renderPendingInstances:function(){for(var i,o;i=this.pendingInitObjects.shift();)(o=$("#"+i.elId))&&o.is(":visible")&&(_.isArray(i.cfg)?_.each(i.cfg,function(e,t){this._addInstance(o.sparkline(i.values[t],e))}.bind(this)):this._addInstance(o.sparkline(i.values,i.cfg)))},refresh:function(){this.isActive&&(D.isLibReady?this._refreshInternalDebounced():D.isLoadingLib&&D.addPendingManager(this))},_refreshInternal:function(){this._removeHiddenInstances(),this._renderPendingInstances()}}),_.extend(D,{isLoadingLib:!1,isLibReady:!1,_pendingManagers:[],addPendingManager:function(e){D._pendingManagers.indexOf(e)<0&&D._pendingManagers.push(e)},loadSparklinesLib:function(e){e&&D.addPendingManager(e),$.fn.sparkline?D._ready():D.isLoadingLib||(D.isLoadingLib=!0,require(["sparkline"],function(){D.isLoadingLib=!1,D._ready()}))},_ready:function(){D.isLibReady=!0,D._refreshPendingManagers()},_refreshPendingManagers:function(){_.each(D._pendingManagers,function(e){e.refresh()}),D._pendingManagers=[]}}),_.extend(We.prototype,w.Events,{initialize:function(){this.$root=this.app.$(">.Datagrid"),this.$pnlGrid=this.app.$(".pnlGrid"),this.listenTo(this.app.viewModel,"change:Style.EvenRowBackgroundColorOverride change:Style.OddRowBackgroundColorOverride change:Style.HeaderFontWeight change:Style.FontFamily",_.bind(this.app.generateDataGridFromReceivedData,this.app)),this.listenTo(this.app.viewModel,"change:Style.FontSize",_.bind(this.app.generateDataGridFromReceivedData,this.app)),this.listenTo(this.app.viewModel,"change:Style.RowHeight change:Style.HeaderRowHeight",_.bind(this.app.generateDataGridFromReceivedData,this.app)),this.listenTo(this.app.viewModel,"change:Style.Theme",this.onChange_Theme),this.listenTo(this.app.viewModel,"change:Style.SelectedRowBackgroundColor",this.onChange_SelectedRowBackgroundColor),this.listenTo(this.app.viewModel,"change:Style.HeaderTextTransformation",this.onChange_HeaderTextTransformation)},getFontSize:function(){var e=this.app.viewModel.get("Style.FontSize");return parseFloat(e).toString()==e&&(e+="px"),e},onChange_HeaderTextTransformation:function(e,t){this.$pnlGrid.removeClass("header-uppercase header-lowercase header-capitalize"),"none"===t?this.app.generateDataGridFromReceivedData():this.$pnlGrid.addClass("header-"+t)},onChange_SelectedRowBackgroundColor:function(e,t){t?(this.$SelectedRowBackgroundColorCss=this.$SelectedRowBackgroundColorCss||$("<style />",{type:"text/css"}).appendTo(document.head),t='[data-widgetid="'+this.app.widgetId+'"]  div.Datagrid .slick-row > .slick-cell.selected { background-color: '+t+"; }",this.$SelectedRowBackgroundColorCss.html(t)):this.remove_SelectedRowBackgroundColorCss()},onChange_Theme:function(){var e,o=this,n=this.app.viewModel.get("Style.Theme"),t=(this.currentTheme&&this.$root.removeClass(this.currentTheme),this.currentTheme=n,this.$root.addClass(this.currentTheme),this.app.api&&(t=this.app.api.getProperty("Style.EvenRowBackgroundColorOverride"),e=this.app.api.getProperty("Style.OddRowBackgroundColorOverride")),[t,e]),a=["Style.EvenRowBackgroundColorOverride","Style.OddRowBackgroundColorOverride"],r=v.Tools.getDefaultThemeColors("Light"),l=v.Tools.getDefaultThemeColors("Dark");_.forEach(t,function(e,t){var i;"Light"!==n||e&&e!==l[t]?"Dark"!==n||e&&e!==r[t]||(i=l[t]):i=r[t],i&&o.app.api.setProperty(a[t],i)})},remove:function(){this.stopListening(),this.remove_SelectedRowBackgroundColorCss()},remove_SelectedRowBackgroundColorCss:function(){this.$SelectedRowBackgroundColorCss&&(this.$SelectedRowBackgroundColorCss.remove(),this.$SelectedRowBackgroundColorCss=null)},setTheme:function(){var e=this.app.dashboardViewModel.get("DashboardTheme")||"Dark";this.app.viewModel.set("Style.Theme",e)}}),{getExportMetaData:function(c){var h=this,p=[],g={GBP:" ",USD:"$ ",EUR:" ",none:""},f=h.getConfigs_datagridConfig_layoutConfig(c);return _.each(f.datagridConfig,function(e,t){var t=f.layoutConfig[t],i={},o=t.Format,n=t.DateFormat,a=t.TimeFormat,r=c.isRawFormat||"Percentage"!==o?"":"%",l=void 0!==g[t.Currency]?g[t.Currency]:t.Currency,s=t.Template,d=c.columnInfo.findWhere({id:e.field}),u=d?d.get("kdbType"):"",o=h.resolveColumnFormat(o,u,n,a,t.Precision,c.isRawFormat,c.isPreserveKDBTypes);d||console.log("Datagrid column kdbType reverted to empty, col model not foud in columnInfo"),i.colId=e.field,i.colName=e.name,i.dataType=o.dataType,i.dataKdbType=o.dataKdbType,i.dataFormat=o.dataFormat,i.hideTrailingZeroes=t.HideTrailingZeroes,i.prefix=l,i.suffix=r,i.template=s,i.columnConfig=e,i.formatter=e.formatter,i.isRawFormat=c.isRawFormat,p.push(i)}),p},resolveColumnFormat:function(e,t,i,o,n,a,r){var l="",i=v.ExportTools.DATE_FORMAT_MAP[i],o=v.ExportTools.TIME_FORMAT_MAP[o],s=11<t&&t<20,d=2<t&&t<12,u=_.includes(["Number","Formatted Number","Smart Number","Percentage"],e),c=_.includes(["Date","Time","DateTime"],e),h=(n=this.getValidPrecission(Number(n)))?"."+Array(n+1).join("0"):"",p=((t<1||19<t||a)&&(t=11,l="TO_STRING",e="String"),(!d&&u||!s&&c)&&(e="String",console.log("!!exportConverterTools value kdbType, col type, format mismatch: "+t+", "+e+", "+l)),{dataKdbType:t,dateFormat:i,timeFormat:o});function g(e,t){var i=e,o="";switch(e){case"Formatted Number":i="Number",o="#,##0"+h;break;case"Smart Number":i="String",o="SmartNumber"+h;break;case"Date":o=t.dateFormat||(console.log("Invalid date format: "+t.dateFormat+". Reverting to defaut format"),"");break;case"Time":o=t.timeFormat||(console.log("Invalid time format: "+t.timeFormat+". Reverting to defaut format"),"");break;case"DateTime":o=t.dateFormat&&t.timeFormat?t.timeFormat:(console.log("Invalid date or time formats: "+t.dateFormat+", "+t.timeFormat+". Reverting to defaut format"),""),o=t.dateFormat+" "+t.timeFormat;break;case"Percentage":i="Number",o="#0";break;case"Boolean":i=1===t.dataKdbType?"Boolean":"String";break;default:return null}return{dataType:i,dataFormat:o}}if(r)if("General"===e)switch(this.getKDBTypeForExcel(t)){case"Number":d&&(l="#,##0"+h),e="Number";break;case"Date":l=i||(console.log("Invalid date format: "+i+". Reverting to defaut format"),""),e="Date";break;case"Time":case"Minute":case"Timespan":case"Second":l=o||(console.log("Invalid time format: "+o+". Reverting to defaut format"),""),e="Time";break;case"Text":e="Text";break;default:e="String",l="TO_STRING"}else switch(e){case"Number":d&&(l="#,##0"+h);break;case"Formatted Number":case"Smart Number":case"Date":case"Time":case"DateTime":case"Percentage":case"Boolean":var f=g(e,p);f&&(e=f.dataType,l=f.dataFormat);break;default:e="String",l="TO_STRING"}else switch(e){case"Number":d&&(l="#0"+h);break;case"Formatted Number":case"Smart Number":case"Date":case"Time":case"DateTime":case"Percentage":case"Boolean":var m=g(e,p);m&&(e=m.dataType,l=m.dataFormat);break;default:e="String",l="TO_STRING"}return{dataType:e=1===t?"Boolean":e,dataFormat:l,dataKdbType:t}},getKDBTypeForExcel:function(e){return{1:"Boolean",2:"String",4:"Number",5:"Number",6:"Number",7:"Number",8:"Number",9:"Number",10:"Text",11:"Text",12:"Timestamp",13:"Month",14:"Date",15:"Datetime",16:"Timespan",17:"Minute",18:"Second",19:"Time"}[e]},getValidPrecission:function(e){var t=void 0!==e?e:0;return t<0?(t=0,console.info("Invalid precission, should be between in range of 0 and 10, got: ",e)):10<t&&(t=10,console.info("Invalid precission, should be between in range of 0 and 10, got: ",e)),t},getConfigs_datagridConfig_layoutConfig:function(e){for(var i=[],o=[],n=_.clone(e.columnsConfig),a=_.clone(e.unpackedColumnsConfiguration),t=a.length-1;0<=t;t--)a[t].Hidden&&(n.splice(t,1),a.splice(t,1));return _.each(e.gridColumns,function(t){var e=_.findIndex(n,function(e){return t.id===e.id});0<=e&&(i.push(n[e]),o.push(a[e]))}),{datagridConfig:i,layoutConfig:o}},getConfig:function(e){var t={},i={".csv":"Csv",".xlsx":"Excel"}[e.fileFormat];try{if(_.some(_.values(e),function(e){return void 0===e}))throw"Missing config generator options.";t.dataSet=e.dataSet,t.metaData=this.getExportMetaData(e.columnsConfig),t.fileName=v.ExportTools.getExportFileName(e.fileName,e.altFileName,i),t.fileFormat=e.fileFormat,t.workSheetTitle=e.workSheetTitle,t.csvExportDelimiter=e.csvExportDelimiter,t.isPreserveKDBTypes=e.columnsConfig.isPreserveKDBTypes,t.actions=e.actions,t.selectedDashboard=e.selectedDashboard}catch(e){console.error("Datagrid config generator error: ",e)}return t},getFullExportConfig:function(e){var n={},a=this.getExportMetaData(e);return a.length&&(n.columnLabel="",n.dateFormat="",_.each(a,function(e,t){var t=t<a.length-1?" && ":"",i=e.dataKdbType,o=e.colId+"#"+e.colName+t;n.columnLabel+=o,12<=i&&i<=19&&"TO_STRING"!==e.dataFormat&&(o=e.dataFormat,"DateTime"===e.dataType&&(o=o.replace(/\s([^\s]+)$/,"_$1")),i=e.colId+"#"+o+t,n.dateFormat+=i)}),new RegExp("&& $").test(n.dateFormat))&&(n.dateFormat=n.dateFormat.slice(0,-4)),n}}),F=w.View.extend({initialize:function(e){var i=this;this.options=e,this.options.theme=this.options.app.viewModel.get("Style.Theme"),this.app=this.options.app,this.$el.html(j.ColumnConfigDialog()),this.$chkRetainColumnWidths=this.$(".chkRetainColumnWidths"),this.initLayout(),this.$dialog=this.$el.dialog(_.extend({classes:{"ui-dialog":"Datagrid column-config-dialog"},title:t("Configure Column Layout"),resizable:!1,width:"850",height:"600",modal:!0,autoOpen:!0,draggable:!0,buttons:[{text:t("Reset"),click:function(){i.wasResetHit=!0,i.initDataRows()},icon:"fa fa-refresh"},{text:t("Ok"),click:$.proxy(i.onOkButtonClick,i),icon:"fa fa-check"},{text:t("Cancel"),click:$.proxy(i.onClose,i),icon:"fa fa-times"}],resizeStop:function(){i.dgSource.onResize(),i.dgTarget.onResize()},close:function(){i.trigger("closing"),i.$dialog.dialog("destroy"),i.remove()}},this.options))},filterColumnConfig:function(e,t){var i=e;switch(t){case"deepClone":i=_.cloneDeep(e);break;case"clone":i=_.clone(e)}return this.app.api.getProperty("CustomLayout.IncludeHiddenColumns")?i:_.filter(i,function(e){return _.isNil(e.Hidden)||!e.Hidden})},initDataRows:function(){var o,t,n=[],e=this.wasResetHit?(t=this.filterColumnConfig(this.options.resetColumnsConfiguration,"deepClone"),n=_.filter(t,{Hidden:!1}),_.filter(t,{Hidden:!0})):(t=this.filterColumnConfig(this.options.columnsConfiguration,"clone"),e=this.filterColumnConfig(this.options.resetColumnsConfiguration,"none"),_.each(e,function(e){_.find(t,{Field:e.Field,Format:e.Format,DisplayName:e.DisplayName})||t.push(_.cloneDeep(e))}),o=_.clone(t),visibleFields=_.map(this.options.currentColumnlayout,"field"),_.each(visibleFields,function(t){var e,i=_.filter(o,{Field:t});0===i.length?(e=_.find(o,function(e){return"*"===e.Field||0<=t.indexOf(e.Field.replace("*",""))}))&&(n.push(e),o=_.without(o,e)):(e=i[0],n.push(e),o=_.without(o,e))}),_.difference(t,n));this.populateDatagrid(this.dgSourceModel,e),this.populateDatagrid(this.dgTargetModel,n)},initLayout:function(){var e=F.generateDatagridConfig();e.set("theme",this.options.theme),this.dgSourceModel=e.get("data"),this.dgSource=new V.Master({el:this.$(".pnlSource > .pnlGrid"),model:e}),this.dgSource.$el.on("dblclick",".slick-row",$.proxy(this.onClick_moveToTarget,this)),(e=F.generateDatagridConfig()).set("theme",this.options.theme),this.selectedColumns=new v.DocumentViewModel({_default:[],_viewType:!0,_type:"list",value:[]}),e.get("datagridConfig").Selection.SelectedValue=this.selectedColumns,this.dgTargetModel=e.get("data"),this.dgTarget=new V.Master({el:this.$(".pnlTarget > .pnlGrid"),model:e}),this.dgTarget.$el.on("dblclick",".slick-row",$.proxy(this.onClick_moveToSource,this)),this.listenTo(this.dgSource,"selectedRowsChanged",this.updateButtonStates),this.listenTo(this.dgTarget,"selectedRowsChanged",this.updateButtonStates),this.initDataRows(),this.dgSource.isDialogueGrid=!0,this.dgTarget.isDialogueGrid=!0,this.$btnMoveToSource=this.$(".btnMoveToSource"),this.$btnMoveToTarget=this.$(".btnMoveToTarget"),this.$btnMoveUp=this.$(".btnMoveUp"),this.$btnMoveDown=this.$(".btnMoveDown"),this.$btnMoveToSource.button({icon:"fa fa-arrow-left",disabled:!0,text:!1,showLabel:!1}).click($.proxy(this.onClick_moveToSource,this)),this.$btnMoveToTarget.button({icon:"fa fa-arrow-right",disabled:!0,text:!1,showLabel:!1}).click($.proxy(this.onClick_moveToTarget,this)),this.$btnMoveUp.button({icon:"fa fa-arrow-up",disabled:!0,text:!1,showLabel:!1}).click($.proxy(this.onClick_moveUp,this)),this.$btnMoveDown.button({icon:"fa fa-arrow-down",disabled:!0,text:!1,showLabel:!1}).click($.proxy(this.onClick_moveDown,this))},moveSelectedColumns:function(e){var i,o,t=this.selectedColumns.get("value"),n=[];0===t.length||(i=this.dgTargetModel.dataSet.collection.toJSON(),o=i.length-1,!e&&_.max(t)===o)||e&&0===_.min(t)||(e&&(i=i.reverse(),t=_.map(t,function(e){return i.length-e-1})),t=_.sortBy(t).reverse(),_.each(t,function(e){var t;e+1<=o?(t=i[e+1],i[e+1]=i[e],i[e]=t,o=e,n.push(e+1)):(o=e-1,n.push(e))}),e&&(i=i.reverse(),n=_.map(n,function(e){return i.length-e-1})),this.populateDatagrid(this.dgTargetModel,_.map(i,"columnConfig")),this.selectedColumns.set("value",n),this.dgTarget.onSettingsChange({"Selection.SelectedValue":n}),this.dgTarget.grid.scrollRowIntoView(_.first(n)))},onClick_moveDown:function(){this.wasResetHit=!1,this.moveSelectedColumns(!1)},onClick_moveToTarget:function(){var e,t,i=this.dgSource.selectionModule.getSelectedRowObjects()||[],o=_.map(i,"pk");i.length&&(this.wasResetHit=!1,e=this.dgSourceModel.dataSet.collection.toJSON(),i=_.filter(e,function(e){return _.includes(o,e.pk)}),e=_.difference(e,i),i=_.map(i,"columnConfig"),e=_.map(e,"columnConfig"),this.populateDatagrid(this.dgSourceModel,e),this.populateDatagrid(this.dgTargetModel,this.dgTargetModel.dataSet.collection.pluck("columnConfig").concat(i)),this.dgSource.grid)&&(e=_.extend({},this.dgSource.grid.getActiveCell()),this.dgSource.grid.setSelectedRows([]),i=this.dgSource.grid.getDataLength()-1,t=this.dgTarget.grid.getDataLength()-1,this.dgSource.grid.resetActiveCell(),i>=e.row?this.dgSource.grid.setActiveCell(e.row,0):null==e.row&&0<=i&&this.dgSource.grid.setActiveCell(i,0),this.dgTarget.grid.setActiveCell(t,0))},onClick_moveToSource:function(){var e,t,i=this.dgTarget.selectionModule.getSelectedRowObjects()||[];selectedObjectPKs=_.map(i,"pk"),i.length&&(this.wasResetHit=!1,t=(t=this.dgSourceModel.dataSet.collection.toJSON()).concat(i),e=this.dgTargetModel.dataSet.collection.toJSON(),i=_.filter(e,function(e){return!_.includes(selectedObjectPKs,e.pk)}),i=_.map(i,"columnConfig"),t=_.map(t,"columnConfig"),this.populateDatagrid(this.dgSourceModel,t),this.populateDatagrid(this.dgTargetModel,i),this.dgTarget.grid)&&(e=_.extend({},this.dgTarget.grid.getActiveCell()),this.dgTarget.grid.setSelectedRows([]),t=this.dgSource.grid.getDataLength()-1,i=this.dgTarget.grid.getDataLength()-1,this.dgTarget.grid.resetActiveCell(),i>=e.row?this.dgTarget.grid.setActiveCell(e.row,0):null==e.row&&0<=i&&this.dgTarget.grid.setActiveCell(i,0),this.dgSource.grid.setActiveCell(t,0))},onClick_moveUp:function(){this.wasResetHit=!1,this.moveSelectedColumns(!0)},onClose:function(){this.$el.dialog("close")},onOkButtonClick:function(){var t,i,o,n,e,a=null,r=this;this.wasResetHit?(e=this.app.cloneDeep_processViewStates(this.app.api.getProperty("ColumnsConfiguration")),this.app.viewModel.set("ColumnsConfiguration",e,{silent:!0})):(a=[],n=this.dgTargetModel.dataSet.collection.toJSON(),e=this.dgSourceModel.dataSet.collection.toJSON(),n=_.map(n,"columnConfig"),e=_.map(e,"columnConfig"),_.each(n,function(e){e.Hidden=!1}),_.each(e,function(e){e.Hidden=!0}),this.$chkRetainColumnWidths.is(":checked")?(i=this.options.currentColumnlayout,o=1,0<i.length&&(o=_.minBy(i,"width").width),_.each(n,function(e,t){e=_.find(i,{field:e.Field})||{width:o};n[t].WidthWeight=e.width,n[t]._RetainWidth=!0})):_.each(n,function(e){t=_.find(r.options.resetColumnsConfiguration,{Field:e.Field}),e.WidthWeight=t.WidthWeight,e.MinWidthAbsolute=t.MinWidthAbsolute}),a=a.concat(n).concat(e)),this.trigger("okClick",a),this.onClose()},populateDatagrid:function(e,t){dataRows=_.map(t,function(e,t){return{pk:t,name:e.DisplayName,columnConfig:e}}),e.onExecuteBegin(),(t=F.dummyKdbResponse()).rows=dataRows,e.onExecuteSuccess(t,!0)},remove:function(){_.each([this.dgSource,this.dgTarget],function(e){e.$el.off(),e.remove()}),_.each([this.$btnMoveToSource,this.$btnMoveToTarget,this.$btnMoveUp,this.$btnMoveDown],function(e){e.off(),e.button("destroy")}),w.View.prototype.remove.apply(this,arguments)},updateButtonStates:function(){var e=0===(this.dgSource.selectionModule.getSelectedRowObjects()||[]).length,t=0===(this.dgTarget.selectionModule.getSelectedRowObjects()||[]).length;this.$btnMoveToSource.button("option","disabled",t),this.$btnMoveToTarget.button("option","disabled",e),this.$btnMoveUp.button("option","disabled",t),this.$btnMoveDown.button("option","disabled",t)}},(T=["pk","name","columnConfig"],Ze=[6,11,0],et=["pk","Name","columnConfig"],tt=["pk","columnConfig"],{generateDatagridConfig:function(){var e=new v.DocumentDataModel({_subscriptionKey:"pk",_dataType:"copy",_maxRows:1e6});return e.apply(),e.onExecuteSuccess(F.dummyKdbResponse(),!0),new w.Model({data:e,columnsConfig:F.getColumnsConfiguration(),datagridConfig:F.datagridConfiguration(),sortColumns:F.sortColumns,theme:"Dark"})},datagridConfiguration:function(){return{Selection:{Mode:"Multi Row"}}},columnsConfiguration:function(){return _.map(T,function(e,t){return{Field:e,DisplayName:et[t],Sortable:!1,Hidden:_.includes(tt,T[t])}})},dummyKdbResponse:function(){return{rows:[],columns:T,meta:_.zipObject(T,Ze)}},getColumnsConfiguration:function(){var e=F.columnsConfiguration();return _.map(e,function(e){return _.extend({},V.getColumnSettingsModel(),{DisplayName:e.Field,TextAlign:"left",IsReadonly:!0},e)})},sortColumns:[{sortCol:"pk",sortAsc:!0}]})),at=(_.extend($e.prototype,w.Events,{initialize:function(){var i=this;_.extend(this.app,at),this.$lnkCsvExport=this.app.$("a.lnkCsvExport"),this.$lnkExcelExport=this.app.$("a.lnkExcelExport"),this.$lnkFullExport=this.app.$("a.lnkFullExport"),this.$lnksExport=this.app.$(".lnksExport"),this.$lnkResetFilters=this.app.$(".lnkResetFilters").hide(),this.$pnlPager=this.app.$(".pnlPager"),this.$txtGlobalFilter=this.app.$(".txtGlobalFilter"),this.$lnkConfiguration=this.app.$(".lnkConfiguration"),this.$lnkCsvExport.click(_.bind(this.showDialog,this,".csv")),this.$lnkExcelExport.click(_.bind(this.showDialog,this,".xlsx")),this.$lnkFullExport.click(_.bind(this.apiExport,this)),this.displayChoiceLinkButtons(),this.$lnkConfiguration.click(_.bind(this.showCustomLayoutConfig,this)),this.listenTo(this.app.viewModel,"change:FileExport.ShowExportCsvButton change:FileExport.ShowExportExcelButton change:FileExport.ShowFullExportButton",_.bind(this.displayChoiceLinkButtons,this)),this.listenTo(this.app.viewModel,"change:Basics.EnableGrouping",this.onChange_EnableGrouping),this.listenTo(this.app.viewModel,"change:Basics.Filtering change:Basics.EditMode",_.bind(this.app.positionPanelWithDatagrid,this.app)),this.listenTo(this.app.viewModel,"change:Basics.ShowPagingControl change:Basics.ShowPageState change:Basics.Filtering change:Basics.IsFilterVisible",this.onChange_ShowPagingControl_Filtering_IsFilterVisible),this.listenTo(this.app.viewModel,"change:Basics.EnableCustomLayoutConfiguration",this.onChange_EnableCustomLayoutConfiguration),this.listenTo(this.app.viewModel,"change:Basics.Data",function(e,t){v.ExportTools.onQueryChange(t,i.$lnkFullExport)})},showDialog:function(e){var t=this.app.dashboardViewModel.get("selectedDocumentId"),i=this.app.api.getDashboardName(t),o=_.get(this.app,"model.path")&&0<=this.app.model.path.indexOf("AT_internal")?"ActionTracker":"Datagrid",n=this.app.$el.get(0).classList.value,n=(0<=n.indexOf("sellBook")?o="Order Book - Sell Depth Grid":0<=n.indexOf("buyBook")?o="Order Book - Buy Depth Grid":0<=n.indexOf("buy")?o="Order Book - Buy Book Grid":0<=n.indexOf("sell")&&(o="Order Book - Sell Book Grid"),v.ExportTools),e=nt.getConfig({actions:this.app.api.getProperty("FileExport.Actions"),altFileName:this.getAltFileName(),columnsConfig:{columnInfo:this.app.columnInfo,columnsConfig:this.app.columnsConfig,unpackedColumnsConfiguration:this.app.unpackedColumnsConfiguration,gridColumns:this.app.grid.getColumns(),isRawFormat:this.app.api.getProperty("FileExport.RawFormat"),isPreserveKDBTypes:this.app.api.getProperty("FileExport.PreserveKDBTypes")},csvExportDelimiter:this.getCsvDelimiter(),dataSet:this.app.getAllFilteredItems(),fileFormat:e,fileName:this.getFileName(),selectedDashboard:{dashboardId:t,dashboardName:i},workSheetTitle:o});n.openFileExportDialog(e)},getFileName:function(){return this.app.viewModel.get("FileExport.FileName")},getCsvDelimiter:function(){return this.app.viewModel.get("FileExport.CsvExportDelimiter")},getAltFileName:function(){return this.app.viewModel.get("format.widgetTitle")||""},onChange_EnableCustomLayoutConfiguration:function(e,t){this.$lnkConfiguration[t?"show":"hide"](),this.positionPanelWithDatagrid()},onChange_EnableGrouping:function(e,t){this.positionPanelWithDatagrid()},apiExport:function(){var e,i,o,n,a,r;this.$lnkFullExport.hasClass("events-disabled")||(e=this.app.dashboardViewModel.get("selectedDocumentId"),i=this.app.api.getDashboardName(e),n={columnInfo:(o=this).app.columnInfo,columnsConfig:this.app.columnsConfig,unpackedColumnsConfiguration:this.app.unpackedColumnsConfiguration,gridColumns:this.app.grid.getColumns()},n=nt.getFullExportConfig(n),a=v.ExportTools.getExportFileName(this.getFileName(),this.getAltFileName(),"DatagridExport"),r=$("<span />").addClass("export-spinner fa fa-spinner fa-pulse").attr("title",t("Download in progress")).appendTo(this.$lnkFullExport),this.$lnkFullExport.addClass("export-in-progress"),this.app.api.exportData(this.app.viewModel.get("Basics.Data"),function(){r.remove(),o.$lnkFullExport.removeClass("export-in-progress")},{exportName:a,exportParams:n},{actions:this.app.api.getProperty("FileExport.Actions"),component:"Datagrid",dashboardId:e,dashboardName:i}))},displayChoiceLinkButtons:function(){var e=this.app.viewModel.get("FileExport");e&&(e.ShowExportCsvButton||e.ShowExportExcelButton||e.ShowFullExportButton?(this.$lnksExport.removeClass("link-disabled"),this.$lnkCsvExport.toggleClass("link-disabled",!e.ShowExportCsvButton),this.$lnkExcelExport.toggleClass("link-disabled",!e.ShowExportExcelButton),this.$lnkFullExport.toggleClass("link-disabled",!e.ShowFullExportButton)):this.$lnksExport.addClass("link-disabled"),this.positionPanelWithDatagrid())},omitColumnFields:function(e){return _.map(e,function(e){return _.pick(e,p.FIELDS_TO_SAVE)})},onChange_ShowPagingControl_Filtering_IsFilterVisible:function(){var e=this.app.viewModel.get("Basics.ShowPagingControl"),t=this.app.viewModel.get("Basics.ShowPageState"),i="Quick Search"===this.app.viewModel.get("Basics.Filtering")&&this.app.viewModel.get("Basics.IsFilterVisible");this.$pnlPager.css("display",e?"block":"none").css("right",i?"220px":"0px"),this.$txtGlobalFilter.css("display",i?"block":"none"),e&&t?this.$pnlPager.find(".slick-pager-settings-expanded").show():this.$pnlPager.find(".slick-pager-settings-expanded").hide(),this.positionPanelWithDatagrid()},positionPanelWithDatagrid:function(){this.app.positionPanelWithDatagrid()},remove:function(){this.$lnkCsvExport.off(),this.$lnkExcelExport.off(),this.$lnkFullExport.off(),this.$lnkConfiguration.off(),this.stopListening()},saveCurrentColumnLayout:function(){var o,n,e=this.app.grid.getColumns();this.app.summaryRowModule.updateSummmaryRow(),this.app.viewModel.get("Basics.EnableCustomLayoutConfiguration")&&e.length&&(o=$.extend(!0,[],this.app.unpackedColumnsConfiguration),n=[],_.each(e,function(e){var t=e.field,i=_.findIndex(o,function(e){return e.Field===t});0<=i&&((i=o.splice(i,1)[0]).WidthWeight=e.width,i._RetainWidth=!0,n.push(i))}),n.length)&&(n=this.omitColumnFields(n),this.app.api.saveSetting("UsersColumnsConfiguration",n))},showCustomLayoutConfig:function(){var t=this,e=p.unpackColumnConfiguration(this.app.cloneDeep_processViewStates(this.app.api.getProperty("ColumnsConfiguration")),this.app.columnInfo),i=new F({app:this.app,currentColumnlayout:t.app.grid.getColumns(),columnsConfiguration:t.app.unpackedColumnsConfiguration,resetColumnsConfiguration:e});t.listenTo(i,"closing",function(){t.stopListening(i)}),t.listenTo(i,"okClick",function(e){e=_.reject(e,{Hidden:!0}),e=t.omitColumnFields(e);t.app.api.saveSetting("UsersColumnsConfiguration",e),t.app.sortingModule.storeSortColumns(),t.app.filteringModule.resetFilters(),t.app.generateDataGridFromReceivedData()})},subscribeToColumnsResizeEvent:function(){this.app.grid.onColumnsResized.subscribe(this.saveCurrentColumnLayout.bind(this))}}),{onResize:function(){var e=this;this.onResizeDebounced||(this.onResizeDebounced=_.debounce(function(){e.resizeConditional(),_.get(e.layoutModule,"app.grouping")&&e.layoutModule.app.grouping.forceColumnGrouping()},400)),this.ignoreResize||this.onResizeDebounced()},onResizeStart:function(){this.ignoreResize=!0},onResizeStop:function(){this.ignoreResize=!1,this.resizeConditional(),this.onResize()},positionPanelWithDatagrid:function(){var e,t,i,o=this.viewModel.get("Basics.Filtering"),n=this.viewModel.get("Basics.EnableGrouping"),a=this.viewModel.get("FileExport.ShowExportCsvButton"),r=this.viewModel.get("FileExport.ShowExportExcelButton"),l=this.viewModel.get("FileExport.ShowFullExportButton"),s=this.viewModel.get("Basics.EnableCustomLayoutConfiguration"),d="enabled"===this.viewModel.get("Basics.EditMode"),u=this.isDialogueGrid;this.api.hasPermission&&!this.api.hasPermission(v.CustomAPIPermission.canExportData)&&(a=r=l=!1),e=!(!this.$(".lnkToggleEditable")||"none"===this.$(".lnkToggleEditable").css("display")),t="Quick Search"===o&&this.viewModel.get("Basics.IsFilterVisible"),i=this.viewModel.get("Basics.ShowPagingControl"),this.summaryRowModule.positionSummaryRowHeight(i=i||t),this.$pnlGrid.css("bottom",this.summaryRowModule.getSummaryRowHeight()+(i?30:0)+"px"),this.$pnlGrid.css("top",!n&&(a||r||l||"disabled"!==o||s||d&&e)&&!u?"36px":"0px"),this.resizeConditional()},resizeConditional:function(){this.grid&&this.$el.is(":visible")&&(this.printModule.render()||(this.grid.resizeCanvas(),this.viewModel.isLazyDataLoadingOn()&&this.grid.onViewportChanged.notify(),this.sparklinesManager.refresh(),this.summaryRowModule.updateSummaryRowScrollPosition()))},setTheme:function(){this.themeModule&&this.themeModule.setTheme()}}),N=(_.extend(Ue.prototype,w.Events,{initialize:function(){this.hideQueryStatus=this.app.api.hideQueryStatus,this.showQueryStatus=this.app.api.showQueryStatus},initializeQueryStatusHandler:function(e){this.stopListening(),e&&(this.updateQueryStatus(e,e.get("queryStatus")),this.listenTo(e,"change:queryStatus",this.updateQueryStatus))},remove:function(){this.stopListening()},updateQueryStatus:function(e,t){t?this.showQueryStatus(t):this.hideQueryStatus()}}),L=window,Slick.Utils.extend(!0,L,{Slick:{DraggableGrouping:function(f){var a,m,v,r,C,l,w,b,y,S,s={ignoreGroupingProperty:!1,repositionDropzone:!0,useFontAwesome:!1,singleGridDragging:!1},i=new Slick.Event,R=new Slick.BindingEventService,d=new Slick.EventHandler,u="shared";f&&f.singleGridDragging&&(u+="_"+Slick.Utils.generateUid());function n(e){e&&e.el&&e.destroy()}var E=[];function c(e,t){for(var i=t.getAttribute("data-id"),o=i&&i.replace(m,""),n=!0,a=0,r=E;a<r.length;a++){var l=r[a];if(l.id===o){n=!1,_.pull(E,l),E.push(l);l=e.querySelector('.slick-dropped-grouping[data-id="'.concat(o,'"]'));e.appendChild(l),M("sort-group");break}}if(n){for(var s=0,d=v;s<d.length;s++){var u,c,h,p,g=d[s];g.id===o&&(f.ignoreGroupingProperty||g.grouping&&!Slick.Utils.isEmptyObject(g.grouping))&&(u=t.querySelector(".slick-column-name"),(c=document.createElement("div")).id="".concat(m,"_").concat(g.id,"_entry"),c.className="slick-dropped-grouping",c.dataset.id="".concat(g.id),(h=document.createElement("div")).className="slick-dropped-grouping-title",h.style.display="inline-flex",h.textContent=(u||t).textContent,c.appendChild(h),f.useFontAwesome?(p=document.createElement("i")).className="btnClose fa fa-close":((p=document.createElement("div")).className="slick-groupby-remove",f.deleteIconCssClass&&p.classList.add(f.deleteIconCssClass.split(" ")),f.deleteIconImage&&p.classList.add(f.deleteIconImage.split(" ")),f.deleteIconCssClass||p.classList.add("slick-groupby-remove-icon"),f.deleteIconImage||p.classList.add("slick-groupby-remove-image")),(p=document.createElement("i")).className="btnClose fa fa-close",f&&!0!==f.hideGroupSortIcons&&g.sortable&&g.grouping&&void 0===g.grouping.sortAsc&&(g.grouping.sortAsc=!0),c.appendChild(p),e.appendChild(c),E.push(g),M("add-group"),function(a,r,l){R.bind(r,"click",function(){for(var e=0,t=R.boundedEvents.filter(function(e){return e.element===r});e<t.length;e++){var i=t[e];R.unbind(i.element,"click",i.listener)}var o=a,n=(l.remove(),[]);v.forEach(function(e){n[e.id]=e}),function(e){var t,i,o=arguments,n=o.length;for(;1<n&&e.length;)for(t=o[--n];-1!=(i=e.indexOf(t));)e.splice(i,1)}(E,n[o]),0===E.length&&(w.style="block",b.style.display="none"),M("remove-group")})}(g.id,p,c))}b.style.display="inline-block"}}function M(e){var t;f.ignoreGroupingProperty||0!==E.length?(t=[],f.ignoreGroupingProperty?E.forEach(function(e){t.push(e)}):(E.forEach(function(e){t.push(e.grouping)}),r.setGrouping(t)),i.notify({caller:e,groupColumns:t})):(r.setGrouping([]),i.notify({caller:e,groupColumns:[]}))}Slick.Utils.extend(this,{init:function(e){f=Slick.Utils.extend(!0,{},s,f),m=(a=e).getUID(),v=a.getColumns(),r=a.getData(),C=e.getPreHeaderPanel(),f.repositionDropzone&&(C=C.parentNode.parentNode.parentNode,(e=document.createElement("div")).className="slick-preheader-panel",e.style.position="relative",e.style.overflow="hidden",t=document.createElement("div"),e.appendChild(t),C.appendChild(e),C=t),C.classList.add("slick-dropzone");var o,e=f.dropPlaceHolderText||"Drop a column header here to group by the column",t=((w=document.createElement("div")).className="slick-placeholder",w.textContent=e,(b=document.createElement("div")).className="slick-group-toggle-all expanded",b.style.display="none",C.appendChild(w),o=C,l=Sortable.create(o,{group:u,ghostClass:"slick-droppable-sortitem-hover",draggable:".slick-dropped-grouping",dragoverBubble:!0,onAdd:function(e){var t=e.item,i=t.getAttribute("id");i&&i.replace(m,"")&&c(o,Sortable.utils.clone(e.item)),e.clone.style.opacity=".5",t.parentNode&&t.parentNode.removeChild(t)},onUpdate:function(){for(var e=l&&l.toArray()||[],t=[],i=0,o=e.length;i<o;i++)for(var n=0,a=E.length;n<a;n++)if(E[n].id==e[i]){t.push(E[n]);break}E=t,M("sort-group")}}),C.querySelector(".slick-placeholder"));t&&(R.bind(t,"dragover",function(e){return e.preventDefault}),R.bind(t,"dragenter",function(){return C.classList.add("slick-dropzone-hover")}),R.bind(t,"dragleave",function(){return C.classList.remove("slick-dropzone-hover")})),b&&R.bind(b,"click",function(e){var e=e.target,t=e,e=e&&e.classList.contains("expanded"),i=void 0;void 0===e&&(e=!0),void 0===i&&(i=!0),t&&(!0===e?(t.classList.add("collapsed"),t.classList.remove("expanded"),i&&r.collapseAllGroups()):(t.classList.remove("collapsed"),t.classList.add("expanded"),i&&r.expandAllGroups()))}),d.subscribe(a.onHeaderCellRendered,function(e,t){var i=t.column,t=t.node;!Slick.Utils.isEmptyObject(i.grouping)&&t&&(t.style.cursor="pointer",f.groupIconCssClass||f.groupIconImage)&&((i=document.createElement("span")).className="slick-column-groupable",f.groupIconCssClass&&i.classList.add(f.groupIconCssClass.split(" ")),f.groupIconImage&&(i.style.background="url("+f.groupIconImage+") no-repeat center center"),t.appendChild(i))});for(var i=0;i<v.length;i++){var n=v[i].field;a.updateColumnHeader(n)}},destroy:function(){n(y),n(S),n(l),i.unsubscribe(),d.unsubscribeAll(),R.unbindAll(),Slick.Utils.emptyElement(document.querySelector(".".concat(m," .slick-preheader-panel")))},pluginName:"DraggableGrouping",onGroupChanged:i,setDroppedGroups:function(e){e=Array.isArray(e)?e:[e],w.style.display="none";for(var t=0,i=e;t<i.length;t++){var o=i[t],o=a.getHeaderColumn(o);c(C,o)}},clearDroppedGroups:function(){E=[],M("clear-all");var e=C.querySelectorAll(".slick-dropped-grouping");b.style.display="none";for(var t=0,i=Array.from(e);t<i.length;t++){var o=i[t],n=C.querySelector(".slick-groupby-remove");n&&n.remove(),o&&o.remove()}w.style.display="inline-block"},getSetupColumnReorder:function(h,p,e,g,f,t,m,i,v){var o={animation:50,ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dataIdAttr:"data-id",group:{name:u,pull:"clone",put:!1},revertClone:!0,onStart:function(){var e=C,t=(e.classList.add("slick-dropzone-hover"),e.classList.add("slick-dropzone-placeholder-hover"),e.classList.add("ui-state-hover"),e.querySelector(".slick-placeholder"));0===e.querySelectorAll(".slick-dropped-grouping").length&&(t.style.display="inline-block"),b.style.display="none"},onEnd:function(e){var t=C,i=t.querySelector(".slick-placeholder"),t=(t.classList.remove("slick-dropzone-hover"),t.classList.remove("ui-state-hover"),i.classList.remove("slick-dropzone-placeholder-hover"),t.querySelectorAll(".slick-dropped-grouping"));if(t.forEach(function(e){return e.style.display="inline-block"}),0<t.length&&w&&(w.style.display="none"),i&&i.parentElement&&i.parentElement.classList.remove("slick-dropzone-placeholder-hover"),t.length&&(i&&(i.style.display="none"),b.style.display="inline-block"),h.getEditorLock().commitCurrentEdit()){var o=y&&y.toArray()||[];if(1<p.length)for(var n=0,a=S&&S.toArray()||[];n<a.length;n++){var r=a[n];o.push(r)}for(var l=[],s=h.getColumns(),d=0,u=o;d<u.length;d++){var c=u[d];l.push(s[m(c)])}g(l),v(h.onColumnsReordered,{grid:h}),e.stopPropagation(),f()}}};return n(y),y=Sortable.create(document.querySelector(".".concat(h.getUID()," .slick-header-columns.slick-header-columns-left")),o),n(S),S=Sortable.create(document.querySelector(".".concat(h.getUID()," .slick-header-columns.slick-header-columns-right")),o),{sortableLeftInstance:y,sortableRightInstance:S}}})}}}),Slick.Data=Slick.Data||{},Slick.Data.GroupItemMetadataProvider=function(e){var n,t=Slick.Utils,l=t.extend(!0,{},{checkboxSelect:!1,checkboxSelectCssClass:"slick-group-select-checkbox",checkboxSelectPlugin:null,groupCssClass:"slick-group",groupTitleCssClass:"slick-group-title",totalsCssClass:"slick-group-totals",groupFocusable:!0,totalsFocusable:!1,toggleCssClass:"slick-group-toggle",toggleExpandedCssClass:"expanded",toggleCollapsedCssClass:"collapsed",enableExpandCollapse:!0,groupFormatter:function(e,t,i,o,n,a){var r;return l.enableExpandCollapse?(r=15*n.level+"px",(l.checkboxSelect?'<span class="'+l.checkboxSelectCssClass+" "+(n.selectChecked?"checked":"unchecked")+'"></span>':"")+"<span class='"+l.toggleCssClass+" "+(n.collapsed?l.toggleCollapsedCssClass:l.toggleExpandedCssClass)+"' style='margin-left:"+r+"'></span><span class='"+l.groupTitleCssClass+"' level='"+n.level+"'>"+n.title+"</span>"):n.title},totalsFormatter:function(e,t,i,o,n,a){return o.groupTotalsFormatter&&o.groupTotalsFormatter(n,o,a)||""},includeHeaderTotals:!1},e);function i(e,t){var i,o=e.target,t=this.getDataItem(t.row);t&&t instanceof Slick.Group&&o.classList.contains(l.toggleCssClass)&&(i=n.getRenderedRange(),this.getData().setRefreshHints({ignoreDiffsBefore:i.top,ignoreDiffsAfter:i.bottom+1}),t.collapsed?this.getData().expandGroup(t.groupingKey):this.getData().collapseGroup(t.groupingKey),e.stopImmediatePropagation(),e.preventDefault()),t&&t instanceof Slick.Group&&o.classList.contains(l.checkboxSelectCssClass)&&(t.selectChecked=!t.selectChecked,o.classList.remove(t.selectChecked?"unchecked":"checked"),o.classList.add(t.selectChecked?"checked":"unchecked"),i=n.getData().mapItemsToRows(t.rows),(t.selectChecked?l.checkboxSelectPlugin.selectRows:l.checkboxSelectPlugin.deSelectRows)(i))}function o(e,t){var i,o;l.enableExpandCollapse&&e.which==Slick.keyCode.SPACE&&(i=this.getActiveCell())&&(i=this.getDataItem(i.row))&&i instanceof Slick.Group&&(o=n.getRenderedRange(),this.getData().setRefreshHints({ignoreDiffsBefore:o.top,ignoreDiffsAfter:o.bottom+1}),i.collapsed?this.getData().expandGroup(i.groupingKey):this.getData().collapseGroup(i.groupingKey),e.stopImmediatePropagation(),e.preventDefault())}return{init:function(e){(n=e).onClick.subscribe(i),n.onKeyDown.subscribe(o)},destroy:function(){n&&(n.onClick.unsubscribe(i),n.onKeyDown.unsubscribe(o))},getGroupRowMetadata:function(e){return e=e&&e.level,{selectable:!1,focusable:l.groupFocusable,cssClasses:l.groupCssClass+" slick-group-level-"+e,formatter:l.includeHeaderTotals&&l.totalsFormatter,columns:{0:{colspan:l.includeHeaderTotals?"1":"*",formatter:l.groupFormatter,editor:null}}}},getTotalsRowMetadata:function(e){return e=e&&e.group&&e.group.level,{selectable:!1,focusable:l.totalsFocusable,cssClasses:l.totalsCssClass+" slick-group-level-"+e,formatter:l.totalsFormatter,editor:null}},getOptions:function(){return l},setOptions:function(e){t.extend(!0,l,e)}}},_.extend(Ke.prototype,w.Events,{groupItemMetadataProvider:null,draggableGrouping:null,groupedColumnConfigs:null,isEnabled:!1,initialize:function(){this.$pnlGrid=this.app.$(".pnlGrid"),this.$frame=this.app.$(".datagridFrame"),this.groupedColumnConfigs=[],this.initGrouping(),this.listenTo(this.app.viewModel,"change:Basics.GroupingAutoCollapse",this.applyGroupingAutoCollapse),this.listenTo(this.app.viewModel,"change:Basics.EnableGrouping",this.onChange_EnableGrouping),this.listenTo(this.app.viewModel,"change:GroupingConfiguration",this.onChange_GroupingConfiguration),this.listenTo(this.app.viewModel,"change:SummaryRow_Groupings",this.onChange_SummaryRow_Groupings)},applyGroupingAutoCollapse:function(){this.app.dataView&&(this.app.viewModel.get("Basics.GroupingAutoCollapse")?this.app.dataView.collapseAllGroups():this.app.dataView.expandAllGroups())},fixColumnReorderingLayoutIssue:function(){var i=this;this.app.grid.onColumnsReordered.subscribe(function(e,t){i.app.resizeConditional(),i.app.layoutModule&&i.app.layoutModule.saveCurrentColumnLayout()})},groupingChanged:function(e){var n,a,r,l,t;this.avoidLoopback_applyingGroupings||(a=[],r=(n=this).app.viewModel.get("SummaryRow_Groupings"),l=[],n.app.dataView&&!n.avoidLoopback&&(e&&(this.avoidLoopback_applyingGroupings=!0,this.loadAndApplyGroupings(),this.avoidLoopback_applyingGroupings=!1),_.each(this.groupedColumnConfigs,function(o,e){var t=o.field,i={};a.push(i.getter=t),i.comparer=function(){return 0},n.app.groupingsOrder&&e<=n.app.groupingsOrder.length&&(_.isFunction(n.app.groupingsOrder[e])?i.comparer=n.app.groupingsOrder[e]:"asc"===n.app.groupingsOrder[e]?i.comparer=function(e,t){return e.value-t.value}:i.comparer=function(e,t){return t.value-e.value}),i.formatter=function(e){var t=void 0,i=e.value;return _.isArray(e.rows)&&(t=e.rows[0]),o.formatter&&(i=o.formatter(void 0,void 0,i,void 0,t,void 0,!0)),t=O.getSummaryRowHtml(e,r,n.app.columnsConfig,n.app),i+' <span class="lblGropRowCount">('+e.count+" items)</span>"+t},l.push(i)}),n.app.RAW_MODE&&(n.app.rawModeModule.populateFields(a,"group"),t=[],a.length&&(_.each(r,function(e){t.push(e.Column),t.push(e.Column2)}),t=_.uniq(_.compact(t))),n.app.rawModeModule.populateFields(t,"groupSummary")),n.app.dataView.setGrouping(l),n.applyGroupingAutoCollapse(),n.defaultGroupingLoaded)&&!_.some(n.app.api.getProperty("GroupingConfiguration"),{ColumnProperty:""})&&(e=_.map(l,function(e){return{ColumnProperty:e.getter}}),n.avoidLoopback=!0,n.app.api.saveSetting("GroupingConfiguration",e),n.app.api.setProperty("GroupingConfiguration",e),n.avoidLoopback=!1))},initGrouping:function(){this.groupedColumnConfigs=[]},loadAndApplyGroupings:function(){var e=this.app.api.loadSetting("GroupingConfiguration")||this.app.viewModel.get("GroupingConfiguration");this.setDroppedGroups(e),this.defaultGroupingLoaded=!0},modifyConfigs:function(e,t){this.isEnabled?(this.draggableGrouping=new Slick.DraggableGrouping({dropPlaceHolderText:"Drag a column header and drop it here for grouping",ignoreGroupingProperty:!0,useFontAwesome:!0,singleGridDragging:!0}),this.draggableGrouping.onGroupChanged.subscribe(this.onGroupChanged_draggableGrouping.bind(this)),_.extend(e,{createPreHeaderPanel:!0,showPreHeaderPanel:!0,preHeaderPanelHeight:36},{enableColumnReorder:this.draggableGrouping.getSetupColumnReorder})):this.draggableGrouping=null,this.groupItemMetadataProvider=new Slick.Data.GroupItemMetadataProvider,_.extend(t,{groupItemMetadataProvider:this.groupItemMetadataProvider})},registerPlugins:function(){this.isEnabled&&this.app.grid.registerPlugin(this.draggableGrouping),this.app.grid.registerPlugin(this.groupItemMetadataProvider)},onGroupChanged_draggableGrouping:function(e){var e=e.getArguments(),t=e.caller,e=e.groupColumns;"add-group"===t||"remove-group"===t||"sort-group"===t?(this.groupedColumnConfigs=e,this.groupingChanged()):"clear-all"===t&&(this.groupedColumnConfigs=[],this.groupingChanged())},onChange_EnableGrouping:function(e,t){var i=this;this.isEnabled=t,this.app.dataView&&(this.isEnabled?this.app.renderDatagrid():_.defer(function(){i.app.api.setProperty("GroupingConfiguration",[]),i.app.renderDatagrid()}))},onChange_GroupingConfiguration:function(){var e;this.app.skipGridGeneration||this.avoidLoopback||(e=this.app.viewModel.get("GroupingConfiguration"),this.avoidLoopback_applyingGroupings=!0,this.resetGrouping(),e&&e.length&&this.setDroppedGroups(e),this.avoidLoopback_applyingGroupings=!1,this.groupingChanged())},setDroppedGroups:function(e){var t,i,o,n=this;e&&e.length&&(e=e.map(function(e){return e.ColumnProperty}),t=[],_.each(e,function(e){e=_.find(n.app.columnsConfig,{field:e});e&&t.push(e.id)}),this.isEnabled?this.draggableGrouping.setDroppedGroups(t):(i=this.app.grid.getColumns(),o=[],_.each(t,function(e){e=n.app.grid.getColumnIndex(e);void 0!==e&&o.push(i[e])}),this.onGroupChanged_draggableGrouping({getArguments:function(){return{caller:"add-group",groupColumns:o}}})))},onChange_SummaryRow_Groupings:function(){_.each(_.compact(this.app.viewModel.get("SummaryRow_Groupings")),function(e,t){t="SummaryRow_Groupings.".concat(t,".Column2");"WAVG"===e.Function?void 0===e.Column2&&(this.app.viewModel.set(t,"",{silent:!0}),this.app.api.setProperty(t,"")):void 0!==e.Column2&&(this.app.viewModel.set(t,void 0,{silent:!0}),this.app.api.setProperty(t,void 0))}.bind(this)),this.app.generateDataGridFromReceivedData()},remove:function(){this.stopListening()},resetGrouping:function(){this.draggableGrouping&&this.draggableGrouping.clearDroppedGroups()},saveGroupingState:function(){var i=this;i.dataRefresh?i.setSavedGroupingState():(i.collapsedGroups=[],i.expandedGroups=[],_.each(i.$pnlGrid.find(".slick-group-toggle"),function(e,t){($(e).hasClass("collapsed")?i.collapsedGroups:i.expandedGroups).push({groupTitle:$(e).siblings(".slick-group-title")[0].childNodes[0].textContent,groupIndex:t})}))},setDataRefresh:function(e){this.dataRefresh=e},setSavedGroupingState:function(){var i=this.$pnlGrid.find(".slick-group-toggle");this.app.viewModel.get("Basics.GroupingAutoCollapse")?_.each(this.expandedGroups,function(t){var e=_.filter(i,function(e){return $(e).siblings(".slick-group-title")[0].childNodes[0].textContent===t.groupTitle});e[0]&&$(e[0]).hasClass("collapsed")&&$(e[0]).mousedown()}):_.each(this.collapsedGroups,function(t){var e=_.filter(i,function(e){return $(e).siblings(".slick-group-title")[0].childNodes[0].textContent===t.groupTitle});e[0]&&$(e[0]).hasClass("expanded")&&$(e[0]).mousedown()})}}),e=window,Slick.Utils.extend(!0,e,{Slick:{Controls:{Pager:function(d,u,c,h){var p,g,o=S(c),f={showAllText:"Showing all {rowCount} rows",showPageText:"Showing page {pageNum} of {pageCount}",showCountText:"From {countBegin} to {countEnd} of {rowCount} rows",showCount:!1,pagingOptions:[{data:0,name:"All",ariaLabel:"Show All Pages"},{data:-1,name:"Auto",ariaLabel:"Auto Page Size"},{data:25,name:"25",ariaLabel:"Show 25 rows per page"},{data:50,name:"50",ariaLabel:"Show 50 rows per page"},{data:100,name:"100",ariaLabel:"Show 100 rows per page"}],showPageSizes:!1},m=new Slick.BindingEventService;function e(){g=Slick.Utils.extend(!0,{},f,h),d.onPagingInfoChanged.subscribe(function(e,t){_(t)});var e=S(c);if(e&&(!e.jquery||e[0])){var o=document.createElement("span"),t=(o.className="slick-pager-nav",document.createElement("span")),i=(t.className="slick-pager-settings",(p=document.createElement("span")).className="slick-pager-status",document.createElement("span"));i.className="slick-pager-settings-expanded",i.textContent="Show: ";for(var n=0;n<g.pagingOptions.length;n++){var a=g.pagingOptions[n],r=document.createElement("a");r.textContent=a.name,r.ariaLabel=a.ariaLabel,r.dataset.val=a.data,i.appendChild(r),m.bind(r,"click",function(e){var t,e=e.target.dataset.val;void 0!==e&&(-1===Number(e)?v((t=u.getViewport()).bottom-t.top):v(parseInt(e)))})}i.style.display=g.showPageSizes?"block":"none",t.appendChild(i);var l=document.createElement("span"),s=document.createElement("span");l.className="ui-state-default ui-corner-all ui-icon-container",s.ariaLabel="Show Pagination Options",s.role="button",s.className="ui-icon ui-icon-lightbulb slick-icon-lightbulb",l.appendChild(s),m.bind(s,"click",function(){var e=i.style.display;i.style.display="none"===e?"inline":"none"}),t.appendChild(l);[{key:"first",ariaLabel:"First Page",callback:C},{key:"prev",ariaLabel:"Previous Page",callback:b},{key:"next",ariaLabel:"Next Page",callback:y},{key:"end",ariaLabel:"Last Page",callback:w}].forEach(function(e){var t=document.createElement("span"),i=(t.className="ui-state-default ui-corner-all ui-icon-container",document.createElement("span"));i.role="button",i.ariaLabel=e.ariaLabel,i.className="ui-icon ui-icon-seek-".concat(e.key," slick-icon-seek-").concat(e.key),m.bind(i,"click",e.callback),t.appendChild(i),o.appendChild(t)});s=document.createElement("div");s.className="slick-pager",s.appendChild(o),s.appendChild(t),s.appendChild(p),e.appendChild(s)}_(d.getPagingInfo())}function n(){var e=!Slick.GlobalEditorLock.commitCurrentEdit(),t=d.getPagingInfo(),i=t.totalPages-1;return{canGotoFirst:!e&&0!==t.pageSize&&0<t.pageNum,canGotoLast:!e&&0!==t.pageSize&&t.pageNum!==i,canGotoPrev:!e&&0!==t.pageSize&&0<t.pageNum,canGotoNext:!e&&0!==t.pageSize&&t.pageNum<i,pagingInfo:t}}function v(e){d.setRefreshHints({isFilterUnchanged:!0}),d.setPagingOptions({pageSize:e})}function C(){n().canGotoFirst&&d.setPagingOptions({pageNum:0})}function w(){var e=n();e.canGotoLast&&d.setPagingOptions({pageNum:e.pagingInfo.totalPages-1})}function b(){var e=n();e.canGotoPrev&&d.setPagingOptions({pageNum:e.pagingInfo.pageNum-1})}function y(){var e=n();e.canGotoNext&&d.setPagingOptions({pageNum:e.pagingInfo.pageNum+1})}function S(e){return"string"==typeof e?document.querySelector(e):"object"==typeof e&&e[0]?e[0]:e}function _(e){var t,i;!o||o.jquery&&!o[0]||(t=n(),o.querySelectorAll(".slick-pager-nav span").forEach(function(e){return e.classList.remove("ui-state-disabled","slick-icon-state-disabled")}),t.canGotoFirst||(o.querySelector(".ui-icon-seek-first").classList.add("ui-state-disabled"),o.querySelector(".slick-icon-seek-first").classList.add("slick-icon-state-disabled")),t.canGotoLast||(o.querySelector(".ui-icon-seek-end").classList.add("ui-state-disabled"),o.querySelector(".slick-icon-seek-end").classList.add("slick-icon-state-disabled")),t.canGotoNext||(o.querySelector(".ui-icon-seek-next").classList.add("ui-state-disabled"),o.querySelector(".slick-icon-seek-next").classList.add("slick-icon-state-disabled")),t.canGotoPrev||(o.querySelector(".ui-icon-seek-prev").classList.add("ui-state-disabled"),o.querySelector(".slick-icon-seek-prev").classList.add("slick-icon-state-disabled")),0===e.pageSize?p.textContent=g.showAllText.replace("{rowCount}",e.totalRows+"").replace("{pageCount}",e.totalPages+""):p.textContent=g.showPageText.replace("{pageNum}",e.pageNum+1+"").replace("{pageCount}",e.totalPages+""),g.showCount&&0!==e.pageSize&&(t=e.pageNum*e.pageSize,(i=p.textContent)&&(i+=" - "),p.textContent=i+g.showCountText.replace("{rowCount}",e.totalRows+"").replace("{countBegin}",1+t).replace("{countEnd}",Math.min(t+e.pageSize,e.totalRows))))}e(),Slick.Utils.extend(this,{init:e,destroy:function(){v(0),m.unbindAll(),o.innerHTML=""}})}}}}),it=function(e){this.app=e,this.$moduleEl=this.app.$(".pnlPager")},_.extend(it.prototype,{afterInitialize:function(e){this.restoreCurrentState(),_.isFunction(e)&&e()},initPager:function(e,t){this.removePager(),this.app.viewModel.isLazyDataLoadingOn()||(this.$pager=$("<div />").addClass("pager").appendTo(this.$moduleEl),e?(this.pager=new H({api:this.app.api,el:this.$pager[0],skipDataSourceSubscription:!0}),_.extend(this,this.pager),this.listenTo(this.app.viewModel,"change:Basics.Data",this.onChange_Data),this.onChange_Data(),this.pendingOnData&&(this.onData.apply(this,this.pendingOnData),delete this.pendingOnData),this.listenTo(this.pager,"paged",function(){this.trigger("paged")})):(this.pager=new Slick.Controls.Pager(this.app.dataView,this.app.grid,this.$pager),_.extend(it.prototype,w.Events))),this.afterInitialize(t)},onChange_Data:function(){this.onSettingsChange({"Basics.Data":this.app.viewModel.get("Basics.Data")})},onData:function(){this.pendingOnData=arguments},onSettingsChange:$.noop,remove:function(){this.removePager(),this.stopListening()},removePager:function(){this.pager&&_.isFunction(this.pager.remove)&&this.pager.remove(),this.$pager&&this.$pager.remove(),this.pager=null},restoreCurrentState:function(){this.pagerState=this.app.api.getProperty("Basics.ShowPageState"),this.pagerState&&this.$pager?this.$pager.find(".slick-pager-settings-expanded").show():this.$pager.find(".slick-pager-settings-expanded").hide()},setSortConfig:$.noop,listenTo:$.noop,listenToOnce:$.noop,off:$.noop,on:$.noop,once:$.noop,stopListening:$.noop,trigger:$.noop}),_.extend(je.prototype,w.Events,{initialize:function(){this._debouncedDepopulateFields=_.debounce(this.depopulateFields,this.depopulateDelay,{trailing:!0})},cacheScrollValues:function(e,t,i){this.lastdisplayedDataTop=e,this.lastdisplayedDataIdTop=t,this.scrollLeft=i},createRowFromColumns:function(i,e,o){return _.each(e,function(e,t){i[t]=e.toLegacy(o)}),i},depopulateFields:function(){var i=this,o=i.app.dataView.getItems();_.each(i.getFieldsToDepopulate(i.app.populatedFields),function(e,t){delete i.app.populatedFields[t],_.each(o,function(e){delete e[t]})})},getAllFilteredItems:function(){for(var e=[],t=this.app.dataView.getItems(),i=this.app.SLICKGRID_ROW_UNIQUE_ID,o=0;o<this.app.pks.length;o++){var n=this.app.pkOffsetMap[t[o][i]],n=this.createRowFromColumns({},this.app.dataColsMap,n);n[this.app.primaryKey]||(n[this.app.primaryKey]=o),e.push(n)}return this.app.dataView.filterRows(e)},getFieldsToDepopulate:function(e){return _.pickBy(e,function(t){return _.every(_.keys(t),function(e){return!t[e]})})},getRowData:function(i,t){for(var o=this.app.columnInfo.get(this.app.SLICKGRID_ROW_UNIQUE_ID)?i.cols[this.app.SLICKGRID_ROW_UNIQUE_ID]:{length:this.app.columnInfo.at(0)?i.cols[this.app.columnInfo.at(0).id].length:0,toLegacy:_.identity},e=o.length,n=[],a=(i.reset=[],{}),r=_.isFinite(t)?function(e){return t+Number(o.toLegacy(e))}:function(e){return o.toLegacy(e)},l=0;l<e;l++){var s={},d=r(l);n.push(d),s[this.app.SLICKGRID_ROW_UNIQUE_ID]=d,i.reset.push(s),a[d]=l}return{pks:n,pkOffsetMap:a,dataColsMap:dataColsMap=_.reduce(this.app.columnInfo.map("id"),function(e,t){return e[t]=i.cols[t],e},{})}},modifyDataViewConfig:function(e){_.extend(e,{populateItem:_.bind(this.populateItem,this)})},populateFields:function(o,i,e){var n=this,a={},r=(this.app.populatedFields=this.app.populatedFields||{},o=_.without(_.uniq(_.compact(o)),n.app.SLICKGRID_ROW_UNIQUE_ID),_.reduce(o,function(e,t){return e[t]=!0,e},{}));_.each(this.app.populatedFields,function(e,t){r[t]?(o=_.without(o,t),this.app.populatedFields[t][i]=!0):this.app.populatedFields[t][i]&&(this.app.populatedFields[t][i]=!1,a[t]=this.app.populatedFields[t])}.bind(this)),o=_.filter(o,function(e){return n.app.dataColsMap[e]}),_.each(o,function(e,t){n.app.populatedFields[e]=n.app.populatedFields[e]||{},n.app.populatedFields[e][i]=!0}),o.length&&(e=e?_.map(n.app.dataView.mapRowsToIds(e),function(e){return n.app.dataView.getItemById(e)}):n.app.dataView.getItems(),_.each(e,function(t){var i=n.app.pkOffsetMap[t[n.app.SLICKGRID_ROW_UNIQUE_ID]];_.each(o,function(e){t[e]=n.app.dataColsMap[e].toLegacy(i)})})),_.isEmpty(this.getFieldsToDepopulate(a))||this._debouncedDepopulateFields()},populateFilterFields:function(e){var i,o;this.app.grid&&(this.app.filteringModule.showAdvancedColumnFilters||this.app.filteringModule.showColumnFilters?(i=[],o=this,_.each(this.app.filteringModule.columnFilters,function(e,t){e&&(e=o.app.grid.getColumnIndex(t),t=o.app.grid.getColumns()[e])&&i.push(t.field)}),_.isArray(e)&&(i=_.union(i,e)),this.populateFields(i,"filter")):this.app.filteringModule.showQuickSearch&&!_.isEmpty(this.app.filteringModule.lastSearchValue)&&this.populateFields(_.keys(this.app.dataColsMap),"search"))},populateItem:function(e){var t;if(e)return t=this.app.pkOffsetMap[e[this.app.SLICKGRID_ROW_UNIQUE_ID]],this.createRowFromColumns(_.extend({},_.pick(e,this.app.SLICKGRID_ROW_UNIQUE_ID)),this.app.dataColsMap,t)},remove:function(){this.reset()},removePopulateItemFn:function(){this.replacePopulateItemFn(_.identity)},replacePopulateItemFn:function(e){this.app.dataView&&(this.app.dataView.getOptions().populateItem=e)},reset:function(){this._debouncedDepopulateFields.flush(),this._debouncedDepopulateFields.cancel(),this.app.populatedFields=null},resetVerticalScrollValues:function(){this.lastdisplayedDataTop&&(this.app.scrollingModule.lastdisplayedDataTop=this.lastdisplayedDataTop),this.lastdisplayedDataIdTop&&(this.app.scrollingModule.lastdisplayedDataIdTop=this.lastdisplayedDataIdTop)},restorePopulateItemFn:function(){this.replacePopulateItemFn(_.bind(this.populateItem,this))},switchDataviewGetters:function(){var e=this.app.dataView;e&&e instanceof Slick.Data.DataView&&(e.getItemById_orig=e.getItemById_orig||e.getItemById,this.app.RAW_MODE?e.getItemById=function(e){e=this.dataView.getItemById_orig(e);return this.rawModeModule.populateItem.call(this.rawModeModule,e)}.bind(this.app):e.getItemById=e.getItemById_orig)}}),_.extend(qe.prototype,w.Events,{hasNaturalOrder:!0,initialize:function(){this.listenTo(this.app.viewModel,"change:Basics.SortColumn change:Basics.SortOrder change:ColumnsConfiguration",_.after(3,this.onSortingConfigChanged))},generateSortFunctions:function(d){var u=this.app.columnInfo,c=this.app.sortFunctions,h=this.app.sortColumnsForCaseInsensitiveSort||[],p=this;return _.map(d,function(e,t){var n,i,o,a=d.length,r=e.sortAsc?1:-1,l=e.sortCol.field,e=t===a-1,s=_.includes(h,l)?function(e){return(e[l]||"").toLowerCase()}:function(e){return e[l]},t=c&&_.isFunction(c[t])?_.wrap(c[t],function(e,t,i){return e(s(t),s(i),r)}):(a=u.get(l))?(i=b.getComparator(a.get("kdbType"),s),function(e,t){return i(s(e),t)*r}):function(){return 0};return e&&(o=p.app.SLICKGRID_ROW_UNIQUE_ID,n=function(e){return e[o]},t=_.wrap(t,function(e,t,i){var o,e=e(t,i);return e=0===e&&(o=p.app.dataView,t=n(t),i=n(i),null!=t)&&null!=i?o.getIdxById(t)>o.getIdxById(i)?1:-1:e})),t})},initDefaultSortings:function(){var o=this,e=this.app.sortColumns;e&&(this.app.sortColumns=null,this.sortingSpec=_.compact(_.map(e,function(t){var e=null,i=_.find(o.app.columnsConfig,function(e){return e.field===t.sortCol});return e=i&&_.find(o.app.viewModel.get("ColumnsConfiguration"),{Field:t.sortCol})?{columnId:i.id,sortAsc:t.sortAsc}:e})))},isInNaturalOrder:function(){return this.hasNaturalOrder},isSortingSpecEmpty:function(){return!(this.sortingSpec&&this.sortingSpec.length)},modifyViewStates:function(e){var t=this.app.api.getPropertyMeta("Basics.SortColumn"),i=this.app.api.getPropertyMeta("Basics.SortOrder"),o="";t&&"viewstate"===t.type&&i&&"viewstate"===i.type&&(e&&e[0]&&(o=e[0].sortCol.field,t=e[0].sortAsc?"ascending":"descending",this.app.viewModel.set("Basics.SortOrder",t,{silent:!0}),this.app.api.setProperty("Basics.SortOrder",t)),this.app.viewModel.set("Basics.SortColumn",o,{silent:!0}),this.app.api.setProperty("Basics.SortColumn",o))},onSortingConfigChanged:function(){this.app.sortColumns||(this.app.viewModel.get("Basics.SortColumn")?(this.app.sortColumns=[{sortCol:this.app.viewModel.get("Basics.SortColumn"),sortAsc:"ascending"===this.app.viewModel.get("Basics.SortOrder").toLocaleLowerCase()}],this.app.grid&&(this.initDefaultSortings(),this.triggerSorting())):this.app.grid&&(this.sortingSpec=[{columnId:"nonexistentColumn123"}],this.triggerSorting()))},onData:function(){this.pendingSortConfig&&(this.sortSlickgrid(this.pendingSortConfig),this.pendingSortConfig=null)},remove:function(){this.stopListening(),this.dataChangeSet=null},resetSortingSpec:function(){this.sortingSpec=null},setDataChangeSet:function(e){this.dataChangeSet=e,this.positionMap=null},sortSlickgrid:function(a,e){var r,o=this;a&&0===(a=_.filter(a,"sortCol")).length&&o.dataChangeSet?(o.positionMap=o.positionMap||_.reduce(o.dataChangeSet.items(),function(e,t,i){return e[t[o.app.SLICKGRID_ROW_UNIQUE_ID]]=i,e},{}),_.isEmpty(o.positionMap)||(o.app.dataView.sort(function(e,t){return o.positionMap[e[o.app.SLICKGRID_ROW_UNIQUE_ID]]-o.positionMap[t[o.app.SLICKGRID_ROW_UNIQUE_ID]]}),o.hasNaturalOrder=!0)):(r=this.generateSortFunctions(a),o.hasNaturalOrder=!1,o.app.dataView.sort(function(e,t){for(var i,o=0,n=a.length;o<n;o++)if(0!==(i=r[o](e,t)))return i;return 0},void 0,e))},storeSortColumns:function(){var i,o=this.app.grid;o&&(i=o.getColumns(),this.app.sortColumns=_.compact(_.map(o.getSortColumns(),function(e){var t=o.getColumnIndex(e.columnId);return void 0===t?null:{sortCol:i[t].field,sortAsc:e.sortAsc}})))},storeSortingSpec:function(){this.app.grid&&this.app.api.getPropertyMeta&&(this.sortingSpec=this.app.grid.getSortColumns())},subscribeToSortEvent:function(e,t){var n=this;n.app.grid.onSort.subscribe(function(e,t){var i,o=t.multiColumnSort?t.sortCols:[{sortAsc:t.sortAsc,sortCol:t.sortCol}];n.app.pagerModule&&_.isFunction(n.app.pagerModule.setSortConfig)&&n.app.model&&n.app.model.get("_serverPaging")?(i={},_.each(t.sortCols,function(e){i[e.sortCol.field]=e.sortAsc}),n.app.viewModel.isLazyDataLoadingOn()?n.app.api.page(n.app.model,{_pageSort:i}):(n.pendingSortConfig=o,n.app.pagerModule.setSortConfig(i),n.app.highlightingModule.processMinMaxHighlighting())):n.app.filteringModule.isProcessedServerSide&&!n.forceResort?n.sortSlickgrid(o,!0):(n.app.RAW_MODE&&n.app.rawModeModule.populateFields(_.map(o,function(e){return e.sortCol.field}),"sort"),n.sortSlickgrid(o),n.app.highlightingModule.processMinMaxHighlighting()),n.app.api.getPropertyMeta&&n.modifyViewStates(o)})},triggerSorting:function(){var i=this,o=!1;i.sortingSpec&&i.sortingSpec.length&&(i.app.grid.setSortColumns(i.sortingSpec),i.sortingSpec=_.map(i.sortingSpec,function(t){var e=_.find(i.app.columnsConfig,function(e){return e.id===t.columnId});return void 0===e?o=!0:t.sortCol={field:e.field},t}),o&&(i.sortingSpec=[]),i.app.grid.onSort.notify({multiColumnSort:!0,sortCols:i.sortingSpec},null,i.grid),i.sortingSpec=null)}}),_.extend(Ye.prototype,w.Events,{initialize:function(){this.listenTo(this.app.viewModel,"change:Basics.ScrollValueV",this.onScrollValueChanged),this.listenTo(this.app,"model-unset",this.onModelUnset),this.listenToOnce(this.app,"data-processed",this.onDataProcessed)},handleScrollInfo:function(e){var t,i,o=0,n=this;n.lastRowDisplayed=!1,0===e.scrollTop?(n.lastdisplayedDataTop=void 0,n.lastdisplayedDataIdTop=void 0):(i=n.app.grid.getViewport(),t=n.app.grid.getData(),n.lastdisplayedDataTop=void 0,_.find(_.range(i.top,i.bottom+1),function(e){e=t.getItem(e);if(!(e instanceof Slick.NonDataRow))return n.lastdisplayedDataTop=e,!0}),n.lastdisplayedDataTop&&(n.lastdisplayedDataIdTop=n.lastdisplayedDataTop[n.app.SLICKGRID_ROW_UNIQUE_ID]),i.bottom>t.getLength()&&(n.lastRowDisplayed=!0),o=i.top),this.isViewState_ScrollValueV()&&(this.manualSet=!0,this.app.api.setProperty("Basics.ScrollValueV",o),this.manualSet=!1),n.app.RAW_MODE&&n.app.rawModeModule.cacheScrollValues(n.lastdisplayedDataTop,n.lastdisplayedDataIdTop,e.scrollLeft),n.app.grid.updateRowCount()},isViewState_ScrollValueV:function(){var e,t=!1;return t=this.app.api.getPropertyMeta?!(!(e=this.app.api.getPropertyMeta("Basics.ScrollValueV"))||"viewstate"!==e.type):t},onDataProcessed:function(e){e?this.listenToOnce(this.app,"data-processed",this.onDataProcessed):void 0!==this.pendingScrollValueV&&(this.pendingScrollValueV=void 0,this.onScrollValueChanged())},onModelUnset:function(){this.pendingScrollValueV=void 0},onScrollValueChanged:function(){var e;this.isViewState_ScrollValueV()&&!this.app.api.getProperty("Selection.FollowSelectedValue")&&(this.app.grid?this.manualSet||void 0!==(e=this.parseInt_ScrollValueV())&&this.scrollTo(e):void 0!==(e=this.parseInt_ScrollValueV())&&(this.pendingScrollValueV=e))},parseInt_ScrollValueV:function(){var e=parseInt(this.app.api.getProperty("Basics.ScrollValueV"),10);return e=_.isNaN(e)?void 0:e},remove:function(){this.stopListening()},scrollTo:function(e,t){t&&(t=this.app.grid.getViewport(),e=Math.max(0,e-Math.floor((t.bottom-t.top)/2))),this.app.grid.scrollRowToTop(e)},subscribeToScrollEvent:function(){var i=this;i.app.grid.onScroll.subscribe(function(e,t){i.app.sparklinesManager.refresh(),i.app.highlightingModule.processMinMaxHighlighting_debouncedMore(),i.handleScrollInfo(t),i.app.onScrollHorizontalAdjust()})},updateScrollPosition:function(){var i,o=this;this.app.model.get("_forceReset")&&(o.lastRowDisplayed?o.app.grid.scrollRowIntoView(999999999999,!1):o.lastdisplayedDataTop&&o.app.sortingModule.isSortingSpecEmpty()&&_.find(o.app.grid.getData().getItems(),function(e,t){return i=t,e[o.app.SLICKGRID_ROW_UNIQUE_ID]===o.lastdisplayedDataIdTop})&&o.app.grid.scrollRowToTop(i))}}),L=window,Slick.Utils.extend(!0,L,{Slick:{CellRangeDecorator:function(i,o){var n;function e(){n&&(n.remove(),n=null)}o=Slick.Utils.extend(!0,{},{selectionCssClass:"slick-range-decorator",selectionCss:{zIndex:"9999",border:"2px dashed red"},offset:{top:0,left:0,height:1,width:0}},o),Slick.Utils.extend(this,{pluginName:"CellRangeDecorator",show:function(e){!n&&((n=document.createElement("div")).className=o.selectionCssClass,Object.keys(o.selectionCss).forEach(function(e){n.style[e]=o.selectionCss[e]}),n.style.position="absolute",t=i.getActiveCanvasNode())&&t.appendChild(n);var t=i.getCellNodeBox(e.fromRow,e.fromCell),e=i.getCellNodeBox(e.toRow,e.toCell);return t&&e&&o&&o.offset&&(n.style.top="".concat(t.top+o.offset.top,"px"),n.style.left="".concat(t.left+o.offset.left,"px"),n.style.height="".concat(e.bottom-t.top+o.offset.height,"px"),n.style.width="".concat(e.right-t.left+o.offset.width,"px")),n},hide:e,destroy:function(){e()}})}}}),e=window,Slick.Utils.extend(!0,e,{Slick:{CellSelectionModel:function(t){var s,i,o,d=[],n=this;i=void 0===t||void 0===t.cellRangeSelector?new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}}):t.cellRangeSelector;var a={selectActiveCell:!0,singleCellMode:!1};function u(e){for(var t=[],i=0;i<e.length;i++){var o=e[i];s.canCellBeSelected(o.fromRow,o.fromCell)&&s.canCellBeSelected(o.toRow,o.toCell)&&t.push(o)}return t}function c(e,t){var i;(d&&0!==d.length||e&&0!==e.length)&&(i=!function(e,t){var i=e.length!==t.length;if(!i)for(var o=0;o<e.length;o++)if(e[o].fromCell!==t[o].fromCell||e[o].fromRow!==t[o].fromRow||e[o].toCell!==t[o].toCell||e[o].toRow!==t[o].toRow){i=!0;break}return!i}(d,e),d=u(e),i)&&(e=new Slick.EventData(null,d),Object.defineProperty(e,"detail",{writable:!0,configurable:!0,value:{caller:t||"SlickCellSelectionModel.setSelectedRanges"}}),n.onSelectedRangesChanged.notify(d,e))}function e(){return d}function r(e,t){e=s.getCellFromEvent(e);e&&s.canCellBeSelected(e.row,e.cell)?(d=[new Slick.Range(e.row,e.cell,e.row,e.cell)],n.onSelectedRangesChanged.notify(d)):d=[]}function l(e){if(s.getEditorLock().isActive())return e.stopPropagation(),!1}function h(e,t){s.setActiveCell(t.range.fromRow,t.range.fromCell,!1,!1,!0);var i=[t.range];c(i=t.desc?_.map(_.range(t.range.toRow,t.range.fromRow-1),function(e){return new Slick.Range(e,t.range.fromCell,e,t.range.toCell)}):i)}function p(e,t){o.selectActiveCell&&null!=t.row&&null!=t.cell?c([new Slick.Range(t.row,t.cell)]):o.selectActiveCell||c([])}function g(e){var t,i,o,n,a,r=s.getActiveCell(),l=e.ctrlKey||e.metaKey;r&&e.shiftKey&&!l&&!e.altKey&&33<=e.which&&e.which<=40&&((l=d.slice()).length||l.push(new Slick.Range(r.row,r.cell)),n=(t=(t=l.pop()).contains(r.row,r.cell)?t:new Slick.Range(r.row,r.cell)).toRow-t.fromRow,a=t.toCell-t.fromCell,i=r.row==t.fromRow?1:-1,o=r.cell==t.fromCell?1:-1,37==e.which?a-=o:39==e.which?a+=o:38==e.which?n-=i:40==e.which?n+=i:35==e.which?n+=1e10*i:36==e.which?n-=1e10*i:34==e.which?n+=i*s.getNumVisibleRows():33==e.which&&(n-=i*s.getNumVisibleRows()),(n=new Slick.Range(r.row,r.cell,r.row+i*n,r.cell+o*a)).toRow>=s.getDataLength()?n.toRow=s.getDataLength()-1:n.fromRow<0&&(n.fromRow=0),u([n]).length?(l.push(n),r=0<i?n.toRow:n.fromRow,a=0<o?n.toCell:n.fromCell,s.scrollRowIntoView(r),s.scrollCellIntoView(r,a)):l.push(t),c(l),e.preventDefault(),e.stopPropagation())}Slick.Utils.extend(this,{getSelectedRanges:e,setSelectedRanges:c,refreshSelections:function(){c(d)},init:function(e){o=Slick.Utils.extend(!0,{},a,t),(s=e).onActiveCellChanged.subscribe(p),o.singleCellMode?s.onClick.subscribe(r):(s.onKeyDown.subscribe(g),e.registerPlugin(i),i.onCellRangeSelected.subscribe(h),i.onBeforeCellRangeSelected.subscribe(l))},destroy:function(){s.onActiveCellChanged.unsubscribe(p),o.singleCellMode?s.onClick.unsubscribe(r):(s.onKeyDown.unsubscribe(g),i.onCellRangeSelected.unsubscribe(h),i.onBeforeCellRangeSelected.unsubscribe(l),s.unregisterPlugin(i)),i&&i.destroy&&i.destroy()},pluginName:"CellSelectionModel",onSelectedRangesChanged:new Slick.Event})}}}),L=window,Slick.Utils.extend(!0,L,{Slick:{RowSelectionModel:function(t){var s,i,o,n,a,d=[],r=this,l=new Slick.EventHandler,u={selectActiveRow:!1,dragToSelect:!1,autoScrollWhenDrag:!0,cellRangeSelector:void 0,useEvent_onCellRangeSelecting:!0};function c(e){return function(){i||(i=!0,e.apply(this,arguments),i=!1)}}function h(e){for(var t=[],i=0;i<e.length;i++)for(var o=e[i].fromRow;o<=e[i].toRow;o++)t.push(o);return t}function p(e){for(var t=[],i=s.getColumns().length-1,o=0;o<e.length;o++)t.push(new Slick.Range(e[o],0,e[o],i));return t}function g(){return h(d)}function e(e){f(p(e),"SlickRowSelectionModel.setSelectedRows")}function f(e,t,i){(d&&0!==d.length||e&&0!==e.length)&&(d=e,e=new Slick.EventData(i||null,d),Object.defineProperty(e,"detail",{writable:!0,configurable:!0,value:{caller:t||"SlickRowSelectionModel.setSelectedRanges"}}),r.onSelectedRangesChanged.notify(d,e))}function m(e,t){o.selectActiveRow&&null!=t.row&&t.grid.canCellBeSelected(t.row,t.cell)&&f([new Slick.Range(t.row,0,t.row,s.getColumns().length-1)])}function v(e){var t,i,o=s.getActiveCell();!s.getOptions().multiSelect&&e.shiftKey||!o||!e.shiftKey||e.ctrlKey||e.altKey||e.metaKey||e.which!=Slick.keyCode.UP&&e.which!=Slick.keyCode.DOWN||((i=g()).sort(function(e,t){return e-t}),t=(i=i.length?i:[o.row])[0],i=i[i.length-1],0<=(o=e.which==Slick.keyCode.DOWN?o.row<i||t==i?++i:++t:o.row<i?--i:--t)&&o<s.getDataLength()&&(s.scrollRowIntoView(o),f(p(function(e,t){for(var i=[],o=e;o<=t;o++)i.push(o);for(o=t;o<e;o++)i.push(o);return i}(t,i)))),e.preventDefault(),e.stopPropagation())}function C(e){var t=s.getCellFromEvent(e),i=s.getOptions().multiSelect;if(!t||!s.canCellBeActive(t.row,t.cell))return!1;if(!e.ctrlKey&&!e.shiftKey&&!e.metaKey)return!1;var o=(n=h(d)).indexOf(t.row);if(-1===o&&(e.ctrlKey||e.metaKey))(n=i?n:[]).push(t.row),s.setActiveCell(t.row,t.cell);else if(-1!==o&&(e.ctrlKey||e.metaKey)){var n,o=n.length;(n=n.filter(function(e){return e!==t.row})).length<o?s.resetActiveCell():s.setActiveCell(t.row,t.cell)}else if(n.length&&e.shiftKey){if(!i)return;var o=n[0],a=t.row,r=_.reduce(n,function(e,t){return e[t]=!0,e},{});if(o<=a)for(var l=o;l<=a;l++)r[l]||n.push(l);else for(l=o;a<=l;l--)r[l]||n.push(l);s.setActiveCell(t.row,t.cell)}return f(p(n),void 0,e),e.stopImmediatePropagation(),!0}function w(e,t){var i;if(a||(i=s.getPluginByName("RowMoveManager")||s.getPluginByName("CrossGridRowMoveManager"),a=i?i.isHandlerColumn:Slick.Utils.noop),s.getEditorLock().isActive()||a(t.cell))return e.stopPropagation(),!1;s.setActiveCell(t.row,t.cell)}function b(e,t){if(!s.getOptions().multiSelect||!o.selectActiveRow)return!1;var i=[t.range];f(i=t.desc?p(h(i).reverse()):i)}Slick.Utils.extend(this,{getSelectedRows:g,setSelectedRows:e,getSelectedRanges:function(){return d},setSelectedRanges:f,refreshSelections:function(){e(g())},init:function(e){if(void 0===Slick.Draggable)throw new Error('Slick.Draggable is undefined, make sure to import "slick.interactions.js"');if(o=Slick.Utils.extend(!0,{},u,t),n=o.cellRangeSelector,s=e,!n&&o.dragToSelect){if(!Slick.CellRangeDecorator)throw new Error("Slick.CellRangeDecorator is required when option dragToSelect set to true");n=new Slick.CellRangeSelector({autoScroll:o.autoScrollWhenDrag,rowMode:!0})}l.subscribe(s.onActiveCellChanged,c(m)),l.subscribe(s.onKeyDown,c(v)),l.subscribe(s.onClick,c(C)),n&&(e.registerPlugin(n),o.useEvent_onCellRangeSelecting&&n.onCellRangeSelecting.subscribe(b),n.onCellRangeSelected.subscribe(b),n.onBeforeCellRangeSelected.subscribe(w))},destroy:function(){l.unsubscribeAll(),n&&(o.useEvent_onCellRangeSelecting&&n.onCellRangeSelecting.unsubscribe(b),n.onCellRangeSelected.unsubscribe(b),n.onBeforeCellRangeSelected.unsubscribe(w),s.unregisterPlugin(n),n.destroy)&&n.destroy()},pluginName:"RowSelectionModel",onSelectedRangesChanged:new Slick.Event})}}}),e=window,Slick.Utils.extend(!0,e,{Slick:{CheckboxSelectColumn:function(e){var r,c,h,p,g=!1,f=null,m=S(),t=new Slick.EventHandler,v={},C=!1,a=new Slick.BindingEventService,w=Slick.Utils.extend(!0,{},{columnId:"_checkbox_selector",cssClass:null,hideSelectAllCheckbox:!1,toolTip:"Select/Deselect All",width:30,applySelectOnAllPages:!1,hideInColumnTitleRow:!1,hideInFilterHeaderRow:!0},e);"function"==typeof w.selectableOverride&&k(w.selectableOverride);function i(){c.updateColumnHeader(w.columnId,"","")}function o(){var e=p&&p.querySelector("#filter-checkbox-selectall-container");e&&(e.style.display="none")}function n(){var e,t=c.getSelectedRows(),i={},o=[];if("function"==typeof f)for(e=0;e<c.getDataLength();e++)E(a,c.getDataItem(e),c)||0;for(var n=[],a=0;a<t.length;a++){var r=t[a];E(a,c.getDataItem(r),c)?(i[r]=!0,i[r]!==v[r]&&(o.push(r),delete v[r])):n.push(r)}for(a in v)o.push(a);v=i;var l=c.getColumnIndex(w.columnId);if(_.each(o,function(e){c.updateCell(e,l)}),h){var s=c.getData(),d=s.extractIds(y()),s=s.selectionSyncHelper.getSelectedIds();if(C=d.length===_.intersection(d,s).length,g&&w.applySelectOnAllPages||(w.hideInColumnTitleRow||w.hideSelectAllCheckbox||M(C),w.hideInFilterHeaderRow)||(d=p&&p.querySelector("#header-filter-selector".concat(m)))&&(d.checked=C),0<n.length){for(a=0;a<n.length;a++){var u=t.indexOf(n[a]);t.splice(u,1)}c.setSelectedRows(t,"click.cleanup")}}}function l(){var e=r.getAllSelectedFilteredIds(),n=r.getFilteredItems(),a=0;if("function"==typeof f&&0<e.length)for(var t=0;t<r.getItemCount();t++)!function(e){var t=r.getItemByIdx(e),i=r.getIdPropertyName(),o=t[i];0<=n.findIndex(function(e){return e[i]===o})&&!E(e,t,c)&&a++}(t);C=(e&&e.length)+a>=n.length,w.hideInColumnTitleRow||w.hideSelectAllCheckbox||M(C),w.hideInFilterHeaderRow||(e=p&&p.querySelector("#header-filter-selector".concat(m)))&&(e.checked=C)}function s(e,t){32==e.which&&c.getColumns()[t.cell].id===w.columnId&&(c.getEditorLock().isActive()&&!c.getEditorLock().commitCurrentEdit()||u(t.row),e.preventDefault(),e.stopImmediatePropagation())}function d(e,t){c.getColumns()[t.cell].id!==w.columnId||"checkbox"!==e.target.type&&!$(e.target).find(":checkbox").length||(c.getEditorLock().isActive()&&!c.getEditorLock().commitCurrentEdit()?e.preventDefault():(u(t.row),e.stopPropagation()),e.stopImmediatePropagation())}function u(t){var e=c.getDataItem(t);E(t,e,c)&&(v[t]?(e=c.getSelectedRows().filter(function(e){return e!==t}),c.setSelectedRows(e,"click.toggle")):c.setSelectedRows(h?c.getSelectedRows().concat(t):[t],"click.toggle"))}function b(e,t){var i;t.column.id==w.columnId&&"checkbox"===e.target.type&&(c.getEditorLock().isActive()&&!c.getEditorLock().commitCurrentEdit()?e.preventDefault():(t=e.target.checked,i=r.extractIds(y()),t?r.selectionSyncHelper.addSelectedIds(i):r.selectionSyncHelper.removeSelectedIds(i),c.focus(),e.stopPropagation()),e.stopImmediatePropagation())}function y(){for(var e,t=[],i=0,o=c.getDataLength();i<o;i++)if((e=c.getDataItem(i))instanceof Slick.NonDataRow){if(e instanceof Slick.Group&&e.collapsed)for(var n=0,a=e.rows.length;n<a;n++)t.push(e.rows[n])}else t.push(e);return t}function S(){return Slick.Utils.generateUid()}function R(e,t,i,o,n,a){var r=S()+e;return n&&E(e,n,a)?v[e]?"<input id='selector"+r+"' type='checkbox' checked='checked'><label for='selector"+r+"'></label>":"<input id='selector"+r+"' type='checkbox'><label for='selector"+r+"'></label>":null}function E(e,t,i){return"function"!=typeof f||f(e,t,i)}function M(e){e?c.updateColumnHeader(w.columnId,"<input id='header-selector"+m+"' type='checkbox' checked='checked'><label for='header-selector"+m+"'></label>",w.toolTip):c.updateColumnHeader(w.columnId,"<input id='header-selector"+m+"' type='checkbox'><label for='header-selector"+m+"'></label>",w.toolTip)}function k(e){f=e}Slick.Utils.extend(this,{init:function(e){c=e,(g=!Array.isArray(e.getData()))&&(r=e.getData()),(h=c.getOptions().multiSelect)||(w.hideSelectAllCheckbox=!0,i()),t.subscribe(c.onSelectedRowsChanged,n).subscribe(c.onClick,d).subscribe(c.onKeyDown,s),g&&r&&w.applySelectOnAllPages&&t.subscribe(r.onSelectedRowIdsChanged,l).subscribe(r.onPagingInfoChanged,l),w.hideInFilterHeaderRow||t.subscribe(e.onHeaderRowCellRendered,function(e,t){var i,o,n;"sel"===t.column.field&&(Slick.Utils.emptyElement(t.node),(i=document.createElement("span")).id="filter-checkbox-selectall-container",(o=document.createElement("input")).type="checkbox",o.id="header-filter-selector".concat(m),(n=document.createElement("label")).htmlFor="header-filter-selector".concat(m),i.appendChild(o),i.appendChild(n),t.node.appendChild(i),p=t.node,a.bind(i,"click",function(e){return b(e,t)}))}),w.hideInColumnTitleRow||t.subscribe(c.onHeaderClick,b)},destroy:function(){t.unsubscribeAll(),a.unbindAll()},pluginName:"CheckboxSelectColumn",deSelectRows:function(e){for(var t=e.length,i=[],o=0;o<t;o++)v[e[o]]&&(i[i.length]=e[o]);c.setSelectedRows(c.getSelectedRows().filter(function(e){return i.indexOf(e)<0}),"SlickCheckboxSelectColumn.deSelectRows")},selectRows:function(e){for(var t=e.length,i=[],o=0;o<t;o++)v[e[o]]||(i[i.length]=e[o]);c.setSelectedRows(c.getSelectedRows().concat(i),"SlickCheckboxSelectColumn.selectRows")},getColumnDefinition:function(){return{id:w.columnId,name:w.hideSelectAllCheckbox||w.hideInColumnTitleRow?"":"<input id='header-selector"+m+"' type='checkbox'><label for='header-selector"+m+"'></label>",toolTip:w.hideSelectAllCheckbox||w.hideInColumnTitleRow?"":w.toolTip,field:"sel",width:w.width,resizable:!1,sortable:!1,cssClass:w.cssClass,hideSelectAllCheckbox:w.hideSelectAllCheckbox,formatter:R}},getOptions:function(){return w},selectableOverride:k,setOptions:function(e){(w=Slick.Utils.extend(!0,{},w,e)).hideSelectAllCheckbox?(i(),o()):(w.hideInColumnTitleRow?i():(M(C),t.subscribe(c.onHeaderClick,b)),w.hideInFilterHeaderRow?o():(e=p.querySelector("#filter-checkbox-selectall-container"))&&(e.style.display="flex",e=e.querySelector('input[type="checkbox"]'))&&(e.checked=C))}})}}}),_.extend(Xe.prototype,w.Events,{PROP_SELECTION_COLUMN:"Selection.RowSelectionColumn",initialize:function(){this.listenTo(this.app.viewModel,"change:"+this.PROP_SELECTION_COLUMN,this.onChange_SelectionColumn),this.listenTo(this.app.viewModel,"change:Selection.SelectedValue",this.onChange_SelectedValue),this.listenTo(this.app.viewModel,"change:Selection.SelectedField",this.onChange_SelectedValue),this.listenTo(this.app.viewModel,"change:Selection.Mode",this.onChange_SelectionMode),this.listenTo(this.app.viewModel,"change:Selection.CheckboxAlignment",this.onChange_CheckboxAlignment)},convertValueIfNecessary:function(e){return b.isKDBTemporal(e)?b.convertKDBTemporalToMoment(e).toDashString():e},doActions:function(l,s,d,u){var c,h,p=this,e=p.app.viewModel.get("Selection.Actions"),g=p.app.viewModel.get("Selection.DefaultFallbackOnDeselect"),f=this.app.dataView.selectionSyncHelper,m=[];function v(e){return p.app.api.getPropertyMeta("Selection.Actions."+e+".Target")}0===(c=f?f.getSelectedIds():p.app.grid.getSelectedRows()).length&&0!==d.indexOf("Mouse")&&(l={}),_.each(e,function(e,t){var i,o,n=!1,a=e.Current,r=e.TriggerColumn||"";e.Trigger===d&&("*"===r?n=!0:"<div></div>"!==u&&-1===u.indexOf("disable-action")&&(n=r===s)),n&&(r=!1,n={_PropertyIndex:t},"map"===e._Type&&("Click"===d&&(o=v(t))&&"viewstate"===o.type&&"list"===o.viewstateType&&(h=h||(f?_.map(c,p.app.dataView.getItemById.bind(p.app.dataView)):p.getDataRowsWithoutGroups(c)),r=!0),g&&0===c.length&&0!==d.indexOf("Mouse")?(o=o||v(t))&&"viewstate"===o.type&&(i=o.defaultValue):("*"===a&&(a=s),i=r?_.chain(h).map(a).map(p.convertValueIfNecessary).value():_.has(l,a)?p.convertValueIfNecessary(l[a]):a),n.Value=i),m.push(_.extend({},e,n)))}),p.app.api.doActions(m,"Selection.Actions")},getCurrentSelectedRanges:function(){var e=this.app.grid.getSelectionModel().getSelectedRanges();return _.map(e,function(e){return[e.fromRow,e.toRow,e.fromCell,e.toCell].join(" ")})},getDataRowsWithoutGroups:function(e){var i=this.app.dataView.getItem.bind(this.app.dataView);return _.reduce(e,function(e,t){t=i(t);return!t||t instanceof Slick.NonDataRow||e.push(t),e},[])},getSelectedRowObject:function(){return this.selectedRowObject},getSelectedRowObjects:function(){return this.selectedRowObjects},initCheckBoxColumn:function(e){var t=this.app.viewModel.get("Selection.CheckboxAlignment");"none"!==t&&(this.checkboxSelector=new Slick.CheckboxSelectColumn({cssClass:"slick-cell-checkboxsel",width:0,minWidth:30}),e["right"===t?"push":"unshift"](this.checkboxSelector.getColumnDefinition()))},onAction:function(e,t,i){var o,n=this.app.grid;!this.hasActions&&"Double Click"!==e||this.app.editorModule&&this.app.editorModule.isEditable||null===(t=null===(t=n.getCellFromEvent(t))&&_.has(i,"row")&&_.has(i,"cell")?i:t)||(i=this.app.dataView.getItem(t.row))instanceof Slick.NonDataRow||(o=n.getColumns()[t.cell]).selectable&&(o=o.field,n=n.getCellNode(t.row,t.cell).innerHTML,this.app.api.doActions&&this.doActions(i,o,e,n),"Double Click"===e&&i&&this.app.trigger("dataGridRowDoubleClicked",i),"Right Click"===e)&&i&&this.app.trigger("dataGridRowRightClicked",i)},onChange_CheckboxAlignment:function(){this.onChange_SelectionMode()},onChange_SelectedValue:function(){this.app.skipGridGeneration||this.setSelectedRows_ignoreCallback_onSelectedRowsChanged()},onChange_SelectionColumn:function(){var e;this.app.skipGridGeneration||this.app.RAW_MODE&&(e=this.app.viewModel.get(this.PROP_SELECTION_COLUMN),this.app.rawModeModule.populateFields([e],"selection"))},onChange_SelectionActions:function(){var e=this.app.viewModel.get("Selection.Actions");this.hasActions=!(!e||!e.length)},onChange_SelectionMode:function(){this.app.skipGridGeneration||this.app.generateDataGridFromReceivedData()},onKeyDown:function(e,t){this.hasActions&&(this.lastSelectedRanges=this.getCurrentSelectedRanges())},onKeyDownDone:function(e,t){this.hasActions&&_.includes([40,38,34,33,39,37,9],e.which)&&!_.isEqual(this.getCurrentSelectedRanges(),this.lastSelectedRanges)&&(e.target=this.app.grid.getActiveCellNode(),this.onAction("Click",e))},registerGridSelectionModel:function(){var e,l=this,t=l.app.viewModel.get("Selection.Mode"),s="Selection.SelectedValue",i=l.app.grid;_.includes(["Single Row","Multi Row"],t)?(e=new Slick.RowSelectionModel({dragToSelect:"Multi Row"===t,selectActiveRow:!0,useEvent_onCellRangeSelecting:!1}),i.setSelectionModel(e),e=null,i.onSelectedRowsChanged.subscribe(function(e,t){l.ignoreCallback_onSelectedRowsChanged||l.userClickSelection||0===i.getSelectedRows().length&&0===l.app.dataView.selectionSyncHelper.getSelectedIds().length&&null!=l.selectedRowObject&&(l.selectedRowObject=null,l.trigger_selectedRowChanged(),l.trigger_selectedRowsChanged([]))}),this.app.dataView.syncGridSelection(i,!0,!0).subscribe(function(e,t){var i,o,n;l.ignoreCallback_onSelectedRowsChanged||l.userClickSelection||(t=t.ids,i=l.app.api.getPropertyMeta(s),n=l.app.viewModel.get("Selection.RowSelectionColumn"),l.selectedRowObject=0===t.length?null:l.app.dataView.getItemById(_.last(t)),l.trigger_selectedRowChanged(),l.trigger_selectedRowsChanged(t),o=0<t.length?i&&"list"===i.viewstateType?_.chain(t).map(l.app.dataView.getItemById.bind(l.app.dataView)).map(n).map(l.convertValueIfNecessary).value():(o=l.selectedRowObject[n],l.convertValueIfNecessary(o)):(o="",i&&(l.app.viewModel.get("Selection.DefaultFallbackOnDeselect")?o=i.defaultValue:"list"===i.viewstateType&&(o=[])),l.convertValueIfNecessary(o)),l.userClickSelection=!0,l.ignoreCallback_setSelectedRows=!0,l.app.api.setProperty(s,o),l.ignoreCallback_setSelectedRows=!1,l.userClickSelection=!1)}.bind(this))):_.includes(["Cell","Area"],t)?(e=new Slick.CellSelectionModel({singleCellMode:"Cell"===t})).onSelectedRangesChanged.subscribe(function(e,t){var i,o,n=l.app.viewModel.get("Selection.RowSelectionColumn"),a=[],r=[];t&&t[0]&&l.app.dataView&&(i=1<t.length?_.map(t,"fromRow"):_.range(t[0].fromRow,t[0].toRow+1),t=_.range(t[0].fromCell,t[0].toCell+1),i=l.getDataRowsWithoutGroups(i),o=_.map(t,function(e){return l.app.grid.getColumns()[e].field}),_.each(i,function(t){_.each(o,function(e){a.push(t[e])}),r.push(t[n])}),l.setViewstateProperty("Selection.SelectedField",o),l.setViewstateProperty("Selection.SelectedCellValue",a),l.ignoreCallback_setSelectedRows=!0,l.setViewstateProperty(s,r),l.ignoreCallback_setSelectedRows=!1)}):"None"===t&&(e=new function(e){var t=[];$.extend(this,{init:_.noop,destroy:_.noop,getSelectedRanges:function(){return t},setSelectedRanges:_.noop,onSelectedRangesChanged:new Slick.Event})}),"none"!==l.app.viewModel.get("Selection.CheckboxAlignment")&&i.registerPlugin(this.checkboxSelector),i.onClickDone.subscribe(_.bind(this.onAction,this,"Click")),i.onDblClick.subscribe(_.bind(this.onAction,this,"Double Click")),i.onMouseEnter.subscribe(_.bind(this.onAction,this,"Mouse In")),i.onMouseLeave.subscribe(_.bind(this.onAction,this,"Mouse Out")),i.onKeyDown.subscribe(this.onKeyDown.bind(this)),i.onKeyDownDone.subscribe(this.onKeyDownDone.bind(this)),e&&i.setSelectionModel(e)},remove:function(){this.stopListening()},setSelectedRows_ignoreCallback_onSelectedRowsChanged:function(){this.ignoreCallback_onSelectedRowsChanged=!0,this.setSelectedRows(),this.ignoreCallback_onSelectedRowsChanged=!1},setSelectedRows:function(){if(!this.ignoreCallback_setSelectedRows&&this.app.grid&&this.app.api.getPropertyMeta){var e,t,l=this.app.dataView,r=[],s=this,d=s.app.viewModel.get("Selection.Mode"),u=this.app.viewModel.get("Selection.RowSelectionColumn");if(_.includes(["Single Row","Multi Row"],d))e=this.app.dataView.selectionSyncHelper;else{if("Cell"!==d)return;var i=this.app.api.getPropertyMeta("Selection.SelectedValue")||{};if(!u||"viewstate"!==i.type)return;e={getSelectedIds:function(){var e=this.app.grid.getSelectionModel().getSelectedRanges();return e&&e[0]?_.without(l.mapRowsToIds(_.range(e[0].fromRow,e[0].toRow+1)),void 0):[]}.bind(this),setSelectedIds:function(e){var t,i,e=_.without(l.mapIdsToRows(e),void 0),o=[],n=this.app.viewModel.get("Selection.SelectedField"),a=this.app.grid.getColumns(),r=-1;(n=n&&_.isArray(n)?n.length?n[0]:"":n)&&(r=_.findIndex(a,{field:n})),t=i=0<=r?r:_.max([0,_.findIndex(a,{field:u})]),e.length&&(o=_.map("Cell"===d?[e[0]]:e,function(e){return new Slick.Range(e,t,e,i)})),this.app.grid.getSelectionModel().setSelectedRanges(o)}.bind(this)}}void 0===(i=(s.app.api.getPropertyMeta("Selection.SelectedValue")||{value:void 0}).value)||_.isArray(i)||(i=[i]),_.each(i,function(e){var t,i;if(void 0!==e)for(t=0,i=l.getItems().length;t<i;t++){var o,n,a=(n=l.getItemByIdx(t))[u];o=!1,b.isKDBTemporal(a)?o=b.convertKDBTemporalToMoment(a).toDashString()==e:(a==e||_.isArray(e)&&_.includes(e,a))&&(o=!0),o&&r.push(n[s.app.SLICKGRID_ROW_UNIQUE_ID])}}),0!==r.length&&_.isEqual(e.getSelectedIds(),r)||this.app.grid.resetActiveCell(),e.setSelectedIds(r),0<r.length&&this.app.viewModel.get("Selection.FollowSelectedValue")&&!this.userClickSelection&&this.app.scrollingModule&&(t=void 0,_.find(r,function(e){return void 0!==(t=l.getRowById(e))}),void 0!==t)&&this.app.scrollingModule.scrollTo(t,!0)}},setViewstateProperty:function(e,t){var i=this.app.api.getPropertyMeta?this.app.api.getPropertyMeta(e):null;i&&"viewstate"===i.type&&(t="list"===i.viewstateType?_.map(_.isArray(t)?t:[t],this.convertValueIfNecessary):this.convertValueIfNecessary(_.isArray(t)&&t.length?t[0]:""),this.app.api.setProperty(e,t))},trigger_selectedRowChanged:function(){this.app.trigger("selectedRowChanged",this.selectedRowObject)},trigger_selectedRowsChanged:function(e){e=_.compact(_.map(e,this.app.dataView.getItemById.bind(this.app.dataView)));this.selectedRowObjects=e,this.app.trigger("selectedRowsChanged",e)}}),_.extend(Qe.prototype,w.Events,{initialize:function(){this.onMouseMove=this.onMouseMove.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this)},initRowTooltip:function(){var e=this.app.grid;this.remove_onMouseMoveHandler(),e.onMouseEnter.subscribe(this.onMouseEnter),e.onMouseLeave.subscribe(this.onMouseLeave)},onMouseEnter:function(e){var i,o,t=this.app.grid;"none"!==this.app.viewModel.get("Tooltip.Position")&&(e=t.getCellFromEvent(e))&&(o=this.app.dataView.getItem(e.row))&&!o.__group&&(o=_.omit(o,"_rowIndex","idProperty"),this.app.api.getProperty("Tooltip.UseFormattedCellValue")&&(i=_.keyBy(t.getColumns(),"field"),_.each(Object.keys(o),function(e){var t=i[e];t&&(t=t.formatter(void 0,void 0,o[e],t,o,!0),o[e]=t.textContent)})),t=this.app.grid.getColumns()[e.cell].field,o.thisField=t,o.thisRawValue=o.thisValue=o[t],this.tooltip=this.app.api.setTooltip({data:o,text:this.app.viewModel.get("Tooltip.Template")}),this.remove_onMouseMoveHandler(),$(document).mousemove(this.onMouseMove))},onMouseLeave:function(e){this.tooltip&&(this.app.api.removeTooltip(),delete this.tooltip),this.remove_onMouseMoveHandler()},onMouseMove:function(e){var t,i,o,n,a,r=this.app.grid,l=this.app.viewModel.get("Tooltip.Position"),s=r.getCellFromEvent(e);if(s){switch(l){case"cursor":t=e.clientY+10,i=e.clientX+20;break;case"right":case"left":a=r.getCellNode(s.row,s.cell),t=$(a).offset().top,i=(n=(a=$(r.getContainerNode())).offset()).left+a.width(),o=$("body").width()-n.left}this.tooltip.updatePosition(_.extend({top:t},"left"===l?{right:o}:{left:i}))}else this.onMouseLeave()},remove:function(){this.$tooltipDiv&&this.$tooltipDiv.remove(),this.remove_onMouseMoveHandler(),this.stopListening()},remove_onMouseMoveHandler:function(){$(document).off("mousemove",this.onMouseMove)}}),{COLOR_SCHEMAS:{},_clamp:function(e,t,i){return i<e?i:e<t?t:e},_generateColorSchema:function(e){for(var t=[],i=N._hexToRgb(e),o=i[0],n=i[1],a=i[2],r=0;r<10;r++)t[r]="rgb("+(o-10*r)+","+(n-10*r)+","+(a-10*r)+")";return t.reverse(),N.COLOR_SCHEMAS[e]=t},getColor:function(e,t){return e=e.replace("#",""),(N.COLOR_SCHEMAS[e]||N._generateColorSchema(e))[t]},_hexToRgb:function(e){return[parseInt(e.substr(0,2),16),parseInt(e.substr(2,2),16),parseInt(e.substr(4,2),16)]},interpolateColor:function(e,t,i,o){for(var i=(i-t)/(e.length-1),o=this._clamp((o-t)/i,0,e.length-1),t=e[Math.floor(o)].color.replace("#",""),i=e[Math.ceil(o)].color.replace("#",""),n=this._hexToRgb(t),a=this._hexToRgb(i),r=o-Math.floor(o),l=n.slice(),s=0;s<3;s++)l[s]=Math.round(l[s]+r*(a[s]-n[s]));return"#"+this._rgbToHex(l)},_rgbToHex:function(e){return((1<<24)+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1)}}),rt=(I.PREVIOUS_VALUE="previous value",_.extend(I.prototype,w.Events,{isPreviousValueUsedInAnyRule:!1,displayArrowsOrHighlightOnChange:!1,initialize:function(){this.clearHighlightRuleChains(),this.listenTo(this.app.viewModel,"change:HighlightRules",this.onChange_HighlightRules),this.listenTo(this.app.viewModel,"change:ColumnsConfiguration",this.onChange_ColumnsConfiguration)},clearHighlightRuleChains:function(){this.highlightRuleChains={}},evalHighlight_Equality:function(e,t,i,o){e&&null!==i&&i===o&&(t["border-color"]=e,t["box-shadow"]="inset 0px 0px 1px 1px rgba(0,0,0, 0.8)")},evalHighlight_Range:function(e,t,i,o,n,a){e&&null!==i&&(i=n===o?1:(i-o)/(n-o),i=Math.round(9*i),n=N.getColor(e,i=a?9-i:i),t["background-color"]=n)},getFieldsUsedInRulesWithPreviousValue:function(){var i,e;return _.includes(this.fieldsUsedInRulesWithPreviousValue,"<this>")?(i=_.without(this.fieldsUsedInRulesWithPreviousValue,"<this>"),e=_.compact(_.map(_.filter(this.app.grid.getColumns(),function(e){return e._dashboardConfig}),"field")),_.each(_.filter(this.app.viewModel.get("HighlightRules"),{ConditionSource:"<this>",ConditionValue:I.PREVIOUS_VALUE,RuleType:"discrete",Enabled:!0}),function(t){_.each(e,function(e){u.isFieldMatched(t.Target,e)&&i.push(e)})}),_.uniq(i)):this.fieldsUsedInRulesWithPreviousValue},getHighlightBox:function(e){var t=e.find(">.highlightBox");return t.length?t.removeAttr("style"):(t=$('<div class="highlightBox"></div>')).prependTo(e),t},getHighlightingFields:function(){var e=_.uniq(_.map(this.getTrackedColumns(function(e){return e.ShowArrowsOnChange||e.HighlightChanges}),"field"));return e=_.uniq(e.concat(this.getFieldsUsedInRulesWithPreviousValue()))},getHighlightRuleChain:function(t){var e=this.highlightRuleChains[t];return e||(e=this.app.viewModel.get("HighlightRules"),(e=_.filter(e,function(e){return e.Enabled&&!!e.ConditionSource&&u.isFieldMatched(e.Target,t)})).reverse(),this.highlightRuleChains[t]=e),e},getTrackedColumns:function(o,n){var a=this.app.columnInfo;return _.filter(this.app.grid.getColumns(),function(e){var t=e._dashboardConfig,i=!1;return t&&(i=o(t),n)&&i&&(t=e.field,e=a.get(t))&&(n[t]=7===e.get("kdbType")),i})},highlightCachedChanges:function(){console.log("IK REMOVE THIS CODE highlightCachedChanges")},hasPreviousValueInAnyRule:function(){return this.isPreviousValueUsedInAnyRule},isValidHighlightRulesConfig:function(){var e=this.app.viewModel.get("HighlightRules");return e&&(0===e.length||_.every(e,function(e){var t=e.Target&&e.ConditionSource,i=e.ConditionOperator&&void 0!==e.ConditionValue||_.includes(["Fill Left-to-Right","Fill Right-to-Left"],e.ConditionOperator);return!e.Enabled||t&&i}))},getAffectedIndicies:function(e,s){var d=[],u=this.app.previousValuesMap,c=this.app.atomizeTemporal,h=this.app.columnInfo,p=this.app.SLICKGRID_ROW_UNIQUE_ID;return _.each(e,function(e){if(s&&s.length)for(var t=0;t<s.length;t++){var i,o,n,a=!1,r=s[t],l=r.ConditionSource;if("gradient"===r.RuleType||"<this>"===l?a=!0:(i=r.ConditionValue,r=r.ConditionOperator,o=e[l],(n=h.get(l))&&7===n.get("kdbType")&&_.isString(o)&&(o=parseInt(o,10)),i===I.PREVIOUS_VALUE?(n=u[c(e[p])])&&(n=n[l],o&&o.class&&(o=O._convertKdbValueforComparison(o)),n&&n.class&&(n=O._convertKdbValueforComparison(n)),a=O._getConditionResult(o,n,r)):a=o&&o.class?O._getConditionResult(O._convertKdbValueforComparison(o),i,r):O._getConditionResult(o,i,r)),a)return void d.push(e[p])}}),this.app.dataView.mapIdsToRows(d)},onChange_ColumnsConfiguration:function(){this.displayArrowsOrHighlightOnChange=_.some(this.app.viewModel.get("ColumnsConfiguration"),function(e){return e.ShowArrowsOnChange||e.HighlightChanges})},onChange_HighlightRules:function(r){var e,t,i,l=this,s=(this.setupStateForRulesWithPreviousValue(r.get("HighlightRules")),this.app.globalPalette),d=r.get("Style.Theme");_.isNil(s)||r.get("HighlightRules").forEach(function(e,t){var i=e.PaletteTheme,o=_.isEmpty(i)||" "===i,n=[],a=!1;s.forEach(function(e){var t=".dark"!==_.get(e,"theme")&&".light"!==_.get(e,"theme")||e.theme.toLowerCase()==="."+d.toLowerCase();_.isEmpty(e.rule.trim())||e.rule!==i||!t||o||(n.push({color:v.Tools.rgbStr2hex(e.color)}),a=!0)}),a&&(l.app.api.setProperty(e="HighlightRules."+t+".Palette",n),r.set(e,n))}),!this.app.skipGridGeneration&&this.app.grid&&(t=(t=r.changedAttributes())?_.keys(t.HighlightRules):[],e=_.pick(r.previousAttributes(),_.map(t,function(e){return"HighlightRules."+e})),t=_.pick(r.attributes,_.map(t,function(e){return"HighlightRules."+e})),i=this.app.grid.getRenderedRange(),i=this.app.dataView.mapRowsToIds(_.range(i.top,i.bottom+1)),_.remove(i,_.isUndefined),i=_.map(i,this.app.dataView.getItemById.bind(this.app.dataView)),i=this.getAffectedIndicies(i,(e.HighlightRules||[]).concat(t.HighlightRules||[])),this.clearHighlightRuleChains(),this.app.grid.invalidateRows(i),this.app.grid.render(),this.app.sparklinesManager.refresh(),this.processMinMaxHighlighting())},prepareValue:function(e,t){return e=void 0!==(e=t&&_.isString(e)?parseInt(e,10):e).i?e.i:e},processMinMaxHighlighting:function(){var e,p,g,f,t,m=this.app.grid,i=this.app.dataView,v={};m&&(this.app.filteringModule.refreshDataviewIfFilterNotEmpty(),0!==(e=this.getTrackedColumns(function(e){var t=this.app.columnInfo.get(e.Field);return t&&11!==t.get("kdbType")&&(e.HighlightMinValueColor||e.HighlightMaxValueColor||e.RangeHighlightColor)}.bind(this),v)).length)&&(this.app.RAW_MODE&&this.app.rawModeModule.populateFields(_.map(e,function(e){return e.name}),"minmax"),0!==(p=i.getItems()).length)&&(t=m.getViewport(),g=_.range(t.top,t.bottom+1),f=_.map(i.mapRowsToIds(g),function(e){return i.getItemById(e)}),_.each(e,function(e){for(var t,o=m.getColumnIndex(e.id),n=e.field,e=e._dashboardConfig,a=e.HighlightMinValueColor,r=e.HighlightMaxValueColor,l=e.RangeHighlightColor,s=e.IsRangeHighlightColorInverted||!1,d=Number.MAX_VALUE,u=Number.MIN_VALUE,c=v[n],i=0,h=p.length;i<h;i++)null!=(t=p[i][n])&&((t=this.prepareValue(t,c))<d&&(d=t),u<t)&&(u=t);_.each(f,function(e,t){var i;e&&null!=(e=e[n])&&(e=this.prepareValue(e,c),this.evalHighlight_Equality(a,i={},e,d),this.evalHighlight_Equality(r,i,e,u),this.evalHighlight_Range(l,i,e,d,u,s),!_.isEmpty(i))&&(e=g[t],t=m.getCellNode(e,o))&&this.getHighlightBox($(t)).css(i)}.bind(this))}.bind(this)))},processMinMaxHighlighting_debounced:function(){(this.processMinMaxHighlighting_debounced=_.debounce(this.processMinMaxHighlighting.bind(this),10))()},processMinMaxHighlighting_debouncedMore:function(){(this.processMinMaxHighlighting_debouncedMore=_.debounce(this.processMinMaxHighlighting.bind(this),100))()},processNumberDiffHighlighting:function(){var t,i,p=this.app.grid,o=this.app.dataView,n=this.app.previousValuesMap,g=this.app.diffValuesMap,a=this.app.atomizeTemporal,f={};p&&this.displayArrowsOrHighlightOnChange&&0!==(t=this.getTrackedColumns(function(e){return e.ShowArrowsOnChange||e.HighlightChanges},f)).length&&(i=this.app.getRowIxRange(),_.each(o.mapRowsToIds(i),function(d,e){var u,c,h;void 0!==d&&(h=i[e],d=a(d),u=o.getItemById(d),c=n[d])&&_.each(t,function(e){var t,i,o=p.getColumnIndex(e.id),n=e.field,e=e._dashboardConfig,a=e.Precision,r=e.HighlightChangeDuration,l=u[n],s=c[n];f[n]&&_.isString(s)&&_.isString(l)&&(s=parseInt(s,10),l=parseInt(l,10)),_.isNumber(s)&&_.isNumber(l)&&(s=this.roundToPrecision(s,a),t=(l=this.roundToPrecision(l,a))===s?void 0:s<l,e.ShowArrowsOnChange&&void 0===t&&g&&g[d]&&(s=g[d][n],f[n]&&_.isString(s)&&(s=parseInt(s,10)),_.isNumber(s))&&(i=l===(s=this.roundToPrecision(s,a))?void 0:s<l),n=_.some([t,i],_.negate(_.isUndefined)))&&(a=p.getCellNode(h,o))&&(e.HighlightChanges&&void 0!==t&&this.setBackgroundColorInCell(a,r,t),e.ShowArrowsOnChange)&&n&&this.showArrowInCell(a,void 0===t?i:t)}.bind(this))}.bind(this)))},remove:function(){this.stopListening()},roundToPrecision:function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)},setBackgroundColorInCell:function(e,t,i){e.dataset.tid&&clearTimeout(e.dataset.tid),e.style.backgroundColor=i?"green":" red",e.dataset.tid=setTimeout(function(){e.style.backgroundColor=""},t)},setupStateForRulesWithPreviousValue:function(e){var t=[];_.each(e,function(e){e.Enabled&&"discrete"===e.RuleType&&e.ConditionValue===I.PREVIOUS_VALUE&&t.push(e.ConditionSource)}.bind(this)),this.fieldsUsedInRulesWithPreviousValue=_.uniq(t),this.isPreviousValueUsedInAnyRule=0<this.fieldsUsedInRulesWithPreviousValue.length},showArrowInCell:function(e,t){var i=document.createElement("i");i.className="fa fa-caret-"+(t?"up":"down"),e.appendChild(i)},showArrowsOrHighlightOnChange:function(){return this.displayArrowsOrHighlightOnChange}}),_.extend(Je.prototype,{initialize:function(){_.defaults(this.api,{getTemplateViewStates:function(){return{}},subscribeTemplateViewStates:function(e,t){t&&t({})},unsubscribeTemplateViewStates:_.noop})},remove:function(){this.unsubscribeViewstateSubscribers()},subscribeViewstateSubscribers:function(e){_.each(e,function(o){var e=_.get(o,"_dashboardConfig.Template","");$.trim(e)&&this.viewstateSubscriberIDs.push(this.api.subscribeTemplateViewStates(e,function(){var t,e,i=this.app.grid;i&&void 0!==(t=i.getColumnIndex(o.id))&&(e=i.getViewport(),_.each(_.range(e.top,e.bottom+1),function(e){i.updateCell(e,t)}))}.bind(this)))}.bind(this))},unsubscribeViewstateSubscribers:function(){_.isEmpty(this.viewstateSubscriberIDs)||_.each(this.viewstateSubscriberIDs,function(e){this.api.unsubscribeTemplateViewStates(e)}.bind(this)),this.viewstateSubscriberIDs=[]}}),A.prototype.getSummaryRowFields=function(){var i=[];return _.each(this.app.grid.getColumns(),function(e){var t=_.get(e,"_dashboardConfig.Footer","None");"None"!==t&&(i.push(e.field),"WeightedAverage"===t)&&i.push(_.get(e,"_dashboardConfig.FooterWeights"))}),_.uniq(_.filter(i))},A.prototype.getSummaryRowHeight=function(){var e=_.map(null==(e=this.app.grid)?void 0:e.getColumns(),"_dashboardConfig");return _.some(e,function(e){return e&&!_.isNil(e.Footer)&&"None"!==e.Footer})?this.viewModel.get("Style.RowHeight"):0},A.prototype.positionSummaryRowHeight=function(e){this.summaryRowEl&&(this.summaryRowEl.style.bottom=(e?30:0)+"px")},A.prototype.set_isEnabled=function(e){this.isEnabled=e},A.prototype.updateSummmaryRow=function(e){var t=this;if(this.isEnabled){var i=this.app.$(".pnlSummaryRow").empty();if(this.removeScrollHandler(),this.getSummaryRowHeight()){for(var o=document.createDocumentFragment(),n=(this.paneLeft=document.createElement("div"),this.paneLeft.className="pnlSummaryRowPaneLeft",this.paneRight=document.createElement("div"),this.paneRight.className="pnlSummaryRowPaneRight",o.appendChild(this.paneLeft),o.appendChild(this.paneRight),this.app.columnInfo),a=this.app.grid.getUID(),r=this.viewModel.get("Style.RowHeight"),l=(i.attr("class","pnlSummaryRow").addClass(a).css({height:r,lineHeight:r}),this.summaryRowEl=i[0],this.app.grid.getCanvases()[0]),a=this.app.grid.getCanvases()[1],r=(this.viewportLeftEl=l.parentElement,this.viewportRightEl=a.parentElement,e&&this.app.positionPanelWithDatagrid(),this.app.columnsConfig),i=this.app.dataView.getFilteredItems(),s=this.getDataContext(r,n,i),d=(this.rowSummaryObj={},_.filter(r,function(e){return!_.get(e,"_dashboardConfig.Hidden")})),u=_.map(this.app.grid.getColumns(),"id").map(function(e){return _.find(d,{id:e})}).filter(Boolean),c=0;c<u.length;c++){var h=u[c],p=h.field,g=document.createElement("div"),f=(g.className="slick-cell l"+c+" r"+c+" ui-state-default "+h.cssClass,h.formatter(void 0,void 0,s[p],h,s,this.app.grid,!0)),h=""+((f=_.get(h,"_dashboardConfig.Template")?f.replace("<div>","").replace(/\<\/div\>$/,""):f)instanceof Node?f.textContent:f);g.innerHTML=h,(l===this.app.grid.getCanvasNode(c)?this.paneLeft:this.paneRight).appendChild(g),this.rowSummaryObj[p]=(s[p]||"").toString()}null!=(a=this.summaryRowEl)&&a.appendChild(o),$(this.viewportLeftEl).add(this.viewportRightEl).on("scroll",function(){return t.updateSummaryRowScrollPosition()}),this.updateSummaryRowScrollPosition()}else e&&this.app.positionPanelWithDatagrid()}},A.prototype.getDataContext=function(e,i,t){var o={};function n(e){return _.isNumber(e)&&!_.isNaN(e)}function a(e,t){e=_.map(e,t),t=i.get(t);return e=t&&7===t.get("kdbType")?_.map(e,function(e){return _.isString(e)?parseInt(e,10):e}):e}for(var r=0;r<e.length;r++){var l=e[r],s=l.field,d=_.get(l,"_dashboardConfig.Footer","None");if("None"!==d&&t.length){var u=0,c=[];switch(d){case"Count":u=t.length;break;case"WeightedAverage":for(var h=_.get(l,"_dashboardConfig.FooterWeights"),p=a(t,s),g=a(t,h),f=0,m=0,v=0;v<p.length;v++){var C=p[v],w=g[v];n(w)&&n(C)&&(f+=w*C,m+=w)}0!==m&&(u=f/m);break;case"Average":case"Sum":h=a(t,s),c=_.filter(h,function(e){return!_.isNull(e)&&!_.isUndefined(e)&&(_.isNumber(e)||_.has(e,"i"))}),u=_.reduce(c,function(e,t){return e+t},0);break;default:if(!this.app.footerFieldValues||!this.app.footerFieldValues[d]){console.log("Data Grid: Footer ".concat(d," not defined for column ").concat(s));continue}u=this.app.footerFieldValues[d]}"Average"===d&&(u/=c.length),o[s]=u}}return o},A.prototype.updateSummaryRowScrollPosition=function(){var e;this.viewportLeftEl&&this.viewportRightEl&&(e=this.viewportLeftEl.firstElementChild.offsetWidth,this.paneLeft.style.width=e+"px",this.paneLeft.style.left=-this.viewportLeftEl.scrollLeft+"px",this.paneRight.style.left=e-this.viewportRightEl.scrollLeft+"px",this.paneRight.style.width=this.viewportRightEl.firstElementChild.offsetWidth+"px")},A.prototype.remove=function(){this.removeScrollHandler(),this.summaryRowEl=this.viewportLeftEl=this.viewportRightEl=void 0},A.prototype.removeScrollHandler=function(){this.viewportLeftEl&&this.viewportRightEl&&$(this.viewportLeftEl).add(this.viewportRightEl).off()},A);function A(e){this.isEnabled=!1,this.rowSummaryObj={},this.app=e,this.viewModel=e.viewModel}P.prototype.remove=function(){},P.prototype.render=function(){if(this.viewModel.get("Basics.ExpandOnPdf")){if(this.isMultipageGridRendered)return!0;if(this.isActive||(this.isActive=!!$("body.pdf").length),this.isActive&&this.app.$el.height())return this.isMultipageGridRendered=this.renderDatagrid(),this.isMultipageGridRendered}return!1},P.prototype.generateDatagridModel=function(){var e=new v.DocumentDataModel({_subscriptionKey:this.app.SLICKGRID_ROW_UNIQUE_ID,_dataType:"copy",_maxRows:1e6},void 0,"",null);return e.apply(),e.onExecuteSuccess(F.dummyKdbResponse(),!0),new w.Model({data:e,datagridConfig:{Basics:{Filtering:"disabled"},ColumnsConfiguration:this.viewModel.get("ColumnsConfiguration"),Style:this.viewModel.get("Style")},theme:this.viewModel.get("Style.Theme")})},P.prototype.renderDatagrid=function(){var e=this.app.dataView.getItems(),t=e.length,i=this.app.$el.parents("[data-componentid]"),o=i.map(function(){return $(this).attr("data-componentid")}).get(),n=_.find([["Datagrid","Panel","Tabs"],["Datagrid","Tabs"]],function(e){return _.isEqual(e,o)});if(n){var a,r=0,i=(1<=n.length&&(l=(s=(i=i.filter(".ui-tabs-panel")).parent()).find("> div:not(.interaction-div):not(.hidden-tab)"),i[0]===l[0])&&(r=s.find(">ul").height()),2===n.length?null:this.app.$el.closest(".grid-stack").children(".grid-stack-item:not([data-componentid='Datagrid'])").eq(0)),l=0,s=(i&&(l=i.height(),(a=$(i.find(".grid-stack-item-content").prop("outerHTML"))).css({height:l,width:i.width(),position:"relative"})),parseFloat(this.viewModel.get("Style.HeaderRowHeight"))+1),n=parseFloat(this.viewModel.get("Style.RowHeight")),d=1080-l,u=this.app.$el.siblings(".title-div").outerHeight(),c=Math.floor((d-s)/n),h=Math.floor((d-r-u-s)/n),p=1+Math.ceil((t-h)/c);if(1<p){var s=1080*p-r,g=(this.app.$el.closest(".ui-tabs-panel").css("height",s),i&&(i.css({height:l,"min-height":l}),this.app.$el.closest(".grid-stack-item").css({height:s-l,top:l})),this.app.$(".datagridFrame"));g.empty(),"_rowIndex"===this.app.SLICKGRID_ROW_UNIQUE_ID&&(e=_.cloneDeep(e));for(var f=0;f<p;f++){a&&0<f&&a.clone().appendTo(g);var m=$("<div></div>",{class:"singlePageGrid",css:{position:"relative",height:d-(0===f?r+u:0)}}).appendTo(g),v=this.generateDatagridModel(),m=(new V.Master({el:m,model:v}),this.app.columnInfo.map("id")),C=this.app.columnInfo.map("kdbType"),w=_.take(_.drop(e,0===f?0:h+(f-1)*c),0===f?h:c),v=v.get("data");v.onExecuteBegin(),v.onExecuteSuccess({rows:w,columns:m,meta:_.zipObject(m,C)},!0)}return!0}}else console.warn("Datagrid > multi page printing > current layout not supported");return!1};var lt=P;function P(e){this.isActive=!1,this.isMultipageGridRendered=!1,this.app=e,this.viewModel=e.viewModel}var L={initialize:function(e){var t,i,o,n,a,r=this;this.subscriptionKey=_.uniqueId("datagridMaster_"),e=(i=e.model).get("data"),o=i.get("columnsConfig")||[],n=i.get("datagridConfig")||{},t=i.get("theme")||"Dark",a=i.get("gridMasterModelEventSubscribers"),this.customEditors=i.get("customEditors"),this.ignoreMetaChanges=i.get("ignoreMetaChanges")||!1,this.settingsModel=V.getSettingsModel($.extend(!0,{Basics:{Data:e,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:o,FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Selection:{RowSelectionColumn:e.get("_subscriptionKey"),SelectedValue:new v.DocumentViewModel({_default:[],_viewType:!0,_type:"list",value:[]})}},n)),o={sortColumns:i.get("sortColumns"),sortColumnsForCaseInsensitiveSort:i.get("sortColumnsForCaseInsensitiveSort"),gridEventSubscribers:i.get("gridEventSubscribers"),dataViewFilter:i.get("dataViewFilter"),dashboardViewModel:i.get("dashboardViewModel")||new w.Model({DashboardTheme:t}),serverSidePaging:!1,settingsModel:this.settingsModel,api:{showQueryStatus:$.noop,hideQueryStatus:$.noop,subscribe:function(e,t){t={key:r.subscriptionKey,source:e,onData:t};e.subscribe(t.key,t)},unsubscribe:function(e){e.unsubscribe&&e.unsubscribe(r.subscriptionKey)},doActions:$.noop,getProperty:$.proxy(this.getProperty,this),getPropertyMeta:$.proxy(this.getPropertyMeta,this),setProperty:$.proxy(this.setProperty,this),loadSetting:$.noop,saveSetting:$.noop}},V.prototype.initialize.apply(this,[o]),_.defer(function(){r.listenTo(r.settingsModel,"change",function(){r.onSettingsChange(r.settingsModel.toFlat())}),r.onSettingsChange(r.settingsModel.toFlat()),_.isArray(a)&&_.each(a,function(e){_.isFunction(e)&&e.call(r,i)})})},determineType:function(e){return _.isObject(e)&&_.isFunction(e.get)?e.get("_viewType")?"viewstate":e.get("_dataType")?"datasource":void 0:"none"},getProperty:function(e){var t,i;if(!e)return null;if(!(i=this.settingsModel.get(e)))return null;switch(this.determineType(i)){case"data":t=null;break;case"viewstate":t=this.getPropertyValue(i);break;default:t=i}return t},getPropertyMeta:function(e){var t,i,o,n;if(!e)return null;if(!(t=this.settingsModel.get(e)))return null;switch(e=this.determineType(t)){case"data":n=null;break;case"viewstate":n=this.getPropertyValue(t),i=t.get("_default"),o=t.get("_type");break;default:n=t}return{path:t.path||null,type:e,value:n,viewstateType:o||null,defaultValue:i||null}},getPropertyValue:function(e){return"viewstate"===this.determineType(e)?e.get("value"):e},setProperty:function(e,t){var i=this.settingsModel.get(e);"viewstate"===this.determineType(i)?i.set("value",t):this.settingsModel.set(e,t)}},V=w.View.extend({SLICKGRID_ROW_UNIQUE_ID:"slickGridId",RAW_MODE:!1,initialize:function(e){var o=this;this.api=e.api,this.settingsModel=e.settingsModel,this.dashboardAppModel=e.dashboardAppModel,this.dashboardViewModel=e.dashboardViewModel,this.dataConfigDialogMode=e.dataConfigDialogMode||!1,this.orderBookMode=e.orderBookMode,this.widgetId=e.widgetId,this.viewModelLoaded=!1,this.groupingsOrder=e.groupingsOrder,this.sortColumns=e.sortColumns,this.sortFunctions=e.sortFunctions,this.sortColumnsForCaseInsensitiveSort=e.sortColumnsForCaseInsensitiveSort,this.sortFunctionsMap=_.reduce(this.sortColumns,function(e,t,i){return o.sortFunctions&&_.isFunction(o.sortFunctions[i])&&(e[t.sortCol]=o.sortFunctions[i]),e},{}),this.gridEventSubscribers=e.gridEventSubscribers,this.dataViewFilter=e.dataViewFilter,this.removedColumnInfoCache=new w.Collection([]),this.$el.html(j.app()),this.viewModel=new X,this.columnInfo=new w.Collection([],{comparator:"index"}),this.$pnlGrid=this.$(".pnlGrid"),this.editorModule=new f(this),this.filteringModule=new E(this),this.highlightingModule=new I(this),this.groupingModule=new Ke(this),this.layoutModule=new $e(this),this.pagerModule=new it(this),this.queryStatusModule=new Ue(this),this.rawModeModule=new je(this),this.scrollingModule=new Ye(this),this.selectionModule=new Xe(this),this.sortingModule=new qe(this),this.themeModule=new We(this),this.tooltipModule=new Qe(this),this.sparklinesManager=new D,this.viewstateTrackingModule=new Je(this),this.summaryRowModule=new rt(this),this.printModule=new lt(this),this.resetPreviousValuesMap(),this.initEvents(),this.globalPalette=_.get(e,"dashboardAppModel")?e.dashboardAppModel.get("globalPalettes"):null,this.globalPalette&&this.api.setProperty("possiblePalettes",_.map(_.uniqBy(this.globalPalette,"rule"),"rule"))},manageDiffMaps:function(e){e&&e.reset&&this.resetPreviousValuesMap(),this.previousValuesMapPending&&(this.previousValuesMap=this.previousValuesMapPending,this.previousValuesMapPending=null),e.remove&&(this.highlightingModule.hasPreviousValueInAnyRule()||this.highlightingModule.showArrowsOrHighlightOnChange())&&_.each(e.remove,function(e){e=e[this.SLICKGRID_ROW_UNIQUE_ID],e=this.atomizeTemporal(e);delete this.previousValuesMap[e],delete this.diffValuesMap[e]}.bind(this))},atomizeTemporal:function(e){return null!==e&&"object"==typeof e&&void 0!==e.i?void 0===e.n?""+e.i:e.i+"_"+e.n:e},cloneDeep_processViewStates:function(e){return _.cloneDeepWith(e,function(e){if(e instanceof w.Model)return e.get("value")})},columnIsInstantEditable:function(e){var t;if(e&&this.editorModule.checkUpdateQueryExists())return t=this.columnInfo.get(e.field),"instant"===this.viewModel.get("Basics.EditMode")&&1===t.get("kdbType")&&!e._dashboardConfig.IsReadonly},correctWidthWeights:function(e,t){var i,o,n=!1,t=t||!1,a={},r=_.filter(e,{Hidden:!1}),r=_.filter(_.map(r,"WidthWeight")),r=_.partition(r,function(e){return e<30}),l=r[0],r=r[1];function s(e,t,i){a["ColumnsConfiguration."+t+".WidthWeight"]=e.WidthWeight=i}return 0<l.length&&0<r.length&&(n=!0,l.length>r.length?(i=_.max(l),_.each(e,function(e,t){e.WidthWeight&&30<=e.WidthWeight&&s(e,t,i)})):(o=_.min(r),_.each(e,function(e,t){e.WidthWeight&&e.WidthWeight<30&&s(e,t,o)}))),t?(this.viewModel.set({ColumnsConfiguration:null},{silent:!0}),this.api.setProperty("ColumnsConfiguration",e)):n&&(this.viewModel.set({ColumnsConfiguration:null},{silent:!0}),_.each(a,function(e,t){this.api.setProperty(t,e,{silent:!0})}.bind(this)),this.onSettingsChange({ColumnsConfiguration:e})),t||n},destroyGrid:function(){this.grid&&(this.filteringModule.unsubscribeFromEvents(),this.pagerModule.removePager(),this.grid.onContextMenu.unsubscribe(),this.grid.destroy(),this.grid=null,this.columnFields=null,this.RAW_MODE&&this.rawModeModule.reset(),this.dataView&&this.dataView.destroy&&this.dataView.destroy(),this.dataView=null)},getColumnsWithRulesApplied:function(r,e,l,s){var d=this;return _.isNil(e)||_.isNil(r)||_.isNil(s)?[]:(e.forEach(function(e,t){var i,o,n=d.viewModel.get(r+"."+t+".RuleSource"),a=d.viewModel.get(r+"."+t+".RuleTarget");a&&(i=d.viewModel.get(r+"."+t+".RuleValue"),o=v.Tools.getRegex(a),s.forEach(function(e,t){a&&(a.toLowerCase()===e.toLowerCase()||e.match(o))&&(l[t][n]=i)}))}),l)},initEvents:function(){var t=this;this.listenTo(this.viewModel,"change:Basics.Data",this.onChange_Data),this.listenTo(this.viewModel,"change:Basics.FooterData",this.onChange_FooterData),this.listenTo(this.viewModel,"change:Basics.ExperimentalMode",this.onChange_ExperimentalMode),this.listenTo(this.viewModel,"change:Basics.LazyDataLoading",this.onChange_DataRelated),this.listenTo(this.viewModel,"change:ColumnsConfiguration",this.generateDataGridFromReceivedData),this.listenTo(this.viewModel,"change:OverrideRules",this.generateDataGridFromReceivedData),this.listenTo(this.viewModel,"change:HierarchicalRules",this.generateDataGridFromReceivedData),this.listenTo(this.viewModel,"change:UseHierarchicalRules",this.generateDataGridFromReceivedData),this.listenTo(this.dashboardViewModel,"change:HierarchicalRules",function(e){e=null==(e=e.get("HierarchicalRules"))?void 0:e.GridHierarchicalRules;t.onSettingsChange({HierarchicalRules:e})}),this.listenTo(this.viewModel,"change:Tooltip.Position",this.generateDataGridFromReceivedData),this.listenTo(this.pagerModule,"paged",this.onPage),this.listenTo(this.viewModel,"change:HeaderGroup",this.generatePossibleHeaderColumns),this.listenTo(this.viewModel,"change:Selection.SelectOnCheckOnly",this.onSelectOnCheckOnly),this.listenTo(this.viewModel,"change:Basics.FrozenColumnCount",this.generateDataGridFromReceivedData)},insertIntoDataView:function(e){var i,o,n,a,r,l=this,t=this.grid.getSortColumns();t&&t[0]&&(i=t[0].sortAsc,o=(t[0].columnId?_.find(this.columnsConfig,{id:t[0].columnId}):t[0].sortCol).field),o&&(a=this.sortFunctionsMap[o]?(n=this.sortFunctionsMap[o],this.orderBookMode&&!i?function(e,t){return-n(e,t[o],-1)}:function(e,t){return n(e,t[o],1)}):(t=this.getKdbTypeFromColumn(o),b.getComparator(t,function(e){return e[o]})),r=this.dataView.getItems(),i||(r=r.slice().reverse()),_.each(e,function(e){_.each(e,function(e){var t=b.binarySearch2(e[o],r,a);t<0&&(t=Math.abs(t)-1),i||(r.splice(t,0,e),t=r.length-t-1),l.dataView.insertItem(t,e)})}))},onChange_Data:function(){var e,t,i,o,n;this.editorModule.stopListeningToCurrentDataModel(),this.unsubscribeModel(),this.queryStatusModule.remove(),this.model=this.viewModel.get("Basics.Data")||null,this.sortingModule.resetSortingSpec(),this.filteringModule.resetColumnFiltersMap(),this.columnInfo.reset(),this.removedColumnInfoCache.reset(),this.queryStatusModule.initializeQueryStatusHandler(this.model),this.model?(this.editorModule.checkIfEditable(),this.viewModel.isLazyDataLoadingOn()&&(e=(o=this.viewModel.get("Basics")).SortColumn,t=o.SortOrder,o=o.ScrollValueV||0,n=this.viewModel.get("Style"),n=Math.max(1,Math.ceil((this.$pnlGrid.height()-n.HeaderRowHeight)/n.RowHeight)),i=null,o=Math.max(0,o-Math.ceil(+n)),n=3*n,e&&((i={})[e]="descending"!==t),e={_lazyLoading:!0,_forceReset:!1,_pageSize:n,_pageSort:i,_pagingNum:o,_pagingType:this.viewModel.getDeltaPagingType(),_serverPaging:!0}),this.api.subscribe(this.model,_.bind(this.onData,this),this.RAW_MODE,e)):(this.resetLayout(),this.trigger("model-unset"))},onChange_DataRelated:function(){this.viewModel.get("Basics.Data")&&this.onChange_Data()},onChange_ExperimentalMode:function(){this.RAW_MODE=this.viewModel.get("Basics.ExperimentalMode"),this.onChange_DataRelated()},onData:function(e,i,t){var o,n,a,r,l=this,s=!1,d=!1,u=!1,c=!1;if(this.viewModel.isLazyDataLoadingOn()&&this.model&&!this.model.get("_lazyLoading"))this.onChange_Data();else{if(this.RAW_MODE=_.has(i,"cols"),this.rawModeModule.switchDataviewGetters(),this.skipGridGeneration=!1,this.trigger("data-loaded"),i=_.clone(i),this.manageDiffMaps(i),this.sortingModule.setDataChangeSet(i),this.currentPagingInfo=e.paging,o=e.columns,n=this.dataView?this.dataView.getItems().length:0,this.filteringModule.isProcessedServerSide&&this.isChangeSetEmpty(o)&&i.reset&&0===n){if(0===i.reset.length)return;i.add=i.reset,delete i.reset}if(o.reset&&o.reset.length&&this.isChangeSetEmpty(i)&&(i.reset=[]),t&&(this.columnsToRemoveOnNextRun=o.remove||this.columnsToRemoveOnNextRun,o={},c=this.previousOnDataWasError=!0),!c&&this.previousOnDataWasError&&o&&(o.remove=this.columnsToRemoveOnNextRun,o.add=o.reset,delete o.reset,this.previousOnDataWasError=!1,this.columnsToRemoveOnNextRun=null),this.orderBookMode&&this.columnInfo.length&&e.columns&&delete e.columns.reset,(_.isUndefined(this.viewModel.get("ColumnsConfiguration"))||this.viewModel.get("ColumnsConfiguration")&&0===this.viewModel.get("ColumnsConfiguration").length)&&(this.regenerateColumnsConfiguration=!0),this.resortRequired=!1,this.groupingModule.setDataRefresh(!0),this.onDataFirstPassCheck){if(e.columns&&e.columns.reset&&0===e.columns.reset.length&&i.reset&&0===i.reset.length)return}else if(this.onDataFirstPassCheck=u=!0,e.columns&&e.columns.reset&&0===e.columns.reset.length&&i.reset&&0===i.reset.length)return;e.primaryKey!==this.primaryKey&&(this.primaryKey=e.primaryKey,this.SLICKGRID_ROW_UNIQUE_ID=this.primaryKey,s=!0),a=i.reset&&o.change&&void 0===i.change&&void 0===i.add&&void 0===i.remove&&void 0===o.reset&&void 0===o.add&&void 0===o.remove,o.reset?(this.editorModule.isEditable&&this.editorModule.toggleEditMode(!1),this.columnInfo.reset(e.columns.reset),u||this.ignoreMetaChanges||(this.regenerateColumnsConfiguration=!0),this.removedColumnInfoCache.reset()):(this.viewModel.get("Basics.KeepNonExistentColumns")?(this.removedColumnInfoCache.add(o.remove),this.removedColumnInfoCache.remove(_.map(o.add,function(e){return e.id}))):(this.columnInfo.remove(_.map(o.remove,function(e){return e.id})),o.remove&&o.remove.length&&(d=!0)),this.columnInfo.add(o.add),o.add&&o.add.length&&(d=!0),a||this.columnInfo.add(o.change,{merge:!0}),o.change&&this.columnInfo.set(o.change,{add:!1,remove:!1})),_.some(["add","remove","reset"],function(e){return void 0!==o[e]})&&((a=(u=this.columnInfo.pluck("id")).slice(0)).push("*"),(r=u.slice(0)).unshift(""),this.api.setProperty("datagridPossibleColumns",u),this.api.setProperty("datagridPossibleColumnsWithItself",_.concat("<this>",u)),this.api.setProperty("selectedColumnPossibleValues",u),this.api.setProperty("highlightTargetPossibleValues",a),this.api.setProperty("sortingPossibleValues",r)),this.columnInfo.sort(),this.onDataTriggered&&(s?this.sortingModule.resetSortingSpec():this.sortingModule.storeSortingSpec()),this.onDataTriggered=!0,this.RAW_MODE?(u=this.viewModel.isLazyDataLoadingOn()&&this.dataView instanceof ke&&!_.isEmpty(this.currentPagingInfo),a=this.rawModeModule.getRowData(i,u?this.currentPagingInfo.startRows:null),this.pks=a.pks,this.pkOffsetMap=a.pkOffsetMap,this.dataColsMap=a.dataColsMap,u&&(i.add=i.reset,delete i.reset,this.dataView.clear(),this.dataView.updateLength())):(this.pks=void 0,this.pkOffsetMap=void 0,this.dataColsMap=void 0),!this.editorModule.isDataviewsLengthAffectedByDeletedRows()&&n&&i.remove&&i.remove.length===n&&!this.filteringModule.isProcessedServerSide&&(i.reset=i.add||[],delete i.add,delete i.remove),(_.reduce(["add","change"],function(e,t){return i[t]?e+i[t].length:e},0)>n/10||this.grid&&(0===this.grid.getSortColumns().length||1<this.grid.getSortColumns().length)||this.viewModel.isLazyDataLoadingOn())&&(this.resortRequired=!0),c?i.reset&&this.dataView&&this.dataView.setItems(i.reset,l.SLICKGRID_ROW_UNIQUE_ID):i.reset?(this.dataToRender_usedOnlyOnce=i.reset.slice(0),this.generateDataGridFromReceivedData(),this.scrollingModule.updateScrollPosition(),this.filteringModule.resetGlobalFilter()):this.dataView&&(this.resortRequired?(this.dataView.beginUpdate(),i.remove&&i.remove.length&&(this.dataView.suspendIndexing(),this.removeItemsFromDataview(i.remove),this.dataView.reactivateIndexing()),i.change&&i.change.length&&i.change.forEach(function(e){e=e[this.primaryKey];this.dataView.updateItem_unchecked_noRefresh(e,i.collection.get(e).attributes)},this),i.add&&i.add.length&&i.add.forEach(function(e){this.dataView.addItem(e)},this)):(this.dataView.beginUpdate(),(i.remove&&i.remove.length||i.change&&i.change.length)&&(this.dataView.suspendIndexing(),i.remove&&i.remove.length&&this.removeItemsFromDataview(i.remove),i.change&&i.change.length&&(this.grid.invalidateRows(this.dataView.mapIdsToRows(_.map(i.change,this.SLICKGRID_ROW_UNIQUE_ID))),this.removeItemsFromDataview(i.change)),this.dataView.reactivateIndexing(!(!i.change||!i.change.length))),(i.add&&i.add.length||i.change&&i.change.length)&&(this.dataView.suspendIndexing(),r=_.map(i.change,function(e){return i.collection.get(e[l.primaryKey]).attributes}),this.insertIntoDataView([i.add,r]),this.dataView.reactivateIndexing(),_.each(r,function(e){this.dataView.updateItem_unchecked_noRefresh(e[l.primaryKey])}.bind(this)))),this.dataView.endUpdate(),l.regenerateColumnsConfiguration&&(i.add||i.reset||i.change)||!i.add&&!i.reset&&!i.change&&s||d?l.generateDataGridFromReceivedData():(this.summaryRowModule.updateSummmaryRow(),this.onSelectOnCheckOnly())),this.filteringModule.reapplyColumnFilters(),this.resortRequired&&(this.model.get("_serverPaging")||this.sortingModule.isInNaturalOrder()||this.dataView.reSort(),this.resortRequired=!1),this.filteringModule.isProcessedServerSide&&this.dataView&&(this.sortingModule.forceResort=!0,this.dataView.reSort(),this.sortingModule.forceResort=!1),this.viewModel.isLazyDataLoadingOn()?this.dataView&&(this.dataView.updateLength(),this.dataView.updateScrollbar(),this.dataView.onViewportChanged(),this.grid.render()):this.selectionModule.setSelectedRows(),this.pagerModule.onData(e,i,t),this.sortingModule.onData(e,i,t),this.groupingModule.setDataRefresh(!1),this.highlightingModule.processNumberDiffHighlighting(),this.highlightingModule.processMinMaxHighlighting(),(this.highlightingModule.hasPreviousValueInAnyRule()||this.highlightingModule.showArrowsOrHighlightOnChange())&&this.storeAllCurrentDataRows(),this.trigger("data-processed",t)}},generatePossibleHeaderColumns:function(){var n=this,a=this.api.getProperty("datagridPossibleHeaderColumns"),t=[];_.each(this.api.getProperty("HeaderGroup"),function(e,i){var o=n.api.getProperty("HeaderGroup."+i+".ColumnProperty");t.push(o),a.indexOf(o)<0&&_.each(n.viewModel.get("ColumnsConfiguration"),function(e,t){e.Header===a[i+1]&&n.viewModel.set("ColumnsConfiguration."+t+".Header",o)})}),this.api.setProperty("datagridPossibleHeaderColumns",_.concat("none",t))},generateDatagridColumnsConfiguration:function(){var i=this,e=this.viewModel.get("ColumnsConfiguration"),t=(i.unpackedColumnsConfiguration=null,(t=i.api.loadSetting("UsersColumnsConfiguration"))&&t.length&&((t=p.amendUserConfiguration(t,e,i.columnInfo)).length?(i.unpackedColumnsConfiguration=t,i.api.getProperty("CustomLayout.IgnoreCustomLayoutViewstate")||p.injectViewstateValuesToUnpackedConfiguration(i.unpackedColumnsConfiguration,e,i.api.getPropertyMeta)):i.api.saveSetting("UsersColumnsConfiguration",null)),i.unpackedColumnsConfiguration=i.unpackedColumnsConfiguration||_.clone(e),_.some(i.unpackedColumnsConfiguration,u.isDynamic)&&(!i.viewModel.get("Basics.KeepNonExistentColumns")&&i.removedColumnInfoCache.length&&(i.columnInfo.remove(i.removedColumnInfoCache.pluck("id")),i.removedColumnInfoCache.reset()),i.unpackedColumnsConfiguration=p.unpackColumnConfiguration(i.unpackedColumnsConfiguration,i.columnInfo)),this.editorModule.addDeleteColumnIfNecessary(i.unpackedColumnsConfiguration),i.viewModel.get("OverrideRules")),e=_.cloneDeep(i.unpackedColumnsConfiguration),o=i.unpackedColumnsConfiguration.map(function(e){return e.Field}),n=i.viewModel.get("HierarchicalRules");i.viewModel.get("Basics.UseHierarchicalRules")&&null!=n&&n.length&&(e=i.getColumnsWithRulesApplied("HierarchicalRules",n,e,o)),e=i.getColumnsWithRulesApplied("OverrideRules",t,e,o),i.columnsConfig=_.map(e,function(e,t){return ot(e,t,i)})},generateDataGridFromReceivedData:function(){var n,a,e,i,r=!1,t=!1;this.skipGridGeneration||(this.regenerateColumnsConfiguration&&(this.regenerateColumnsConfiguration=!1,e=this.viewModel.get("Basics.Data"),i=e&&e.path===s.SAMPLE_DATA,e=this.viewModel.get("ColumnsConfiguration"),n=_.map(this.columnInfo.models,function(e){var t=e.get("id"),e=e.get("kdbType");return De.generate(t,e,i)}),a=[],_.each(e,function(t){var i,e,o=u.isDynamic(t);o&&(i=u.getRegex(t).regex),e=_.filter(n,function(e){return o?i.test(e.Field):t.Field===e.Field}),n=_.difference(n,e),0<e.length||o||t.UserDefined?a.push(t):r=!0}),this.dataConfigDialogMode||r?a=_.concat(a,n):n.length&&0===a.length&&(a=n),t=!_.isEqual(e,a)),this.correctWidthWeights(t?a:this.viewModel.get("ColumnsConfiguration"),t))||(this.generateDatagridColumnsConfiguration(),this.renderDatagrid())},getAllFilteredItems:function(){var e=this.RAW_MODE&&(null==(t=this.rawModeModule)?void 0:t.getAllFilteredItems)?this.rawModeModule.getAllFilteredItems():(null==(e=null==(t=this.dataView)?void 0:t.getFilteredItems)?void 0:e.call(t))||[];if(this.api.getProperty("FileExport.IncludeRowSummary")){var t=null==(t=this.summaryRowModule)?void 0:t.rowSummaryObj;if(t)return t._rowIndex=e.length,_.flatten([e,[t]])}return e},getKdbTypeFromColumn:function(e){e=this.columnInfo.get(e);return e?e.get("kdbType"):null},getRowIxRange:function(){return e=this.grid.getRenderedRange(),_.range(e.top,e.bottom+1);var e},isChangeSetEmpty:function(e){return _.isEmpty(_.pick(e,["reset","add","change","remove"]))},onPage:function(){this.grid&&this.grid.scrollRowToTop(0)},onSettingsChange:function(e){var t=_.has(e,"Basics.Data");void 0===this.skipGridGeneration&&(this.skipGridGeneration=!0),_.each(_.omit(e,"Style.Theme","Basics.Data"),_.bind(function(e,t){this.viewModel.set(t,"ColumnsConfiguration"===t?_.cloneDeep(e):e),t===this.filteringModule.BASICS_KDB_FILTER_STRING?this.viewModel.trigger("change:"+this.filteringModule.BASICS_KDB_FILTER_STRING):"Selection.Actions"===t&&this.selectionModule.onChange_SelectionActions()},this)),t&&this.viewModel.set("Basics.Data",_.get(e,"Basics.Data")),this.skipGridGeneration&&(this.skipGridGeneration=!1,this.generateDataGridFromReceivedData()),this.viewModelLoaded||((e=null==(t=this.dashboardViewModel.get("HierarchicalRules"))?void 0:t.GridHierarchicalRules)&&e.length&&this.viewModel.set("HierarchicalRules",e),this.viewModelLoaded=!0)},refreshDataView:function(){this.dataView&&this.dataView.refresh()},registerCellExternalCopyManager:function(){var e={includeHeaderWhenCopying:!0};_.isEmpty(this.customEditors)&&this.grid.registerPlugin(new Slick.CellExternalCopyManager(e))},remove:function(){this.destroyGrid(),this.viewstateTrackingModule.remove(),this.editorModule.remove(),this.filteringModule.remove(),this.groupingModule.remove(),this.highlightingModule.remove(),this.layoutModule.remove(),this.pagerModule.remove(),this.queryStatusModule.remove(),this.scrollingModule.remove(),this.selectionModule.remove(),this.sortingModule.remove(),this.themeModule.remove(),this.tooltipModule.remove(),this.sparklinesManager.remove(),this.rawModeModule.remove(),this.summaryRowModule.remove(),this.printModule.remove(),this.unsubscribeModel(),w.View.prototype.remove.apply(this,arguments)},removeItemsFromDataview:function(e){e&&e.length&&e.forEach(function(e){this.dataView.deleteItem(e[this.primaryKey])},this)},renderDatagrid:function(){var e=this,i=this,t={},o="enabled"===i.viewModel.get("Basics.EditMode")&&i.viewModel.get("Basics.IsInsertable");if(this.dataView||this.dataToRender_usedOnlyOnce){if(this.RAW_MODE&&this.rawModeModule.modifyDataViewConfig(t),i.editorModule.hasUnmodifiedData()&&(this.dataToRender_usedOnlyOnce=i.editorModule.useUnmodifiedData()),this.dataView&&null===this.dataToRender_usedOnlyOnce)if(this.viewModel.isLazyDataLoadingOn()&&this.currentPagingInfo){if(0!==this.currentPagingInfo.startRows)return void this.onChange_DataRelated();this.dataToRender_usedOnlyOnce=[];for(var n=Number(this.currentPagingInfo.numRows),a=0;a<n;a++)this.dataToRender_usedOnlyOnce.push(this.dataView.getItem(a))}else this.dataToRender_usedOnlyOnce=this.dataView.getItems();this.editorModule.removeGridListeners(),this.summaryRowModule.set_isEnabled(!1),this.destroyGrid();var r=Math.abs(i.viewModel.get("Basics.FrozenColumnCount"))-1,o={autosizeColsMode:Slick.GridAutosizeColsMode.KxRatio,enableCellNavigation:!0,editable:i.customEditors||i.editorModule.isEditable,enableAddRow:i.editorModule.isEditable&&o,enableCellNavigation:!0,asyncEditorLoading:!1,rowHeight:i.viewModel.get("Style.RowHeight"),headerRowHeight:i.viewModel.get("Style.HeaderRowHeight"),multiColumnSort:!0,multiSelect:"Multi Row"===i.viewModel.get("Selection.Mode"),forceFitColumns:!1,autoExpandColumns:!0,forceSyncScrolling:!0,autoEdit:!0,kdbTypesColumnInfo:this.columnInfo,editorLock:new Slick.EditorLock,frozenColumn:r,suppressCssChangesOnHiddenInit:!0},r=(this.filteringModule.modifyGridConfig(o),_.extend(o,{evenRowBackgroundColorOverride:i.viewModel.get("Style.EvenRowBackgroundColorOverride"),oddRowBackgroundColorOverride:i.viewModel.get("Style.OddRowBackgroundColorOverride"),headerFontWeight:i.viewModel.get("Style.HeaderFontWeight"),fontFamily:i.viewModel.get("Style.FontFamily"),fontSize:this.themeModule.getFontSize(),cellHighlightCssClass:"highlighted",scrollLeft:this.RAW_MODE?this.rawModeModule.scrollLeft:null}),this.groupingModule.modifyConfigs(o,t),t.atomizeTemporal=this.atomizeTemporal,i.dataView=this.viewModel.isLazyDataLoadingOn()?new ke(this,t):new Slick.Data.DataView(t),this.rawModeModule.switchDataviewGetters(),i.columnFields=_.map(i.columnsConfig,"field"),_.map(i.unpackedColumnsConfiguration,function(e,t){return e.Hidden?null:i.columnsConfig[t]})),t=_.compact(r),r=(this.selectionModule.initCheckBoxColumn(t),this.viewstateTrackingModule.unsubscribeViewstateSubscribers(),this.viewstateTrackingModule.subscribeViewstateSubscribers(t),_.some(t,function(e){if(_.get(e,"_dashboardConfig.Header"))return _.get(e,"_dashboardConfig.Header")&&"none"!==e._dashboardConfig.Header}));r&&_.each(t,function(e){e.groupName="none"===_.get(e,"_dashboardConfig.Header")?" ":_.get(e,"_dashboardConfig.Header")}),this.onSelectOnCheckOnly(),i.grid=new Slick.Grid(i.$pnlGrid.get(0),i.dataView,t||[],o),i.grid.onContextMenu.subscribe(function(e){e.preventDefault();var t=i.grid.getCellFromEvent(e);i.selectionModule.onAction("Right Click",e,t)}),this.editorModule.resetLists(),this.editorModule.setUpdateTypeConfig(i.columnInfo),this.editorModule.initializeGridListeners(),this.groupingModule.registerPlugins(),i.grid.registerPlugin(new Slick.AutoTooltips({enableForHeaderCells:!0,enableForCells:"none"===this.viewModel.get("Tooltip.Position")})),r&&(i.grouping=new Slick.ColumnGroup,i.grid.registerPlugin(i.grouping),i.grouping.enableColumnGrouping()),this.tooltipModule.initRowTooltip(),this.selectionModule.registerGridSelectionModel(),i.registerCellExternalCopyManager(),i.subscribeToDataViewEvents(),i.subscribeToGridEvents(),o.explicitInitialization&&(this.filteringModule.registerColumnFilters(),i.grid.init()),"instant"===this.viewModel.get("Basics.EditMode")&&(this.$el.find(".slick-header-columns").on("sortcreate",function(){return e.editorModule.refreshSelectAllState()}),this.editorModule.refreshSelectAllState(!0)),i.dataView.beginUpdate(),i.dataView.setItems(this.dataToRender_usedOnlyOnce,i.SLICKGRID_ROW_UNIQUE_ID),this.dataToRender_usedOnlyOnce=null,this.filteringModule.registerDataViewFilter(),i.dataView.endUpdate(),this.RAW_MODE&&(this.selectionModule.onChange_SelectionColumn(),this.rawModeModule.populateFields(this.highlightingModule.getHighlightingFields(),"highlighting"),this.rawModeModule.populateFields(this.summaryRowModule.getSummaryRowFields(),"summaryRow")),this.pagerModule.initPager(this.model&&this.model.get("_serverPaging"),function(){i.sortingModule.initDefaultSortings(),i.sortingModule.triggerSorting()}),i.groupingModule.groupingChanged(!0),this.RAW_MODE&&this.rawModeModule.resetVerticalScrollValues(),this.summaryRowModule.set_isEnabled(!0),this.summaryRowModule.updateSummmaryRow(!0),this.trigger("datagrid-rendered")}},onScrollHorizontalAdjust:function(){var e=this.grid,t=e.getCanvasWidth(),i=e.getViewport(),o=e.getViewportNode(),i=i&&_.get(i,"rightPx")?i.rightPx:0,e=e.getDisplayedScrollbarDimensions(),e=_.get(e,"width")?_.get(e,"width"):0,n=_.get(o,"scrollWidth")?_.get(o,"scrollWidth"):0,o=_.get(o,"clientWidth")?_.get(o,"clientWidth"):0,i=i-t,t=0<=i&&i<=(n-o!=0?e:0)?i:0,n=this.$el.find(".slick-headerrow .slick-headerrow-columns");n.length&&n.css({right:t})},onSelectOnCheckOnly:function(){var t=this.viewModel.get("Selection.SelectOnCheckOnly"),i=this;this.dataView&&!this.RAW_MODE&&(this.dataView.getItemMetadata=function(e){e=i.dataView.getItem(e);return void 0===e?null:e.__group?i.groupingModule.groupItemMetadataProvider.getGroupRowMetadata(e):e.__groupTotals?i.groupingModule.groupItemMetadataProvider.getTotalsRowMetadata(e):{selectable:!t}})},resetLayout:function(){this.dataToRender_usedOnlyOnce=[],this.renderDatagrid()},resetPreviousValuesMap:function(){this.previousValuesMapPending=null,this.previousValuesMap={},this.diffValuesMap={}},storeAllCurrentDataRows:function(){var n,a,r=this.dataView;r&&(a=this.highlightingModule.getHighlightingFields()).length&&(n=r.getOptions&&r.getOptions().populateItem,this.previousValuesMapPending=_.mapValues(r.getInternalMap_idxById(),function(e,t){var i=r.getItemByIdx(e),o={};return n&&(i=n(i)),_.forEach(a,function(e){o[e]=_.cloneDeep(i[e]),this.previousValuesMap&&this.previousValuesMap[t]&&void 0!==this.previousValuesMap[t][e]&&(this.diffValuesMap[t]=this.diffValuesMap[t]||{},_.isEqual(o[e],this.previousValuesMap[t][e])||(this.diffValuesMap[t][e]=this.previousValuesMap[t][e]))}.bind(this)),o}.bind(this)))},subscribeToDataViewEvents:function(){var i=this;i.dataView.onPagingInfoChanged.subscribe(function(e,t){i.highlightingModule.processMinMaxHighlighting_debounced()}),i.dataView.onRowCountChanged.subscribe(function(e,t){i.grid.updateRowCount()}),i.dataView.onRowsChanged.subscribe(function(e,t){i.grid.invalidateRows(t.rows),i.grid.render(),i.sparklinesManager.refresh(),i.highlightingModule.processMinMaxHighlighting_debounced(),i.summaryRowModule.updateSummmaryRow(),i.groupingModule.saveGroupingState()})},subscribeToGridEvents:function(){this.scrollingModule.subscribeToScrollEvent(),this.sortingModule.subscribeToSortEvent(),this.groupingModule.fixColumnReorderingLayoutIssue(),this.layoutModule.subscribeToColumnsResizeEvent(),_.each(this.gridEventSubscribers,_.bind(function(e){e.apply(this)},this))},unsubscribeModel:function(){this.model&&(this.stopListening(this.model),this.api.unsubscribe(this.model))},onChange_FooterData:function(){var e=this.viewModel.get("Basics.FooterData");e!==this.footerDataModel&&(this.footerFieldValues=[]),this.footerDataModel&&(this.stopListening(this.footerDataModel),this.api.unsubscribe(this.footerDataModel)),(this.footerDataModel=e)?this.footerDataModel&&this.footerDataModel.attributes?(this.initializeErrorHandler(this.footerDataModel),this.api.subscribe(this.footerDataModel,this.onFooterData.bind(this))):this.api.showErrorMessage({error:t('Invalid Data Source: "')+e.path+'" '+t("visible"),errorType:"Warning"}):this.resetColumnFooters(l)},initializeErrorHandler:function(e){var t=this;this.updateErrorMessage(),this.listenTo(e,"change:error",function(){t.updateErrorMessage()})},updateErrorMessage:function(){this.footerDataModel&&this.footerDataModel.get("error")?this.api.showErrorMessage(this.footerDataModel.get("error")):this.api.hideErrorMessage()},resetColumnFooters:function(i,e){var o,n=this,t=this.viewModel.get("ColumnsConfiguration");t&&(o=!1,_.each(t,function(e,t){_.includes(i,e.Footer)||(n.api.setProperty("ColumnsConfiguration."+t+".Footer","None",{silent:!0}),e.Footer="None",o=!0)}),o||e)&&(this.viewModel.set({ColumnsConfiguration:null},{silent:!0}),this.onSettingsChange({ColumnsConfiguration:t}))},onFooterData:function(e,t,i){t.reset&&0<t.reset.length&&(this.footerFieldValues=t.reset[0],t=this.api.getProperty("footerPossibleValues"),this.resetColumnFooters(_.concat(l,t),!0))}},{getComponentDefinition:s.getComponentDefinition,getSettingsModel:s.getSettingsModel,getColumnSettingsModel:s.getColumnSettingsModel,getDefaultJSONTemplates:s.getDefaultJSONTemplates,mergeWithDefault:s.mergeWithDefault});return V.Master=V.extend(L),V});