define(["backbone","Forms","Handlebars","QuickBase","log","css!./css/main.css"],function(l,r,n,a,z){"use strict";var o,e=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),c=this&&this.__assign||function(){return(c=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},R=(s.transformFn=function(i,e,t,o){"Basics.Data"===t&&(i.Basics.Data?i.Basics.Data.getMeta(function(e){var e=_.fromPairs(_.map(e.columns.collection.models,function(e){return[e.get("id"),e.toJSON()]})),t=_.keys(e),e=_.find(e,function(e){return 0===e.kdbType||11===e.kdbType});i.dropdownPossibleValues&&i.dropdownPossibleValues.sort()!==t.sort()&&(i.dropdownPossibleValues=t,i.Basics.DataSourceMapping.Value=t[0]||"",i.Basics.DataSourceMapping.Text=e&&e.id||t[0]||""),i.dropdownPossibleValuesWithEmpty=_.concat([""],i.dropdownPossibleValues),o(i)}):(i.dropdownPossibleValues=[],i.dropdownPossibleValuesWithEmpty=[],i.Basics.DataSourceMapping.Value="",i.Basics.DataSourceMapping.Text="",o(i))),"root"===t&&(i.Basics.MultiSelect&&(e.properties.Basics.properties.SelectAllByDefault.options={hidden:!1}),o(i,e)),"Basics.MultiSelect"===t?(i.Basics.MultiSelect?(i.Basics.SelectAllByDefault=!1,e.properties.Basics.properties.SelectAllByDefault.options={hidden:!1}):e.properties.Basics.properties.SelectAllByDefault.options={hidden:!0},o(i,e)):o()},s.getDefinition=function(e){var t,i,o={id:16,componentName:"Dropdown",componentDescription:"classic combobox",appKey:"BasicComponents",listViewThumb:e.websiteUrl+"Images/dropdown.png",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{version:"4.7.7.2",dropdownPossibleValues:[""],Basics:{Name:"",Data:"",SelectedValue:"",ComponentName:"Dropdown",DataSourceMapping:{Value:"",Text:""},GroupMapping:{Group:!1,GroupBy:""},Items:[],Width:100,Theme:"Dark",Label:"select:",LabelWidth:75,MultiSelect:!1,SelectAllByDefault:!1,ShowSearch:!1,AdvancedSearch:!1,AcceptEmptyValues:!1,ForceSelectedValue:!1,FieldSummaryThreshold:5,TooltipSummaryThreshold:10,SelectAllValue:"",horizontal:"Center",vertical:"Middle",tooltip:"",SortListBySelected:!1,Custom:{Icon:"",IconColor:""}},Actions:[],Style:{advanced:""}},schema:{type:"object",title:"Properties",_transform:s.transformFn,properties:{dropdownPossibleValues:{type:"array",format:"table",items:{type:"string"},default:[""],options:{collapsed:!1,hidden:!0}},dropdownPossibleValuesWithEmpty:{type:"array",format:"table",items:{type:"string"},default:[""],options:{collapsed:!1,hidden:!0}},Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{Name:{title:"Name",type:"string",tooltip:a.ComponentPropertyTooltip.getTooltip("Name"),default:"",propertyOrder:1},Data:{type:"data",title:"Data Source",default:"",propertyOrder:1},SelectedValue:{type:"viewstate",title:"Selected Value",default:"",propertyOrder:2},Label:{title:"Label",tooltip:a.ComponentPropertyTooltip.getTooltip("Label"),type:"string",default:"select:",propertyOrder:3},AcceptEmptyValues:{type:"boolean",title:"Accept Empty Values",tooltip:a.ComponentPropertyTooltip.getTooltip("AcceptEmptyValues")+a.ComponentPropertyTooltip.getTooltip("AcceptEmptyValuesNote"),default:!1,format:"checkbox",propertyOrder:5},ForceSelectedValue:{type:"boolean",title:"Force Selected Value",default:!1,format:"checkbox",propertyOrder:6},MultiSelect:{type:"boolean",title:"Multi-select",default:!1,format:"checkbox",propertyOrder:7},SelectAllByDefault:{type:"boolean",title:"Select All by Default",default:!1,format:"checkbox",propertyOrder:7,options:{hidden:!0}},ShowRowCount:{type:"boolean",title:"Show row count",default:!1,format:"checkbox",propertyOrder:7,options:{hidden:!0}},ShowSearch:{type:"boolean",title:"Show Search",tooltip:a.ComponentPropertyTooltip.getTooltip("ShowSearch"),default:!1,format:"checkbox",propertyOrder:8},AdvancedSearch:{type:"boolean",title:"Advanced Search",tooltip:a.ComponentPropertyTooltip.getTooltip("AdvancedSearch"),default:!1,format:"checkbox",propertyOrder:8},Flex:{type:"boolean",title:"Fill available space",default:!1,format:"checkbox",propertyOrder:9,options:{hidden:!0}},horizontal:{type:"string",title:"Horizontal",enum:["Left","Center","Right"],propertyOrder:9},vertical:{type:"string",title:"Vertical",enum:["Top","Middle","Bottom"],propertyOrder:10},tooltip:{title:"Tooltip",type:"string",default:"",propertyOrder:11},Width:{title:"Width",type:"number",propertyOrder:12},EnableDropdownHeight:{type:"boolean",title:"Enable Dropdown Height",default:!1,format:"checkbox",propertyOrder:12,options:{hidden:!0}},DropdownHeight:{title:"Dropdown Height",type:"number",propertyOrder:12,options:{hidden:!0}},LabelWidth:{title:"Label Width",type:"number",default:100,propertyOrder:13},FieldSummaryThreshold:{title:"Field Summary Threshold",tooltip:a.ComponentPropertyTooltip.getTooltip("FieldSummaryThreshold"),type:"number",propertyOrder:14},TooltipSummaryThreshold:{title:"Tooltip Summary Threshold",tooltip:a.ComponentPropertyTooltip.getTooltip("TooltipSummaryThreshold"),type:"number",propertyOrder:15},SelectAllValue:{title:"'Select All' Value",type:"string",propertyOrder:16},SortListBySelected:{type:"boolean",title:"Sort List by Selected",tooltip:a.ComponentPropertyTooltip.getTooltip("SortListBySelected"),default:!1,format:"checkbox",propertyOrder:16},ComponentName:{title:"Component",type:"string",default:"Dropdown",options:{hidden:!0}},Theme:{type:"string",title:"Theme",options:{hidden:!0},enum:["Light","Dark"]},DataSourceMapping:{type:"object",title:"Data Source Mapping",options:{collapsed:!0},properties:{Value:{type:"string",enumSource:"possibleValues",watch:{possibleValues:"root.dropdownPossibleValues"},default:""},Text:{type:"string",enumSource:"possibleValues",watch:{possibleValues:"root.dropdownPossibleValues"},default:""}},propertyOrder:17},Items:{type:"array",format:"table",title:"Items",uniqueItems:!0,options:{collapsed:!0},items:{type:"object",properties:{Value:{type:"string"},Text:{type:"string"},DropdownValue:{options:{hidden:!0}}}},propertyOrder:19},Custom:{type:"object",title:"Custom",options:{collapsed:!0},properties:{Icon:{default:"",enumSource:"possibleValues",title:"Icon",type:"string",watch:{possibleValues:"root.dropdownPossibleValuesWithEmpty"}},IconColor:{default:"",enumSource:"possibleValues",title:"Icon Color",type:"string",watch:{possibleValues:"root.dropdownPossibleValuesWithEmpty"}}},propertyOrder:20},GroupMapping:{type:"object",title:"Grouping",options:{collapsed:!0},properties:{Group:{type:"boolean",title:"Use Group By",default:!1,format:"checkbox"},GroupBy:{type:"string",title:"Group By",enumSource:"possibleValues",watch:{possibleValues:"root.dropdownPossibleValues"},default:""}},propertyOrder:18}}},Actions:{type:"actions",options:{collapsed:!0},fields:{map:{Current:{title:"Source Column",type:"string",enumSource:"possibleColumns",watch:{possibleColumns:"root.dropdownPossibleValues"},default:"",propertyOrder:10}}}},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{advanced:{type:"css",title:"Advanced CSS",default:""}}}}}}};if(0<_.keys(e.settingsModel.attributes).length)for(i=s.upgrades.indexOf(_.find(s.upgrades,{version:e.settingsModel.get("version")}))+1;i<s.upgrades.length;i+=1)(t=s.upgrades[i]).fn(e.settingsModel),e.settingsModel.set("version",t.version);return o},s);function s(){}R.upgrades=[{version:"4.0.0p2",fn:function(e){var t=e.get("Basics"),i=void 0===(i=e.get("Style"))?{}:i;t.Flex=void 0!==t.Flex&&t.Flex,e.set("Basics",t),e.set("Style",i)}},{version:"4.0.2",fn:function(e){var t=e.get("Basics");t.ShowRowCount=void 0===t.ShowRowCount?t.MultiSelect:t.ShowRowCount,t.EnableDropdownHeight=!1,t.DropdownHeight=100,e.set("Basics",t)}},{version:"4.1.0s2",fn:function(e){e.unset("Basics.EnableDropdownHeight"),e.unset("Basics.DropdownHeight"),e.unset("Basics.Flex"),e.unset("Basics.ShowRowCount"),e.set("Basics.FieldSummaryThreshold",5),e.set("Basics.TooltipSummaryThreshold",10),e.set("Basics.SelectAllValue","")}},{version:"4.3.1",fn:function(e){var t=_.map(e.get("Basics.SelectedObjectRouting"),function(e){return{_Type:"map",Current:e.ColumnProperty,Target:e.ViewstateProperty}});e.set("Actions",t),e.unset("Basics.SelectedObjectRouting")}},{version:"4.4.1",fn:function(e){e.unset("Basics.UseDataSource")}},{version:"4.5.0",fn:function(e){e.get("Basics.AdvancedSearch")||e.set("Basics.AdvancedSearch",!1)}},{version:"4.7.6",fn:function(e){e.get("Basics.SortListBySelected")||e.set("Basics.SortListBySelected",!1),e.get("Basics.Custom")||e.set("Basics.Custom",{Icon:"",IconColor:""}),e.get("dropdownPossibleValues")&&_.isNil(e.get("dropdownPossibleValuesWithEmpty"))&&e.set("dropdownPossibleValuesWithEmpty",_.concat([""],e.get("dropdownPossibleValues")))}},{version:"4.7.7",fn:function(e){e.get("Basics.Name")||e.set("Basics.Name","")}},{version:"4.7.7.1",fn:function(e){e.set("Basics.ComponentName","Dropdown")}},{version:"4.7.7.2",fn:function(e){e=e.get("Basics");e.GroupMapping=_.isNil(e.GroupMapping)?{Group:!1,GroupBy:""}:e.GroupMapping}},{version:"2.12.0",fn:function(e){e.get("Basics.SelectAllByDefault")||e.set("Basics.SelectAllByDefault",!1)}}];p.transformFn=function(e,t,i,o){"Basics.UseDataSource"===i&&(e.Basics.UseDataSource?(e.Basics.ItemActionEvent="None",t.properties.Basics.properties.ItemActionEvent.options={hidden:!0}):t.properties.Basics.properties.ItemActionEvent.options={hidden:!1},o(e,t)),"root"===i&&(e.Basics.MultiSelect&&(t.properties.Basics.properties.DoubleClick.options={hidden:!1}),o(e,t)),"Basics.MultiSelect"===i?(e.Basics.MultiSelect?(e.Basics.DoubleClick=!1,t.properties.Basics.properties.DoubleClick.options={hidden:!1}):t.properties.Basics.properties.DoubleClick.options={hidden:!0},o(e,t)):o()},p.getDefinition=function(e){var t,i,o={id:34,componentName:"SelectionControls",componentDescription:"classic radio buttons",appKey:"BasicComponents",listViewThumb:"fa fa-check-circle",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{version:"v2.9.0",dropdownPossibleValues:[],Basics:{Name:"",Data:"",SelectedValue:"",ComponentName:"SelectionControls",DataSourceMapping:{},Items:[{Text:"item 1",Value:"value 1"},{Text:"item 2",Value:"value 2"},{Text:"item 3",Value:"value 3"}],Theme:"Dark",Label:"select:",LabelWidth:75,MultiSelect:!1,DoubleClick:!1,UseDataSource:!1,AcceptEmptyValues:!1,ForceSelectedValue:!1,ItemActionEvent:"None",ItemsLayout:"Horizontal",horizontal:"Center",vertical:"Middle"},Actions:[],Style:{advanced:"",labelTemplate:""}},schema:{type:"object",title:"Properties",_transform:p.transformFn,properties:{dropdownPossibleValues:{type:"array",format:"table",items:{type:"string"},default:[""],options:{collapsed:!1,hidden:!0}},Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{Name:{title:"Name",tooltip:a.ComponentPropertyTooltip.getTooltip("Name"),type:"string",default:"",propertyOrder:1},Data:{type:"data",title:"Data Source",default:"",propertyOrder:2},SelectedValue:{type:"viewstate",title:"Selected Value",default:"",propertyOrder:3},Label:{title:"Label",tooltip:a.ComponentPropertyTooltip.getTooltip("Label"),type:"string",default:"select:",propertyOrder:4},UseDataSource:{type:"boolean",title:"Use Data Source",default:!1,format:"checkbox",propertyOrder:5},AcceptEmptyValues:{type:"boolean",title:"Accept Empty Values",tooltip:a.ComponentPropertyTooltip.getTooltip("AcceptEmptyValues"),default:!1,format:"checkbox",propertyOrder:6},ForceSelectedValue:{type:"boolean",title:"Force Selected Value",default:!1,format:"checkbox",propertyOrder:7},MultiSelect:{type:"boolean",title:"Multi-select",default:!1,format:"checkbox",propertyOrder:8},DoubleClick:{type:"boolean",title:"Double Click",default:!1,format:"checkbox",propertyOrder:9,options:{hidden:!0}},ItemsLayout:{type:"string",title:"Items Layout",enum:["Horizontal","Vertical"],propertyOrder:10},horizontal:{type:"string",title:"Horizontal",enum:["Left","Center","Right"],propertyOrder:11},vertical:{type:"string",title:"Vertical",enum:["Top","Middle","Bottom"],propertyOrder:12},LabelWidth:{title:"Label Width",type:"number",default:100,propertyOrder:13},ComponentName:{title:"Component",type:"string",default:"SelectionControls",options:{hidden:!0}},ItemActionEvent:{type:"string",title:"Item Action Event",enum:["None","Always","Index","Value"],propertyOrder:14},Theme:{type:"string",title:"Theme",options:{hidden:!0},enum:["Light","Dark"]},DataSourceMapping:{type:"object",title:"Data Source Mapping",options:{collapsed:!0},properties:{Value:{type:"string",enumSource:"possibleValues",watch:{possibleValues:"root.dropdownPossibleValues"},default:""},Text:{type:"string",enumSource:"possibleValues",watch:{possibleValues:"root.dropdownPossibleValues"},default:""}},propertyOrder:15},Items:{type:"array",format:"table",title:"Items",uniqueItems:!0,options:{collapsed:!0},items:{type:"object",properties:{Value:{type:"string"},Text:{type:"string"},DropdownValue:{options:{hidden:!0}}}},propertyOrder:16}}},Actions:{type:"actions",options:{collapsed:!0},fields:{map:{Current:{title:"Source Column",type:"string",enumSource:"possibleColumns",watch:{possibleColumns:"root.dropdownPossibleValues"},default:"",propertyOrder:10}}}},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{advanced:{type:"css",title:"Advanced CSS",default:""},labelTemplate:{type:"handlebar",title:"Label Template",default:""}}}}}}};if(0<_.keys(e.settingsModel.attributes).length)for(i=p.upgrades.indexOf(_.find(p.upgrades,{version:e.settingsModel.get("version")}))+1;i<p.upgrades.length;i+=1)(t=p.upgrades[i]).fn(e.settingsModel),e.settingsModel.set("version",t.version);return o};var F=p;function p(){}F.upgrades=[{version:"4.3.1",fn:function(e){e.get("Actions")||e.set("Actions",[])}},{version:"4.3.1p2",fn:function(e){var t=_.map(e.get("Basics.SelectedObjectRouting"),function(e){return{_Type:"map",Current:e.ColumnProperty,Target:e.ViewstateProperty}});e.set("Actions",t.concat(e.get("Actions"))),e.unset("Basics.SelectedObjectRouting")}},{version:"4.7.4",fn:function(e){e=e.get("Basics");e.ItemActionEvent=_.isNil(e.ItemActionEvent)?"None":e.ItemActionEvent}},{version:"4.7.7",fn:function(e){e.get("Basics.Name")||e.set("Basics.Name","")}},{version:"4.7.7.1",fn:function(e){e.set("Basics.ComponentName","SelectionControls")}},{version:"v2.9.0",fn:function(e){_.isNil(e.get("Basics.DoubleClick"))&&e.set("Basics.DoubleClick",!1)}}];var d=a.Tools,H=(h.getComponentDefinition=function(e){var t,i={},o={Trigger:{default:"Click",enum:["Click","Hover"],propertyOrder:2,title:"Trigger Action",type:"string"}};switch(e.componentId){case 15:i={id:15,componentName:"date picker",componentDescription:"control for changing date",appKey:"BasicComponents",listViewThumb:e.websiteUrl+"Images/calendar.png",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{version:"v2.9.0",Basics:{ComponentName:"DatePicker",Name:"",Data:"",Label:"pick date:",SelectedDate:"",Theme:"Dark",horizontal:"Center",vertical:"Middle",tooltip:"",width:100,labelWidth:75},Actions:[],Style:{advanced:""}},schema:{type:"object",title:"Properties",properties:{Basics:{type:"object",title:"Basics",properties:{Name:{title:"Name",type:"string",default:""},Label:{title:"Label",type:"string",default:"pick date:"},Data:{title:"Data Source",type:"data",default:""},SelectedDate:{title:"Selected Date",type:"viewstate",default:""},Theme:{type:"string",title:"Theme",options:{hidden:!0},enum:["Light","Dark"]},DashboardTheme:{options:{hidden:!0}},ComponentName:{title:"Component",type:"string",default:"DatePicker",options:{hidden:!0}},horizontal:{type:"string",title:"Horizontal",enum:["Left","Center","Right"]},vertical:{type:"string",title:"Vertical",enum:["Top","Middle","Bottom"]},tooltip:{title:"Tooltip",type:"string",default:""},width:{title:"Width",type:"number",default:100},labelWidth:{title:"Label Width",type:"number",default:100}}},Actions:{type:"actions"},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{advanced:{type:"css",title:"Advanced CSS",default:""}}}}}}};break;case 16:i=R.getDefinition(e);break;case 17:i={id:17,componentName:"label",componentDescription:"Basic labels, headers and paragraphs.",appKey:"BasicComponents",listViewThumb:e.websiteUrl+"Images/text-field.png",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{version:"v2.9.0",Basics:{ComponentName:"Text",Name:"",HtmlText:"insert text here",Data:"",Template:"",Theme:"Dark",FontSize:"13",horizontal:"Center",vertical:"Middle",tooltip:"",AllowUnsafeContent:!1,version:"4.2.0s2"},Style:{advanced:""}},schema:{type:"object",title:"Properties",properties:{Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{Name:{title:"Name",propertyOrder:1,type:"string",default:""},HtmlText:{type:"html",propertyOrder:4,title:"Formatted Text",default:"insert text here"},Data:{type:"data",propertyOrder:1,format:"string",title:"Data Source",default:""},Template:{type:"tooltipTemplate",propertyOrder:5,title:"Template Text",default:"",options:{showMenuLayout:!0}},FontSize:{title:"Font Size",propertyOrder:6,type:"number",default:"10",format:"number"},Theme:{type:"string",propertyOrder:7,title:"Theme",options:{hidden:!0},enum:["Light","Dark"]},ComponentName:{title:"Component",propertyOrder:8,type:"string",default:"Text",options:{hidden:!0}},horizontal:{type:"string",propertyOrder:9,title:"Horizontal",enum:["Left","Center","Right"]},vertical:{type:"string",propertyOrder:10,title:"Vertical",enum:["Top","Middle","Bottom"]},tooltip:{title:"Tooltip",propertyOrder:11,type:"string",default:""},AllowUnsafeContent:{type:"boolean",title:"Allow Unsafe Templates",format:"checkbox",propertyOrder:12},version:{type:"string",propertyOrder:13,title:"version",options:{hidden:!0}}}},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{advanced:{type:"css",title:"Advanced CSS",default:""}}}}}}};break;case 24:i={id:24,componentName:"EXT Component",componentDescription:"This element displays web content.",appKey:"BasicComponents",listViewThumb:e.websiteUrl+"Images/webComponent.png",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{version:"v2.9.0",Basics:{ComponentName:"ExternalContent",Name:""},ViewState:{Url:"https://bing.com"},Style:{advanced:""}},schema:{type:"object",title:"Properties",properties:{ViewState:{type:"object",title:"View State",options:{collapsed:!1},propertyOrder:210,properties:{Url:{type:"string",title:"Url",default:"https://bing.com"}}},Basics:{type:"object",title:"Basics",propertyOrder:200,properties:{Name:{title:"Name",type:"string",default:""},ComponentName:{type:"string",title:"hide me",default:"ExternalContent",options:{hidden:!0}}}},Style:{type:"object",title:"Style",options:{collapsed:!0},propertyOrder:220,properties:{advanced:{type:"css",title:"Advanced CSS",default:""}}}}}}};break;case 25:i={id:25,componentName:"button",componentDescription:"This element allows to link screens.",appKey:"BasicComponents",appArgs:{json:{version:"v2.9.0",Actions:[],Basics:{ComponentName:"Button",Name:"",Label:"click",Icon:"",FontSize:11,horizontal:"Center",vertical:"Middle",tooltip:"",fixedWidth:!1,width:100,isEnabled:!0},Style:{advanced:"",background:"",color:"",border:""}},schema:{type:"object",title:"Properties",properties:{possible_screens:{type:"array",format:"table",items:{type:"object",properties:{title:{type:"string"},value:{type:"string"}}},options:{hidden:!0}},possible_dashboards:{type:"array",format:"table",items:{type:"object",properties:{title:{type:"string"},value:{type:"string"}}},options:{hidden:!0}},possible_viewstates:{type:"array",format:"table",items:{type:"string"},options:{hidden:!0}},Basics:{type:"object",title:"Basics",properties:{ComponentName:{type:"string",title:"hide me",default:"Button",options:{hidden:!0}},Name:{title:"Name",type:"string",default:"",propertyOrder:1},Label:{type:"string",title:"Label",default:"click here",propertyOrder:1},FontSize:{type:"number",title:"Font Size",default:11,format:"number",propertyOrder:2},horizontal:{type:"string",title:"Horizontal",enum:["Left","Center","Right"],default:"Center",propertyOrder:3},vertical:{type:"string",title:"Vertical",enum:["Top","Middle","Bottom"],default:"Middle",propertyOrder:4},tooltip:{type:"string",title:"Tooltip",fotmat:"string",default:"",propertyOrder:5},fixedWidth:{type:"boolean",title:"Fixed Width",format:"checkbox",propertyOrder:6},width:{type:"number",title:"Width",default:100,format:"number",propertyOrder:7},Icon:{type:"icon",title:"Icon",propertyOrder:8},isEnabled:{type:"boolean",title:"Is Enabled",format:"checkbox",propertyOrder:11}}},Actions:{type:"actions"},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{advanced:{type:"css",title:"Advanced CSS",default:""},background:{type:"gradient",options:{noColor:!0,gradient:!1},title:"Button Background",default:""},color:{type:"gradient",options:{noColor:!0,gradient:!1},title:"Button Text",default:""},border:{type:"gradient",options:{noColor:!0,gradient:!1},title:"Button border",default:""}}}}}},listViewThumb:e.websiteUrl+"Images/button.png",ghostViewThumb:null,buildViewThumb:null};break;case 30:i={id:30,componentName:"button",componentDescription:"button",appKey:"BasicComponents",listViewThumb:e.websiteUrl+"Images/button.png",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{version:"v2.9.0",Basics:{ComponentName:"button",Name:"",Theme:"Dark"},Style:{advanced:""}},schema:{type:"object",title:"Properties",properties:{Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{Theme:{type:"string",title:"Theme",options:{hidden:!0},enum:["Light","Dark"]},ComponentName:{title:"Component",type:"string",default:"button",options:{hidden:!0}},Name:{title:"Name",type:"string",default:""}}},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{advanced:{type:"css",title:"Advanced CSS",default:""}}}}}}};break;case 31:i={id:31,componentName:"pdf button",componentDescription:"Save as pdf",appKey:"BasicComponents",listViewThumb:e.websiteUrl+"Images/pdfButton.png",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{Basics:{ComponentName:"pdfButton",Name:"",Theme:"Dark"}},schema:{type:"object",title:"Properties",properties:{Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{Theme:{type:"string",title:"Theme",options:{hidden:!0},enum:["Light","Dark"]},ComponentName:{title:"Component",type:"string",default:"pdfButton",options:{hidden:!0}},Name:{title:"Name",type:"string",default:""}}}}}}};break;case 32:i={id:32,componentName:"server status",componentDescription:"Display Server Status",appKey:"BasicComponents",listViewThumb:e.websiteUrl+"Images/server-status.png",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{version:"4.7.7",possibleConnections:[],Basics:{ComponentName:"serverStatus",Name:"",Theme:"Dark",Connection:"",PollingInterval:5,IsEnabled:!0},Style:{advanced:""}},schema:{type:"object",title:"Properties",properties:{possibleConnections:{type:"readOnlyArray",items:{type:"string"},default:[],options:{collapsed:!0,hidden:!0}},Basics:{type:"object",title:"Basics",options:{collapsed:!1},propertyOrder:200,properties:{Theme:{type:"string",title:"Theme",enum:["Light","Dark"],options:{hidden:!0}},DashboardTheme:{options:{hidden:!0}},ComponentName:{title:"Component",type:"string",default:"serverStatus",options:{hidden:!0}},Name:{title:"Name",type:"string",default:""},Connection:{title:"Server Connection",type:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleConnections"},default:"mnth"},PollingInterval:{title:"Polling Interval (sec)",minimum:1,maximum:60,type:"number",step:1,format:"range"},IsEnabled:{type:"boolean",title:"Is Enabled",format:"checkbox"}}},Style:{type:"object",title:"Style",options:{collapsed:!0},propertyOrder:210,properties:{advanced:{type:"css",title:"Advanced CSS",default:""}}}}}}};break;case 33:i={id:33,componentName:"textbox",componentDescription:"textbox component",appKey:"BasicComponents",listViewThumb:e.websiteUrl+"Images/textBox.png",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{version:"v2.9.0",Basics:{ComponentName:"TextInput",Name:"",Theme:"Dark",Text:"",Type:"text",FontSize:16,horizontal:"Center",vertical:"Middle",fixedWidth:!1,width:100,fixedHeight:!1,height:100},Actions:[],Style:{advanced:""}},schema:{type:"object",title:"Properties",properties:{possibleColumns:{type:"array",format:"table",items:{type:"string"},default:["bid","ask"],options:{collapsed:!0,hidden:!0}},Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{ComponentName:{title:"Component",type:"string",default:"TextInput",options:{hidden:!0}},Theme:{type:"string",title:"Theme",options:{hidden:!0},enum:["Light","Dark"]},Name:{title:"Name",type:"string",default:"",propertyOrder:1},Text:{type:"string",title:"Text",propertyOrder:1},Type:{type:"string",title:"Input Type",enum:["text","search","multiline"],default:"text",propertyOrder:2},fixedWidth:{type:"boolean",title:"Fixed Width",format:"checkbox",propertyOrder:3},width:{type:"number",title:"Width",default:100,format:"number",propertyOrder:4},fixedHeight:{type:"boolean",title:"Fixed Height",format:"checkbox",propertyOrder:5},height:{type:"number",title:"Height",default:100,format:"number",propertyOrder:6},horizontal:{type:"string",title:"Horizontal",enum:["Left","Center","Right"],default:"Center",propertyOrder:7},vertical:{type:"string",title:"Vertical",enum:["Top","Middle","Bottom"],default:"Middle",propertyOrder:8},FontSize:{type:"number",title:"Font Size",default:16,minimum:1,format:"number",propertyOrder:9}}},Actions:{type:"actions"},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{advanced:{type:"css",title:"Advanced CSS",default:""}}}}}}};break;case 34:i=F.getDefinition(e);break;case 35:i={id:35,componentName:"navigation",componentDescription:"navigation component",appKey:"BasicComponents",listViewThumb:e.websiteUrl+"Images/navigation.png",ghostViewThumb:null,buildViewThumb:null,appArgs:{quickStart:[{path:"Basics.Data",message:"populate Data Source"}],json:{version:"v2.9.0",possibleCols:[],Basics:{ComponentName:"NavigationMenu",Name:"",Data:"",FontSize:13,Node:{Parent:"",Node:"",URL:"",ID:""},Actions:[]}},schema:{type:"object",title:"Properties",properties:{possibleColumns:{type:"array",format:"table",items:{type:"string"},default:[],options:{collapsed:!0,hidden:!0}},Basics:{title:"Basics",type:"object",properties:{ComponentName:{title:"Component",type:"string",default:"NavigationMenu",options:{hidden:!0}},Name:{title:"Name",type:"string",default:"",propertyOrder:1},Data:{type:"data",propertyOrder:1,format:"string",title:"Data Source",default:""},FontSize:{title:"Font Size",propertyOrder:2,type:"number",default:13,format:"number"},Node:{title:"Node",type:"object",properties:{Node:{title:"Node",default:"",type:"string",enumSource:"possible_cols",watch:{possible_cols:"root.possibleColumns"}},Parent:{title:"Parent",default:"",type:"string",enumSource:"possible_cols",watch:{possible_cols:"root.possibleColumns"}},URL:{title:"URL",default:"",type:"string",enumSource:"possible_cols",watch:{possible_cols:"root.possibleColumns"}},ID:{title:"ID",default:"",type:"string",enumSource:"possible_cols",watch:{possible_cols:"root.possibleColumns"}}}},Actions:{title:"Actions",type:"actions",fields:{map:_.extend({Current:{enumSource:"possible_cols",propertyOrder:10,title:"Source Column",type:"string",watch:{possibleColumns:"root.possibleColumns"}}},o),nav:o,query:o,url:o},options:{collapsed:!0}}}}}}}};break;case 36:i={id:36,appArgs:{json:{version:"v2.9.0",Style:{advanced:""},Basics:{ComponentName:"TextToSpeech",Name:"",Data:"",HtmlText:"insert text here",Template:"",Theme:"Dark",FontSize:"13",horizontal:"Center",vertical:"Middle",tooltip:"",AllowUnsafeContent:!1,version:"v2.9.0",SpeechOptions:{CacheData:!1,Voice:"",Rate:1,ShowPlayPause:!1}}},schema:{type:"object",title:"Properties",properties:{Basics:{propertyOrder:0,id:"arrItem",type:"object",title:"Basics",options:{collapsed:!1},properties:{ComponentName:{title:"Component",type:"string",default:"TextToSpeech",options:{hidden:!0}},possibleVoices:{type:"array",options:{hidden:!0}},possibleSpeechCols:{type:"array",options:{hidden:!0}},possibleVoiceCols:{type:"array",options:{hidden:!0}},Name:{title:"Name",type:"string",default:"",propertyOrder:1},Data:{title:"Data Source",type:"data",default:"",propertyOrder:2},HtmlText:{type:"html",propertyOrder:3,title:"Formatted Text",default:"insert text here"},Template:{type:"tooltipTemplate",propertyOrder:4,title:"Template Text",default:"",options:{showMenuLayout:!0}},FontSize:{title:"Font Size",propertyOrder:6,type:"number",default:"10",format:"number"},Theme:{type:"string",propertyOrder:7,title:"Theme",options:{hidden:!0},enum:["Light","Dark"]},horizontal:{type:"string",propertyOrder:9,title:"Horizontal",enum:["Left","Center","Right"]},vertical:{type:"string",propertyOrder:10,title:"Vertical",enum:["Top","Middle","Bottom"]},tooltip:{title:"Tooltip",propertyOrder:11,type:"string",default:""},AllowUnsafeContent:{type:"boolean",title:"Allow Unsafe Templates",format:"checkbox",propertyOrder:12},version:{type:"string",propertyOrder:13,title:"version",options:{hidden:!0}},SpeechOptions:{title:"Speech Options",type:"object",options:{collapsed:!1},properties:{CacheData:{title:"Cache Data",type:"boolean",default:!1},Voice:{title:"Voice",type:"string",default:"",enumSource:"possible_voices",watch:{possible_voices:"arrItem.possibleVoices"}},Rate:{title:"Rate",type:"number",default:1,min:.1,max:10,format:"number"},ShowPlayPause:{title:"Show Play/Pause Button",type:"boolean",default:!1}}}}}}}}};break;default:i={}}if(-1===[16,34].indexOf(e.componentId)&&0<_.keys(e.settingsModel.attributes).length)for(var n=h.upgrades.indexOf(_.find(h.upgrades,{version:e.settingsModel.get("version")}))+1;n<h.upgrades.length;n+=1)(t=h.upgrades[n]).fn(e.settingsModel,e.componentId,e),e.settingsModel.set("version",t.version);return i},h);function h(){}H.upgrades=[{version:"4.0.0p2",fn:function(e,t){32!==t&&24!==t||e.set("Style.advanced","")}},{version:"4.1.0s1",fn:function(e,t){25===t&&(e.set("Style.background",""),e.set("Style.color",""),e.set("Style.border",""))}},{version:"4.0.2d1",fn:function(e,t){17===t&&e.set("Basics.AllowUnsafeContent",!1)}},{version:"4.1.0s2",fn:function(e,t){25===t&&(e.set("Basics.useUrl",!1),e.set("Basics.urlString",""),e.set("Basics.isEnabled",!0))}},{version:"4.2.0s2",fn:function(e,t){17!==t||(t=e.get("Basics.HtmlText"))._dashboardsType||(t=(t=(t=t.toString()).replace(/\n/g,"<br>")).replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;"),t=decodeURIComponent(t),e.set("Basics.HtmlText",t))}},{version:"4.2.0",fn:function(e,t,i){var o;25===t&&(o=[],t=e.get("ViewState.target_dashboard_screen"),_.each(e.get("ViewState.viewstates_mapping"),function(e){o.push(_.extend({_Type:"map"},e))}),(t&&t.dashboard&&"<none>"!==t.dashboard||t.value)&&("<this>"===t.dashboard&&(i=i.dashboardAppModel.get("documents").get(i.dashboardViewModel.get("selectedDocumentId")))&&(i=i.get("screens").get(t.screen))&&(t.screen=i.get("name")),o.push({_Type:"nav",SelectDashboardScreen:t})),e.get("Basics.useUrl")&&o.push({_Type:"url",Url:e.get("Basics.urlString"),Target:"_blank"}),e.set("Actions",o),e.unset("ViewState"),e.unset("Basics.urlString"),e.unset("Basics.useUrl"))}},{version:"4.2.0s3",fn:function(e,t){17===t&&e.get("Basics.Label")&&(e.set("Basics.HtmlText",e.get("Basics.Label")),e.unset("Basics.Label"))}},{version:"4.3.0p2",fn:function(e,t,o){var n;25===t&&(n=[],t=e.get("Actions"),_.each(t,function(e){var t,i;e._Type&&"nav"!==e._Type||e.SelectDashboardScreen?n.push(e):(t={_dashboardsType:e._dashboardsType},void 0!==e.dashboard?(i=o.dashboardAppModel.get("documents").get(o.dashboardViewModel.get("selectedDocumentId")),t.dashboard="<none>",t.screen="<none>",(i="<this>"!==e.dashboard?o.dashboardAppModel.get("documents").get(e.dashboard):i)&&(t.dashboard=e.dashboard,_.find(i.get("screenDetails"),{value:e.screen}))&&(t.screen=e.screen)):"viewstate"===e._dashboardsType&&(t.value=e.value),n.push({_Type:"nav",SelectDashboardScreen:t}))}),n.length)&&e.set("Actions",n)}},{version:"4.3.1",fn:function(e,t){15!==t&&33!==t||e.get("Actions")||e.set("Actions",[]),34===t&&((t=e.get("Style")).labelTemplate=void 0===t.labelTemplate?"":t.labelTemplate,e.get("Style",t))}},{version:"4.3.1",fn:function(e,t){33===t&&((t=e.get("Basics")).Type=void 0===t.Type?"text":t.Type,e.set("Basics",t),t.Type=t.Multiline?"multiline":t.Type,e.unset("Basics.Multiline"))}},{version:"4.5.0",fn:function(e,t){32===t&&e.unset("Basics.PollingIntervalSec")}},{version:"4.7.7",fn:function(e){e.get("Basics.Name")||e.set("Basics.Name","")}},{version:"4.7.7.1",fn:function(e,t){15===t?e.set("Basics.ComponentName","DatePicker"):17===t?e.set("Basics.ComponentName","Text"):24===t?e.set("Basics.ComponentName","ExternalContent"):25===t?e.set("Basics.ComponentName","Button"):33===t?e.set("Basics.ComponentName","TextInput"):35===t&&e.set("Basics.ComponentName","NavigationMenu")}},{version:"v2.2.2",fn:function(e,t){35===t&&_.isNil(e.get("Basics.Actions"))&&e.set("Basics.Actions",[])}},{version:"v2.9.0",fn:function(i,e){_.each(i.get("Actions"),function(e,t){"query"!==e._Type&&"map"!==e._Type||_.isNil(i.get("Actions."+t+".Async"))&&i.set("Actions."+t+".Async",!1)})}}];i.button=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="basicComponents_btn">'+e.escapeExpression((a(i,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"button text",{name:"t",hash:{},data:n,loc:{start:{line:1,column:33},end:{line:1,column:52}}}))+"</div>"},useData:!0}),i.datePicker=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){return'<div style="display: table; width: 100%; height: 100%;">\n    <div class="align-div" style="display: table-cell; width: 100%; height: 100%; text-align: center; vertical-align: middle;">\n        <div style="display: inline-block;">\n            <label class="datepicker-label"></label>\n            <div class="datepicker-container">\n                <span class="datepicker-input bbf-editor"></span>\n                <div class="datepicker-button"></div>\n            </div>\n        </div>\n    </div>\n</div>'},useData:!0}),i.dropdown=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){return'<div style="display: table; width: 100%; height: 100%;">\n    <div class="align-div" style="display: table-cell; width: 100%; height: 100%; text-align: center; vertical-align: middle;">\n        <div class="bbf-field">\n            <div class="bbf-editor">\n                <label class="dropdown-label"></label>\n                <div class="dropdown-container"></div>\n            </div>\n        </div>\n    </div>\n</div>'},useData:!0}),i.dropdownCustomStyle=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"#"+c(typeof(a=null!=(a=e(i,"cid")||(null!=t?e(t,"cid"):t))?a:l)==r?a.call(s,{name:"cid",hash:{},data:n,loc:{start:{line:1,column:1},end:{line:1,column:8}}}):a)+" > ul {\n    height: "+c(typeof(a=null!=(a=e(i,"height")||(null!=t?e(t,"height"):t))?a:l)==r?a.call(s,{name:"height",hash:{},data:n,loc:{start:{line:2,column:12},end:{line:2,column:22}}}):a)+";\n}\n"},useData:!0}),i.dummy=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){return"error! please update componentMap in BasicComponents"},useData:!0}),i.label=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){return'<div style="display: table; width: 100%; height: 100%;">\n    <div class="text-align" style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center; overflow: hidden;">\n\t\t<div class="htmlContent"></div>\n    </div>\n</div>\n'},useData:!0}),i.linkButton=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div style="display: table; width: 100%; height: 100%;">\n    <div class="align-div" style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center;">\n        <button class="button-root" style="font-size: '+c(typeof(a=null!=(a=e(i,"FontSize")||(null!=t?e(t,"FontSize"):t))?a:l)==r?a.call(s,{name:"FontSize",hash:{},data:n,loc:{start:{line:3,column:54},end:{line:3,column:66}}}):a)+'px">\n            '+c(typeof(a=null!=(a=e(i,"Label")||(null!=t?e(t,"Label"):t))?a:l)==r?a.call(s,{name:"Label",hash:{},data:n,loc:{start:{line:4,column:12},end:{line:4,column:21}}}):a)+"\n        </button>\n    </div>\n</div>\n"},useData:!0}),i.linkButtonCustomStyle=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"#"+c(typeof(a=null!=(a=e(i,"cid")||(null!=t?e(t,"cid"):t))?a:l)==r?a.call(s,{name:"cid",hash:{},data:n,loc:{start:{line:1,column:1},end:{line:1,column:8}}}):a)+" {\n    background: "+c(typeof(a=null!=(a=e(i,"c0")||(null!=t?e(t,"c0"):t))?a:l)==r?a.call(s,{name:"c0",hash:{},data:n,loc:{start:{line:2,column:16},end:{line:2,column:22}}}):a)+";\n    background: -moz-linear-gradient(bottom,"+c(typeof(a=null!=(a=e(i,"c0")||(null!=t?e(t,"c0"):t))?a:l)==r?a.call(s,{name:"c0",hash:{},data:n,loc:{start:{line:3,column:44},end:{line:3,column:50}}}):a)+",50%,"+c(typeof(a=null!=(a=e(i,"c1")||(null!=t?e(t,"c1"):t))?a:l)==r?a.call(s,{name:"c1",hash:{},data:n,loc:{start:{line:3,column:55},end:{line:3,column:61}}}):a)+",80%,"+c(typeof(a=null!=(a=e(i,"c2")||(null!=t?e(t,"c2"):t))?a:l)==r?a.call(s,{name:"c2",hash:{},data:n,loc:{start:{line:3,column:66},end:{line:3,column:72}}}):a)+");\n    background: -webkit-linear-gradient(bottom,"+c(typeof(a=null!=(a=e(i,"c0")||(null!=t?e(t,"c0"):t))?a:l)==r?a.call(s,{name:"c0",hash:{},data:n,loc:{start:{line:4,column:47},end:{line:4,column:53}}}):a)+",50%,"+c(typeof(a=null!=(a=e(i,"c1")||(null!=t?e(t,"c1"):t))?a:l)==r?a.call(s,{name:"c1",hash:{},data:n,loc:{start:{line:4,column:58},end:{line:4,column:64}}}):a)+",80%,"+c(typeof(a=null!=(a=e(i,"c2")||(null!=t?e(t,"c2"):t))?a:l)==r?a.call(s,{name:"c2",hash:{},data:n,loc:{start:{line:4,column:69},end:{line:4,column:75}}}):a)+");\n    background: linear-gradient(to top,"+c(typeof(a=null!=(a=e(i,"c0")||(null!=t?e(t,"c0"):t))?a:l)==r?a.call(s,{name:"c0",hash:{},data:n,loc:{start:{line:5,column:39},end:{line:5,column:45}}}):a)+",50%,"+c(typeof(a=null!=(a=e(i,"c1")||(null!=t?e(t,"c1"):t))?a:l)==r?a.call(s,{name:"c1",hash:{},data:n,loc:{start:{line:5,column:50},end:{line:5,column:56}}}):a)+",80%,"+c(typeof(a=null!=(a=e(i,"c2")||(null!=t?e(t,"c2"):t))?a:l)==r?a.call(s,{name:"c2",hash:{},data:n,loc:{start:{line:5,column:61},end:{line:5,column:67}}}):a)+");\n}\n\n#"+c(typeof(a=null!=(a=e(i,"cid")||(null!=t?e(t,"cid"):t))?a:l)==r?a.call(s,{name:"cid",hash:{},data:n,loc:{start:{line:8,column:1},end:{line:8,column:8}}}):a)+".ui-state-hover {\n    background: "+c(typeof(a=null!=(a=e(i,"h0")||(null!=t?e(t,"h0"):t))?a:l)==r?a.call(s,{name:"h0",hash:{},data:n,loc:{start:{line:9,column:16},end:{line:9,column:22}}}):a)+";\n    background: -moz-linear-gradient(bottom,"+c(typeof(a=null!=(a=e(i,"h0")||(null!=t?e(t,"h0"):t))?a:l)==r?a.call(s,{name:"h0",hash:{},data:n,loc:{start:{line:10,column:44},end:{line:10,column:50}}}):a)+",50%,"+c(typeof(a=null!=(a=e(i,"h1")||(null!=t?e(t,"h1"):t))?a:l)==r?a.call(s,{name:"h1",hash:{},data:n,loc:{start:{line:10,column:55},end:{line:10,column:61}}}):a)+",80%,"+c(typeof(a=null!=(a=e(i,"h2")||(null!=t?e(t,"h2"):t))?a:l)==r?a.call(s,{name:"h2",hash:{},data:n,loc:{start:{line:10,column:66},end:{line:10,column:72}}}):a)+");\n    background: -webkit-linear-gradient(bottom,"+c(typeof(a=null!=(a=e(i,"h0")||(null!=t?e(t,"h0"):t))?a:l)==r?a.call(s,{name:"h0",hash:{},data:n,loc:{start:{line:11,column:47},end:{line:11,column:53}}}):a)+",50%,"+c(typeof(a=null!=(a=e(i,"h1")||(null!=t?e(t,"h1"):t))?a:l)==r?a.call(s,{name:"h1",hash:{},data:n,loc:{start:{line:11,column:58},end:{line:11,column:64}}}):a)+",80%,"+c(typeof(a=null!=(a=e(i,"h2")||(null!=t?e(t,"h2"):t))?a:l)==r?a.call(s,{name:"h2",hash:{},data:n,loc:{start:{line:11,column:69},end:{line:11,column:75}}}):a)+");\n    background: linear-gradient(to top,"+c(typeof(a=null!=(a=e(i,"h0")||(null!=t?e(t,"h0"):t))?a:l)==r?a.call(s,{name:"h0",hash:{},data:n,loc:{start:{line:12,column:39},end:{line:12,column:45}}}):a)+",50%,"+c(typeof(a=null!=(a=e(i,"h1")||(null!=t?e(t,"h1"):t))?a:l)==r?a.call(s,{name:"h1",hash:{},data:n,loc:{start:{line:12,column:50},end:{line:12,column:56}}}):a)+",80%,"+c(typeof(a=null!=(a=e(i,"h2")||(null!=t?e(t,"h2"):t))?a:l)==r?a.call(s,{name:"h2",hash:{},data:n,loc:{start:{line:12,column:61},end:{line:12,column:67}}}):a)+");\n}\n\n#"+c(typeof(a=null!=(a=e(i,"cid")||(null!=t?e(t,"cid"):t))?a:l)==r?a.call(s,{name:"cid",hash:{},data:n,loc:{start:{line:15,column:1},end:{line:15,column:8}}}):a)+".ui-state-hover.ui-state-active {\n    background: "+c(typeof(a=null!=(a=e(i,"a0")||(null!=t?e(t,"a0"):t))?a:l)==r?a.call(s,{name:"a0",hash:{},data:n,loc:{start:{line:16,column:16},end:{line:16,column:22}}}):a)+";\n    background: -moz-linear-gradient(bottom,"+c(typeof(a=null!=(a=e(i,"a0")||(null!=t?e(t,"a0"):t))?a:l)==r?a.call(s,{name:"a0",hash:{},data:n,loc:{start:{line:17,column:44},end:{line:17,column:50}}}):a)+",50%,"+c(typeof(a=null!=(a=e(i,"a1")||(null!=t?e(t,"a1"):t))?a:l)==r?a.call(s,{name:"a1",hash:{},data:n,loc:{start:{line:17,column:55},end:{line:17,column:61}}}):a)+",80%,"+c(typeof(a=null!=(a=e(i,"a2")||(null!=t?e(t,"a2"):t))?a:l)==r?a.call(s,{name:"a2",hash:{},data:n,loc:{start:{line:17,column:66},end:{line:17,column:72}}}):a)+");\n    background: -webkit-linear-gradient(bottom,"+c(typeof(a=null!=(a=e(i,"a0")||(null!=t?e(t,"a0"):t))?a:l)==r?a.call(s,{name:"a0",hash:{},data:n,loc:{start:{line:18,column:47},end:{line:18,column:53}}}):a)+",50%,"+c(typeof(a=null!=(a=e(i,"a1")||(null!=t?e(t,"a1"):t))?a:l)==r?a.call(s,{name:"a1",hash:{},data:n,loc:{start:{line:18,column:58},end:{line:18,column:64}}}):a)+",80%,"+c(typeof(a=null!=(a=e(i,"a2")||(null!=t?e(t,"a2"):t))?a:l)==r?a.call(s,{name:"a2",hash:{},data:n,loc:{start:{line:18,column:69},end:{line:18,column:75}}}):a)+");\n    background: linear-gradient(to top,"+c(typeof(a=null!=(a=e(i,"a0")||(null!=t?e(t,"a0"):t))?a:l)==r?a.call(s,{name:"a0",hash:{},data:n,loc:{start:{line:19,column:39},end:{line:19,column:45}}}):a)+",50%,"+c(typeof(a=null!=(a=e(i,"a1")||(null!=t?e(t,"a1"):t))?a:l)==r?a.call(s,{name:"a1",hash:{},data:n,loc:{start:{line:19,column:50},end:{line:19,column:56}}}):a)+",80%,"+c(typeof(a=null!=(a=e(i,"a2")||(null!=t?e(t,"a2"):t))?a:l)==r?a.call(s,{name:"a2",hash:{},data:n,loc:{start:{line:19,column:61},end:{line:19,column:67}}}):a)+");\n}"},useData:!0}),i.navigation=n.template({1:function(e,t,i,o,n){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return" "+(null!=(i=(a(i,"eq")||t&&a(t,"eq")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?a(t,"isDropdown"):t,!0,{name:"eq",hash:{},fn:e.program(2,n,0),inverse:e.program(5,n,0),data:n,loc:{start:{line:2,column:19},end:{line:21,column:11}}}))?i:"")+" "},2:function(e,t,i,o,n){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,p=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n    <div class="dropdown">\n        \x3c!-- dropdown parent--\x3e\n        <button class="dropbtn '+c(typeof(a=null!=(a=p(i,"class")||(null!=t?p(t,"class"):t))?a:l)==r?a.call(s,{name:"class",hash:{},data:n,loc:{start:{line:5,column:31},end:{line:5,column:40}}}):a)+'">\n            <a href="'+c(typeof(a=null!=(a=p(i,"url")||(null!=t?p(t,"url"):t))?a:l)==r?a.call(s,{name:"url",hash:{},data:n,loc:{start:{line:6,column:21},end:{line:6,column:28}}}):a)+'">'+c(typeof(a=null!=(a=p(i,"node")||(null!=t?p(t,"node"):t))?a:l)==r?a.call(s,{name:"node",hash:{},data:n,loc:{start:{line:6,column:30},end:{line:6,column:38}}}):a)+'</a>\n            <i class="fa fa-caret-down"></i>\n        </button>\n\n        <div class="dropdown-content">\n            \x3c!-- dropdown children--\x3e\n'+(null!=(c=p(i,"each").call(s,null!=t?p(t,"dropdown"):t,{name:"each",hash:{},fn:e.program(3,n,0),inverse:e.noop,data:n,loc:{start:{line:12,column:12},end:{line:14,column:21}}}))?c:"")+"        </div>\n    </div>\n\n"},3:function(e,t,i,o,n){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <a class="'+c(typeof(a=null!=(a=e(i,"class")||(null!=t?e(t,"class"):t))?a:l)==r?a.call(s,{name:"class",hash:{},data:n,loc:{start:{line:13,column:22},end:{line:13,column:31}}}):a)+'" href="'+c(typeof(a=null!=(a=e(i,"url")||(null!=t?e(t,"url"):t))?a:l)==r?a.call(s,{name:"url",hash:{},data:n,loc:{start:{line:13,column:39},end:{line:13,column:46}}}):a)+'">'+c(typeof(a=null!=(a=e(i,"node")||(null!=t?e(t,"node"):t))?a:l)==r?a.call(s,{name:"node",hash:{},data:n,loc:{start:{line:13,column:48},end:{line:13,column:56}}}):a)+"</a>\n"},5:function(e,t,i,o,n){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    \x3c!-- item without children --\x3e\n    <a class="'+c(typeof(a=null!=(a=e(i,"class")||(null!=t?e(t,"class"):t))?a:l)==r?a.call(s,{name:"class",hash:{},data:n,loc:{start:{line:20,column:14},end:{line:20,column:23}}}):a)+'" href="'+c(typeof(a=null!=(a=e(i,"url")||(null!=t?e(t,"url"):t))?a:l)==r?a.call(s,{name:"url",hash:{},data:n,loc:{start:{line:20,column:31},end:{line:20,column:38}}}):a)+'">'+c(typeof(a=null!=(a=e(i,"node")||(null!=t?e(t,"node"):t))?a:l)==r?a.call(s,{name:"node",hash:{},data:n,loc:{start:{line:20,column:40},end:{line:20,column:48}}}):a)+"</a>\n    "},compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="navbar" style="font-size: '+e.escapeExpression(e.lambda(null!=(a=null!=t?s(t,"0"):t)?s(a,"fontSize"):a,t))+'px">\n    '+(null!=(a=s(i,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,n,0),inverse:e.noop,data:n,loc:{start:{line:2,column:4},end:{line:21,column:21}}}))?a:"")+"\n</div>\n"},useData:!0}),i.pdfButton=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="basicComponents_pdfBtn">'+e.escapeExpression((a(i,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"button text",{name:"t",hash:{},data:n,loc:{start:{line:1,column:36},end:{line:1,column:55}}}))+"</div>"},useData:!0}),i.radio=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){return'<div style="display: table; width: 100%; height: 100%;">\n    <div class="align-div" style="display: table-cell; width: 100%; height: 100%; text-align: center; vertical-align: middle;">\n        <div style="display: inline-block;">\n            <span class="basicComponents_cmbLbl"></span>\n            <div class="radio_buttons"></div>\n        </div>\n    </div>\n</div>'},useData:!0}),i.serverStatus=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){return'<div class="pnlLineStatus">\n    Line Status: <span class="txtLineStatus"></span>\n</div>\n\n<span class="txtServerTime"></span>\n\n\n'},useData:!0}),i.tabs=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){return'<div class="tabs-div">\n    <ul>\n        <li><a href="#tabs-1">Nunc tincidunt</a></li>\n        <li><a href="#tabs-2">Proin dolor</a></li>\n        <li><a href="#tabs-3">Aenean lacinia</a></li>\n    </ul>\n    <div id="tabs-1">\n        <p>Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin. Sed ut dolor nec orci tincidunt interdum. Phasellus ipsum. Nunc tristique tempus lectus.</p>\n    </div>\n    <div id="tabs-2">\n        <p>Morbi tincidunt, dui sit amet facilisis feugiat, odio metus gravida ante, ut pharetra massa metus id nunc. Duis scelerisque molestie turpis. Sed fringilla, massa eget luctus malesuada, metus eros molestie lectus, ut tempus eros massa ut dolor. Aenean aliquet fringilla sem. Suspendisse sed ligula in ligula suscipit aliquam. Praesent in eros vestibulum mi adipiscing adipiscing. Morbi facilisis. Curabitur ornare consequat nunc. Aenean vel metus. Ut posuere viverra nulla. Aliquam erat volutpat. Pellentesque convallis. Maecenas feugiat, tellus pellentesque pretium posuere, felis lorem euismod felis, eu ornare leo nisi vel felis. Mauris consectetur tortor et purus.</p>\n    </div>\n    <div id="tabs-3">\n        <p>Mauris eleifend est et turpis. Duis id erat. Suspendisse potenti. Aliquam vulputate, pede vel vehicula accumsan, mi neque rutrum erat, eu congue orci lorem eget lorem. Vestibulum non ante. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Fusce sodales. Quisque eu urna vel enim commodo pellentesque. Praesent eu risus hendrerit ligula tempus pretium. Curabitur lorem enim, pretium nec, feugiat nec, luctus a, lacus.</p>\n        <p>Duis cursus. Maecenas ligula eros, blandit nec, pharetra at, semper at, magna. Nullam ac lacus. Nulla facilisi. Praesent viverra justo vitae neque. Praesent blandit adipiscing velit. Suspendisse potenti. Donec mattis, pede vel pharetra blandit, magna ligula faucibus eros, id euismod lacus dolor eget odio. Nam scelerisque. Donec non libero sed nulla mattis commodo. Ut sagittis. Donec nisi lectus, feugiat porttitor, tempor ac, tempor vitae, pede. Aenean vehicula velit eu tellus interdum rutrum. Maecenas commodo. Pellentesque nec elit. Fusce in lacus. Vivamus a libero vitae lectus hendrerit hendrerit.</p>\n    </div>\n</div>'},useData:!0}),i.textBox=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="align-div" style="display: block; width: 100%; height: 100%; vertical-align: middle; text-align: center;">\n    <input type="'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"type")||(null!=t?a(t,"type"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"type",hash:{},data:n,loc:{start:{line:2,column:17},end:{line:2,column:25}}}):i)+'">\n    <textarea></textarea>\n</div>\n'},useData:!0}),i.textToSpeech=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){return'<div style="display: table; width: 100%; height: 100%;">\n    <div\n        class="text-align"\n        style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center; overflow: hidden;"\n    >\n        <div class="htmlContent"></div>\n    </div>\n\n    <div class="play-controls ui-state-default">\n        <div class="back-btn"></div>\n        <div class="play-btn"></div>\n        <div class="forward-btn"></div>\n    </div>\n</div>\n'},useData:!0}),i.webComponent=n.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,o,n){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="title">\n\n</div>\n<iframe src="'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"Url")||(null!=t?a(t,"Url"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"Url",hash:{},data:n,loc:{start:{line:4,column:13},end:{line:4,column:20}}}):i)+'"></iframe>'},useData:!0});var m=i;function i(){}u=l.View,e(g,u),g.prototype.onData=function(e,t){var i=this,o=(e.primaryKey!==this.primaryKey&&(this.primaryKey=e.primaryKey,this.dateCollection=new l.Collection([],{model:l.Model.extend({idAttribute:this.primaryKey})})),t.reset?(e.columns.reset&&(this.columns=e.columns.reset),this.dateCollection.reset(t.reset)):(this.dateCollection.remove(_.map(t.remove,function(e){return e[i.primaryKey]})),this.dateCollection.add(t.add),this.dateCollection.add(t.change,{merge:!0})),this.columns&&this.columns[0]?this.columns[0].id:"");this.availableDates=this.dateCollection.map(function(e){e=e.get(o)||"";return d.isKDBTemporal(e)?d.convertKDBTemporalToMoment(e).toDashString():(i.api.showQueryStatus({error:'Invalid Date Type "'+(_.isFunction(e.toString)?e.toString():e)+'", please choose a Data Source that returns a column of date/time types',errorType:"Warning"}),null)}),this.debouncedRenderDatePicker()},g.prototype.onDataError=function(e){a.Log.Error("Datepicker data error ",e)},g.prototype.onDataSourceChanged=function(){var e=this.viewModel.get("Basics.Data");e?this.dataModel&&e.path===this.dataModel.path||this.applyDataProperty(e):(this.applyDataProperty(),this.availableDates=null),this.debouncedRenderDatePicker()},g.prototype.render=function(){return this.$el.html(m.datePicker()),this.$alignDiv=this.$(".align-div"),this.$lbl=this.$(".datepicker-label"),this.$datePickerContainer=this.$(".datepicker-input"),this.$btnShowPopup=this.$(".datepicker-button"),this},g.prototype.onSettingsChange=function(e){var i=this;_.each(e,function(e,t){i.viewModel.set(t,e)}),this.hasInit||(this.hasInit=!0,this.afterInitialize())},g.prototype.remove=function(){var e;return null!=(e=this.intersectionObserver)&&e.unobserve(this.$el[0]),this.$datePickerContainer.off(),this.$btnShowPopup.off(),this.$btnShowPopup.data("uiButton")&&this.$btnShowPopup.button("destroy"),this.setError(null),this.removeDatePicker(),l.View.prototype.remove.apply(this)},g.prototype.initializeEvents=function(){var o=this;this.listenTo(this.viewModel,"change:Basics.Data",this.onDataSourceChanged.bind(this)),this.listenTo(this.viewModel,"change:Basics.width",this.setWidth.bind(this)),this.listenTo(this.viewModel,"change:Basics.labelWidth",this.updateLabelWidth.bind(this)),this.listenTo(this.viewModel,"change:Basics.Label",this.onLabelChange.bind(this)),this.listenTo(this.viewModel,"change:Basics.horizontal",this.onHorizontalAlignChanged.bind(this)),this.listenTo(this.viewModel,"change:Basics.vertical",this.onVerticalAlignChanged.bind(this)),this.listenTo(this.viewModel,"change:Basics.tooltip",this.onTooltipChanged.bind(this)),this.listenTo(this.viewModel,"change:Basics.SelectedDate",this.onSelectedDateChange.bind(this)),this.$datePickerContainer.add(this.$btnShowPopup).mouseenter(this.setFlagVisible.bind(this)),this.intersectionObserver=new IntersectionObserver(function(e){for(var t=0,i=e;t<i.length;t++)i[t].isIntersecting||o.onResize()}),this.intersectionObserver.observe(this.$el[0])},g.prototype.afterInitialize=function(){this.render(),this.initializeEvents(),this.onLabelChange(),this.onDataSourceChanged(),this.onVerticalAlignChanged(),this.onTooltipChanged(),this.updateLabelWidth(),this.setStyle(),this.onHorizontalAlignChanged(),this.renderDatePicker()},g.prototype.applyDataProperty=function(e){this.dataModel&&(this.stopListening(this.dataModel),this.api.unsubscribe(this.dataModel),this.availableDates=null),(this.dataModel=e)&&(this.dataModel&&this.dataModel.attributes?(this.api.subscribe(e,this.onData.bind(this)),this.initializeQueryStatusHandler(this.dataModel)):this.api.showQueryStatus({error:'Invalid Data Source: "'+e.path+'" selected',errorType:"Warning"}))},g.prototype.bindButton=function(){var e=this;this.$btnShowPopup.data("uiButton")||this.$btnShowPopup.button({icon:"fa fa-calendar"}).click(function(){e.datePicker&&(e.visible?e.datePicker.hide():e.datePicker.show(),e.visible=!e.visible)})},g.prototype.convertDateToString=function(e){return _.isDate(e)?d.convertValueToMoment(e,"1214",!0).toDashString():e},g.prototype.executeActions=function(){this.api.doActions(this.viewModel.get("Actions"),"Actions")},g.prototype.initializeQueryStatusHandler=function(e){this.updateQueryStatus(),this.listenTo(e,"change:queryStatus",this.updateQueryStatus.bind(this))},g.prototype.onDimensionsChanged=function(){this.onTooltipChanged()},g.prototype.onHorizontalAlignChanged=function(){this.$alignDiv.css("text-align",this.viewModel.get("Basics.horizontal"))},g.prototype.onLabelChange=function(){this.$lbl.text(this.viewModel.get("Basics.Label"))},g.prototype.onSelectedDateChange=function(){var e=this.api.getPropertyMeta("Basics.SelectedDate");e?e.viewstateType!==this.selectedDateType?(this.onSelectedDateChangePostRender(),this.$btnShowPopup.removeClass("datePickerButtonError")):this.datePicker&&!_.isUndefined(e.value)&&(this.datePicker.setValue(e.value),!_.has(a.Tools.Types.dashboardToKdb,e.viewstateType)||(e=d.convertUserInputToMoment(e.value,""))&&e._isValid&&this.datePicker.$el.find(".hasDatepicker").length&&this.datePicker.isInAvailableDatesList(e))&&this.setError(null):this.onSelectedDateChangePostRender(),this.executeActions()},g.prototype.onSelectedDateChangePostRender=function(){this.selectedChanged=!0,this.debouncedRenderDatePicker()},g.prototype.onVerticalAlignChanged=function(){this.$alignDiv.css("vertical-align",this.viewModel.get("Basics.vertical"))},g.prototype.onThemeChanged=function(){var e="Dark";this.options.dashboardViewModel.get("DashboardTheme")&&(e=this.options.dashboardViewModel.get("DashboardTheme")),this.$el.removeClass("Dark").removeClass("Light").addClass(e)},g.prototype.onTooltipChanged=function(){var e=this.viewModel.get("Basics.tooltip")||"";this.$datePickerContainer.add(this.$btnShowPopup).prop("title",e)},g.prototype.renderDatePicker=function(){var e,t,i,o,n,a,s=this;this.removeDatePicker(),this.$datePickerContainer.empty(),(e=this.api.getPropertyMeta("Basics.SelectedDate"))?null===e.viewstateType?null===e.viewstateType&&(e=null,e=this.currentPickerType):this.currentPickerType=e:e=this.currentPickerType,e&&e.viewstateType&&(t=(o=r.RTTI.getByName(e.viewstateType)).editor.type,i=o.editor.options,o=o.editor.validators,a=l.Form.editors[t],i=_.extend({},i,{beforeShowDay:function(e){return s.availableDates&&null!==s.availableDates[0]?[_.includes(s.availableDates,s.convertDateToString(e)),""]:[!0,""]},changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",showAnim:"slideDown",showOn:"focus",availableDates:this.availableDates}),n=_.uniqueId("date_"),this.datePicker=new a({id:n,schema:{options:i,validators:o}}).render(),this.$lbl&&this.$lbl.attr("for",n),i.bindButton?(this.bindButton(),this.$btnShowPopup.show()):this.$btnShowPopup.hide(),this.$el.attr("data-type",t),this.$datePickerContainer.append(this.datePicker.el),a=0<this.datePicker.$el.find(".hasDatepicker").length,this.api.getPropertyMeta("Basics.SelectedDate")?(this.selectedDateType=this.api.getPropertyMeta("Basics.SelectedDate").viewstateType||this.selectedDateType,a&&this.datePicker.updateDateInputField(this.api.getPropertyMeta("Basics.SelectedDate").value),this.datePicker.setValue(this.api.getPropertyMeta("Basics.SelectedDate").value)):this.api.getPropertyMeta("Basics.SelectedDate")&&(a&&this.datePicker.updateDateInputField(this.api.getPropertyMeta("Basics.SelectedDate").defaultValue),this.datePicker.setValue(this.api.getPropertyMeta("Basics.SelectedDate").defaultValue)),null===this.previousPickerType&&(this.previousPickerType=this.currentPickerType.viewstateType),this.previousPickerType!==e.viewstateType&&this.setStyle(),this.previousPickerType=e.viewstateType,$.datepicker._gotoToday=function(e){var t=this._getInst($(e)[0]),i=this._get(t,"timepicker"),o=d.convertValueToMoment(null),o=d.convertMomentToDatePicker(o);this._base_gotoToday(e),this._setTime(t,o),this._setDate(t,o),i._onSelectHandler(),this._setDateDatepicker($(e)[0],o)},this.setWidth()),this.listenTo(this.datePicker,"change",function(){s.setError(null),s.api.setProperty("Basics.SelectedDate",s.datePicker.getValue()),s.datePicker&&s.datePicker.setValue(s.api.getPropertyMeta("Basics.SelectedDate").value)}),this.listenTo(this.datePicker,"close",function(){s.$errorTooltip&&s.$errorTooltip.is(":visible")&&s.$errorTooltip.hasClass("internal-invalid-error")&&s.datePicker.previousDate&&(s.setError(null),s.api.setProperty("Basics.SelectedDate",s.datePicker.previousDate),s.datePicker)&&s.api.getPropertyMeta("Basics.SelectedDate")&&s.datePicker.setValue(s.api.getPropertyMeta("Basics.SelectedDate").value)}),this.listenTo(this.datePicker,"invalid",function(){s.setError(g.ERROR_TABLE.invalid)}),this.listenTo(this.datePicker,"valid",function(){s.setError(null)}),this.listenTo(this.datePicker,"unavailable",function(){s.setError(g.ERROR_TABLE.unavailable)}),_.isEmpty(this.availableDates)||this.datePicker.$el.find(".hasDatepicker").trigger("keyup")},g.prototype.onScroll=function(){this.onResize()},g.prototype.onResize=function(){var e,t;this.error&&this.setError(this.error),this.datePicker.hasFocus&&this.$datePickerContainer&&(e=this.$datePickerContainer[0].getBoundingClientRect(),(t=$("#ui-datepicker-div")[0]).style.top=e.bottom+"px",t.style.left=e.left+"px")},g.prototype.removeDatePicker=function(){this.datePicker&&(this.stopListening(this.datePicker),this.datePicker.remove(),this.datePicker=null)},g.prototype.isTopMostElement=function(e){var t=e.getBoundingClientRect(),t=document.elementFromPoint(t.x+t.width/2,t.y+t.height/2);return t===e||(null==t?void 0:t.classList)&&(null==t?void 0:t.classList.contains("field-error"))},g.prototype.setError=function(e){var t;(this.error=e)?(this.$el.addClass(this.errorClassName),this.$errorTooltip&&r.ErrorTooltip.clear(this.$errorTooltip),this.isTopMostElement(this.el.querySelectorAll(".hasDatepicker")[0])&&(this.$errorTooltip=r.ErrorTooltip.show(e.msg,this.el.querySelectorAll(".hasDatepicker")[0])),e.cssClass&&null!=(t=this.$errorTooltip)&&t.addClass(e.cssClass),this.$btnShowPopup.addClass("datePickerButtonError"),this.$("#"+this.datePicker.id).addClass("datePickerInputBoxError")):(this.$el.removeClass(this.errorClassName),this.$btnShowPopup.removeClass("datePickerButtonError"),this.$("#"+this.datePicker.id).removeClass("datePickerInputBoxError"),r.ErrorTooltip.clear(this.$errorTooltip))},g.prototype.setFlagVisible=function(){this.visible=$("#ui-datepicker-div").is(":visible")},g.prototype.setStyle=function(){var e,t=this.api.getPropertyMeta("Basics.SelectedDate"),t=t?t.viewstateType:null,i={"has-container":_.includes(["date","datetime","timestamp",null],t),"has-button":_.includes(["date","datetime",null],t),"datepicker-extended":"datetime"===t,"month-extended":"month"===t,"timespan-extended":"timespan"===t,"timestamp-extended":"timestamp"===t};for(e in i)this.$datePickerContainer.toggleClass(e,i[e])},g.prototype.setWidth=function(){_.isFunction(this.datePicker.setWidth)&&this.datePicker.setWidth(this.viewModel.get("Basics.width"))},g.prototype.updateLabelWidth=function(){var e=this.viewModel.get("Basics.labelWidth");e&&this.$lbl.css("width",e)},g.prototype.updateQueryStatus=function(e,t){t?"NoResults"!==t.type&&this.api.showQueryStatus(t):this.api.hideQueryStatus()},g.ERROR_TABLE={invalid:{msg:"Invalid date/time",cssClass:"internal-invalid-error"},unavailable:{msg:"Date out of scope",cssClass:"internal-unavailable-error"}};var u,j=g;function g(e){var t=u.call(this,_.extend(e,{tagName:"div",className:"basicComponents_datePicker"}))||this;return t.selectedChanged=!1,t.error=null,t.defaultType="date",t.errorClassName="error",t.hasInit=!1,t.selectedDateType=null,t.currentPickerType={viewstateType:null},t.previousPickerType=null,t.columns=[{id:"",index:0,kdbType:0}],t.primaryKey=null,t.intersectionObserver=null,t.api=e.options.api,t.visible=!1,t.availableDates=null,t.dateCollection=new l.Collection,t.viewModel=new l.DeepModel({SelectedDate:""}),t.debouncedRenderDatePicker=_.debounce(t.renderDatePicker.bind(t),100),t.onDebouncedResize=_.debounce(t.onResize.bind(t),5),t.currentPickerType.viewstateType=t.defaultType,t.options=e.options,t.listenTo(e.options.dashboardViewModel,"change:DashboardTheme",t.onThemeChanged.bind(t)),t.onThemeChanged(),t}y.escapeRegexCharacters=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g,"\\$&")},y.matchCustom=function(e,t){var i;return""===$.trim(e.term)||void 0!==t.text&&(e=e.term||"",i=t.text||"",y.isMatch(e.toLowerCase(),i.toLowerCase()))?t:null},y.isMatch=function(e,t){var i,o=!1,n=e.split(/ +and +| +/);for(_.includes(n,"or")&&(n=_.without(n,"or"),o=!0),i=0;i<n.length;i++)0!==n[i].indexOf("-")&&n[i].indexOf("*")<0&&(n[i]="*"+n[i]+"*");var a=o||_.every(n,function(e){return 0===e.indexOf("-")});return _[o?"some":"every"](n,function(e){return y.isSimpleMatch(e,t,a)})},y.isSimpleMatch=function(e,t,i){var o=!1;if(i||0!==e.indexOf("-")||(e=e.replace("-",""),o=!0),""===t){if("null"===e||"*null*"===e)return!o}else if("-null"===e)return!0;i=new RegExp("^"+y.escapeRegexCharacters(e).replace(/\*/g,".*")+"$").test(t);return o?!i:i};var W=y;function y(){}var b,U={"Basics.AcceptEmptyValues":"AcceptEmptyValues","Basics.AdvancedSearch":"AdvancedSearch","Basics.Data":"Data","Basics.Flex":"Flex","Basics.ForceSelectedValue":"ForceSelectedValue","Basics.Items":"Items","Basics.Label":"Label","Basics.LabelWidth":"LabelWidth","Basics.DataSourceMapping.Text":"MappingText","Basics.DataSourceMapping.Value":"MappingValue","Basics.Custom.Icon":"MappingIcon","Basics.Custom.IconColor":"MappingIconColor","Basics.FieldSummaryThreshold":"FieldSummaryThreshold","Basics.MultiSelect":"MultiSelect","Basics.SelectAllByDefault":"SelectAllByDefault","Basics.ShowRowCount":"ShowRowCount","Basics.SelectAllValue":"SelectAllValue","Basics.SelectedValue":"SelectedValue","Basics.SelectedObjectRouting":"SelectedObjectRouting","Basics.ShowSearch":"ShowSearch","Basics.TooltipSummaryThreshold":"TooltipSummaryThreshold","Basics.Width":"Width","Basics.EnableDropdownHeight":"EnableDropdownHeight","Basics.DropdownHeight":"DropdownHeight","Basics.horizontal":"HorizontalAlign","Basics.tooltip":"Tooltip","Basics.vertical":"VerticalAlign","Basics.SortListBySelected":"SortListBySelected",dropdownPossibleValues:"dropdownPossibleValues"},q=["date","datetime","month","timestamp","minute","time","timespan","second"],K=["byte","short","int","long","float","double"],G=(b=l.View,e(f,b),f.prototype.onSettingsChange=function(e){var i=this;_.each(e,function(e,t){"Basics.SelectedValue"===t&&(i.viewModel.set("SelectedValueCast",_.isArray(e)?e:i.castToDropdownValue(e)),i.viewModel.get("SortListBySelected"))&&(!i.viewModel.get("MultiSelect")||i.viewModel.get("MultiSelect")&&!i.isOpen)&&i.debouncedSetSelectOptions(i.currentValidDropDownItems),i.viewModel.set(U[t]||t,e)}),this.hasInit||(this.hasInit=!0,this.afterInitialize())},f.prototype.onThemeChange=function(){var e=this.viewModel.get("Theme");this.options.dashboardViewModel.get("DashboardTheme")&&(e=this.options.dashboardViewModel.get("DashboardTheme")),this.$el.prop("class",""),this.$el.addClass(this.className),this.$el.addClass(e)},f.prototype.render=function(){return this.$el.html(m.dropdown()),this.$alignDiv=this.$(".align-div"),this},f.prototype.remove=function(){return this.removeCustomStyle(),this.dataModel&&(this.stopListening(this.dataModel),this.api.unsubscribe(this.dataModel)),l.View.prototype.remove.apply(this)},f.prototype.initializeEvents=function(){this.listenTo(this.viewModel,"change:Data",this.onDataSourceChanged.bind(this)),this.listenTo(this.viewModel,"change:HorizontalAlign",this.onHorizontalAlignChanged.bind(this)),this.listenTo(this.viewModel,"change:Label",this.onLabelChanged.bind(this)),this.listenTo(this.viewModel,"change:LabelWidth",this.updateLabelWidth.bind(this)),this.listenTo(this.viewModel,"change:SelectedValue",this.onSelectedValueChange.bind(this)),this.listenTo(this.viewModel,"change:Tooltip",this.updateTooltip.bind(this)),this.listenTo(this.viewModel,"change:VerticalAlign",this.onVerticalAlignChanged.bind(this)),this.listenTo(this.viewModel,"change:Width",this.updateWidth.bind(this)),this.listenTo(this.viewModel,"change:MultiSelect",this.onMultiselect.bind(this)),this.listenTo(this.viewModel,"change:ShowRowCount",this.toggleShowRowCount.bind(this)),this.listenTo(this.viewModel,"change:AcceptEmptyValues change:Items change:MappingText change:Basics.GroupMapping.Group change:Basics.GroupMapping.GroupBychange:MappingValue change:MultiSelect change:SortListBySelected change:ShowSearch change:AdvancedSearch change:FieldSummaryThreshold change:AdvancedSearch change:FieldSummaryThreshold change:Icon change:IconColorchange:TooltipSummaryThreshold change:SelectAllValue change:ForceSelectedValue",this.debouncedRenderDropDown.bind(this)),this.listenTo(this.viewModel,"change:SelectAllByDefault",this.onSelectAllByDefault.bind(this))},f.prototype.initializeErrorHandler=function(e){var t=this;this.updateErrorMessage(),this.listenTo(e,"change:error",function(){t.updateErrorMessage()})},f.prototype.afterInitialize=function(){this.render(),this.initDropdown(),this.initLabel(),this.initializeEvents(),this.applyDataProperty(),this.onHorizontalAlignChanged(),this.onVerticalAlignChanged(),this.onLabelChanged(),this.onThemeChange(),this.debouncedRenderDropDown()},f.prototype.applyDataProperty=function(){var e=this.viewModel.get("Data");this.dataModel&&(this.stopListening(this.dataModel),this.api.unsubscribe(this.dataModel)),e?(this.dataModel=e,this.dataModel&&this.dataModel.attributes?(this.initializeErrorHandler(this.dataModel),this.api.subscribe(this.dataModel,this.onData.bind(this))):this.api.showErrorMessage({error:t('Invalid Data Source: "')+e.path+'" '+t("selected"),errorType:"Warning"})):(console.log("No datasource selected for Dropdown component"),this.api.hideErrorMessage())},f.prototype.castToDropdownValue=function(t){var e,i=this.api.getPropertyMeta("Basics.SelectedValue"),o="";return t&&t.class?(e=_.find(r.RTTI.infos,function(e){return e.num===parseInt(t.class.substr(2,2),10)}))&&(o=e.name):i&&i.viewstateType&&(o=i.viewstateType),t&&t.class&&_.includes(q,o)?(e=d.convertKDBTemporalToMoment(t),t=e.toDashString()):_.isArray(t)?t=t.join(","):_.isBoolean(t)||_.isNumber(t)||_.isObject(t)&&"function"==typeof t.toString?t=t.toString():_.isString(t)&&"timespan"===o&&-1<t.indexOf(".000Z")?t=t.replace(".000Z",".000000000Z"):_.isString(t)&&"datetime"===o&&null!==t.match(/[DTZ]/g)&&23<t.length&&(t=t.slice(0,23)+"Z"),t},f.prototype.dataSourceEnabled=function(){return this.viewModel.get("Data")instanceof l.Model},f.prototype.executeActions=function(){var i,t,o,e,n,a,s=this,l={},r=this.viewModel.get("Actions");r.length&&(i=this.viewModel.get("MultiSelect"),a=this.viewModel.get("SelectedValue"),n=this.viewModel.get("SelectAllValue"),a=i&&_.isArray(a)?a:[a],(e=!(!i||!a.length||n!==a[0]))||(o=this.dataSourceEnabled()?(t=this.viewModel.get("MappingValue"),a.map(function(e){return l[t]=e,s.collection.findWhere(l)})):a.map(function(e){return l.Value=e,_.find(s.currentValidDropDownItems,l)}),o=_.compact(o)),i||0<o.length)&&(r=e?r.map(function(e){return _.defaults({Value:[n]},e)}):r.map(function(t){var e=o.map(function(e){return _.isFunction(e.get)?e.get(t.Current):e.Value}),e=i?e:e[0];return _.defaults({Value:e},t)}),this.api.doActions(r,"Actions"))},f.prototype.forceSelectedValue=function(){var e,t=this.viewModel.get("SelectedValue"),i=_.map(this.currentValidDropDownItems,"DropdownValue"),o=this.viewModel.get("SelectAllValue"),n=[];this.viewModel.get("ForceSelectedValue")&&(this.viewModel.get("MultiSelect")?(e=_.isArray(t)?t:[t]).length&&e[0]===o||(n=_.map(t,this.castToDropdownValue.bind(this)),e=_.intersection(i,n),o=_.first(i),(0<e.length||!_.isNil(o))&&(o=0===e.length?[o]:e,this.api.setProperty("Basics.SelectedValue",o))):(n=this.castToDropdownValue(t),_.includes(i,n)||(this.currentValidDropDownItems[0]?this.api.setProperty("Basics.SelectedValue",this.currentValidDropDownItems[0].DropdownValue):this.api.setProperty("Basics.SelectedValue",""))))},f.prototype.initDropdown=function(){var i=this;this.$cmb=this.$(".basicComponents_cmb"),this.$dropdownContainer=this.$(".dropdown-container"),this.$cmb.on("select2:select select2:unselect",function(){var e,t=null;i.viewModel.get("MultiSelect")?((e=i.$cmb.select2("data")).length&&(t=_.map(e,function(e){return e.id})),i.viewModel.set("SelectedValue",t)):(t=i.dataSourceEnabled()?i.$cmb.val():(e=i.$cmb.select2("data")[0].text,(e=_.find(i.viewModel.get("Items"),{Text:e}))?e.Value:""),i.viewModel.set("SelectedValue",_.isUndefined(t)?null:t))})},f.prototype.initLabel=function(){this.$lbl=this.$(".dropdown-label")},f.prototype.onData=function(e,t){var i=this,o=e.columns;e.primaryKey!==this.primaryKey&&(this.primaryKey=e.primaryKey,this.collection.reset()),t.reset?this.collection.reset(t.reset):_.isArray(o.reset)&&_.isEmpty(o.reset)?this.collection.reset():(this.collection.remove(_.map(t.remove,function(e){return e[i.primaryKey]})),this.collection.add(t.add),this.collection.add(t.change,{merge:!0}))},f.prototype.onDataCollectionChanged=function(){var t=this,i={Text:this.viewModel.get("MappingText"),Value:this.viewModel.get("MappingValue"),Icon:this.viewModel.get("MappingIcon"),IconColor:this.viewModel.get("MappingIconColor"),GroupBy:this.viewModel.get("Basics.GroupMapping.GroupBy"),Group:this.viewModel.get("Basics.GroupMapping.Group")},e=this.collection.map(function(e){return{Value:e.get(i.Value),Text:e.get(i.Text),Icon:e.get(i.Icon),IconColor:e.get(i.IconColor),Data:e.cid,DropdownValue:t.castToDropdownValue(e.get(i.Value)),GroupBy:e.get(i.GroupBy),Group:i.Group}});this.$cmb.empty(),this.setSelectOptions(e),this.forceSelectedValue(),this.onSelectedValueChange(),this.updateWidth(),this.select&&this.select.$el.data("select2")&&this.select.$el.select2("close")},f.prototype.onDataSourceChanged=function(){this.applyDataProperty(),this.debouncedRenderDropDown()},f.prototype.onHorizontalAlignChanged=function(){this.$alignDiv.css("text-align",this.viewModel.get("HorizontalAlign"))},f.prototype.onLabelChanged=function(){this.$lbl.text(this.viewModel.get("Label"))},f.prototype.onMultiselect=function(){var e=this.$(".basicComponents_cmbCount");!this.viewModel.get("MultiSelect")&&this.viewModel.get("ShowRowCount")?this.api.setProperty("Basics.ShowRowCount",!1):"none"===e.css("display")&&this.toggleShowRowCount()},f.prototype.onSelectAllByDefault=function(){var e;this.viewModel.get("MultiSelect")&&this.viewModel.get("SelectAllByDefault")?(e=this.currentValidDropDownItems.map(function(e){return e.DropdownValue}),this.viewModel.set("SelectedValue",e)):this.viewModel.set("SelectedValue",[])},f.prototype.onSelectedValueChange=function(){var t=this,e=this.api.getPropertyMeta("Basics.SelectedValue"),i="",o=this.viewModel.get("SelectedValue"),n=[],a=0,s=0,l=(void 0!==o&&this.executeActions(),_.find(this.currentValidDropDownItems,function(e){return e.DropdownValue===o||e.DropdownValue===t.castToDropdownValue(o)})),e=(_.isObject(l)&&_.isBoolean(l.Value)&&(o=l.Value),e&&(i=e.viewstateType),l=o,_.includes(K,i)&&_.isNumber(o)?l=Number(o):"list"===i&&_.isString(o)&&(l=o.split(",")),e&&!_.isEqual(e.value,l)&&"dict"!==i&&(this.viewModel.set("SelectedValue",l,{silent:!0}),this.api.setProperty("Basics.SelectedValue",l)),_.map(this.currentValidDropDownItems,"DropdownValue"));this.viewModel.get("MultiSelect")?(this.dataSourceEnabled()?this.viewModel.get("Data")&&this.viewModel.get("Data").dataSet&&(a=this.viewModel.get("Data").dataSet.collection.length):a=(this.viewModel.get("Items")||[]).length,null!=l&&("dict"===i?l=n=_.chain(l).values().map(this.castToDropdownValue.bind(this)).value():n=_.isArray(l)?l:[this.castToDropdownValue(l)],s=Math.min(a,_.intersection(e,n).length)),this.$(".basicComponents_cmbCount").text(s+" / "+a),_.isEqual(l,this.$cmb.val())||this.$cmb.val(l).trigger("change")):(i=this.castToDropdownValue(l),e.length&&(_.includes(e,i)?this.$cmb.val(i):this.$cmb.val("")).trigger("change"),this.updateWidth())},f.prototype.onVerticalAlignChanged=function(){this.$alignDiv.css("vertical-align",this.viewModel.get("VerticalAlign"))},f.prototype.removeCustomStyle=function(){this.$styleEl&&(this.$styleEl.remove(),this.$styleEl=null)},f.prototype.renderDropDown=function(){var e,t=this,i=this.viewModel.get("ShowSearch"),o=this.api.getPropertyMeta("Basics.SelectedValue");this.$dropdownContainer.empty(),e=this.viewModel.get("MultiSelect")?l.Form.editors.MultiSelect:l.Form.editors.Select,this.select&&(this.select.off(),this.select.remove()),this.select=new e(_.extend({model:this.viewModel,schema:{dropdownId:this.dropdownId,enforceValue:this.viewModel.get("ForceSelectedValue"),onReadyCallback:this.options.onReadyCallback,inputItemLimit:this.viewModel.get("FieldSummaryThreshold"),options:_.map(this.currentValidDropDownItems,function(e){return{label:e.Text,val:e.DropdownValue||e.Value,Icon:e.Icon,IconColor:e.IconColor}})||[],matcher:this.viewModel.get("AdvancedSearch")?W.matchCustom:null,multiSelect:this.viewModel.get("MultiSelect"),selectAllValue:this.viewModel.get("SelectAllValue"),sortListBySelected:this.viewModel.get("SortListBySelected"),showSearch:i,tooltip:function(e){return t.viewModel.get("Tooltip")?t.viewModel.get("Tooltip"):e},tooltipItemLimit:this.viewModel.get("TooltipSummaryThreshold"),viewstateType:o?o.viewstateType:null,width:this.viewModel.get("Width")}},_.zipObject(["key"],["SelectedValueCast"]))),this.$dropdownContainer.width(this.viewModel.get("Width")),this.$dropdownContainer.append(this.select.el),this.$lbl&&(e=_.uniqueId("label"),this.$lbl.attr("id",e),this.select.$el.attr("aria-labelledby",e)),this.select.$el.on("select2:open",function(){t.isOpen=!0}),this.select.on("change",function(){t.viewModel.set("SelectedValue",t.select.getValue()),t.updateTooltip()}),this.select.$el.on("select2:closing",function(){t.viewModel.get("SortListBySelected")&&t.setSelectOptions(t.currentValidDropDownItems),t.isOpen=!1}),this.dataSourceEnabled()?(i={Text:this.viewModel.get("MappingText"),Value:this.viewModel.get("MappingValue"),Icon:this.viewModel.get("MappingIcon"),IconColor:this.viewModel.get("MappingIconColor")}).Value&&i.Text&&this.dataModel?(this.$cmb.empty(),this.onDataCollectionChanged()):(this.currentValidDropDownItems=[],this.$cmb.empty(),this.setSelectOptions(this.currentValidDropDownItems),this.forceSelectedValue()):(this.currentValidDropDownItems=[],this.$cmb.empty(),o=_.map(this.viewModel.get("Items"),function(e){return{Value:e.Value,Text:e.Text,Icon:e.Icon,IconColor:e.IconColor,DropdownValue:t.castToDropdownValue(e.Value)}}),this.setSelectOptions(o),this.forceSelectedValue(),this.onSelectedValueChange()),this.updateWidth(),this.onMultiselect(),this.updateLabelWidth(),this.updateTooltip()},f.prototype.setSelectOptions=function(e){var i,t=this.viewModel.get("AcceptEmptyValues");this.viewModel.get("SortListBySelected");_.each(e,function(e){_.isArray(e.Value)&&(e.Value=e.Value.join(","))}),this.currentValidDropDownItems=t?e:_.filter(e,function(e){return null!==e.Value&&void 0!==e.Value&&""!==e.Value}),this.select&&(this.viewModel.get("Basics.GroupMapping.Group")?(t=_.chain(this.currentValidDropDownItems).groupBy("GroupBy").value(),i=[],_.each(t,function(e,t){i.push({group:t,options:_.map(e,function(e){return{label:e.Text,val:e.DropdownValue||e.Value,Icon:e.Icon,IconColor:e.IconColor}})})}),this.select.setOptions(i)):this.select.setOptions(_.map(this.currentValidDropDownItems,function(e){return{label:e.Text,val:e.DropdownValue||e.Value,Icon:e.Icon,IconColor:e.IconColor}}))),this.viewModel.get("SelectAllByDefault")&&this.onSelectAllByDefault()},f.prototype.toggleShowRowCount=function(){var e=this.$(".basicComponents_cmbCount"),t=this.$el.find(".select2.select2-container");this.viewModel.get("ShowRowCount")?(this.viewModel.get("MultiSelect")||this.api.setProperty("Basics.MultiSelect",!0),t.addClass("dropdown-count-enabled"),e.show()):(t.removeClass("dropdown-count-enabled"),e.hide())},f.prototype.updateErrorMessage=function(){this.dataModel&&this.dataModel.get("error")?this.api.showErrorMessage(this.dataModel.get("error")):this.api.hideErrorMessage()},f.prototype.updateLabelWidth=function(){var e=this.viewModel.get("LabelWidth"),e=Number(e);_.isNumber(e)&&!_.isNaN(e)&&this.$(".dropdown-label").css("width",e)},f.prototype.updateTooltip=function(){var e,t,i;this.viewModel.get("Tooltip")?(this.$el.find(".dropdown-container").prop("title",this.viewModel.get("Tooltip")),this.$el.find(".select2-selection__rendered").prop("title",this.viewModel.get("Tooltip"))):this.viewModel.get("MultiSelect")?(t=this.select.model.get("SelectedValue")===this.viewModel.get("SelectAllValue")?this.select.value:this.select.model.get("SelectedValue"),i=this.viewModel.get("TooltipSummaryThreshold"),t&&_.isArray(t)?e=t.slice(0,i||t.length).join(", "):t&&_.isString(t)&&(e=t),t.length>i&&0!==i&&(e+=" and "+(t.length-i)+" more"),this.$el.find(".dropdown-container").prop("title",e),this.$el.find(".select2-selection__rendered").prop("title",e)):(this.$el.find(".dropdown-container").prop("title",this.viewModel.get("SelectedValue")),this.$el.find(".select2-selection__rendered").prop("title",this.viewModel.get("SelectedValue")))},f.prototype.updateWidth=function(){var e=this.viewModel.get("Width");this.select&&this.select.setWidth(e)},f);function f(e){var t=b.call(this,_.extend(e,{tagName:"div",className:"basicComponents_dropdown"}))||this;return t.currentValidDropDownItems=[],t.handlebarFn=null,t.$styleEl=null,t.hasInit=!1,t.isOpen=!1,t.dropdownId="",t.dataModel=null,t.options=e.options,t.api=t.options.api,t.viewModel=new l.DeepModel,t.primaryKey="_rowIndex",t.collection=new l.Collection([],{model:l.Model.extend({idAttribute:t.primaryKey})}),t.debouncedOnDataCollectionChanged=_.debounce(t.onDataCollectionChanged.bind(t),100),t.debouncedRenderDropDown=_.debounce(t.renderDropDown.bind(t),100),t.debouncedSetSelectOptions=_.debounce(function(e){t.setSelectOptions(e)},100),t.listenTo(t.collection,"change add remove reset",t.debouncedOnDataCollectionChanged),t.dropdownId="dropdown-container-"+t.cid,t}v=l.View,e(w,v),w.prototype.onData=function(e,t){this.dataSet=t.items(),this.updateHTML()},w.prototype.onSettingsChange=function(e){var i=this;_.each(e,function(e,t){switch(t){case"Basics.Data":i.applyDataProperty(e),i.updateHTML();break;case"Basics.FontSize":i.$el.css("font-size",e+"px");break;case"Basics.horizontal":i.$textAlign.css("text-align",e);break;case"Basics.HtmlText":i.htmlText=e,i.updateHTML();break;case"Basics.Template":try{i.api.unsubscribeTemplateViewStates(i.templateSubscriptionKey),i.template=null,i.templateSubscriptionKey=null,e?(i.template=n.compile(e),i.templateSubscriptionKey=i.api.subscribeTemplateViewStates(e,function(e){i.viewStates=e,i.updateHTML()})):i.updateHTML()}catch(e){}break;case"Basics.theme":i.theme=e,i.onThemeChange();break;case"Basics.tooltip":i.$html.prop("title",e);break;case"Basics.vertical":i.$textAlign.css("vertical-align",e)}})},w.prototype.remove=function(){return this.dataModel&&this.api.unsubscribe(this.dataModel),l.View.prototype.remove.apply(this)},w.prototype.applyDataProperty=function(e){this.dataModel&&(_.isEqual(this.dataModel,{})||this.api.unsubscribe(this.dataModel),this.dataModel=null),e&&(this.dataModel=e,this.dataModel&&this.dataModel.attributes?(this.api.hideErrorMessage(),this.api.subscribe(this.dataModel,this.onData.bind(this))):this.api.showErrorMessage({error:t("Invalid Data Source")+': "'+this.dataModel.path+'" '+t("selected"),type:"Warning"}))},w.prototype.onThemeChange=function(){var e=this.theme;this.dashboardViewModel.get("DashboardTheme")&&(e=this.dashboardViewModel.get("DashboardTheme")),this.$el.prop("class",""),this.$el.addClass(this.className),this.$el.addClass(e)},w.prototype.parseTextToHtml=function(e){return e=(e=(e=""+e).replace(/\n/g,"<br>")).replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")},w.prototype.stringify=function(e){return _.isArray(e)?JSON.stringify(e):_.isObject(e)?_.isFunction(e.toString)&&"[object Object]"!==e.toString()?e.toString():JSON.stringify(e):e},w.prototype.updateHTML=function(){this.dataModel?this.template?this.$html.html(this.template(_.extend(this.dataSet,this.viewStates))):this.$html.text(this.stringify(this.dataSet)):this.htmlText?this.$html.html(this.stringify(this.htmlText)):this.$html.html(this.parseTextToHtml(this.stringify(this.htmlText)))};var v,Q=w;function w(e){var t=v.call(this,_.extend(e,{tagName:"div",className:"basicComponents_label"}))||this;return t.template=null,t.htmlText="",t.dataModel=null,t.theme="Dark",t.dataSet=[],t.api=e.options.api,t.templateSubscriptionKey=null,t.api=e.options.api,t.dashboardViewModel=e.options.dashboardViewModel,t.$el.html(m.label()),t.$el.css({height:"100%"}),t.$textAlign=t.$(".text-align"),t.$html=t.$el.find(".htmlContent"),t.onThemeChange(),t}S=l.View,e(T,S),T.prototype.onSettingsChange=function(e){var i=this;_.each(e,function(e,t){_.isObject(e)&&_.isEmpty(e)||i.viewModel.set(t,e)})},T.prototype.remove=function(){return this.removeCustomStyle(),this.$button.off(),this.$button.button("destroy"),l.View.prototype.remove.apply(this)},T.prototype.render=function(){return this.$el.html(m.linkButton(this.viewModel.get("Basics"))),this.$button=this.$el.find(".button-root"),this.$button.attr("id",this.buttonId),this.$button.button().click(this.onButtonClick.bind(this)),this.$alignDiv=this.$(".align-div"),this.onWidthChange(),this.onAlignHorizontalChanged(),this.onAlignVerticalChanged(),this},T.prototype.contrast=function(t,i){var e=[[1,3],[3,5],[5,7]].map(function(e){return+("0x"+t.substring(e[0],e[1]))}),o=127.5<e.reduce(function(e,t,i,o){return t+e/o.length},0);return"#"+(e=e.map(function(e){var t=o?e:255-e;return Math.floor(o?e-t*i:e+t*i)})).map(function(e){return("0"+e.toString(16)).slice(-2)}).join("")},T.prototype.initializeEvents=function(){this.listenTo(this.viewModel,"change:Basics.FontSize",this.onFontSizeChanged.bind(this)),this.listenTo(this.viewModel,"change:Basics.horizontal",this.onAlignHorizontalChanged.bind(this)),this.listenTo(this.viewModel,"change:Basics.Label",this.onLabelChanged.bind(this)),this.listenTo(this.viewModel,"change:Basics.Icon",this.onIconChanged.bind(this)),this.listenTo(this.viewModel,"change:Basics.tooltip",this.onTooltipChange.bind(this)),this.listenTo(this.viewModel,"change:Basics.vertical",this.onAlignVerticalChanged.bind(this)),this.listenTo(this.viewModel,"change:Basics.fixedWidth",this.onWidthChange.bind(this)),this.listenTo(this.viewModel,"change:Basics.width",this.onWidthChange.bind(this)),this.listenTo(this.viewModel,"change:Style.background",this.onBackgroundChange.bind(this)),this.listenTo(this.viewModel,"change:Style.color",this.onColorChange.bind(this)),this.listenTo(this.viewModel,"change:Style.border",this.onBorderChange.bind(this)),this.listenTo(this.viewModel,"change:Basics.isEnabled",this.toggleButton.bind(this))},T.prototype.createCustomStyle=function(){var e;this.$styleEl||((e=document.createElement("style")).type="text/css",document.head.appendChild(e),this.$styleEl=$(e))},T.prototype.onAlignHorizontalChanged=function(){this.$alignDiv.css("text-align",this.viewModel.get("Basics.horizontal"))},T.prototype.onAlignVerticalChanged=function(){this.$alignDiv.css("vertical-align",this.viewModel.get("Basics.vertical"))},T.prototype.onBackgroundChange=function(e,t){var i,o,n=this;t?(this.createCustomStyle(),t=this.getGradientColors(t),i=_.map(t,function(e){return n.contrast(e,.1)}),o=_.map(i,function(e){return n.contrast(e,.1)}),t=m.linkButtonCustomStyle({cid:this.buttonId,c0:t[0],c1:t[1],c2:t[2],h0:i[0],h1:i[1],h2:i[2],a0:o[0],a1:o[1],a2:o[2]}),this.$styleEl.text(t)):this.removeCustomStyle()},T.prototype.onBorderChange=function(e,t){this.$button.css({"border-color":t})},T.prototype.onButtonClick=function(){this.api.doActions(this.viewModel.get("Actions"),"Actions")},T.prototype.onColorChange=function(e,t){this.$button.css({color:t})},T.prototype.onFontSizeChanged=function(){this.$button.css("font-size",parseFloat(this.viewModel.get("Basics.FontSize")))},T.prototype.onIconChanged=function(){var e=this.viewModel.get("Basics.Icon");""!==e&&(0<=e.indexOf("mi-")?e="mi "+e:0<=e.indexOf("fa-")&&(e="fa "+e)),this.$button.button("option","icon",e||null)},T.prototype.onLabelChanged=function(){this.$button.button("option","label",this.viewModel.get("Basics.Label")||"&nbsp;")},T.prototype.onTooltipChange=function(){this.$button.prop("title",this.viewModel.get("Basics.tooltip"))},T.prototype.onWidthChange=function(){var e=this.viewModel.get("Basics.width"),t=this.viewModel.get("Basics.fixedWidth");e&&t?this.$button.width(e):(t=this.getAlignmentPaddings(),this.$button.css("width","calc(100% - ".concat(t,"px)")))},T.prototype.getAlignmentPaddings=function(){var i=this;return["Alignment.innerPaddingLeft","Alignment.innerPaddingRight","Alignment.paddingLeft","Alignment.paddingRight"].reduce(function(e,t){t=i.api.getProperty(t);return e+Number(t)},0)},T.prototype.getGradientColors=function(t){return _.map([[1,3],[3,5],[5,7]],function(e){return+("0x"+t.substring(e[0],e[1]))}).reduce(function(t,e,i,o){return t[i]=o.map(function(e){return e*t[i]}),t},[.8354430379746836,.9620253164556962,1]).map(function(e){return e.reduce(function(e,t){t=Math.round(t).toString(16);return e+(1===t.length?"0":"")+t},"#")})},T.prototype.removeCustomStyle=function(){this.$styleEl&&(this.$styleEl.remove(),this.$styleEl=null)},T.prototype.toggleButton=function(){var e=this.viewModel.get("Basics.isEnabled")?"enable":"disable";this.$button.button(e)};var S,Y=T;function T(e){var t=S.call(this,_.extend(e,{className:"link-button"}))||this;return t.buttonId=null,t.$styleEl=null,t.buttonId=t.cid+"btn",t.api=e.options.api,t.dashboardAppModel=e.options.dashboardAppModel,t.dashboardViewModel=e.options.dashboardViewModel,t.viewModel=new l.DeepModel,t.render(),t.initializeEvents(),t}var M,Z={"Basics.AcceptEmptyValues":"AcceptEmptyValues","Basics.Data":"Data","Basics.ForceSelectedValue":"ForceSelectedValue","Basics.Items":"Items","Basics.Label":"Label","Basics.LabelWidth":"LabelWidth","Basics.DataSourceMapping.Text":"MappingText","Basics.DataSourceMapping.Value":"MappingValue","Basics.MultiSelect":"MultiSelect","Basics.DoubleClick":"DoubleClick","Basics.SelectedValue":"SelectedValue","Basics.SelectedObjectRouting":"SelectedObjectRouting","Basics.UseDataSource":"UseDataSource","Basics.horizontal":"HorizontalAlign","Basics.vertical":"VerticalAlign","Basics.ItemsLayout":"ItemsLayout","Style.labelTemplate":"labelTemplate"},J=["date","datetime","month","timestamp","minute","time","timespan","second"],X=["byte","short","int","long","float","double"],ee=(M=l.View,e(C,M),C.prototype.onSettingsChange=function(e){var i=this;_.each(e,function(e,t){i.viewModel.set(Z[t]||t,e)}),this.hasInit||(this.hasInit=!0,this.afterInitialize())},C.prototype.onThemeChange=function(){var e=this.viewModel.get("Theme");this.options.dashboardViewModel.get("DashboardTheme")&&(e=this.options.dashboardViewModel.get("DashboardTheme")),this.$el.prop("class",""),this.$el.addClass(this.className),this.$el.addClass(e)},C.prototype.render=function(){return this.$el.html(m.radio()),this.$alignDiv=this.$(".align-div"),this},C.prototype.remove=function(){return this.dataModel&&(this.stopListening(this.dataModel),this.api.unsubscribe(this.dataModel)),this.unsubscribeTemplateViewStates(),l.View.prototype.remove.apply(this)},C.prototype.renderDropDown=function(){var e;this.viewModel.get("UseDataSource")?(e={Text:this.viewModel.get("MappingText"),Value:this.viewModel.get("MappingValue")}).Value&&e.Text&&this.dataModel?(this.$cmb.find("input").off(),this.$cmb.empty(),this.onDataCollectionChanged()):(this.currentValidDropDownItems=[],this.$cmb.find("input").off(),this.$cmb.empty(),this.appendItemsToDropdown(this.currentValidDropDownItems),this.forceSelectedValue(),this.updateLabelWidth()):(this.currentValidDropDownItems=[],this.$cmb.find("input").off(),this.$cmb.empty(),e=this.viewModel.get("Items"),this.appendItemsToDropdown(e),this.forceSelectedValue(),this.selectValueInDropdown(),this.updateLabelWidth()),this.onItemsLayoutChanged()},C.prototype.initializeEvents=function(){this.listenTo(this.viewModel,"change:Data change:UseDataSource",this.onDataSourceChanged.bind(this)),this.listenTo(this.viewModel,"change:HorizontalAlign",this.onHorizontalAlignChanged.bind(this)),this.listenTo(this.viewModel,"change:Label",this.onLabelChanged.bind(this)),this.listenTo(this.viewModel,"change:LabelWidth",this.updateLabelWidth.bind(this)),this.listenTo(this.viewModel,"change:SelectedValue",this.selectValueInDropdown.bind(this)),this.listenTo(this.viewModel,"change:VerticalAlign",this.onVerticalAlignChanged.bind(this)),this.listenTo(this.viewModel,"change:ItemsLayout",this.onItemsLayoutChanged.bind(this)),this.listenTo(this.viewModel,"change:ForceSelectedValue",this.forceSelectedValue.bind(this)),this.listenTo(this.viewModel,"change:AcceptEmptyValues change:Items change:MappingText change:MappingValue change:MultiSelect change:labelTemplate",this.debouncedRenderDropDown.bind(this))},C.prototype.initializeErrorHandler=function(e){this.updateErrorMessage(),this.listenTo(e,"change:error",this.updateErrorMessage.bind(this))},C.prototype.afterInitialize=function(){this.render(),this.initDropdown(),this.initLabel(),this.initializeEvents(),this.applyDataProperty(),this.onHorizontalAlignChanged(),this.onVerticalAlignChanged(),this.onLabelChanged(),this.onThemeChange(),this.debouncedRenderDropDown()},C.prototype.isSingleCheckBox=function(){return!this.viewModel.get("UseDataSource")&&1===this.viewModel.get("Items").length||this.viewModel.get("UseDataSource")&&1===this.collection.models.length},C.prototype.appendItemsToDropdown=function(e){var l=this,t=null,i=this.viewModel.get("AcceptEmptyValues"),r=this.viewModel.get("MultiSelect"),o=_.uniqueId("radio_"),c=_.uniqueId("radio_group_name_"),p=this.viewModel.get("labelTemplate"),d=$(document.createDocumentFragment());p&&""!==p&&(this.handlebarFn=n.compile(p)),_.each(e,function(e){_.isArray(e.Value)&&(e.Value=e.Value.join(","))}),this.currentValidDropDownItems=i?e:_.filter(e,function(e){return null!==e.Value&&void 0!==e.Value&&""!==e.Value}),0!==this.currentValidDropDownItems.length&&(!i||r||_.find(this.currentValidDropDownItems,function(e){return""===e.DropdownValue||null===e.Value||void 0===e.Value||""===e.Value}))||(e=document.createElement("input"),i=document.createElement("label"),t=document.createElement("div"),$(e).attr("type",r?"checkbox":"radio"),$(e).attr("id",o),$(e).attr("name",c),$(e).val(""),$(e).attr("data",null),$(i).attr("for",o),$(i).text("-"),t.appendChild(e),t.appendChild(i),d.append(t)),this.unsubscribeTemplateViewStates(),_.each(this.currentValidDropDownItems,function(t){var e=document.createElement("input"),i=null===t.Text||void 0===t.Text?"":t.Text,o=document.createElement("label"),n=document.createElement("div"),a=_.uniqueId("radio_");if($(e).attr("type",r?"checkbox":"radio"),$(e).attr("id",a),$(e).attr("name",c),$(o).attr("for",a),l.handlebarFn){var s="";try{l.subscriptionKeys.push(l.api.subscribeTemplateViewStates(p,function(e){s=l.handlebarFn(_.extend({},t,t.Row||{},e)),$(o).html(s)}))}catch(e){s=""}$(o).html(s)}else $(o).text(i);(null===t.DropdownValue||void 0===t.DropdownValue||t.Value&&!t.DropdownValue)&&(t.DropdownValue=t.Value),$(e).val(t.DropdownValue),$(e).attr("data",t.Data),n.appendChild(e),n.appendChild(o),d.append(n)}),this.$cmb.append(d),this.$cmb.find("input").on("change",function(){var e;l.viewModel.get("MultiSelect")?(e=_.map(l.$cmb.find("input:checked"),function(e){return $(e).val()}),l.isSingleCheckBox()&&(e=_.first(e))):e=l.$cmb.find("input:checked").val(),l.viewModel.set("SelectedValue",e)}),this.$cmb.find("input[type='checkbox'], label").on("dblclick",function(e){var t,i;l.viewModel.get("DoubleClick")&&((e=$(e.target)).is("label")&&(t=e.attr("for"),e=l.$cmb.find("#".concat(t))),0===(i=(t=l.$cmb.find("input[type='checkbox']")).filter(":checked")).length||1<i.length?(t.prop("checked",!1),e.prop("checked",!0)):1===i.length&&t.prop("checked",!0),t.trigger("change"))})},C.prototype.applyDataProperty=function(){var e=this.viewModel.get("Data");this.dataModel&&(this.stopListening(this.dataModel),this.api.unsubscribe(this.dataModel)),this.viewModel.get("UseDataSource")&&(e?(this.dataModel=e,this.dataModel&&this.dataModel.attributes?(this.initializeErrorHandler(this.dataModel),this.api.subscribe(this.dataModel,this.onData.bind(this))):this.api.showErrorMessage({error:t('Invalid Data Source: "')+e.path+'" '+t("selected"),errorType:"Warning"})):this.api.showErrorMessage({error:t("To populate this component, please define a")+" <b> "+t("Data Source")+"</b> "+t("from")+"<b>"+t("Properties")+"-"+t("Basics")+"</b>",type:"Warning"}))},C.prototype.castToDropdownValue=function(t){var e,i,o=this.api.getPropertyMeta("Basics.SelectedValue"),n="";if(t&&t.class?(i=_.find(r.RTTI.infos,function(e){return e.num===parseInt(t.class.substr(2,2),10)}))&&(n=i.name):o&&o.viewstateType&&(n=o.viewstateType),t&&t.class&&_.includes(J,n))switch(e=d.convertKDBTemporalToMoment(t),n){case"date":t=e.format("YYYY-MM-DD");break;case"month":t=e.format("YYYY-MM");break;case"datetime":case"timestamp":case"minute":case"time":case"timespan":case"second":t=e.toISOStringNano()}else _.isArray(t)?t=t.join(","):(_.isBoolean(t)||_.isNumber(t)||_.isObject(t)&&_.isFunction(t.toString))&&(t=t.toString());return t},C.prototype.executeActions=function(){var t,i,o,n,a=this,s={},l=this.api.getProperty("Basics.ItemActionEvent"),e=this.viewModel.get("Actions");if(e.length){if(t=this.viewModel.get("MultiSelect"),n=this.viewModel.get("SelectedValue"),n=t&&_.isArray(n)?n:[n],this.viewModel.get("UseDataSource"))i=this.viewModel.get("MappingValue"),o=n.map(function(e){return s[i]=e,a.collection.findWhere(s)});else{if("None"===l)return;o=n.map(function(e){return s.Value=e,_.find(a.currentValidDropDownItems,s)})}o=_.compact(o),(t||0<o.length)&&(e=e.map(function(i){var e=o.map(function(e){var t;return _.isFunction(e.get)?t=e.get(i.Current):"Always"===l?t=e.Value:"Value"===l?0<=n.indexOf(e.Value)&&(t=e.Value):"Index"===l&&0<=_.without(_.map(a.currentValidDropDownItems,function(e,t){if(0<=n.indexOf(e.Value))return t}),void 0).indexOf(parseInt(i.Current,10))&&(t=e.Value),t}),e=t?e:e[0];return _.defaults({Value:e},i)}),this.api.doActions(e,"Actions"))}},C.prototype.forceSelectedValue=function(){var e=this.viewModel.get("SelectedValue"),e=this.castToDropdownValue(e),t=_.map(this.currentValidDropDownItems,"DropdownValue");this.viewModel.get("ForceSelectedValue")&&!_.includes(t,e)&&(this.viewModel.get("MultiSelect")?this.api.setProperty("Basics.SelectedValue",t[0]):this.currentValidDropDownItems[0]?this.api.setProperty("Basics.SelectedValue",this.currentValidDropDownItems[0].DropdownValue):this.api.setProperty("Basics.SelectedValue",""))},C.prototype.initDropdown=function(){this.$cmb=this.$(".radio_buttons")},C.prototype.initLabel=function(){this.$lbl=this.$(".basicComponents_cmbLbl")},C.prototype.onData=function(e,t){var i,o=this,n=e.columns;e.primaryKey!==this.primaryKey&&(this.primaryKey=e.primaryKey,this.collection.reset()),n.reset&&(i=[""].concat(_.map(n.reset,function(e){return e.id})),!_.includes(i,this.viewModel.get("MappingValue"))&&n.reset.length&&this.api.setProperty("Basics.DataSourceMapping.Value",""),!_.includes(i,this.viewModel.get("MappingText"))&&n.reset.length&&this.api.setProperty("Basics.DataSourceMapping.Text",""),_.defer(function(){o.api.setProperty("dropdownPossibleValues",i)})),t.reset?this.collection.reset(t.reset):_.isArray(n.reset)&&_.isEmpty(n.reset)?this.collection.reset():(this.collection.remove(_.map(t.remove,function(e){return e[o.primaryKey]})),this.collection.add(t.add),this.collection.add(t.change,{merge:!0}))},C.prototype.onDataCollectionChanged=function(){var t=this,i={Text:this.viewModel.get("MappingText"),Value:this.viewModel.get("MappingValue")},e=this.collection.map(function(e){return{Value:e.get(i.Value),Text:e.get(i.Text),Data:e.cid,Row:e.attributes,DropdownValue:t.castToDropdownValue(e.get(i.Value))}});this.$cmb.find("input").off(),this.$cmb.empty(),this.appendItemsToDropdown(e),this.forceSelectedValue(),this.selectValueInDropdown()},C.prototype.onDataSourceChanged=function(){this.applyDataProperty(),this.debouncedRenderDropDown()},C.prototype.onHorizontalAlignChanged=function(){this.$alignDiv.css("text-align",this.viewModel.get("HorizontalAlign"))},C.prototype.onItemsLayoutChanged=function(){var e=this.viewModel.get("ItemsLayout");"Horizontal"===e?(this.$cmb.toggleClass("horizontal",!0),this.$cmb.toggleClass("vertical",!1)):"Vertical"===e&&(this.$cmb.toggleClass("horizontal",!1),this.$cmb.toggleClass("vertical",!0))},C.prototype.onLabelChanged=function(){this.$lbl.text(this.viewModel.get("Label"))},C.prototype.onVerticalAlignChanged=function(){this.$alignDiv.css("vertical-align",this.viewModel.get("VerticalAlign"))},C.prototype.selectValueInDropdown=function(){var e="",o=this.viewModel.get("SelectedValue"),t=this.api.getPropertyMeta("Basics.SelectedValue"),i=(void 0!==o&&this.executeActions(),_.find(this.currentValidDropDownItems,function(e){return e.DropdownValue===o}));_.isObject(i)&&_.isBoolean(i.Value)&&(o=i.Value),t&&(e=t.viewstateType),i=o,_.includes(X,e)?i=Number(o):"list"===e&&_.isString(o)?i=o.split(","):_.isBoolean(o)&&(i=o),e&&this.api.setProperty("Basics.SelectedValue",i),this.viewModel.get("MultiSelect")?o?(_.isArray(o)||(o=_.isString(o)?[o.split(",")]:[o]),this.isSingleCheckBox()&&(o=_.first(o)),this.$cmb.find("input").each(function(e,t){var t=$(t),i=t.val();i&&(_.includes(o,i)||_.isEqual(o.toString(),i.toString()))?t.prop("checked",!0):t.prop("checked",!1)})):this.viewModel.get("AcceptEmptyValues")?this.$cmb.find("input:not([name])").prop("checked",!0):this.$cmb.find("input").prop("checked",!1):(t=this.castToDropdownValue(o),(e=_.map(this.currentValidDropDownItems,"DropdownValue")).length&&(_.includes(e,t)?(this.$cmb.find('input[value="'+t+'"]').prop("checked",!0),this.$cmb.val(t)):(this.$cmb.find("input").prop("checked",!1),this.$cmb.val(""))).trigger("change"))},C.prototype.unsubscribeTemplateViewStates=function(){var t=this;0<this.subscriptionKeys.length&&(_.each(this.subscriptionKeys,function(e){t.api.unsubscribeTemplateViewStates(e)}),this.subscriptionKeys=[])},C.prototype.updateErrorMessage=function(){this.dataModel&&this.dataModel.get("error")?this.api.showErrorMessage(this.dataModel.get("error")):this.api.hideErrorMessage()},C.prototype.updateLabelWidth=function(){this.viewModel.get("LabelWidth")&&this.$(".basicComponents_cmbLbl").css("width",this.viewModel.get("LabelWidth"))},C);function C(e){var t=M.call(this,_.extend(e,{tagName:"div",className:"basicComponents_radio"}))||this;return t.handlebarFn=null,t.hasInit=!1,t.subscriptionKeys=[],t.currentValidDropDownItems=[],t.options=e.options,t.api=t.options.api,t.dataModel=null,t.viewModel=new l.DeepModel,t.primaryKey="_rowIndex",t.collection=new l.Collection([],{model:l.Model.extend({idAttribute:t.primaryKey})}),t.debouncedOnDataCollectionChanged=_.debounce(t.onDataCollectionChanged.bind(t),100),t.debouncedRenderDropDown=_.debounce(t.renderDropDown.bind(t),100),t.listenTo(t.collection,"change add remove reset",t.debouncedOnDataCollectionChanged.bind(t)),t}var D,V="LOAD",B="UP",te="DOWN",P="DISCONNECTED",ie=(D=l.View,e(x,D),x.prototype.remove=function(){return this.model.set("IsEnabled",!1),l.View.prototype.remove.apply(this)},x.prototype.render=function(){return this.$el.html(m.serverStatus()),this},x.prototype.executeConnectionQuery=function(){var t=this,e=this.model.get("IsEnabled"),i=this.model.get("Connection");this.pollingTimer&&clearTimeout(this.pollingTimer),e&&i?(this.model.set("Status",V),this.options.DeltaClientLib.getQueryData("kdb",i,".z.p",null,function(e){e=e.rows[0],e=e[_.keys(e)[0]],e=d.convertKDBTemporalToMoment(e);t.model.set("Status",B),t.model.set("StatusDate",e),t.setPollingTimer()},function(e){t.model.set("Status",te),t.setPollingTimer()})):this.model.set("Status",P)},x.prototype.initConnections=function(){function e(e){var t=$.Deferred();return e&&(0===e.length?e.fetch({success:t.resolve,error:t.reject}):_.defer(t.resolve)),t.promise()}var t=this,i=this.options.dashboardAppModel.get("connections"),o=this.options.dashboardAppModel.get("connectionGroups");$.when(e(i),e(o)).then(function(){var e=_.concat(o.map("name"),i.map("name"));t.settingsModel.set("possibleConnections",e),t.connectionsLoaded=!0}).fail(function(){a.Log.Warn("ServerStatus could not fetch connection or connection groups")})},x.prototype.initEventHandlers=function(){var i=this;this.listenTo(this.model,"change:IsEnabled change:Connection",this.executeConnectionQuery.bind(this)),this.listenTo(this.model,"change:Status",_.bind(function(e){var e=e.previous("Status"),t=i.model.get("Status");e===B&&t===V||i.$txtLineStatus.text(t),i.onThemeChange()},this)),this.listenTo(this.model,"change:StatusDate",_.bind(function(){var e=i.model.get("StatusDate");i.$txtServerTime.text(e.format("HH:mm:ss"))},this))},x.prototype.initUiControls=function(){this.$txtLineStatus=this.$(".txtLineStatus"),this.$txtServerTime=this.$(".txtServerTime")},x.prototype.onSettingsModelChange=function(){this.onThemeChange(),this.setOnIsEnabled(),this.setServerConnection(),this.setPollingInterval()},x.prototype.onThemeChange=function(){var e=this.model.get("Status"),t=this.settingsModel.get("Basics").Theme;switch(this.options.dashboardViewModel.get("DashboardTheme")&&(t=this.options.dashboardViewModel.get("DashboardTheme")),this.$el.prop("class",""),this.$el.addClass(this.className),this.$el.addClass(t),e){case V:this.$el.addClass("LOADING");break;case B:this.$el.addClass("UP");break;case te:this.$el.addClass("DOWN");break;case P:this.$el.addClass("DISCONNECTED")}},x.prototype.setOnIsEnabled=function(){var e=this.settingsModel.get("Basics").IsEnabled;this.model.set("IsEnabled",e)},x.prototype.setPollingInterval=function(){var e=this.settingsModel.get("Basics").PollingInterval;this.model.set("PollingInterval",e)},x.prototype.setPollingTimer=function(){var e=this,t=this.model.get("PollingInterval");this.pollingTimer=setTimeout(function(){console.log("SERVER STATUS setPollingTimer, executing"),e.executeConnectionQuery()},1e3*t)},x.prototype.setServerConnection=function(){var e=this.settingsModel.get("Basics").Connection;this.model.set("Connection",e)},x);function x(e){var t=D.call(this,_.extend(e,{tagName:"div",className:"basicComponents_serverStatus"}))||this;return t.connectionsLoaded=!1,t.options=e.options,t.settingsModel=t.options.settingsModel,t.model=new l.Model,t.render(),t.initUiControls(),t.initEventHandlers(),t.onSettingsModelChange(),t.listenTo(t.settingsModel,"change",t.onSettingsModelChange.bind(t)),t.model.set("Status",P),t.initConnections(),t.onThemeChange(),t}var k,oe={"Basics.fixedHeight":"fixedHeight","Basics.fixedWidth":"fixedWidth","Basics.FontSize":"fontsize","Basics.height":"height","Basics.horizontal":"horizontal","Basics.Type":"type","Basics.Text":"text","Basics.vertical":"vertical","Basics.width":"width"},ne=(k=l.View,e(O,k),O.prototype.afterInitialize=function(){this.initializeEvents(),this.onFontSizeChanged(),this.onHeightChanged(),this.onHorizontalChanged(),this.onTextChanged(),this.onVerticalChanged(),this.onWidthChanged(),this.onInputTypeChanged()},O.prototype.onSettingsChange=function(e){var i=this;_.each(e,function(e,t){i.viewModel.set(oe[t]||t,e)}),this.hasInit||(this.hasInit=!0,this.afterInitialize())},O.prototype.onResize=function(){this.$input.outerWidth((this.$el.width()||0)-1),this.onWidthChanged()},O.prototype.onTextChanged=function(){var e=this.stringify(this.viewModel.get("text"));e!==this.$input.val()&&this.$input.val(e),e!==this.$textarea.val()&&this.$textarea.val(e)},O.prototype.onWidthChanged=function(){var e=this.viewModel.get("fixedWidth"),t=this.viewModel.get("width");t&&e?this.$inputs.width(t):this.$inputs.css("width","")},O.prototype.onVerticalChanged=function(){var e=this.viewModel.get("fixedHeight"),t=this.viewModel.get("height"),i=this.viewModel.get("vertical");e?("Top"===i?this.$alignDiv.css("top",0):"Middle"===i?this.$alignDiv.css("top",(this.$el.height()||0)/2-t/2):this.$alignDiv.css({top:"auto",bottom:0}),this.$alignDiv.css("position","absolute")):this.$alignDiv.css({top:"",bottom:""})},O.prototype.remove=function(){return this.$input.off(),l.View.prototype.remove.apply(this)},O.prototype.initializeEvents=function(){this.listenTo(this.viewModel,"change:fixedHeight",this.onHeightChanged.bind(this)),this.listenTo(this.viewModel,"change:fixedWidth",this.onWidthChanged.bind(this)),this.listenTo(this.viewModel,"change:fontsize",this.onFontSizeChanged.bind(this)),this.listenTo(this.viewModel,"change:height",this.onHeightChanged.bind(this)),this.listenTo(this.viewModel,"change:horizontal",this.onHorizontalChanged.bind(this)),this.listenTo(this.viewModel,"change:text",this.onTextChanged.bind(this)),this.listenTo(this.viewModel,"change:vertical",this.onVerticalChanged.bind(this)),this.listenTo(this.viewModel,"change:width",this.onWidthChanged.bind(this)),this.listenTo(this.viewModel,"change:type",this.onInputTypeChanged.bind(this))},O.prototype.executeActions=function(){this.api.doActions(this.viewModel.get("Actions"),"Actions")},O.prototype.onFocusOut=function(){this.executeActions()},O.prototype.onFontSizeChanged=function(){var e=this.viewModel.get("fontsize");this.$el.css("font-size",e+"px")},O.prototype.onHeightChanged=function(){var e=this.viewModel.get("fixedHeight"),t=this.viewModel.get("height");t&&e?this.$alignDiv.height(t):this.$alignDiv.height("100%"),this.onVerticalChanged()},O.prototype.onHorizontalChanged=function(){var e=this.viewModel.get("horizontal");this.$alignDiv.css("text-align",e)},O.prototype.onInput=function(e){this.api.setProperty("Basics.Text",$(e.target).val())},O.prototype.onKeyUp=function(e){13===e.keyCode&&"Enter"===e.key?(this.onInput(e),this.executeActions()):this.debouncedOnInput(e)},O.prototype.onInputTypeChanged=function(){var e=this.viewModel.get("type"),t="multiline"===e;this.$input.toggle(!t),this.$textarea.toggle(t),t||this.$input.attr("type",e)},O.prototype.stringify=function(e){return _.isObject(e)?_.isFunction(e.toString)&&"[object Object]"!==e.toString()?e.toString():JSON.stringify(e):e},O);function O(e){var t=k.call(this,_.extend(e,{className:"text-box"}))||this;return t.hasInit=!1,t.api=e.options.api,t.$el.html(m.textBox({type:"text"})),t.$alignDiv=t.$el.find(".align-div"),t.$input=t.$alignDiv.find("> input"),t.$textarea=t.$alignDiv.find("> textarea"),t.$inputs=t.$input.add(t.$textarea),t.$inputs.focusout(t.onFocusOut.bind(t)),t.$inputs.keyup(t.onKeyUp.bind(t)),t.$inputs.on("search",t.onInput.bind(t)),t.debouncedOnInput=_.debounce(t.onInput.bind(t),400),t.viewModel=new l.DeepModel,t}var I,ae=/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/,se=(I=l.View,e(A,I),A.prototype.onResize=function(){var e=this.$title.outerHeight()||0,t=(this.$el.height()||0)-Number(e);this.$("iframe").css({height:t,top:e})},A.prototype.onSettingsChange=function(i){var o=this;_.each(i,function(e,t){"ViewState.Url"===t?(i["ViewState.Url"]||"").match(ae)?(o.url=i["ViewState.Url"]||"",o.render()):o.api.showQueryStatus({type:"Error",error:"Invalid URL"}):o.viewModel.set(t,e)})},A.prototype.render=function(){var e=this;return this.api.showQueryStatus({type:"Loading"}),this.$el.html(m.webComponent({Url:this.url})),this.$("iframe").on("load",function(){e.api.hideQueryStatus()}),this.$title=this.$(".title"),this.onResize(),this},A);function A(e){var t=I.call(this,_.extend(e,{className:"web-component"}))||this;return t.url="",t.api=e.options.api,t.viewModel=new l.DeepModel,t.render(),t}le=l.View,e(E,le),E.prototype.onData=function(e,t){e=e.columns.reset.map(function(e){return e.id});this.api.setProperty(E.PROP_POSSIBLECOLS,e),-1===e.indexOf(this.api.getProperty(E.PROP_NODE))&&(this.api.setProperty(E.PROP_NODE,e[0]),this.api.setProperty(E.PROP_PARENT,e[1]),this.api.setProperty(E.PROP_URL,e[2]),this.api.setProperty(E.PROP_ID,e[3])),this.cols=e,this.dataVals=_.clone(t.reset),this.renderNavBar()},E.prototype.onSettingsChange=function(e){this.ignoreSettingsChange||((e=e[E.PROP_DATA])!==this.propertyCache[E.PROP_DATA]&&((this.propertyCache[E.PROP_DATA]=e)?this.applyDataProperty(e):this.applyDataProperty()),this.renderNavBar())},E.prototype.applyDataProperty=function(e){this.dataModel&&(_.isEqual(this.dataModel,{})||this.api.unsubscribe(this.dataModel),this.dataModel=null),e&&(this.dataModel=e,this.dataModel&&this.dataModel.attributes?(this.api.hideErrorMessage(),this.api.subscribe(this.dataModel,this.onData.bind(this))):this.api.showErrorMessage({error:t("Invalid Data Source")+': "'+this.dataModel.path+'" '+t("selected"),type:"Warning"}))},E.prototype.doActions=function(n,a){this.setIgnoreSettings(!0);var s,e=this.api.getProperty(E.PROP_ACTIONS),l=[];null!=e&&e.length&&a&&(s=[this.api.getProperty(E.PROP_NODE),this.api.getProperty(E.PROP_PARENT),this.api.getProperty(E.PROP_URL),this.api.getProperty(E.PROP_ID)],e.forEach(function(e,t){var i="";switch(s.indexOf(e.Current)){case 0:i="node";break;case 1:i="parent";break;case 2:i="url";break;case 3:i="id"}var o=a[i];"hover"===n==("Hover"===e.Trigger)&&l.push(c(c({},e),{Value:o,_PropertyIndex:t}))}),this.api.doActions(l,"Basics.Actions")),this.setIgnoreSettings(!1)},E.prototype.getChildNodes=function(n,a,s,l){var e,r=this,c={},p=window.location.hash;return null!=(e=this.dataVals)&&e.forEach(function(e){var t,i,o=e[n];o&&(i=r.dataVals.find(function(e){return e[a]===o}))&&(t=i[s],c[t]||(c[t]=[]),i={class:p===e[l]?"active-page":"",fontSize:r.api.getProperty(E.PROP_FONT_SIZE),id:e[s],node:e[a],parent:e[i],url:r.convertUrlIfEmbedded(e[l])},c[t].push(i))}),c},E.prototype.convertUrlIfEmbedded=function(e){var t;return this.options.options.dashboardAppModel.get("embedded")?(t=e).startsWith("#")?"".concat(window.location.pathname).concat(t):t:e},E.prototype.renderNavBar=function(){for(var e,a=this,n=this.api.getProperty(E.PROP_NODE),s=this.api.getProperty(E.PROP_PARENT),l=this.api.getProperty(E.PROP_URL),r=this.api.getProperty(E.PROP_ID),c=this.getChildNodes(s,n,r,l),p=window.location.hash,d=[],h=(null!=(e=this.dataVals)&&e.forEach(function(e){var t,i,o;e[s]||(i=!(null!=(t=c[e[r]])&&t.length)&&p===e[l],o=null==t?void 0:t.find(function(e){return"active-page"===e.class}),d.push({class:i||o?"active-page":"",dropdown:t,fontSize:a.api.getProperty(E.PROP_FONT_SIZE),id:e[r],isDropdown:!(null==t||!t.length),node:e[n],parent:e[s],url:a.convertUrlIfEmbedded(e[l])}))}),this.$el.html(m.navigation(d)),this.el.getElementsByClassName("dropdown")),u=this.el.getElementsByClassName("dropdown-content"),t=function(e){for(var i=d[e],t=h[e].getElementsByTagName("button")[0],o=(t.addEventListener("mouseover",function(e){return a.doActions("hover",i)}),t.addEventListener("click",function(e){return a.doActions("click",i)}),u[e].children),n=0;n<o.length;n++)!function(e){var t;i.dropdown&&i.dropdown[e]&&o[e]&&(t=i.dropdown[e],(e=o[e]).addEventListener("mouseover",function(e){return a.doActions("hover",t)}),e.addEventListener("click",function(e){return a.doActions("click",t)}))}(n)},i=0;i<h.length;i++)t(i)},E.prototype.setIgnoreSettings=function(e){this.ignoreSettingsChange=e},E.PROP_POSSIBLECOLS="possibleColumns",E.PROP_ACTIONS="Basics.Actions",E.PROP_NODE="Basics.Node.Node",E.PROP_PARENT="Basics.Node.Parent",E.PROP_URL="Basics.Node.URL",E.PROP_ID="Basics.Node.ID",E.PROP_DATA="Basics.Data",E.PROP_FONT_SIZE="Basics.FontSize";var le,re,ce=E;function E(e){var t=le.call(this,_.extend(e,{className:"basicComponents_navbar"}))||this;return t.propertyCache=[],t.ignoreSettingsChange=!1,t.api=e.options.api,t.options=e,t}function L(e){var t=re.call(this,_.extend(e,{tagName:"div",className:"basicComponents_textToSpeech"}))||this;return t.template=null,t.htmlText="",t.dataModel=null,t.theme="Dark",t.dataCache=[],t.dataSet=[],t.lineIndex=0,t.pendingSpeech="",t.running=!1,t.paused=!1,t.spokenData=[],t.api=e.options.api,t.templateSubscriptionKey=null,t.api=e.options.api,t.dashboardViewModel=e.options.dashboardViewModel,t.$el.html(m.textToSpeech()),t.$el.css({height:"100%"}),t.$textAlign=t.$(".text-align"),t.$html=t.$el.find(".htmlContent"),t.onThemeChange(),t.getVoices(),t.throttleSpeak=_.throttle(t.speakByLine.bind(t),300),t.btnPlay=t.el.querySelector(".play-btn"),t.btnBack=t.el.querySelector(".back-btn"),t.btnForward=t.el.querySelector(".forward-btn"),t.initializePlayControls(),window.onbeforeunload=function(e){return window.speechSynthesis.cancel()},t}re=l.View,e(L,re),L.prototype.onData=function(e,t){this.dataSet=t.items(),this.api.getProperty(L.PROP_CACHE_DATA)?this.updateDataCache(t):(this.spokenData.length&&(this.spokenData=[]),this.dataCache.length&&this.resetDataCache(),this.dataModel&&this.throttleSpeak(this.getHTML(this.dataSet)))},L.prototype.onSettingsChange=function(e){var i=this;_.each(e,function(e,t){switch(t){case"Basics.Data":i.resetDataCache(),i.applyDataProperty(e);break;case"Basics.FontSize":i.$el.css("font-size",e+"px");break;case"Basics.horizontal":i.$textAlign.css("text-align",e);break;case"Basics.HtmlText":i.htmlText=e,i.dataModel||(i.spokenData=[],i.throttleSpeak(i.getHTML(i.dataSet)));break;case"Basics.Template":try{i.api.unsubscribeTemplateViewStates(i.templateSubscriptionKey),i.template=null,i.templateSubscriptionKey=null,e&&(i.template=n.compile(e),i.templateSubscriptionKey=i.api.subscribeTemplateViewStates(e,function(e){i.viewStates=e})),i.dataModel&&i.throttleSpeak(i.getHTML(i.dataSet))}catch(e){}break;case"Basics.theme":i.theme=e,i.onThemeChange();break;case"Basics.tooltip":i.$html.prop("title",e);break;case"Basics.vertical":i.$textAlign.css("vertical-align",e);break;case L.PROP_PLAY_PAUSE:e?i.showPlayControls():i.hidePlayControls()}})},L.prototype.remove=function(){return window.speechSynthesis.cancel(),this.dataModel&&this.api.unsubscribe(this.dataModel),this.btnPlay.removeEventListener("click",this.onBtnPlayClick.bind(this)),this.btnBack.removeEventListener("click",this.onBtnBackClick.bind(this)),this.btnForward.removeEventListener("click",this.onBtnForwardClick.bind(this)),l.View.prototype.remove.apply(this)},L.prototype.applyDataProperty=function(e){window.speechSynthesis.cancel(),this.dataModel&&(_.isEqual(this.dataModel,{})||this.api.unsubscribe(this.dataModel),this.dataModel=null),e&&(this.dataModel=e,this.dataModel&&this.dataModel.attributes?(this.api.hideErrorMessage(),this.api.subscribe(this.dataModel,this.onData.bind(this))):this.api.showErrorMessage({error:t("Invalid Data Source")+': "'+this.dataModel.path+'" '+t("selected"),type:"Warning"}))},L.prototype.containsObject=function(e,t){for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e)return!0;return!1},L.prototype.getTextFromHTML=function(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent||""},L.prototype.getHTML=function(e,t,i){var o;return this.dataModel?o=this.template?this.template(_.extend(e,this.viewStates)):this.stringify(e):this.htmlText?(o=this.stringify(this.htmlText),i||(o=this.getTemplateLines()[t])):o=this.parseTextToHtml(this.stringify(this.htmlText)),o},L.prototype.getTemplateLines=function(){return this.getTextFromHTML(this.htmlText).replace(/,(?=[^\s])/g,", ").match(/[^.!?]+[.!?]?/g).map(function(e){return e.replace(/\n/g," ")}).filter(function(e){return""!==e.trim()})},L.prototype.getVoices=function(){var e,t,i=this;speechSynthesis.getVoices().length?(e=speechSynthesis.getVoices().map(function(e){return e.name}),this.api.setProperty(L.PROP_POSSIBLE_VOICES,e),(t=this.api.getProperty(L.PROP_VOICE))&&-1!==e.indexOf(t)||(t=e.length?e[0]:"",this.api.setProperty(L.PROP_VOICE,t))):speechSynthesis.addEventListener("voiceschanged",function(){i.getVoices()})},L.prototype.hidePlayControls=function(){$(this.btnPlay).hide(),$(this.btnBack).hide(),$(this.btnForward).hide()},L.prototype.initializePlayControls=function(){$(this.btnPlay).button({showLabel:!1,label:"play",icon:"fa fa-play"}),$(this.btnBack).button({showLabel:!1,label:"back",icon:"fa fa-backward"}),$(this.btnForward).button({showLabel:!1,label:"forward",icon:"fa fa-forward"}),this.btnPlay.addEventListener("click",this.onBtnPlayClick.bind(this)),this.btnBack.addEventListener("click",this.onBtnBackClick.bind(this)),this.btnForward.addEventListener("click",this.onBtnForwardClick.bind(this)),this.api.getProperty(L.PROP_PLAY_PAUSE)?this.showPlayControls():this.hidePlayControls()},L.prototype.queueSpeech=function(e){this.pendingSpeech=e},L.prototype.onBtnPlayClick=function(){var e;this.running?(speechSynthesis.pause(),$(this.btnPlay).button({label:"play",icon:"fa fa-play"}),this.running=!1,this.paused=!0):this.pendingSpeech?(this.running=!0,this.throttleSpeak(this.pendingSpeech),this.pendingSpeech=""):(this.paused?(speechSynthesis.resume(),this.running=!0,this.paused=!1):(this.spokenData=[],this.lineIndex=0,e=this.getHTML([this.dataSet[this.lineIndex]],this.lineIndex),this.running=!0,this.throttleSpeak(e)),$(this.btnPlay).button({label:"pause",icon:"fa fa-pause"}))},L.prototype.onBtnBackClick=function(){var e,t,i,o;-1!==this.lineIndex&&(--this.lineIndex,e=this.getHTML([this.dataSet[this.lineIndex]],this.lineIndex),t=(o=this.dataModel?this.dataSet:this.getTemplateLines())[this.lineIndex+1],this.containsObject(t,this.spokenData)&&(i=this.spokenData.indexOf(t),this.spokenData.splice(i)),t=o[this.lineIndex],this.containsObject(t,this.spokenData)&&(i=this.spokenData.indexOf(t),this.spokenData.splice(i)),this.running?this.throttleSpeak(e):(speechSynthesis.cancel(),this.queueSpeech(e),(o=_.cloneDeep(this.spokenData)).push(t),this.updateHTML(o)))},L.prototype.onBtnForwardClick=function(){var e=this.dataModel&&this.lineIndex===this.dataSet.length-1,t=this.getTemplateLines(),i=!this.dataModel&&this.lineIndex===t.length-1;e||i||(this.lineIndex+=1,e=this.getHTML([this.dataSet[this.lineIndex]],this.lineIndex),t=(i=this.dataModel?this.dataSet:t)[this.lineIndex],i=i[this.lineIndex-1],this.containsObject(i,this.spokenData)||this.spokenData.push(i),this.running?this.throttleSpeak(e):(speechSynthesis.cancel(),this.queueSpeech(e),(i=_.cloneDeep(this.spokenData)).push(t),this.updateHTML(i)))},L.prototype.onThemeChange=function(){var e=this.theme;this.dashboardViewModel.get("DashboardTheme")&&(e=this.dashboardViewModel.get("DashboardTheme")),this.$el.prop("class",""),this.$el.addClass(this.className),this.$el.addClass(e)},L.prototype.parseTextToHtml=function(e){return e=(e=(e=""+e).replace(/\n/g,"<br>")).replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")},L.prototype.resetDataCache=function(){this.dataCache.length&&(this.dataCache=[])},L.prototype.scrollToBottom=function(){this.el.scrollHeight>this.el.clientHeight&&(this.el.scrollTop=this.el.scrollHeight),this.el.querySelectorAll("*").forEach(function(e){e.scrollHeight>e.clientHeight&&(e.scrollTop=e.scrollHeight)})},L.prototype.showPlayControls=function(){$(this.btnPlay).show(),$(this.btnBack).show(),$(this.btnForward).show()},L.prototype.stringify=function(e){return _.isArray(e)?JSON.stringify(e):_.isObject(e)?_.isFunction(e.toString)&&"[object Object]"!==e.toString()?e.toString():JSON.stringify(e):e},L.prototype.speakByLine=function(e){var t,i,o,n=this;speechSynthesis.cancel(),this.getTextFromHTML(e).trim()&&(e=this.dataModel?this.dataSet:this.getTemplateLines(),o="",o=this.dataModel?(i=(t=this.dataSet.filter(function(e){return!n.containsObject(e,n.spokenData)})).length?[t[0]]:[],this.getHTML(i)):(t=e.filter(function(e){return-1===n.spokenData.indexOf(e)})).length?[t[0]]:[])?(i=this.getTextFromHTML(o),o=e.findIndex(function(e){return _.isEqual(e,t[0])}),this.speak(i,e,o)):this.updateHTML()},L.prototype.speak=function(e,i,o){var t,n=this,a=new SpeechSynthesisUtterance(e),s=speechSynthesis.getVoices();s.length?(t=this.api.getProperty(L.PROP_VOICE),a.voice=s.find(function(e){return e.name===t})||s[0],a.rate=this.api.getProperty(L.PROP_RATE)||1,this.running=!0,this.paused&&(this.paused=!1),this.spokenData.push(i[o]),this.updateHTML(),speechSynthesis.speak(a),this.updatePlayState(),this.lineIndex=o,a.addEventListener("end",function(e){var t;n.running=!1,n.updatePlayState(),o<i.length-1&&(t=n.getHTML([i[o+1]],o+1),t=n.getTextFromHTML(t),n.speak(t,i,o+1))})):window.speechSynthesis.onvoiceschanged=function(){n.throttleSpeak(e)}},L.prototype.updateDataCache=function(e){var i=this,e=e.items(),o=[],t=(this.dataCache=this.dataCache.filter(function(e){return i.containsObject(e,i.dataSet)}),e.forEach(function(e,t){i.containsObject(e,i.dataCache)||o.push(e)}),this.getHTML(o));this.throttleSpeak(t),this.spokenData=this.dataCache,this.dataCache=e},L.prototype.updateHTML=function(e){e=this.getHTML(e||this.spokenData,void 0,!0);this.dataModel&&!this.template?this.$html.text(e):this.$html.html(e),this.scrollToBottom()},L.prototype.updatePlayState=function(){var e=this.running?"pause":"play";$(this.btnPlay).button({label:e,icon:"fa fa-"+e})},L.PROP_VOICE="Basics.SpeechOptions.Voice",L.PROP_RATE="Basics.SpeechOptions.Rate",L.PROP_CACHE_DATA="Basics.SpeechOptions.CacheData",L.PROP_PLAY_PAUSE="Basics.SpeechOptions.ShowPlayPause",L.PROP_POSSIBLE_VOICES="Basics.possibleVoices";var pe,de={Text:Q,DatePicker:j,Dropdown:G,ExternalContent:se,Button:Y,NavigationMenu:ce,serverStatus:ie,TextInput:ne,TextToSpeech:L,SelectionControls:ee};function N(e){var t=pe.call(this,e)||this,i=e.settingsModel.get("Basics").ComponentName,i=de[i];return t.$view=new i({options:e}),t.$el.append(t.$view.$el),t}return pe=l.View,e(N,pe),N.prototype.onResize=function(){this.$view&&this.$view.onResize&&this.$view.onResize()},N.prototype.onScroll=function(){this.$view&&this.$view.onScroll&&this.$view.onScroll()},N.prototype.onSettingsChange=function(e){this.$view&&_.isFunction(this.$view.onSettingsChange)&&this.$view.onSettingsChange(e)},N.prototype.remove=function(){return this.$view&&this.$view.remove&&this.$view.remove(),l.View.prototype.remove.apply(this)},N.prototype.setTheme=function(){this.$view&&this.$view.onThemeChange&&this.$view.onThemeChange()},N.getComponentDefinition=H.getComponentDefinition,N});