define(["backbone","Breadcrumbs","Forms","Fuse","Handlebars","moment","purify","rxjs","QuickBase","css!./css/app.css"],function(Backbone,Breadcrumbs,BBForm,Fuse,Handlebars,moment,DOMPurify,rxjs,QuickBase){var __extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,s,l,r){return new(l=l||Promise)(function(i,t){function n(e){try{a(r.next(e))}catch(e){t(e)}}function o(e){try{a(r.throw(e))}catch(e){t(e)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(n,o)}a((r=r.apply(e,s||[])).next())})},__generator=this&&this.__generator||function(n,o){var a,s,l,r={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,s&&(l=2&t[0]?s.return:t[0]?s.throw||((l=s.return)&&l.call(s),0):s.next)&&!(l=l.call(s,t[1])).done)return l;switch(s=0,(t=l?[2&t[0],l.value]:t)[0]){case 0:case 1:l=t;break;case 4:return r.label++,{value:t[1],done:!1};case 5:r.label++,s=t[1],t=[0];continue;case 7:t=r.ops.pop(),r.trys.pop();continue;default:if(!(l=0<(l=r.trys).length&&l[l.length-1])&&(6===t[0]||2===t[0])){r=0;continue}if(3===t[0]&&(!l||t[1]>l[0]&&t[1]<l[3]))r.label=t[1];else if(6===t[0]&&r.label<l[1])r.label=l[1],l=t;else{if(!(l&&r.label<l[2])){l[2]&&r.ops.pop(),r.trys.pop();continue}r.label=l[2],r.ops.push(t)}}t=o.call(n,r)}catch(e){t=[6,e],s=0}finally{a=l=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},T=function(){function e(){}return e.Accordion=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="section">\n    <div class="heading"><i class="fa fa-caret-right"></i> <input type="checkbox"></input>'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"heading")||(null!=t?a(t,"heading"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"heading",hash:{},data:o,loc:{start:{line:2,column:90},end:{line:2,column:101}}}):i)+'</div>\n    <div class="content"></div>\n</div>\n'},useData:!0}),e.AdvancedSettingsDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="advanced-settings-container">\n    <div class="advanced-setting-prop-row">\n        <div class="prop-left">\n            <label for="available-memory-input">'+e.escapeExpression((a(i,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Available Memory Threshold (MB) ",{name:"t",hash:{},data:o,loc:{start:{line:4,column:48},end:{line:4,column:88}}}))+'</label><i class="fa fa-info-circle" title="\nSpecify in megabytes how much memory should be preserved by this feature. \nA value of 0 disables the feature.\n            "></i>\n        </div>\n        <input class="available-memory-threshold ui-widget ui-state-default ui-corner-all" type="number" min="0" step="100" title="" id="available-memory-input">\n    </div>\n</div>'},useData:!0}),e.AnalyticParamItem=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,c="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="buttonsContainer">\n\t<button class="generate-view-state">'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Generate Viewstate Path",{name:"t",hash:{},data:o,loc:{start:{line:2,column:37},end:{line:2,column:68}}}))+'</button>\n\t<div id="'+r(typeof(a=null!=(a=e(i,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:3,column:10},end:{line:3,column:21}}}):a)+'">\n\t\t<input type="radio" id="'+r(typeof(a=null!=(a=e(i,"radio1Id")||(null!=t?e(t,"radio1Id"):t))?a:l)==c?a.call(s,{name:"radio1Id",hash:{},data:o,loc:{start:{line:4,column:26},end:{line:4,column:38}}}):a)+'" name="'+r(typeof(a=null!=(a=e(i,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:4,column:46},end:{line:4,column:57}}}):a)+'" value="viewState"><label for="'+r(typeof(a=null!=(a=e(i,"radio1Id")||(null!=t?e(t,"radio1Id"):t))?a:l)==c?a.call(s,{name:"radio1Id",hash:{},data:o,loc:{start:{line:4,column:89},end:{line:4,column:101}}}):a)+'" class="firstLabel">'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Existing Viewstate Path",{name:"t",hash:{},data:o,loc:{start:{line:4,column:122},end:{line:4,column:153}}}))+'</label>\n\t\t<input type="radio" id="'+r(typeof(a=null!=(a=e(i,"radio2Id")||(null!=t?e(t,"radio2Id"):t))?a:l)==c?a.call(s,{name:"radio2Id",hash:{},data:o,loc:{start:{line:5,column:26},end:{line:5,column:38}}}):a)+'" name="'+r(typeof(a=null!=(a=e(i,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:5,column:46},end:{line:5,column:57}}}):a)+'" value="text"><label for="'+r(typeof(a=null!=(a=e(i,"radio2Id")||(null!=t?e(t,"radio2Id"):t))?a:l)==c?a.call(s,{name:"radio2Id",hash:{},data:o,loc:{start:{line:5,column:84},end:{line:5,column:96}}}):a)+'">'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Text",{name:"t",hash:{},data:o,loc:{start:{line:5,column:98},end:{line:5,column:110}}}))+'</label>\n\t</div>\n</div>\n\n<div class="analyticParamErrorDialog" style="display: none;">View state parameter type does not match analytic parameter type.</div>'},useData:!0}),e.AnalyticParamsView=Handlebars.template({1:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div class="parameterItem">\n            <div class="label">'+c(typeof(a=null!=(a=e(i,"Name")||(null!=t?e(t,"Name"):t))?a:l)==r?a.call(s,{name:"Name",hash:{},data:o,loc:{start:{line:6,column:31},end:{line:6,column:39}}}):a)+" ("+c(typeof(a=null!=(a=e(i,"Type")||(null!=t?e(t,"Type"):t))?a:l)==r?a.call(s,{name:"Type",hash:{},data:o,loc:{start:{line:6,column:41},end:{line:6,column:49}}}):a)+')</div>\n            <input class="value" value="'+c(typeof(a=null!=(a=e(i,"DefaultValue")||(null!=t?e(t,"DefaultValue"):t))?a:l)==r?a.call(s,{name:"DefaultValue",hash:{},data:o,loc:{start:{line:7,column:40},end:{line:7,column:56}}}):a)+'" >\n        </div>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},r="<fieldset>\n    <legend>"+e.escapeExpression((l(i,"t")||t&&l(t,"t")||s).call(a,"Parameters",{name:"t",hash:{},data:o,loc:{start:{line:2,column:12},end:{line:2,column:30}}}))+'</legend>\n    <div class="parameterList">\n',c=null!=(c=l(i,"Parameters")||(null!=t?l(t,"Parameters"):t))?c:s,s={name:"Parameters",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:4,column:8},end:{line:9,column:23}}},o="function"==typeof c?c.call(a,s):c;return null!=(o=l(i,"Parameters")?o:e.hooks.blockHelperMissing.call(t,o,s))&&(r+=o),r+"    </div>\n</fieldset>\n"},useData:!0}),e.BreadcrumbsWrapper=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return""},useData:!0}),e.BulkColumnEditorDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="pnlInfo">\n</div>\n\n\n<div class="pnlLeft">\n    <ul class="lstColumns">\n    </ul>    \n</div>\n\n\n\n<div class="properties-panel">\n    <div class="pnlPropertyEditor"></div>\n</div>'},useData:!0}),e.CleanUpDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="tree"></div>'},useData:!0}),e.ColorPickerDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<ul>\n    <li><a href="#colorPickerSolid">Solid</a></li>\n    <li><a href="#colorPickerGradient">Gradient</a></li>\n\n</ul>\n<div id="colorPickerSolid">\n    <div class="solid_color"></div>\n</div>\n<div id="colorPickerGradient">\n    <table>\n        <tr>\n            <td style="width: 185px;">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Type",{name:"t",hash:{},data:o,loc:{start:{line:12,column:38},end:{line:12,column:50}}}))+'</td>\n            <td>\n                <select class="colorPickerType">\n                    <option>'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"linear",{name:"t",hash:{},data:o,loc:{start:{line:15,column:28},end:{line:15,column:42}}}))+"</option>\n                    <option>"+l((e(i,"t")||t&&e(t,"t")||s).call(a,"radial",{name:"t",hash:{},data:o,loc:{start:{line:16,column:28},end:{line:16,column:42}}}))+'</option>\n                </select>\n            </td>\n            <td>\n                <select class="colorPickerDirection">\n                    <option>'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"left",{name:"t",hash:{},data:o,loc:{start:{line:21,column:28},end:{line:21,column:40}}}))+"</option>\n                    <option>"+l((e(i,"t")||t&&e(t,"t")||s).call(a,"right",{name:"t",hash:{},data:o,loc:{start:{line:22,column:28},end:{line:22,column:41}}}))+"</option>\n                    <option>"+l((e(i,"t")||t&&e(t,"t")||s).call(a,"top",{name:"t",hash:{},data:o,loc:{start:{line:23,column:28},end:{line:23,column:39}}}))+"</option>\n                    <option>"+l((e(i,"t")||t&&e(t,"t")||s).call(a,"bottom",{name:"t",hash:{},data:o,loc:{start:{line:24,column:28},end:{line:24,column:42}}}))+"</option>\n                    <option>"+l((e(i,"t")||t&&e(t,"t")||s).call(a,"45deg",{name:"t",hash:{},data:o,loc:{start:{line:25,column:28},end:{line:25,column:41}}}))+'</option>\n                </select>\n            </td>\n        </tr>\n        <tr>\n            <td></td>\n            <td colspan="3">\n                <div class="grad_ex" id="ex1"></div>\n            </td>\n        </tr>\n        \x3c!--<tr><td>'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Selected Css",{name:"t",hash:{},data:o,loc:{start:{line:35,column:20},end:{line:35,column:40}}}))+'</td><td><input id="cssGradient" class="cssGradient" type="text" placeholder="css" readonly></td></tr>--\x3e\n        <tr>\n            <td>'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Preview",{name:"t",hash:{},data:o,loc:{start:{line:37,column:16},end:{line:37,column:31}}}))+'</td>\n            <td colspan="3">\n                <div class="left"></div>\n            </td>\n        </tr>\n\n    </table>\n\n</div>\n'},useData:!0}),e.ColumnsDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="addNewColumn">'+e.escapeExpression((a(i,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Add Column",{name:"t",hash:{},data:o,loc:{start:{line:1,column:26},end:{line:1,column:44}}}))+"</div>"},useData:!0}),e.ComponentDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="thumb">\n    <img src="'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"listViewThumb")||(null!=t?a(t,"listViewThumb"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"listViewThumb",hash:{},data:o,loc:{start:{line:2,column:14},end:{line:2,column:31}}}):i)+'" ></img>\n    <div class="file-btn-wrapper">\n        <input class="file-input" type="file" >\n    </div>\n    <button class="upload-btn">\n        Upload Icon\n    </button>\n</div>\n<div class="form"></div>'},useData:!0}),e.ComponentListView=Handlebars.template({1:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="'+c(typeof(a=null!=(a=e(i,"class")||(null!=t?e(t,"class"):t))?a:l)==r?a.call(s,{name:"class",hash:{},data:o,loc:{start:{line:2,column:12},end:{line:2,column:21}}}):a)+'">\n    <div class="name">'+c(typeof(a=null!=(a=e(i,"componentName")||(null!=t?e(t,"componentName"):t))?a:l)==r?a.call(s,{name:"componentName",hash:{},data:o,loc:{start:{line:3,column:22},end:{line:3,column:39}}}):a)+"</div>\n    <hr />\n</div>\n"},3:function(e,t,i,n,o){var a,s,l=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,c="function",d=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="icon">'+(null!=(a=typeof(s=null!=(s=u(i,"listViewThumb")||(null!=t?u(t,"listViewThumb"):t))?s:r)==c?s.call(l,{name:"listViewThumb",hash:{},data:o,loc:{start:{line:7,column:18},end:{line:7,column:37}}}):s)?a:"")+'</div>\n<div class="name">'+d(typeof(s=null!=(s=u(i,"componentName")||(null!=t?u(t,"componentName"):t))?s:r)==c?s.call(l,{name:"componentName",hash:{},data:o,loc:{start:{line:8,column:18},end:{line:8,column:35}}}):s)+'</div>\n<div class="description">'+d((u(i,"t")||t&&u(t,"t")||r).call(l,null!=t?u(t,"componentDescription"):t,{name:"t",hash:{},data:o,loc:{start:{line:9,column:25},end:{line:9,column:51}}}))+'</div>\n<div class="tags">\n'+(null!=(a=u(i,"each").call(l,null!=t?u(t,"tags"):t,{name:"each",hash:{},fn:e.program(4,o,0),inverse:e.noop,data:o,loc:{start:{line:11,column:4},end:{line:13,column:13}}}))?a:"")+"</div>\n"},4:function(e,t,i,n,o){return'    <div class="tag-wrapper"><span class="ui-widget-content">'+e.escapeExpression(e.lambda(t,t))+"</span></div>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(i=(a(i,"eq")||t&&a(t,"eq")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?a(t,"class"):t,"component-header",{name:"eq",hash:{},fn:e.program(1,o,0),inverse:e.program(3,o,0),data:o,loc:{start:{line:1,column:0},end:{line:15,column:7}}}))?i:""},useData:!0}),e.ComponentsPanel=Handlebars.template({1:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <a class="add" title="'+e.escapeExpression((a(i,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Add a new Widget",{name:"t",hash:{},data:o,loc:{start:{line:11,column:26},end:{line:11,column:50}}}))+'"><i class="fa fa-plus fa-fw"></i></a>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="panel-header">\n    <div class="pin-button" data-cy="node-pin-button" tabindex="0" aria-label="Expand/Collapse Component Listing">\n        <i class="fa fa-caret-right"></i><i class="fa fa-caret-right"></i>\n    </div>\n    <div class="search-box" data-cy="node-search-box">\n        <input type="text" placeholder="search components..." />\n        <div class="fa fa-fw fa-search"></div>\n        <div class="fa fa-times" tabindex="0" aria-label="Clear Search"></div>\n    </div>\n'+(null!=(i=a(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?a(t,"isLite"):t,{name:"unless",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:10,column:4},end:{line:12,column:15}}}))?i:"")+'</div>\n\n<div class="components-list"></div>\n<div tabindex="0" class="scroll-up" aria-label="Scroll Up">\n    <i class="fa fa-fw fa-caret-up"></i>\n</div>\n<div tabindex="0" class="scroll-down" aria-label="Scroll Down">\n    <i class="fa fa-fw fa-caret-down"></i>\n</div>\n'},useData:!0}),e.ConnectionManagement=Handlebars.template({1:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                        <option value="'+r("function"==typeof(a=null!=(a=e(i,"DATA_SOURCE_insightsSDK")||(null!=t?e(t,"DATA_SOURCE_insightsSDK"):t))?a:l)?a.call(s,{name:"DATA_SOURCE_insightsSDK",hash:{},data:o,loc:{start:{line:35,column:39},end:{line:35,column:66}}}):a)+'">'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"insights SDK",{name:"t",hash:{},data:o,loc:{start:{line:35,column:68},end:{line:35,column:88}}}))+"</option>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="connectionsTabs">\n    <ul>\n        <li><a href="#'+c(typeof(a=null!=(a=d(i,"singleConnectionsId")||(null!=t?d(t,"singleConnectionsId"):t))?a:l)==r?a.call(s,{name:"singleConnectionsId",hash:{},data:o,loc:{start:{line:3,column:22},end:{line:3,column:45}}}):a)+'">Individual</a></li>\n        <li><a href="#'+c(typeof(a=null!=(a=d(i,"groupConnectionsId")||(null!=t?d(t,"groupConnectionsId"):t))?a:l)==r?a.call(s,{name:"groupConnectionsId",hash:{},data:o,loc:{start:{line:4,column:22},end:{line:4,column:44}}}):a)+'">Groups</a></li>\n        <li><a href="#'+c(typeof(a=null!=(a=d(i,"serivcesTabId")||(null!=t?d(t,"serivcesTabId"):t))?a:l)==r?a.call(s,{name:"serivcesTabId",hash:{},data:o,loc:{start:{line:5,column:22},end:{line:5,column:39}}}):a)+'">Services</a></li>\n    </ul>\n    <div id="'+c(typeof(a=null!=(a=d(i,"singleConnectionsId")||(null!=t?d(t,"singleConnectionsId"):t))?a:l)==r?a.call(s,{name:"singleConnectionsId",hash:{},data:o,loc:{start:{line:7,column:13},end:{line:7,column:36}}}):a)+'">\n        <div class="connectionsList singleConnectionsList">\n            \x3c!--<div class="row">\n\t\t\t\t<div class="newConnectionButton btn">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"New Connection",{name:"t",hash:{},data:o,loc:{start:{line:10,column:41},end:{line:10,column:63}}}))+'</div>\n\t\t\t</div>\n\t\t\t<input class="filterBox singleFilter" placeholder="type to filter">\n\t\t\t<i class="fa fa-search filterIcon"></i>--\x3e\n            <div class="singleConnectionsListGrid"></div>\n            \x3c!--<ul></ul>--\x3e\n        </div>\n\n        <div class="connectionDetailsPanel">\n            <div class="title"></div>\n            <div class="row">\n                <label for="name-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Name:",{name:"t",hash:{},data:o,loc:{start:{line:21,column:40},end:{line:21,column:53}}}))+'</label>\n                <input class="name" type="text" value="" id="name-input" />\n            </div>\n\n            \x3c!-- hide input types for now  --\x3e\n            <div class="row">\n                <label for="type-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Type:",{name:"t",hash:{},data:o,loc:{start:{line:27,column:40},end:{line:27,column:53}}}))+'</label>\n                <select class="type" id="type-input">\n                    <option value="q">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"kdb",{name:"t",hash:{},data:o,loc:{start:{line:29,column:38},end:{line:29,column:49}}}))+'</option>\n                    \x3c!--<option value="jdbc:com.mysql.jdbc.Driver">mysql</option>\n\t\t\t\t\t<option value="jdbc:oracle.jdbc.OracleDriver">oracle</option>\n\t\t\t\t\t<option value="jdbc:com.microsoft.sqlserver.jdbc.SQLServerDriver">mssql</option>\n\t\t\t\t\t<option value="daemon">daemon</option> --\x3e\n'+(null!=(e=d(i,"if").call(s,null!=t?d(t,"isDirectMode"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:34,column:21},end:{line:36,column:28}}}))?e:"")+'                </select>\n            </div>\n\n            <div class="row">\n                <label for="host-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Host:",{name:"t",hash:{},data:o,loc:{start:{line:41,column:40},end:{line:41,column:53}}}))+'</label>\n                <input class="host" type="text" value="" id="host-input" />\n            </div>\n\n            <div class="row qipcportRow" style="display: none">\n                <label for="qipc-port-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"SG Query Port (ipc):",{name:"t",hash:{},data:o,loc:{start:{line:46,column:45},end:{line:46,column:73}}}))+'</label>\n                <input class="qipcport" type="text" value="" id="qipc-port-input" />\n            </div>\n\n            <div class="row">\n                <label for="port-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Port:",{name:"t",hash:{},data:o,loc:{start:{line:51,column:40},end:{line:51,column:53}}}))+'</label>\n                <input class="port" type="text" value="" id="port-input" />\n            </div>\n\n            <div class="row databaseRow" style="display: none">\n                <label for="database-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Database:",{name:"t",hash:{},data:o,loc:{start:{line:56,column:44},end:{line:56,column:61}}}))+'</label>\n                <input class="database" type="text" value="" id="database-input" />\n            </div>\n            <div class="row integratedSecurityRow" style="display: none">\n                <label for="security-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Integrated Security:",{name:"t",hash:{},data:o,loc:{start:{line:60,column:44},end:{line:60,column:72}}}))+'</label>\n                <input\n                    class="integratedSecurity"\n                    type="checkbox"\n                    value=""\n                    style="width: auto; margin-top: 5px"\n                    id="security-input"\n                />\n            </div>\n            <div class="row userRow">\n                <label for="user-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"User:",{name:"t",hash:{},data:o,loc:{start:{line:70,column:40},end:{line:70,column:53}}}))+'</label>\n                <input class="user" type="text" value="" id="user-input" />\n            </div>\n            <div class="row passwordRow">\n                <label for="password-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Password:",{name:"t",hash:{},data:o,loc:{start:{line:74,column:44},end:{line:74,column:61}}}))+'</label>\n                <input class="password" type="password" value="" id="password-input" />\n            </div>\n            <div class="row confirmPasswordRow">\n                <label for="confirm-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Confirm Password:",{name:"t",hash:{},data:o,loc:{start:{line:78,column:43},end:{line:78,column:68}}}))+'</label>\n                <input class="confirmPassword" type="password" value="" id="confirm-input" />\n            </div>\n            <div class="row tlsRow">\n                <label for="tls-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"TLS:",{name:"t",hash:{},data:o,loc:{start:{line:82,column:39},end:{line:82,column:51}}}))+'</label>\n                <input class="tls" type="checkbox" value="" id="tls-input" />\n            </div>\n        </div>\n    </div>\n    <div id="'+c(typeof(a=null!=(a=d(i,"groupConnectionsId")||(null!=t?d(t,"groupConnectionsId"):t))?a:l)==r?a.call(s,{name:"groupConnectionsId",hash:{},data:o,loc:{start:{line:87,column:13},end:{line:87,column:35}}}):a)+'">\n        <div class="connectionsList groupConnectionsList">\n            \x3c!--<input class="filterBox groupFilter" placeholder="type to filter">\n\t\t\t<i class="fa fa-search filterIcon"></i>--\x3e\n            <div class="groupConnectionListGrid"></div>\n            \x3c!--<ul></ul>\n\t\t\t<div class="row">\n\t\t\t\t<div class="newGroupButton btn">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"New Group",{name:"t",hash:{},data:o,loc:{start:{line:94,column:36},end:{line:94,column:53}}}))+'</div>\n\t\t\t</div>\n\t\t\t--\x3e\n        </div>\n        <div class="groupDetailsPanel">\n            <div class="title"></div>\n            <div class="row">\n                <label for="group-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Group Name:",{name:"t",hash:{},data:o,loc:{start:{line:101,column:41},end:{line:101,column:60}}}))+'</label>\n                <input class="groupName" type="text" value="" disabled id="group-input" />\n            </div>\n            <div class="row">\n                <label for="group-type-input">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Group Type:",{name:"t",hash:{},data:o,loc:{start:{line:105,column:46},end:{line:105,column:65}}}))+'</label>\n                <select class="groupType" id="group-type-input">\n                    <option value="DEFAULT">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Default",{name:"t",hash:{},data:o,loc:{start:{line:107,column:44},end:{line:107,column:59}}}))+'</option>\n                    <option value="LEADER_CLUSTER">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Leader",{name:"t",hash:{},data:o,loc:{start:{line:108,column:51},end:{line:108,column:65}}}))+'</option>\n                    <option value="COMBINED">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Combined",{name:"t",hash:{},data:o,loc:{start:{line:109,column:45},end:{line:109,column:61}}}))+'</option>\n                    <option value="ROUND_ROBIN">'+c((d(i,"t")||t&&d(t,"t")||l).call(s,"Round Robin",{name:"t",hash:{},data:o,loc:{start:{line:110,column:48},end:{line:110,column:67}}}))+'</option>\n                </select>\n            </div>\n            <div class="multipleSelect"></div>\n        </div>\n    </div>\n    <div id="'+c(typeof(a=null!=(a=d(i,"serivcesTabId")||(null!=t?d(t,"serivcesTabId"):t))?a:l)==r?a.call(s,{name:"serivcesTabId",hash:{},data:o,loc:{start:{line:116,column:13},end:{line:116,column:30}}}):a)+'">\n        <div class="connectionsList servisesList">\n            <div class="servicesListGrid"></div>\n        </div>\n    </div>\n\n    <div class="statusBar"></div>\n</div>\n'},useData:!0}),e.ContentPanel=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="content-panel">\n\n    <div class="panel-header">\n\n    </div>\n\n    <div class="document-view-div">\n\n    </div>\n\n</div>\n'},useData:!0}),e.CssDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="query-editor" spellcheck="false"></div>'},useData:!0}),e.DashboardListView=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="tile-content">\n    <span class="dash-name">\n        '+c(typeof(a=null!=(a=e(i,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:3,column:8},end:{line:3,column:16}}}):a)+'\n    </span>\n\n    <span class="name-error-info"></span>\n\n    <span class="right-side-span">\n        <i\n            class="dash-wip-icon fa'+c(typeof(a=null!=(a=e(i,"draftStateIcon")||(null!=t?e(t,"draftStateIcon"):t))?a:l)==r?a.call(s,{name:"draftStateIcon",hash:{},data:o,loc:{start:{line:10,column:35},end:{line:10,column:53}}}):a)+'"\n            style="margin-right: 7px; cursor: pointer;"\n            title="'+c(typeof(a=null!=(a=e(i,"title")||(null!=t?e(t,"title"):t))?a:l)==r?a.call(s,{name:"title",hash:{},data:o,loc:{start:{line:12,column:19},end:{line:12,column:28}}}):a)+'"\n            aria-label="'+c(typeof(a=null!=(a=e(i,"title")||(null!=t?e(t,"title"):t))?a:l)==r?a.call(s,{name:"title",hash:{},data:o,loc:{start:{line:13,column:24},end:{line:13,column:33}}}):a)+'"\n        ></i>\n        <i\n            class="fa fa-home"\n            style="margin-right: 7px; cursor: pointer;"\n            title="Select as default dashboard for all users"\n            aria-label="Select as default dashboard for all users"\n        ></i>\n        <i\n            class="fa fa-star"\n            style="margin-right: 7px; cursor: pointer;"\n            title="Unset Dashboard as Favorite"\n            aria-label="Unset Dashboard as Favorite"\n        ></i>\n        <i\n            class="fa fa-star-o"\n            style="margin-right: 7px; cursor: pointer;"\n            title="Set Dashboard as Favorite"\n            aria-label="Set Dashboard as Favorite"\n        ></i>\n        <span class="dash-date">\n            '+c(typeof(a=null!=(a=e(i,"documentLocalDate")||(null!=t?e(t,"documentLocalDate"):t))?a:l)==r?a.call(s,{name:"documentLocalDate",hash:{},data:o,loc:{start:{line:34,column:12},end:{line:34,column:33}}}):a)+"\n        </span>\n    </span>\n</div>\n"},useData:!0}),e.DashboardNamePrompt=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div style="display: table; width: 100%; height: 100%; max-height: 100%; overflow: hidden;">\n    <div style="display: table-cell; width: 100%; height: 100%; max-height: 100%; vertical-align: middle; text-align: center;">\n        <label for="name-input-id" style="margin-right: 3px;">\n            Name:\n        </label>\n        <input class="name-input" value="'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"name")||(null!=t?a(t,"name"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"name",hash:{},data:o,loc:{start:{line:6,column:41},end:{line:6,column:49}}}):i)+'" id="name-input-id">\n        <span class="wip-icon" tabindex="0">\n            <input type="checkbox" id="work-in-progress" class="work-in-progress">\n            <label for="work-in-progress"></label>\n        </span>\n        <div class = "wip-tooltip"></div>\n        <div class="dash-exist-info">\n            Dashboard with this name already exists.\n        </div>\n    </div>\n\n</div>\n'},useData:!0}),e.DashboardPermission=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<td class="permissionName" title="'+c(typeof(a=null!=(a=e(i,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:1,column:34},end:{line:1,column:42}}}):a)+'" colspan="3">'+c(typeof(a=null!=(a=e(i,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:1,column:56},end:{line:1,column:64}}}):a)+'</td>\n<td class="permissionRead" style="text-align: center;">\n\t<input type="checkbox" >\n</td>\n<td class="permissionWrite" style="text-align: center;">\n\t<input type="checkbox" >\n</td>'},useData:!0}),e.DashboardPermissions=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="permissions-panel" style="padding:10px;">\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr><th  colspan="3">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"User Group",{name:"t",hash:{},data:o,loc:{start:{line:4,column:25},end:{line:4,column:43}}}))+'</th><th class="permissionRead">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Read Access",{name:"t",hash:{},data:o,loc:{start:{line:4,column:75},end:{line:4,column:94}}}))+"</th><th permissionWrite>"+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Write Access",{name:"t",hash:{},data:o,loc:{start:{line:4,column:119},end:{line:4,column:139}}}))+"</th></tr>\n\t\t\t</thead>\n\t\t\t<tbody></tbody>\n\t\t</table>\n</div>"},useData:!0}),e.DashboardStyles=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,c="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<table>\n    <tr>\n        <td>\n            <span>"+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Dashboard Theme",{name:"t",hash:{},data:o,loc:{start:{line:4,column:18},end:{line:4,column:41}}}))+'</span>\n        </td>\n        <td>\n            <select class="dashboardTheme">\n                <option>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Dark",{name:"t",hash:{},data:o,loc:{start:{line:8,column:24},end:{line:8,column:36}}}))+"</option>\n                <option>"+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Light",{name:"t",hash:{},data:o,loc:{start:{line:9,column:24},end:{line:9,column:37}}}))+"</option>\n            </select>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>"+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Widgets Spacing",{name:"t",hash:{},data:o,loc:{start:{line:15,column:18},end:{line:15,column:41}}}))+'</span>\n        </td>\n        <td>\n            <input class="widgets-spacing" value="'+r(typeof(a=null!=(a=e(i,"widgetsSpacing")||(null!=t?e(t,"widgetsSpacing"):t))?a:l)==c?a.call(s,{name:"widgetsSpacing",hash:{},data:o,loc:{start:{line:18,column:50},end:{line:18,column:68}}}):a)+'" >\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Border Color",{name:"t",hash:{},data:o,loc:{start:{line:23,column:18},end:{line:23,column:38}}}))+'</span>\n        </td>\n        <td>\n            <input class="border-color" value="'+r(typeof(a=null!=(a=e(i,"borderColor")||(null!=t?e(t,"borderColor"):t))?a:l)==c?a.call(s,{name:"borderColor",hash:{},data:o,loc:{start:{line:26,column:47},end:{line:26,column:62}}}):a)+'" >\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Border Background",{name:"t",hash:{},data:o,loc:{start:{line:31,column:18},end:{line:31,column:43}}}))+'</span>\n        </td>\n        <td>\n            <input class="border-background" value="'+r(typeof(a=null!=(a=e(i,"borderBackground")||(null!=t?e(t,"borderBackground"):t))?a:l)==c?a.call(s,{name:"borderBackground",hash:{},data:o,loc:{start:{line:34,column:52},end:{line:34,column:72}}}):a)+'" >\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Transparent Background",{name:"t",hash:{},data:o,loc:{start:{line:39,column:18},end:{line:39,column:48}}}))+'</span>\n        </td>\n        <td>\n            <input type="checkbox" class="border-background-transparent" checked="'+r(typeof(a=null!=(a=e(i,"transparentBackground")||(null!=t?e(t,"transparentBackground"):t))?a:l)==c?a.call(s,{name:"transparentBackground",hash:{},data:o,loc:{start:{line:42,column:82},end:{line:42,column:107}}}):a)+'" >\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Border Width",{name:"t",hash:{},data:o,loc:{start:{line:47,column:18},end:{line:47,column:38}}}))+'</span>\n        </td>\n        <td>\n            <input class="border-width" value="'+r(typeof(a=null!=(a=e(i,"borderWidth")||(null!=t?e(t,"borderWidth"):t))?a:l)==c?a.call(s,{name:"borderWidth",hash:{},data:o,loc:{start:{line:50,column:47},end:{line:50,column:62}}}):a)+'" >\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Border Rounding",{name:"t",hash:{},data:o,loc:{start:{line:55,column:18},end:{line:55,column:41}}}))+'</span>\n        </td>\n        <td>\n            <input class="border-rounding" value="'+r(typeof(a=null!=(a=e(i,"borderRounding")||(null!=t?e(t,"borderRounding"):t))?a:l)==c?a.call(s,{name:"borderRounding",hash:{},data:o,loc:{start:{line:58,column:50},end:{line:58,column:68}}}):a)+'" >\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Border Spacing",{name:"t",hash:{},data:o,loc:{start:{line:63,column:18},end:{line:63,column:40}}}))+'</span>\n        </td>\n        <td>\n            <input class="border-spacing" value="'+r(typeof(a=null!=(a=e(i,"borderSpacing")||(null!=t?e(t,"borderSpacing"):t))?a:l)==c?a.call(s,{name:"borderSpacing",hash:{},data:o,loc:{start:{line:66,column:49},end:{line:66,column:66}}}):a)+'" >\n        </td>\n    </tr>\n    <tr>\n    <td>\n            <span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Worksheet Padding",{name:"t",hash:{},data:o,loc:{start:{line:71,column:18},end:{line:71,column:43}}}))+'</span>\n        </td>\n        <td>\n            <input class="worksheet-padding" value="'+r(typeof(a=null!=(a=e(i,"worksheetPadding")||(null!=t?e(t,"worksheetPadding"):t))?a:l)==c?a.call(s,{name:"worksheetPadding",hash:{},data:o,loc:{start:{line:74,column:52},end:{line:74,column:72}}}):a)+'" >\n        </td>\n    </tr>\n</table>'},useData:!0}),e.DataConfigAggregateRow=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<input class="aggregateFnItm" value="'+c(typeof(a=null!=(a=e(i,"aggFn")||(null!=t?e(t,"aggFn"):t))?a:l)==r?a.call(s,{name:"aggFn",hash:{},data:o,loc:{start:{line:1,column:37},end:{line:1,column:46}}}):a)+'" placeholder="Function">\n<input class="aggregateColItm" value="'+c(typeof(a=null!=(a=e(i,"aggCol")||(null!=t?e(t,"aggCol"):t))?a:l)==r?a.call(s,{name:"aggCol",hash:{},data:o,loc:{start:{line:2,column:38},end:{line:2,column:48}}}):a)+'" placeholder="Column">\n<input class="aggregateLabelItm" value="'+c(typeof(a=null!=(a=e(i,"aggLabel")||(null!=t?e(t,"aggLabel"):t))?a:l)==r?a.call(s,{name:"aggLabel",hash:{},data:o,loc:{start:{line:3,column:40},end:{line:3,column:52}}}):a)+'" placeholder="Label" >\n<div class="deleteRow"></div>\n<div class="moveRow rowIcon fa fa-bars"></div>'},useData:!0}),e.DataConfigAnalytic=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="pnlAnalyticsGridWrapper">\n    <div class=\'search\'>\n        <i class=\'fa fa-search\'></i>\n        <input type=\'text\' class=\'searchBox\' >\n        <span class="clearSearch fa fa-times" style="display: none"></span>\n    </div>\n    <div class="pnlAnalyticsTree"></div>\n</div>\n\n<div class="propertiesPanel paramsView"></div>\n\n<div class="subscription-select"></div>\n     '},useData:!0}),e.DataConfigApiSource=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="pnlApiSourceGridWrapper">\n    <div class="search">\n        <i class="fa fa-search"></i>\n        <input type="text" class="searchBox" />\n        <span class="clearSearch fa fa-times" style="display: none"></span>\n    </div>\n    <div class="pnlApiSourceTree"></div>\n\n    <div class="missingAPIwarning">\n        <i class="fa fa-exclamation-triangle"></i> No resources connected.<br />\n        Create and deploy a database first.\n    </div>\n</div>\n\n<div class="propertiesPanel paramsView"></div>\n\n<div class="subscription-select"></div>\n'},useData:!0}),e.DataConfigForm=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,c="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="toolbar ui-widget-header ui-corner-all">\n\n    <button class="newConnectionGroup">'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Connection Management",{name:"t",hash:{},data:o,loc:{start:{line:3,column:39},end:{line:3,column:68}}}))+'</button>\n    <button class="connection-select-viewstate"></button></button>\n    <div class="connection-select">\n        <select></select>\n    </div>\n     <div class="connection-select-viewstate-grp">\n        <div class="connection-select-viewstate-icon"><i class="fa fa-eye"></i></div>\n        <div class="connection-select-viewstate-text"></div>\n        <div class="connection-select-viewstate-clear btn-no-borders"></div>\n    </div>\n\n    <button id="datasource-execute-query" class="run-btn" title="'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Execute (Ctrl + Enter)",{name:"t",hash:{},data:o,loc:{start:{line:14,column:65},end:{line:14,column:95}}}))+'">\n        '+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Execute",{name:"t",hash:{},data:o,loc:{start:{line:15,column:8},end:{line:15,column:23}}}))+'\n    </button>\n    <span class="qe-info">'+r(typeof(a=null!=(a=e(i,"queryEnvironmentsText")||(null!=t?e(t,"queryEnvironmentsText"):t))?a:l)==c?a.call(s,{name:"queryEnvironmentsText",hash:{},data:o,loc:{start:{line:17,column:26},end:{line:17,column:51}}}):a)+'</span>\n</div>\n\n<div class="data-div">\n    <div class="function">\n        <fieldset>\n            <span>\n                <label class="lblAPI">\n                    <input type="radio" name="_dataType" class="api" value="api" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"API",{name:"t",hash:{},data:o,loc:{start:{line:25,column:82},end:{line:25,column:93}}}))+'\n                </label>\n                <label class="sql-editor_label lblSql">\n                    <input type="radio" name="_dataType" class="sql" value="sql" checked >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"SQL",{name:"t",hash:{},data:o,loc:{start:{line:28,column:90},end:{line:29,column:27}}}))+'\n                </label>\n                <label class="lblKdb">\n                    <input type="radio" name="_dataType" class="query" value="query" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"kdb+/q",{name:"t",hash:{},data:o,loc:{start:{line:32,column:86},end:{line:33,column:30}}}))+'\n                </label>\n                <label class="lblBuilder">\n                    <input type="radio" name="_dataType" class="builder" value="builder" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Builder",{name:"t",hash:{},data:o,loc:{start:{line:36,column:90},end:{line:37,column:31}}}))+'\n                </label>\n                <label class="analyticFieldsetLabel lblAnalytic">\n                    <input type="radio" name="_dataType" class="analytic" value="analytic" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Analytic",{name:"t",hash:{},data:o,loc:{start:{line:40,column:92},end:{line:41,column:32}}}))+'\n                </label>\n                <label class="pykx-editor_label lblPyKx">\n                    <input type="radio" name="_dataType" class="pykx" value="pykx" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Python",{name:"t",hash:{},data:o,loc:{start:{line:44,column:84},end:{line:44,column:98}}}))+'\n                </label>\n                <label class="lblStreaming">\n                    <input type="radio" name="_dataType" class="streaming" value="streaming" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Streaming",{name:"t",hash:{},data:o,loc:{start:{line:47,column:94},end:{line:48,column:33}}}))+'\n                </label>\n                <label class="lblInsightsStreaming">\n                    <input\n                        type="radio"\n                        name="_dataType"\n                        class="insights-streaming"\n                        value="insightsStreaming"\n                    /><span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Streaming",{name:"t",hash:{},data:o,loc:{start:{line:56,column:28},end:{line:56,column:45}}}))+'</span>\n                </label>\n                <label class="lblVirtual">\n                    <input type="radio" name="_dataType" class="virtual" value="virtual" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Virtual",{name:"t",hash:{},data:o,loc:{start:{line:59,column:90},end:{line:59,column:105}}}))+'\n                </label>\n            </span>\n\n            <div class="legend-right">\n                <label class="pivot-label">\n                    <input class="pivot-checkbox" type="checkbox" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Pivot",{name:"t",hash:{},data:o,loc:{start:{line:65,column:67},end:{line:65,column:80}}}))+'\n                </label>\n                <label class="update-label">\n                    <input class="update-checkbox" type="checkbox" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Update",{name:"t",hash:{},data:o,loc:{start:{line:68,column:68},end:{line:68,column:82}}}))+'\n                </label>\n            </div>\n\n            <div class="analytic-form"></div>\n            <div class="pykx-form"></div>\n            <div class="streaming-form"></div>\n            <div class="insights-streaming-form"></div>\n            <div class="builder-query-form"></div>\n            <div class="query-form"></div>\n            <div class="virtual-query-form"></div>\n            <div class="sql-query-form"></div>\n            <div class="api-source-form"></div>\n        </fieldset>\n    </div>\n    <div class="pivot">\n        <fieldset>\n            <legend>\n                <label>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Pivot Query",{name:"t",hash:{},data:o,loc:{start:{line:86,column:23},end:{line:86,column:42}}}))+'</label>\n            </legend>\n            <div class="legend-right">\n                <label class="pivot-type-label-server">\n                    <input type="radio" name="_pivotType" class="server" value="server" checked >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Server",{name:"t",hash:{},data:o,loc:{start:{line:90,column:97},end:{line:90,column:111}}}))+'\n                </label>\n                <label class="pivot-type-label-client">\n                    <input type="radio" name="_pivotType" class="client" value="client" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Client",{name:"t",hash:{},data:o,loc:{start:{line:93,column:89},end:{line:93,column:103}}}))+'\n                </label>\n            </div>\n            <div class="pivot-form"></div>\n        </fieldset>\n    </div>\n    <div class="update">\n        <fieldset>\n            <legend>\n                <label>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Update",{name:"t",hash:{},data:o,loc:{start:{line:102,column:23},end:{line:102,column:37}}}))+'</label>\n            </legend>\n            <div class="legend-right">\n                <label class="pivot-type-label-query">\n                    <input type="radio" name="_updateType" class="query" value="query" checked >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Query",{name:"t",hash:{},data:o,loc:{start:{line:106,column:96},end:{line:106,column:109}}}))+'\n                </label>\n                <label class="pivot-type-label-analytic">\n                    <input type="radio" name="_updateType" class="analytic" value="analytic" >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Analytic",{name:"t",hash:{},data:o,loc:{start:{line:109,column:94},end:{line:109,column:110}}}))+'\n                </label>\n            </div>\n            <div class="update-form"></div>\n        </fieldset>\n    </div>\n    <div class="subscription">\n    </div>\n    <div class="results">\n        <div class="stacked-bar-graph"></div>\n        <fieldset class="results-div">\n            <legend>\n                <label>Results:</label>\n            </legend>\n\n            <div class="queryStatus ui-state-header">\n                <div class="statusPanel Error ui-state-error">\n                    <div class="statusTitle"><i class="fa fa-exclamation-triangle"></i><span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Error",{name:"t",hash:{},data:o,loc:{start:{line:126,column:93},end:{line:126,column:106}}}))+'</span></div>\n                    <span class="statusText"></span>\n                </div>\n                <div class="statusPanel Warning ui-state-warning">\n                    <div class="statusTitle"><i class="fa fa-exclamation-circle"></i><span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Warning",{name:"t",hash:{},data:o,loc:{start:{line:130,column:91},end:{line:130,column:106}}}))+'</span></div>\n                    <span class="statusText"></span>\n                </div>\n                <div class="statusPanel Info ui-state-highlight">\n                    <div class="statusTitle"><i class="fa fa-info-circle"></i><span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Info",{name:"t",hash:{},data:o,loc:{start:{line:134,column:84},end:{line:134,column:96}}}))+'</span></div>\n                    <span class="statusText"></span>\n                </div>\n                <div class="statusPanel Loading ui-state-highlight">\n                    <div class="statusTitle"><i class="fa fa-spinner fa-pulse"></i><span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Loading",{name:"t",hash:{},data:o,loc:{start:{line:138,column:89},end:{line:138,column:104}}}))+'</span></div>\n                    <span class="statusText"></span>\n                </div>\n                <div class="statusPanel NoResults ui-state-highlight">\n                    <div class="statusTitle"><i class="fa fa-info-circle"></i><span>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"No Results",{name:"t",hash:{},data:o,loc:{start:{line:142,column:84},end:{line:142,column:102}}}))+'</span></div>\n                    <span class="statusText"></span>\n                </div>\n            </div>\n\n            <div class="results-type-div">\n                <label title="'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Display a maximum of 2000 rows",{name:"t",hash:{},data:o,loc:{start:{line:148,column:30},end:{line:148,column:68}}}))+'">\n                    <input type="radio" name="_resultsType" value="preview" checked />\n                    '+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Preview",{name:"t",hash:{},data:o,loc:{start:{line:150,column:20},end:{line:150,column:35}}}))+'\n                </label>\n                <label title="'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Display the maximum number of rows",{name:"t",hash:{},data:o,loc:{start:{line:152,column:30},end:{line:152,column:72}}}))+'">\n                    <input type="radio" name="_resultsType" value="all"/>\n                    '+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Max Rows",{name:"t",hash:{},data:o,loc:{start:{line:154,column:20},end:{line:154,column:36}}}))+'\n                </label>\n            </div>\n            <div class="tabs">\n                <ul class="tabsHeaders">\n                    <li><a href="#'+r(typeof(a=null!=(a=e(i,"tableId")||(null!=t?e(t,"tableId"):t))?a:l)==c?a.call(s,{name:"tableId",hash:{},data:o,loc:{start:{line:159,column:34},end:{line:159,column:45}}}):a)+'"><i class="fa fa-fw fa-table"></i>&nbsp;Results</a></li>\n                    <li><a href="#'+r(typeof(a=null!=(a=e(i,"mappingId")||(null!=t?e(t,"mappingId"):t))?a:l)==c?a.call(s,{name:"mappingId",hash:{},data:o,loc:{start:{line:160,column:34},end:{line:160,column:47}}}):a)+'"><i class="fa fa-fw fa-code-fork fa-rotate-90"></i>&nbsp;Mapping</a></li>\n                    <li class="inputInfo"><a href="#'+r(typeof(a=null!=(a=e(i,"inputId")||(null!=t?e(t,"inputId"):t))?a:l)==c?a.call(s,{name:"inputId",hash:{},data:o,loc:{start:{line:161,column:52},end:{line:161,column:63}}}):a)+'"><i class="fa fa-fw fa-flask"></i>&nbsp;Input</a>\n                    <li><a href="#'+r(typeof(a=null!=(a=e(i,"rawId")||(null!=t?e(t,"rawId"):t))?a:l)==c?a.call(s,{name:"rawId",hash:{},data:o,loc:{start:{line:162,column:34},end:{line:162,column:43}}}):a)+'"><i class="fa fa-fw fa-file-text-o"></i>&nbsp;Raw Output</a></li>\n                </ul>\n                <div id="'+r(typeof(a=null!=(a=e(i,"tableId")||(null!=t?e(t,"tableId"):t))?a:l)==c?a.call(s,{name:"tableId",hash:{},data:o,loc:{start:{line:164,column:25},end:{line:164,column:36}}}):a)+'" class="dataTableTab"></div>\n                <div id="'+r(typeof(a=null!=(a=e(i,"mappingId")||(null!=t?e(t,"mappingId"):t))?a:l)==c?a.call(s,{name:"mappingId",hash:{},data:o,loc:{start:{line:165,column:25},end:{line:165,column:38}}}):a)+'"></div>\n                <div id="'+r(typeof(a=null!=(a=e(i,"inputId")||(null!=t?e(t,"inputId"):t))?a:l)==c?a.call(s,{name:"inputId",hash:{},data:o,loc:{start:{line:166,column:25},end:{line:166,column:36}}}):a)+'"></div>\n                <div id="'+r(typeof(a=null!=(a=e(i,"rawId")||(null!=t?e(t,"rawId"):t))?a:l)==c?a.call(s,{name:"rawId",hash:{},data:o,loc:{start:{line:167,column:25},end:{line:167,column:34}}}):a)+'"></div>\n            </div>\n        </fieldset>\n    </div>\n</div>'},useData:!0}),e.DataConfigForm_Perf=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="stacked-bar-graph-details">\n    <table class="tooltiptext">\n        <tr>\n            <td><i class="fa fa-square iconbar-1"></i></td>\n            <td>Dispatch:</td>\n            <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(i,"subscriptionTime")||(null!=t?e(t,"subscriptionTime"):t))?a:l)==r?a.call(s,{name:"subscriptionTime",hash:{},data:o,loc:{start:{line:6,column:39},end:{line:6,column:59}}}):a)+' ms</td>\n            <td class="rightTextAlign"> '+c((e(i,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"subscriptionPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:7,column:40},end:{line:7,column:73}}}))+'%</td>\n        </tr>\n        <tr>\n            <td><i class="fa fa-square iconbar-2"></i></td>\n            <td>Server Duration:</td>\n            <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(i,"executionTime")||(null!=t?e(t,"executionTime"):t))?a:l)==r?a.call(s,{name:"executionTime",hash:{},data:o,loc:{start:{line:12,column:39},end:{line:12,column:56}}}):a)+' ms</td>\n            <td class="rightTextAlign"> '+c((e(i,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"executionPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:13,column:40},end:{line:13,column:70}}}))+'%</td>\n        </tr>\n        <tr>\n            <td><i class="fa fa-square iconbar-3"></i></td>\n            <td>IPC & Deserialize:</td>\n            <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(i,"dataModelTime")||(null!=t?e(t,"dataModelTime"):t))?a:l)==r?a.call(s,{name:"dataModelTime",hash:{},data:o,loc:{start:{line:18,column:39},end:{line:18,column:56}}}):a)+' ms</td>\n            <td class="rightTextAlign"> '+c((e(i,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"dataModelPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:19,column:40},end:{line:19,column:70}}}))+'%</td>\n        </tr>\n    </table> <span style="width:'+c(typeof(a=null!=(a=e(i,"subscriptionPercent")||(null!=t?e(t,"subscriptionPercent"):t))?a:l)==r?a.call(s,{name:"subscriptionPercent",hash:{},data:o,loc:{start:{line:21,column:32},end:{line:21,column:55}}}):a)+'%" class="bar-1"></span>\n    <span style="width:'+c(typeof(a=null!=(a=e(i,"executionPercent")||(null!=t?e(t,"executionPercent"):t))?a:l)==r?a.call(s,{name:"executionPercent",hash:{},data:o,loc:{start:{line:22,column:23},end:{line:22,column:43}}}):a)+'%" class="bar-2"></span>\n    <span style="width:'+c(typeof(a=null!=(a=e(i,"dataModelPercent")||(null!=t?e(t,"dataModelPercent"):t))?a:l)==r?a.call(s,{name:"dataModelPercent",hash:{},data:o,loc:{start:{line:23,column:23},end:{line:23,column:43}}}):a)+'%" class="bar-3"></span>\n</div>\n<div class="stacked-bar-graph-summary"> Roundtrip: '+c(typeof(a=null!=(a=e(i,"totalTime")||(null!=t?e(t,"totalTime"):t))?a:l)==r?a.call(s,{name:"totalTime",hash:{},data:o,loc:{start:{line:25,column:51},end:{line:25,column:64}}}):a)+" ms</div>"},useData:!0}),e.DataConfigInsightsStreaming=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="propertiesPanel paramsView"></div>\n<p class="permission-required"><i class="fa fa-warning"></i> <span></span></p>\n<div class="subscription-select"></div>\n'},useData:!0}),e.DataConfigMapping=Handlebars.template({1:function(e,t,i,n,o){return" single-value"},3:function(e,t,i,n,o){return'            <div class="value slick-header-column ui-state-default">Value</div>\n            <div class="view-state bbf-editor slick-header-column ui-state-default">View State</div>\n            <div class="remove"></div>\n'},5:function(e,t,i,n,o){return'            <div class="key slick-header-column ui-state-default">\n                <label>Key<select class="key-select"></select></label>\n            </div>\n            <div class="value slick-header-column ui-state-default">\n                <label>Value<select class="value-select"></select></label>\n            </div>\n            <div class="view-state bbf-editor slick-header-column ui-state-default">View State</div>\n            <div class="remove slick-header-column ui-state-default"></div>\n'},7:function(e,t,i,n,o){return" disabled"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="mapping-table Datagrid '+e.escapeExpression("function"==typeof(a=null!=(a=l(i,"theme")||(null!=t?l(t,"theme"):t))?a:e.hooks.helperMissing)?a.call(s,{name:"theme",hash:{},data:o,loc:{start:{line:1,column:35},end:{line:1,column:44}}}):a)+(null!=(a=l(i,"if").call(s,null!=t?l(t,"singleValue"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:44},end:{line:1,column:83}}}))?a:"")+'">\n    <div class="table-header">\n        <div class="row slick-header-columns ui-state-default">\n'+(null!=(a=l(i,"if").call(s,null!=t?l(t,"singleValue"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.program(5,o,0),data:o,loc:{start:{line:4,column:12},end:{line:17,column:19}}}))?a:"")+'        </div>\n    </div>\n    <div class="table-body"></div>\n</div>\n<div class="toolbar">\n    <button class="reset-mapping" '+(null!=(a=l(i,"if").call(s,null!=t?l(t,"singleValue"):t,{name:"if",hash:{},fn:e.program(7,o,0),inverse:e.noop,data:o,loc:{start:{line:23,column:34},end:{line:23,column:69}}}))?a:"")+'>Reset</button>\n    <button class="add-mapping" '+(null!=(a=l(i,"if").call(s,null!=t?l(t,"singleValue"):t,{name:"if",hash:{},fn:e.program(7,o,0),inverse:e.noop,data:o,loc:{start:{line:24,column:32},end:{line:24,column:67}}}))?a:"")+">Add</button>\n</div>\n"},useData:!0}),e.DataConfigMappingItem=Handlebars.template({1:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="slick-cell value">'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"value")||(null!=t?a(t,"value"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"value",hash:{},data:o,loc:{start:{line:2,column:30},end:{line:2,column:39}}}):i)+'</div>\n<div class="slick-cell view-state bbf-editor"></div>\n'},3:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="slick-cell key"><select class="key-select"></select></div>\n<div class="slick-cell value">'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"value")||(null!=t?a(t,"value"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"value",hash:{},data:o,loc:{start:{line:6,column:30},end:{line:6,column:39}}}):i)+'</div>\n<div class="slick-cell view-state bbf-editor"></div>\n<div class="slick-cell remove"><button class="remove-mapping">Remove</button></div>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(i=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"singleValue"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.program(3,o,0),data:o,loc:{start:{line:1,column:0},end:{line:9,column:7}}}))?i:""},useData:!0}),e.DataConfigPivot=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,c="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="row tableNameRow">\n\t<label>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Table name:",{name:"t",hash:{},data:o,loc:{start:{line:2,column:8},end:{line:2,column:27}}}))+'</label>\n\t<input class="_table" value="'+r(typeof(a=null!=(a=e(i,"_table")||(null!=t?e(t,"_table"):t))?a:l)==c?a.call(s,{name:"_table",hash:{},data:o,loc:{start:{line:3,column:30},end:{line:3,column:40}}}):a)+'" >\n\t<div class="_pivotQuery"><textarea>'+r(typeof(a=null!=(a=e(i,"_pivotQuery")||(null!=t?e(t,"_pivotQuery"):t))?a:l)==c?a.call(s,{name:"_pivotQuery",hash:{},data:o,loc:{start:{line:4,column:36},end:{line:4,column:51}}}):a)+'</textarea></div>\n\t<div id="'+r(typeof(a=null!=(a=e(i,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:5,column:10},end:{line:5,column:21}}}):a)+'" class="pivotSourceToggle">\n        <input type="radio" id="'+r(typeof(a=null!=(a=e(i,"radio1Id")||(null!=t?e(t,"radio1Id"):t))?a:l)==c?a.call(s,{name:"radio1Id",hash:{},data:o,loc:{start:{line:6,column:32},end:{line:6,column:44}}}):a)+'" name="'+r(typeof(a=null!=(a=e(i,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:6,column:52},end:{line:6,column:63}}}):a)+'" value="tableName" checked="checked"><label for="'+r(typeof(a=null!=(a=e(i,"radio1Id")||(null!=t?e(t,"radio1Id"):t))?a:l)==c?a.call(s,{name:"radio1Id",hash:{},data:o,loc:{start:{line:6,column:113},end:{line:6,column:125}}}):a)+'">Table name</label>\n        <input type="radio" id="'+r(typeof(a=null!=(a=e(i,"radio2Id")||(null!=t?e(t,"radio2Id"):t))?a:l)==c?a.call(s,{name:"radio2Id",hash:{},data:o,loc:{start:{line:7,column:32},end:{line:7,column:44}}}):a)+'" name="'+r(typeof(a=null!=(a=e(i,"radioId")||(null!=t?e(t,"radioId"):t))?a:l)==c?a.call(s,{name:"radioId",hash:{},data:o,loc:{start:{line:7,column:52},end:{line:7,column:63}}}):a)+'" value="pivotQuery"><label for="'+r(typeof(a=null!=(a=e(i,"radio2Id")||(null!=t?e(t,"radio2Id"):t))?a:l)==c?a.call(s,{name:"radio2Id",hash:{},data:o,loc:{start:{line:7,column:96},end:{line:7,column:108}}}):a)+'">Query string</label>\n    </div>\n</div>\n<div class="_breakdownCols row">\n    <label>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Breakdown Cols:",{name:"t",hash:{},data:o,loc:{start:{line:11,column:11},end:{line:11,column:34}}}))+'</label>\n    <textarea></textarea>\n</div>\n<div class="_aggregateCols row">\n\t<label>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Aggregate Cols:",{name:"t",hash:{},data:o,loc:{start:{line:15,column:8},end:{line:15,column:31}}}))+'</label>\n\t<textarea></textarea>\n</div>\n<div class="_aggregateFns row">\n\t<label>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Aggregate Fns:",{name:"t",hash:{},data:o,loc:{start:{line:19,column:8},end:{line:19,column:30}}}))+'</label>\n\t<textarea></textarea>\n</div>\n<div class="subscription-select"></div>\n\x3c!--<div class="row">\n    <label>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"From Date:",{name:"t",hash:{},data:o,loc:{start:{line:24,column:11},end:{line:24,column:29}}}))+'</label>\n    <input class="_from" value="'+r(typeof(a=null!=(a=e(i,"_from")||(null!=t?e(t,"_from"):t))?a:l)==c?a.call(s,{name:"_from",hash:{},data:o,loc:{start:{line:25,column:32},end:{line:25,column:41}}}):a)+'" data-datadesc="from">\n</div>\n<div class="row">\n    <label>'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"To Date:",{name:"t",hash:{},data:o,loc:{start:{line:28,column:11},end:{line:28,column:27}}}))+'</label>\n    <input class="_to" value="'+r(typeof(a=null!=(a=e(i,"_to")||(null!=t?e(t,"_to"):t))?a:l)==c?a.call(s,{name:"_to",hash:{},data:o,loc:{start:{line:29,column:30},end:{line:29,column:37}}}):a)+'" data-datadesc="to" >\n</div>\n<div class="errorDialog" style="display: none;">Please select either "From Date" or "To Date" to populate.</div>--\x3e\n'},useData:!0}),e.DataConfigQuery_Builder=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="graph-container">\n    <div class="graph-content">\n        <div class="accordion">\n            <div class="side-dialog" style="display:none;">\n                <div class="side-dialog-menu">\n                    <span class="menu-item menu-icon"></span>\n                    <span class="menu-item description"></span>\n                    <span class="menu-item close-button"><i class="fa fa-times"></i></span>\n                </div>\n                <div class="side-dialog-content"></div>\n                <div class="side-dialog-buttons">\n                    <span class="save-button">Save</span>\n                </div>\n            </div>\n            <div class="graph"></div>\n        </div>\n    </div>\n    <ul class=\'custom-menu\'></ul>\n\n    <div class="nodeErrorMessage" style="display:none">\n        <div class="errors-title"><i class="fa fa-exclamation-triangle"></i><span>'+e.escapeExpression((a(i,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Error:",{name:"t",hash:{},data:o,loc:{start:{line:21,column:82},end:{line:21,column:96}}}))+'</span></div>\n        <span class="errors-text"></span>\n    </div>\n\n    <div class="loading">\n        <div class="loadingInner">\n            <i class="fa fa-spinner fa-spin"></i>\n        </div>\n    </div>\n</div>'},useData:!0}),e.DataConfigQuery_Pivot=Handlebars.template({1:function(e,t,i,n,o){return"isViewState"},3:function(e,t,i,n,o){return"checked"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s,l=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,c=e.escapeExpression,d="function",u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n<div class="overlay"></div>\n<div class="_breakdownCols row"></div>\n<div class="_columnLabels row">\n    <label>'+c((u(i,"t")||t&&u(t,"t")||r).call(l,"Column Label:",{name:"t",hash:{},data:o,loc:{start:{line:5,column:11},end:{line:5,column:32}}}))+'</label>\n    <span class="columnLabelInputHolder">\n        \x3c!--<input type="text" class="_columnLabel">--\x3e\n        <input class="_columnLabel" type="text" >\n    </span>\n    \x3c!--<textarea></textarea>--\x3e\n</div>\n<div class="aggregateContainer '+(null!=(a=u(i,"if").call(l,null!=t?u(t,"hasAggregateViewState"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:12,column:31},end:{line:12,column:78}}}))?a:"")+'">\n    <div class="label">\n        Aggregates:<br ></br>\n        <label class="viewStateCheckbox" for="'+c(typeof(s=null!=(s=u(i,"guid")||(null!=t?u(t,"guid"):t))?s:r)==d?s.call(l,{name:"guid",hash:{},data:o,loc:{start:{line:15,column:46},end:{line:15,column:54}}}):s)+'_viewStateCheckbox">'+c((u(i,"t")||t&&u(t,"t")||r).call(l,"Assign View State",{name:"t",hash:{},data:o,loc:{start:{line:15,column:74},end:{line:15,column:99}}}))+'</label>\n        <input id="'+c(typeof(s=null!=(s=u(i,"guid")||(null!=t?u(t,"guid"):t))?s:r)==d?s.call(l,{name:"guid",hash:{},data:o,loc:{start:{line:16,column:19},end:{line:16,column:27}}}):s)+'_viewStateCheckbox" type="checkbox" class="viewStateCheckbox viewStateCheckboxInput ui-helper-hidden-accessible" '+(null!=(a=u(i,"if").call(l,null!=t?u(t,"hasAggregateViewState"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:16,column:140},end:{line:16,column:183}}}))?a:"")+' >\n        <span class="resetBtn">Reset</span>\n    </div>\n    <div>\n        <div class="aggregateList">\n            <ul style="list-style: none;"></ul>\n            <div class="pivotRow newAggregate">\n                <input class="aggregateFnItm new" placeholder="Function" >\n                <input class="aggregateColItm new" placeholder="Column" >\n                <input class="aggregateLabelItm new" placeholder="Label" >\n                <div class="addBtn">Add</div>\n            </div>\n        </div>\n        <div class="aggregateViewState"></div>\n    </div>\n</div>\n'},useData:!0}),e.DataConfigQuery_Query=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="custom-api-params">\n    <select class="cmbAssemblyTarget"></select>\n</div>\n<div class="query-editor"></div>\n<div class="params-box" spellcheck="false" resize="false"></div>\n'},useData:!0}),e.DataConfigQuery_SQL=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="query-editor"></div>\n<div class="params-box" spellcheck="false" resize="false"></div> '},useData:!0}),e.DataConfigQuery_Subscription=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div style="height: 100%;">\n<div class="subscription-select"></div>\n</div>'},useData:!0}),e.DataConfigQuery_Update=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="overlay"></div>\n<div class="update-editor"></div>\n<div class="update-analytic-picker">\n    <div class="picker"></div>\n    <div class="info">\n        <p>Update Analytic is Called with Three Parameters</p>\n        <ol>\n            <li>dgAdd {Dict} - Added Columns</li>\n            <li>dgUpd {Dict} - Updated Columns</li>\n            <li>dgDel {Dict} - Removed Columns</li>\n        </ol>\n    </div>\n</div>\n<a\n    class="fa fa-fw fa-info-circle"\n    title="'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Example shows add, upd and del parameters are passed to the update query as dictionaries",{name:"t",hash:{},data:o,loc:{start:{line:16,column:11},end:{line:16,column:107}}}))+"&#13;"+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Containing all column entries of any rows added, updated or deleted.",{name:"t",hash:{},data:o,loc:{start:{line:16,column:112},end:{line:16,column:188}}}))+'"\n></a>\n<div class="update-params-box" spellcheck="false" resize="false"></div>\n'},useData:!0}),e.DataConfigQuery_Virtual=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="query-editor"></div>\n<div class="params-box" spellcheck="false" resize="false"></div> '},useData:!0}),e.DataDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="tree"></div>\n<div class="form"></div>\n'},useData:!0}),e.DataModelProperties=Handlebars.template({1:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"        <tr><td>"+c(typeof(a=null!=(a=e(i,"key")||(null!=t?e(t,"key"):t))?a:l)==r?a.call(s,{name:"key",hash:{},data:o,loc:{start:{line:4,column:16},end:{line:4,column:23}}}):a)+"</td><td>"+c(typeof(a=null!=(a=e(i,"val")||(null!=t?e(t,"val"):t))?a:l)==r?a.call(s,{name:"val",hash:{},data:o,loc:{start:{line:4,column:32},end:{line:4,column:39}}}):a)+"</td></tr>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<form>\n    <table>\n"+(null!=(a=l(i,"each").call(s,t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:3,column:8},end:{line:5,column:17}}}))?a:"")+'    </table>\n    <div>\n        <div class="config-btn">'+e.escapeExpression((l(i,"t")||t&&l(t,"t")||e.hooks.helperMissing).call(s,"Configure",{name:"t",hash:{},data:o,loc:{start:{line:8,column:32},end:{line:8,column:49}}}))+"</div>\n    </div>\n</form>\n"},useData:!0}),e.DataParameter=Handlebars.template({1:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <input class="name-input col1" value="'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"name")||(null!=t?a(t,"name"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"name",hash:{},data:o,loc:{start:{line:3,column:42},end:{line:3,column:50}}}):i)+'" />\n'},3:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <label class="col1" id="viewstate-'+c(typeof(a=null!=(a=e(i,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:5,column:38},end:{line:5,column:46}}}):a)+'-label">'+c(typeof(a=null!=(a=e(i,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:5,column:54},end:{line:5,column:62}}}):a)+"</label>\n    "},5:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n    <span class="col1-tooltip"><i title="'+e.escapeExpression(e.lambda(null!=(e=null!=t?a(t,"options"):t)?a(e,"tooltip"):e,t))+'" class="mi mi-info-outline"></i></span>\n'},7:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="remove-item-btn col4" data-id="'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"id")||(null!=t?a(t,"id"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"id",hash:{},data:o,loc:{start:{line:65,column:47},end:{line:65,column:53}}}):i)+'">\n        Remove Item\n    </div>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s,l=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="form-control viewstate-control">\n'+(null!=(a=d(i,"if").call(l,null!=t?d(t,"editable"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.program(3,o,0),data:o,loc:{start:{line:2,column:4},end:{line:6,column:11}}}))?a:"")+" "+(null!=(a=d(i,"if").call(l,null!=(a=null!=t?d(t,"options"):t)?d(a,"tooltip"):a,{name:"if",hash:{},fn:e.program(5,o,0),inverse:e.noop,data:o,loc:{start:{line:6,column:12},end:{line:8,column:11}}}))?a:"")+'\n    <div class="type-dropdown col2">\n        <select class="type-select" aria-labelledby="viewstate-'+c("function"==typeof(s=null!=(s=d(i,"name")||(null!=t?d(t,"name"):t))?s:r)?s.call(l,{name:"name",hash:{},data:o,loc:{start:{line:11,column:63},end:{line:11,column:71}}}):s)+'-label">\n            <option>boolean</option>\n            <option>byte</option>\n            <option>char</option>\n            <option>date</option>\n            <option>datetime</option>\n            <option>dict</option>\n            <option>double</option>\n            <option>float</option>\n            <option>guid</option>\n            <option>int</option>\n            <option>list</option>\n            <option>long</option>\n            <option>minute</option>\n            <option>month</option>\n            <option>second</option>\n            <option>short</option>\n            <option>string</option>\n            <option>symbol</option>\n            <option>time</option>\n            <option>timespan</option>\n            <option>timestamp</option>\n        </select>\n    </div>\n\n    <div class="input-div col3">\n        \x3c!-- <input class="value-input" type="text" data-schemaformat="number" > --\x3e\n        <span class="value-input bbf-editor"></span>\n\n        <i class="fa fa-fw watermark fa-eye binding-apply viewstate-apply" tabindex="-1"></i>\n\n        <div class="generate-value" title="'+c((d(i,"t")||t&&d(t,"t")||r).call(l,"Generate View State",{name:"t",hash:{},data:o,loc:{start:{line:42,column:43},end:{line:42,column:70}}}))+'" tabindex="-1">\n            <i class="fa fa-fw watermark fa-eye generate-viewstate-icon"></i>\n            <i class="fa fa-fw watermark fa-cog generate-viewstate-icon"></i>\n        </div>\n\n        <div class="binding-container">\n            <i\n                class="fa fa-fw watermark fa-eraser binding-clear"\n                title="'+c((d(i,"t")||t&&d(t,"t")||r).call(l,"Clear View State",{name:"t",hash:{},data:o,loc:{start:{line:50,column:23},end:{line:50,column:47}}}))+'"\n                tabindex="-1"\n            ></i>\n            <i\n                class="fa fa-fw watermark fa-eye binding-icon viewstate-icon"\n                title="'+c((d(i,"t")||t&&d(t,"t")||r).call(l,"Select View State",{name:"t",hash:{},data:o,loc:{start:{line:55,column:23},end:{line:55,column:48}}}))+'"\n            ></i>\n            <input class="value-display data-parameter-editor" type="text" tabindex="-1" readonly />\n            <label class="label-rolling">\n                <input class="checkbox-rolling" type="checkbox" />Use Rolling Syntax\n            </label>\n        </div>\n    </div>\n\n'+(null!=(a=d(i,"if").call(l,null!=t?d(t,"editable"):t,{name:"if",hash:{},fn:e.program(7,o,0),inverse:e.noop,data:o,loc:{start:{line:64,column:4},end:{line:68,column:11}}}))?a:"")+'</div>\n\n<div class="form-control viewstate-control button-row">\n    <div class="add-item-btn">\n        Add Item\n    </div>\n</div>\n\n<div class="list-items" style="margin-bottom: 22px; padding-left: 1em;"></div>\n'},useData:!0}),e.DocumentGraph=Handlebars.template({1:function(e,t,i,n,o){return" checked "},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="overlay"></div>\n<div class="graph-toolbar">\n    <div class="options ui-widget">\n        <div class="radio-button">    \n            <label><input type="radio" name="hierarchical" value="default" '+(null!=(a=l(i,"unless").call(s,null!=t?l(t,"hierarchical"):t,{name:"unless",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:5,column:75},end:{line:5,column:119}}}))?a:"")+' tabindex="0">Default</label>\n        </div>\n        <div class="radio-button">\n            <label><input type="radio" name="hierarchical" value="hierarchical" '+(null!=(a=l(i,"if").call(s,null!=t?l(t,"hierarchical"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:8,column:80},end:{line:8,column:116}}}))?a:"")+' tabindex="0">Hierarchical</label>\n        </div>\n        <div class="graph-buttons">\n            <button class="clean-up" title="Clean Up Isolated Objects"></button>\n        </div>\n    </div>\n    <div class="search-box">\n        <form autocomplete="off">\n            <i class="fa fa-search"></i>\n            <input type="text" class="searchInput" placeholder="Components, Data Sources, or View States">\n            <span class="clearSearch fa fa-times" style="visibility: hidden"></span>\n        </form>\n    </div>\n    <div class="close-box">\n        <a class="close" tabindex="0" aria-label="Close Document Graph"><i class="fa fa-close"></i></a>\n    </div>\n    \n</div>\n<div class="loading">\n    <div class="loadingInner">\n        <i class="fa fa-spinner fa-spin"></i>\n    </div>\n</div>'},useData:!0}),e.DocumentGraphTooltip=Handlebars.template({1:function(e,t,i,n,o){return"<li>"+e.escapeExpression(e.lambda(t,t))+"</li>\n"},3:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<table class="tooltiptext">\n    <tr>\n        <td><i class="fa fa-square iconbar-1"></i></td>\n        <td>Dispatch:</td>\n        <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(i,"subscriptionTime")||(null!=t?e(t,"subscriptionTime"):t))?a:l)==r?a.call(s,{name:"subscriptionTime",hash:{},data:o,loc:{start:{line:14,column:35},end:{line:14,column:55}}}):a)+' ms</td>\n        <td class="rightTextAlign"> '+c((e(i,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"subscriptionPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:15,column:36},end:{line:15,column:69}}}))+'%</td>\n    </tr>\n    <tr>\n        <td><i class="fa fa-square iconbar-2"></i></td>\n        <td>Server Duration:</td>\n        <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(i,"executionTime")||(null!=t?e(t,"executionTime"):t))?a:l)==r?a.call(s,{name:"executionTime",hash:{},data:o,loc:{start:{line:20,column:35},end:{line:20,column:52}}}):a)+' ms</td>\n        <td class="rightTextAlign"> '+c((e(i,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"executionPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:21,column:36},end:{line:21,column:66}}}))+'%</td>\n    </tr>\n    <tr>\n        <td><i class="fa fa-square iconbar-3"></i></td>\n        <td>IPC & Deserialize:</td>\n        <td class="rightTextAlign">'+c(typeof(a=null!=(a=e(i,"dataModelTime")||(null!=t?e(t,"dataModelTime"):t))?a:l)==r?a.call(s,{name:"dataModelTime",hash:{},data:o,loc:{start:{line:26,column:35},end:{line:26,column:52}}}):a)+' ms</td>\n        <td class="rightTextAlign"> '+c((e(i,"toFixed")||t&&e(t,"toFixed")||l).call(s,null!=t?e(t,"dataModelPercent"):t,2,{name:"toFixed",hash:{},data:o,loc:{start:{line:27,column:36},end:{line:27,column:66}}}))+"%</td>\n    </tr>\n</table>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class = "document-graph-tooltip">\n'+c(typeof(a=null!=(a=d(i,"executions")||(null!=t?d(t,"executions"):t))?a:l)==r?a.call(s,{name:"executions",hash:{},data:o,loc:{start:{line:2,column:0},end:{line:2,column:14}}}):a)+" <br>\n"+c(typeof(a=null!=(a=d(i,"label")||(null!=t?d(t,"label"):t))?a:l)==r?a.call(s,{name:"label",hash:{},data:o,loc:{start:{line:3,column:0},end:{line:3,column:9}}}):a)+"\n<ul>\n"+(null!=(c=d(i,"each").call(s,null!=t?d(t,"subscribers"):t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:5,column:0},end:{line:7,column:9}}}))?c:"")+"</ul>\n"+(null!=(c=d(i,"if").call(s,null!=t?d(t,"bool"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:9,column:0},end:{line:30,column:7}}}))?c:"")+"</div>"},useData:!0}),e.DropDownDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n<ol class="tp-radio">\n</ol>\n\n<div class="pnlCustom"> \n    <p>To create a "wild" column please use * <br></br> \n        <span class="wildcard-example">e.g. use <b>bid*</b> for <b>[bid]</b> and <b>[bid_change]</b></span></p>\n    <input class="customDropwdownInput" type="text" >\n    <button class="customDropwdownSelect">'+e.escapeExpression((a(i,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Add Custom Column",{name:"t",hash:{},data:o,loc:{start:{line:9,column:42},end:{line:9,column:67}}}))+"</button>\n</div>\n"},useData:!0}),e.DropDownSelectableDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'\n<ol class="tp-selectable">\n</ol>\n\n<div class="pnlCustom"> \n    <p><span class="wildcard-message"></span><br></br> \n        <span class="wildcard-example">e.g. use <b>bid*</b> for <b>[bid]</b> and <b>[bid_change]</b></span></p>\n    <input class="customDropwdownInput" type="text" >\n    <button class="customDropwdownSelect"></button>\n</div>\n'},useData:!0}),e.DropDownWithEnumSelectableDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\n<ol class="tp-selectable">\n</ol>\n\n<div class="pnlCustom"> \n    <p>Add custom geoJson url <br></br> \n        \n    <input class="customDropwdownInput" type="text" >\n    <button class="customDropwdownSelect">'+e.escapeExpression((a(i,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"Use Custom Url",{name:"t",hash:{},data:o,loc:{start:{line:9,column:42},end:{line:9,column:64}}}))+"</button>\n</div>\n"},useData:!0}),e.EditorDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="toolbar ui-widget-header ui-corner-all">\n\t<span class="fa-stack fa-lg element-picker" title="'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Choose an element",{name:"t",hash:{},data:o,loc:{start:{line:2,column:52},end:{line:2,column:77}}}))+'">\n\t\t<i class="fa fa-square-o fa-stack-2x"></i>\n\t\t<i class="fa fa-mouse-pointer fa-stack-1x"></i>\n\t</span>\n\t<div class="highlighted-element">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Click the icon to choose an element",{name:"t",hash:{},data:o,loc:{start:{line:6,column:34},end:{line:6,column:77}}}))+"</div>\n</div>"},useData:!0}),e.ErrorDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="dialog-error" title="'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Error",{name:"t",hash:{},data:o,loc:{start:{line:1,column:33},end:{line:1,column:46}}}))+'">\n    <p>'+l("function"==typeof(l=null!=(l=e(i,"body")||(null!=t?e(t,"body"):t))?l:s)?l.call(a,{name:"body",hash:{},data:o,loc:{start:{line:2,column:7},end:{line:2,column:15}}}):l)+"\n    </p>\n</div>\n"},useData:!0}),e.FailedLoginsNotification=Handlebars.template({1:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,d=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="status-'+c(typeof(a=null!=(a=d(i,"status")||(null!=t?d(t,"status"):t))?a:l)==r?a.call(s,{name:"status",hash:{},data:o,loc:{start:{line:2,column:23},end:{line:2,column:33}}}):a)+'">\n        <span>'+c(typeof(a=null!=(a=d(i,"time")||(null!=t?d(t,"time"):t))?a:l)==r?a.call(s,{name:"time",hash:{},data:o,loc:{start:{line:3,column:14},end:{line:3,column:22}}}):a)+'</span>\n        <span class="info">from:</span>\n        <span>'+c(typeof(a=null!=(a=d(i,"machineID")||(null!=t?d(t,"machineID"):t))?a:l)==r?a.call(s,{name:"machineID",hash:{},data:o,loc:{start:{line:5,column:14},end:{line:5,column:27}}}):a)+"</span>\n"+(null!=(e=d(i,"if").call(s,null!=t?d(t,"status"):t,{name:"if",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o,loc:{start:{line:6,column:8},end:{line:9,column:15}}}))?e:"")+'        <span class="info">url:</span>\n        <span>'+c(typeof(a=null!=(a=d(i,"url")||(null!=t?d(t,"url"):t))?a:l)==r?a.call(s,{name:"url",hash:{},data:o,loc:{start:{line:11,column:14},end:{line:11,column:21}}}):a)+"</span>\n    </div>\n"},2:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <span class="info">status:</span>\n        <span>'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"status")||(null!=t?a(t,"status"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"status",hash:{},data:o,loc:{start:{line:8,column:14},end:{line:8,column:24}}}):i)+"</span>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(i=a(i,"each").call(null!=t?t:e.nullContext||{},null!=t?a(t,"rows"):t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:13,column:9}}}))?i:""},useData:!0}),e.GetDataParamsView=Handlebars.template({1:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <div class="parameterItem">\n                <div class="label">'+c(typeof(a=null!=(a=e(i,"Name")||(null!=t?e(t,"Name"):t))?a:l)==r?a.call(s,{name:"Name",hash:{},data:o,loc:{start:{line:7,column:35},end:{line:7,column:43}}}):a)+" ("+c(typeof(a=null!=(a=e(i,"Type")||(null!=t?e(t,"Type"):t))?a:l)==r?a.call(s,{name:"Type",hash:{},data:o,loc:{start:{line:7,column:45},end:{line:7,column:53}}}):a)+')</div>\n                <input class="value" value="'+c(typeof(a=null!=(a=e(i,"DefaultValue")||(null!=t?e(t,"DefaultValue"):t))?a:l)==r?a.call(s,{name:"DefaultValue",hash:{},data:o,loc:{start:{line:8,column:44},end:{line:8,column:60}}}):a)+'" />\n            </div>\n'},3:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r=e.escapeExpression,c="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"    <fieldset>\n        <legend>"+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Query Limit",{name:"t",hash:{},data:o,loc:{start:{line:16,column:16},end:{line:16,column:35}}}))+'</legend>\n        <div class="queryLimitContainer">\n            <label class="applyLimit">\n                <input type="checkbox" />\n                <div class="label" aria-describedby="helperText'+r(typeof(a=null!=(a=e(i,"localGuid")||(null!=t?e(t,"localGuid"):t))?a:l)==c?a.call(s,{name:"localGuid",hash:{},data:o,loc:{start:{line:20,column:63},end:{line:20,column:76}}}):a)+'">'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Apply Limit",{name:"t",hash:{},data:o,loc:{start:{line:20,column:78},end:{line:20,column:97}}}))+'</div>\n            </label>\n            <span id="helperText'+r(typeof(a=null!=(a=e(i,"localGuid")||(null!=t?e(t,"localGuid"):t))?a:l)==c?a.call(s,{name:"localGuid",hash:{},data:o,loc:{start:{line:22,column:32},end:{line:22,column:45}}}):a)+'" class="helperText"\n                >'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Limit helps conserve memory usage from very large data sets.",{name:"t",hash:{},data:o,loc:{start:{line:23,column:17},end:{line:23,column:85}}}))+'</span\n            >\n            <div class="rowLimit">\n                <div class="label">'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Row Limit",{name:"t",hash:{},data:o,loc:{start:{line:26,column:35},end:{line:26,column:52}}}))+'</div>\n                <input class="limitInput" type="number" class="value" step="1"/>\n            </div>\n            <div class="firstLast">\n                <label\n                    class="firstRadio"\n                    title="'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Takes the first N number of rows, designated by a positive number",{name:"t",hash:{},data:o,loc:{start:{line:32,column:27},end:{line:32,column:100}}}))+'"\n                    ><input type="radio" name="firstLast'+r(typeof(a=null!=(a=e(i,"localGuid")||(null!=t?e(t,"localGuid"):t))?a:l)==c?a.call(s,{name:"localGuid",hash:{},data:o,loc:{start:{line:33,column:56},end:{line:33,column:69}}}):a)+'" value="on" />'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"First",{name:"t",hash:{},data:o,loc:{start:{line:33,column:84},end:{line:34,column:29}}}))+'</label\n                >\n                <label\n                    class="lastRadio"\n                    title="'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Takes the last N number of rows, designated by a negative number",{name:"t",hash:{},data:o,loc:{start:{line:38,column:27},end:{line:38,column:99}}}))+'"\n                    ><input type="radio" name="firstLast'+r(typeof(a=null!=(a=e(i,"localGuid")||(null!=t?e(t,"localGuid"):t))?a:l)==c?a.call(s,{name:"localGuid",hash:{},data:o,loc:{start:{line:39,column:56},end:{line:39,column:69}}}):a)+'" value="off"  />'+r((e(i,"t")||t&&e(t,"t")||l).call(s,"Last",{name:"t",hash:{},data:o,loc:{start:{line:39,column:86},end:{line:40,column:28}}}))+"</label\n                >\n            </div>\n        </div>\n    </fieldset>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},r='<div class="getDataParamsView">\n    <fieldset>\n        <legend>'+e.escapeExpression((l(i,"t")||t&&l(t,"t")||s).call(a,"Parameters",{name:"t",hash:{},data:o,loc:{start:{line:3,column:16},end:{line:3,column:34}}}))+'</legend>\n        <div class="parameterList">\n',c=null!=(c=l(i,"Parameters")||(null!=t?l(t,"Parameters"):t))?c:s,s={name:"Parameters",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:5,column:12},end:{line:10,column:27}}},c="function"==typeof c?c.call(a,s):c;return null!=(c=l(i,"Parameters")?c:e.hooks.blockHelperMissing.call(t,c,s))&&(r+=c),r+"        </div>\n    </fieldset>\n\n"+(null!=(c=l(i,"if").call(a,null!=t?l(t,"hasQueryLimit"):t,{name:"if",hash:{},fn:e.program(3,o,0),inverse:e.noop,data:o,loc:{start:{line:14,column:4},end:{line:45,column:11}}}))?c:"")+"</div>\n"},useData:!0}),e.HandlebarHelp=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="handlebars-help">\n    <h2 id="getting-started">Getting Started\n    </h2>\n    <div class="contents">\n        <div class="description">\n            Creating a template looks like regular HTML, with embedded expressions.\n        </div>\n         <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>My symbol is: <span class="EmbeddedSourceBright">&#123;&#123;sym&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n        <div class="notes">\n            An expression is a <code>&#123;&#123;</code>, some contents, followed by a <code>&#125;&#125;</code>\n        </div>\n        <div class="notes">\n            You can iterate over your data using the each helper. Inside the block, you can use this to reference the element being iterated over.\n        </div>\n        <pre class="sunburst"><span class="MetaTagAll">&lt;div&gt;</span>My symbols are:&#x000A;<span class="MetaTagAll">&lt;ol&gt;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#each this&#125;&#125;</span>&#x000A;    <span class="MetaTagAll">&lt;li&gt;</span><span class="EmbeddedSourceBright">&#123;&#123;sym&#125;&#125;</span><span class="MetaTagAll">&lt;/li&gt;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;  <span class="MetaTagAll">&lt;/ol&gt;</span>&#x000A;<span class="MetaTagAll">&lt;/div&gt;</span></pre>\n    </div>\n    <h2 id="basic-blocks">Basic Usage\n    </h2>\n    <div class="contents">\n        <div class="bullet">\n            <div class="description">\n                The simplest Handlebars expression is a simple identifier:\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;title&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n            <div class="notes">\n                This expression means "look up the <code>title</code> property in\n            the current context". Block helpers may manipulate the current\n            context, but they do not change the basic meaning of an expression.\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                Handlebars expressions can also be dot-separated paths.\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;article.title&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n            <div class="notes">\n                This expression means "look up the <code>article</code> property in\n            the current context. Then look up the <code>title</code>\n                property in the result".\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                Identifiers may be any unicode character except for the following:\n            </div>\n            <div class="notes">\n                Whitespace\n            <code>!</code>\n                <code>"</code>\n                <code>#</code>\n                <code>%</code>\n                <code>&</code>\n                <code>\'</code>\n                <code>(</code>\n                <code>)</code>\n                <code>*</code>\n                <code>+</code>\n                <code>,</code>\n                <code>.</code>\n                <code>/</code>\n                <code>;</code>\n                <code><</code>\n                <code>=</code>\n                <code>></code>\n                <code>@</code>\n                <code>[</code>\n                <code>\\</code>\n                <code>]</code>\n                <code>^</code>\n                <code>`</code>\n                <code>{</code>\n                <code>|\x3c!-- Comment to prevent multiline parsing --\x3e</code>\n                <code>}</code>\n                <code>~</code>\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                To reference a property that is not a valid identifier, you can\n            use segment-literal notation, <code>[</code>:\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each articles.[10].[#comments]&#125;&#125;</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;subject&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;    <span class="EmbeddedSourceBright">&#123;&#123;body&#125;&#125;</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                In the example above, the template will treat the <code>each</code>\n                parameter roughly equivalent to this javascript:\n            <code>articles[10][\'#comments\']</code>\n            </div>\n            <div class="notes">\n                You may not include a closing <code>]</code> in a path-literal,\n            but all other characters are fair game.\n            </div>\n            <div class="description">\n                JavaScript-style strings, <code>"</code> and <code>\'</code>, may also be used vs. <code>[</code>\n                pairs.\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                Handlebars HTML-escapes values returned by a <code>&#123;&#123;expression&#125;&#125;</code>.\n            If you don\'t want Handlebars to escape a value, use the "triple-stash", <code>&#123;&#123;{</code>\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;{foo&#125;&#125;</span>}&#x000A;</pre>\n        </div>\n    </div>\n    <h2 id="conditionals">The <code>if</code> block helper\n    </h2>\n    <div class="content">\n        <div class="bullet">\n            <div class="description">\n                You can use the <code>if</code> helper to conditionally render a block. If\n              its argument returns <code>false</code>, <code>undefined</code>, <code>null</code>,\n              <code>""</code>, <code>0</code>, or <code>[]</code>, Handlebars will not\n              render the block.\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#if author&#125;&#125;</span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;firstName&#125;&#125;</span> <span class="EmbeddedSourceBright">&#123;&#123;lastName&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/if&#125;&#125;</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n            <div class="notes">\n                when used with an empty (<code>{}</code>) context, <code>author</code> will be\n              <code>undefined</code>, resulting in:\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                When using a block expression, you can specify a template section to\n              run if the expression returns a falsy value. The section, marked by\n              <code>&#123;&#123;else&#125;&#125;</code> is called an "else section".\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#if author&#125;&#125;</span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;firstName&#125;&#125;</span> <span class="EmbeddedSourceBright">&#123;&#123;lastName&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;else&#125;&#125;</span>&#x000A;    <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>Unknown Author<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h1</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/if&#125;&#125;</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n        </div>\n    </div>\n    <h2 id="unless">The <code>unless</code> block helper\n    </h2>\n    <div class="content">\n        <div class="bullet">\n            <div class="description">\n                You can use the <code>unless</code> helper as the inverse of the\n              <code>if</code> helper. Its block will be rendered if the expression\n              returns a falsy value.\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">div</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>entry<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#unless license&#125;&#125;</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">h3</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>warning<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>WARNING: This entry does not have a license!<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">h3</span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/unless&#125;&#125;</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">div</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n            <div class="notes">\n                If looking up <code>license</code> under the current context returns a\n              falsy value, Handlebars will render the warning. Otherwise, it will render\n              nothing.\n            </div>\n        </div>\n    </div>\n    <h2 id="iteration">The <code>each</code> block helper\n    </h2>\n    <div class="content">\n        <div class="bullet">\n            <div class="description">\n                You can iterate over a list using the built-in <code>each</code>\n                helper. Inside the block, you can use <code>this</code> to reference\n              the element being iterated over.\n            </div>\n            <pre class="sunburst"><span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">ul</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>people_list<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#each people&#125;&#125;</span>&#x000A;    <span class="MetaTagInline"><span class="MetaTagInline">&lt;</span><span class="MetaTagInline">li</span><span class="MetaTagInline">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;this&#125;&#125;</span><span class="MetaTagInline"><span class="MetaTagInline">&lt;/</span><span class="MetaTagInline">li</span><span class="MetaTagInline">&gt;</span></span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">ul</span><span class="MetaTagAll">&gt;</span></span>&#x000A;</pre>\n            <div class="notes">\n                when used with this context:\n            </div>\n            <pre class="sunburst">{&#x000A;  people: [&#x000A;    <span class="String"><span class="String">&quot;</span>Yehuda Katz<span class="String">&quot;</span></span>,&#x000A;    <span class="String"><span class="String">&quot;</span>Alan Johnson<span class="String">&quot;</span></span>,&#x000A;    <span class="String"><span class="String">&quot;</span>Charles Jolley<span class="String">&quot;</span></span>&#x000A;  ]&#x000A;}&#x000A;</pre>\n            <div class="notes">\n                will result in:\n            </div>\n            <pre class="sunburst"><span class="Keyword">&lt;</span>ul <span class="Storage">class</span><span class="Keyword">=</span><span class="String"><span class="String">&quot;</span>people_list<span class="String">&quot;</span></span><span class="Keyword">&gt;</span>&#x000A;  <span class="Keyword">&lt;</span>li<span class="Keyword">&gt;</span>Yehuda Katz<span class="Keyword">&lt;</span>/li<span class="Keyword">&gt;</span>&#x000A;  <span class="Keyword">&lt;</span>li<span class="Keyword">&gt;</span>Alan Johnson<span class="Keyword">&lt;</span>/li<span class="Keyword">&gt;</span>&#x000A;  <span class="Keyword">&lt;</span>li<span class="Keyword">&gt;</span>Charles Jolley<span class="Keyword">&lt;</span>/li<span class="Keyword">&gt;</span>&#x000A;<span class="Keyword">&lt;</span>/ul<span class="Keyword">&gt;</span>&#x000A;</pre>\n            <div class="notes">\n                You can use the <code>this</code> expression in any context to reference\n              the current context.\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                You can optionally provide an <code>&#123;&#123;else&#125;&#125;</code> section which will display only when the list is empty.\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each paragraphs&#125;&#125;</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">p</span><span class="MetaTagAll">&gt;</span></span><span class="EmbeddedSourceBright">&#123;&#123;this&#125;&#125;</span><span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">p</span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;else&#125;&#125;</span>&#x000A;  <span class="MetaTagAll"><span class="MetaTagAll">&lt;</span><span class="MetaTagAll">p</span> <span class="MetaTagAll">class</span>=<span class="String"><span class="String">&quot;</span>empty<span class="String">&quot;</span></span><span class="MetaTagAll">&gt;</span></span>No content<span class="MetaTagAll"><span class="MetaTagAll">&lt;/</span><span class="MetaTagAll">p</span><span class="MetaTagAll">&gt;</span></span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                When looping through items in <code>each</code>, you can optionally reference the current loop index via <code>&#123;&#123;@index&#125;&#125;</code>\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each array&#125;&#125;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;@index&#125;&#125;</span>: <span class="EmbeddedSourceBright">&#123;&#123;this&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                Additionally for object iteration, <code>&#123;&#123;@key&#125;&#125;</code> references the current key name:\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each object&#125;&#125;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;@key&#125;&#125;</span>: <span class="EmbeddedSourceBright">&#123;&#123;this&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                The first and last steps of iteration are noted via the <code>@first</code> and <code>@last</code>\n                variables when iterating over an array. When iterating over an object only the <code>@first</code>\n                is available.\n            </div>\n            <div class="notes">\n                Nested <code>each</code> blocks may access the interation variables via depth based paths.\n              To access the parent index, for example, <code>&#123;&#123;@../index&#125;&#125;</code> can be used.\n            </div>\n        </div>\n        <div class="bullet">\n            <div class="description">\n                The <code>each</code> helper also supports <a href="block_helpers.html#block-params">block parameters</a>, allowing for named references anywhere in the block.\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each array as |value key|&#125;&#125;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;#each child as |childValue childKey|&#125;&#125;</span>&#x000A;    <span class="EmbeddedSourceBright">&#123;&#123;key&#125;&#125;</span> - <span class="EmbeddedSourceBright">&#123;&#123;childKey&#125;&#125;</span>. <span class="EmbeddedSourceBright">&#123;&#123;childValue&#125;&#125;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                Will create a <code>key</code> and <code>value</code> variable that children may access without the need for depthed variable references. In the example above, <code>&#123;&#123;key&#125;&#125;</code> is identical to <code>&#123;&#123;@../key&#125;&#125;</code> but in many cases is more readable.\n            </div>\n        </div>\n    </div>\n    <h2 id="lookup">The <code>lookup</code> helper\n    </h2>\n    <div class="contents">\n        <div class="bullet">\n            <div class="description">\n                The <code>lookup</code> helper allows for dynamic parameter resolution using Handlebars\n              variables. This is useful for resolving values for array indexes.\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;#each bar&#125;&#125;</span>&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;lookup ../foo @index&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;/each&#125;&#125;</span>&#x000A;</pre>\n        </div>\n    </div>\n    <h2 id="log">The <code>log</code> block helper\n    </h2>\n    <div class="contents">\n        <div class="bullet">\n            <div class="description">\n                The <code>log</code> helper allows for logging of context state while executing\n              a template.\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;log &quot;Look at me!&quot;&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                Delegates to <code>Handlebars.logger.log</code> which may\n              be overriden to perform custom logging.\n            </div>\n            <div class="notes">\n                Any number of arguments may be passed to this method and all will be forwarded to the logger.\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;log &quot;This is logged&quot; foo &quot;And so is this&quot;&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                The log level may be set using the <code>level</code> hash parameter. Supported values are <code>debug</code>, <code>info</code>, <code>warn</code>, and <code>error</code>. When omitted, <code>info</code> is the default value,\n            </div>\n            <pre class="sunburst"><span class="EmbeddedSourceBright">&#123;&#123;log &quot;Log!&quot; level=&quot;error&quot;&#125;&#125;</span>&#x000A;</pre>\n            <div class="notes">\n                Logging is conditional based on the level and to value set in <code>Handlebars.logger.level</code>, which defaults to <code>info</code>. All log statements at or above the current level will be output.\n            </div>\n        </div>\n    </div>\n    \n    <h2 id="escaping">Escaping\n    </h2>\n    <div class="contents">\n        <div class="bullet">\n            <div class="description">\n                Handlebars content may be escaped in one of two ways, inline escapes or raw block helpers.\n                Inline escapes created by prefixing a mustache block with <code>\\</code>. Raw blocks are\n                created using <code>&#123;&#123;&#123;&#123;</code> mustache braces.\n            </div>\n            <pre class="sunburst">\\<span class="EmbeddedSourceBright">&#123;&#123;escaped&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;&#123;&#123;raw&#125;&#125;</span>&#125;&#125;&#x000A;  <span class="EmbeddedSourceBright">&#123;&#123;escaped&#125;&#125;</span>&#x000A;<span class="EmbeddedSourceBright">&#123;&#123;&#123;&#123;/raw&#125;&#125;</span>&#125;&#125;&#x000A;</pre>\n            <div class="notes">\n                Raw blocks operate in the same manner as other <a href="/block_helpers.html">block helpers</a>\n                with the distinction of the child content is treated as a literal string.\n            </div>\n        </div>\n    </div>\n    <h2>More...\n    </h2>\n    <div class="contents">\n        More information can be found on the Handlerbars website <a href="http://http://handlebarsjs.com">here</a>.\n    </div>\n</div>\n'},useData:!0}),e.IconDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="search">\n    <input name="q" type="text" size="40" placeholder="Search Icons..." >\n    <i class="fa fa-fw fa-search"></i>\n</div>\n<div class="grid"></div>\n'},useData:!0}),e.IconDialogItem=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<a title="'+c(typeof(a=null!=(a=e(i,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:10},end:{line:1,column:18}}}):a)+'"><i class="gridItem '+c(typeof(a=null!=(a=e(i,"type")||(null!=t?e(t,"type"):t))?a:l)==r?a.call(s,{name:"type",hash:{},data:o,loc:{start:{line:1,column:39},end:{line:1,column:47}}}):a)+" "+c(typeof(a=null!=(a=e(i,"subtype")||(null!=t?e(t,"subtype"):t))?a:l)==r?a.call(s,{name:"subtype",hash:{},data:o,loc:{start:{line:1,column:48},end:{line:1,column:59}}}):a)+" "+c(typeof(a=null!=(a=e(i,"type")||(null!=t?e(t,"type"):t))?a:l)==r?a.call(s,{name:"type",hash:{},data:o,loc:{start:{line:1,column:60},end:{line:1,column:68}}}):a)+"-"+c(typeof(a=null!=(a=e(i,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:69},end:{line:1,column:77}}}):a)+'"></i><div class="gridItemName">'+c(typeof(a=null!=(a=e(i,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:109},end:{line:1,column:117}}}):a)+"</div></a>"},useData:!0}),e.IconDialogItemMD=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<a title="'+c(typeof(a=null!=(a=e(i,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:10},end:{line:1,column:18}}}):a)+'"><i class="gridItem fa fa-fw '+c(typeof(a=null!=(a=e(i,"type")||(null!=t?e(t,"type"):t))?a:l)==r?a.call(s,{name:"type",hash:{},data:o,loc:{start:{line:1,column:48},end:{line:1,column:56}}}):a)+"-"+c(typeof(a=null!=(a=e(i,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:57},end:{line:1,column:65}}}):a)+' \'"></i><div class="gridItemName">'+c(typeof(a=null!=(a=e(i,"icon")||(null!=t?e(t,"icon"):t))?a:l)==r?a.call(s,{name:"icon",hash:{},data:o,loc:{start:{line:1,column:99},end:{line:1,column:107}}}):a)+"</div></a>"},useData:!0}),e.JsonDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="json-editor" spellcheck="false"></div>\n'},useData:!0}),e.LoadingScreen=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="loading" style="display: table; width: 100%; height: 100%; opacity: 0.9; pointer-events: none;">\n    <div style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center;">\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="64" height="64" fill="#D2D2D2">\n            <circle cx="16" cy="3" r="0">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" ></animate>\n            </circle>\n            <circle transform="rotate(45 16 16)" cx="16" cy="3" r="0">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.125s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" ></animate>\n            </circle>\n            <circle transform="rotate(90 16 16)" cx="16" cy="3" r="0">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.25s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" ></animate>\n            </circle>\n            <circle transform="rotate(135 16 16)" cx="16" cy="3" r="0.567031">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.375s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" ></animate>\n            </circle>\n            <circle transform="rotate(180 16 16)" cx="16" cy="3" r="1.82452">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" ></animate>\n            </circle>\n            <circle transform="rotate(225 16 16)" cx="16" cy="3" r="2.88475">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.625s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" ></animate>\n            </circle>\n            <circle transform="rotate(270 16 16)" cx="16" cy="3" r="2.1029">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.75s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" ></animate>\n            </circle>\n            <circle transform="rotate(315 16 16)" cx="16" cy="3" r="0.60761">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.875s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" ></animate>\n            </circle>\n            <circle transform="rotate(180 16 16)" cx="16" cy="3" r="1.82452">\n                <animate attributeName="r" values="0;3;0;0" dur="1s" repeatCount="indefinite" begin="0.5s" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" ></animate>\n            </circle>\n        </svg>\n        <div style="color: #D2D2D2; font-weight: bold; margin-top: 7px; font-size: 11px; letter-spacing: 1px;">\n            '+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"text")||(null!=t?a(t,"text"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"text",hash:{},data:o,loc:{start:{line:33,column:12},end:{line:33,column:20}}}):i)+"\n        </div>\n    </div>\n</div>"},useData:!0}),e.LoginHistoryDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="grid-div">\n</div>'},useData:!0}),e.MainToolbar=Handlebars.template({1:function(e,t,i,n,o){return'<a class="toolbar-toggler"></a>\n'},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="dash-main-menu">\n    <button class="main-menu-btn ui-button ui-corner-all ui-widget ui-button-icon-only" aria-label="Main Menu">\n        <span class="ui-button-icon ui-icon fa fa-bars"></span> \n    </button>\n</div>\n\n<div class="logo"></div>\n\n<div class="document-selector" style="display: inline-block"></div>\n\n<div class="main">\n    <a tabindex="0" class="new-dash">'+l((r(i,"t")||t&&r(t,"t")||s).call(a,"New Dashboard",{name:"t",hash:{},data:o,loc:{start:{line:12,column:37},end:{line:12,column:58}}}))+'</a><a\n        tabindex="0"\n        class="save-dash"\n        >'+l((r(i,"t")||t&&r(t,"t")||s).call(a,"Save Dashboard",{name:"t",hash:{},data:o,loc:{start:{line:15,column:9},end:{line:15,column:31}}}))+'</a\n    ><a tabindex="0" class="undo-action" title="Undo Action">'+l((r(i,"t")||t&&r(t,"t")||s).call(a,"Undo Action",{name:"t",hash:{},data:o,loc:{start:{line:16,column:71},end:{line:16,column:90}}}))+'</a><a tabindex="0" class="redo-action" title="Redo Action">'+l((r(i,"t")||t&&r(t,"t")||s).call(a,"Redo Action",{name:"t",hash:{},data:o,loc:{start:{line:17,column:64},end:{line:17,column:83}}}))+'</a><a\n        tabindex="0"\n        class="print-dash"\n        data-cy="insights-print-pdf-button"\n        title="Generate PDF document"\n        >'+l((r(i,"t")||t&&r(t,"t")||s).call(a,"Generate PDF document",{name:"t",hash:{},data:o,loc:{start:{line:22,column:9},end:{line:22,column:38}}}))+'</a\n    >\n</div>\n\n<div class="content-toggle">\n    <input tabindex="0" type="checkbox" id="checkbtn" class="ui-helper-hidden-accessible" /><label\n        for="checkbtn"\n        title="'+l((r(i,"t")||t&&r(t,"t")||s).call(a,"Toggle Design/Preview View",{name:"t",hash:{},data:o,loc:{start:{line:29,column:15},end:{line:29,column:49}}}))+'"\n    >\n        <span class="design"><i class="fa fa-fw fa-pencil-square-o"></i>'+l((r(i,"t")||t&&r(t,"t")||s).call(a,"Design",{name:"t",hash:{},data:o,loc:{start:{line:31,column:72},end:{line:31,column:86}}}))+'</span>\n        <span class="preview"><i class="fa fa-fw fa-desktop"></i>'+l((r(i,"t")||t&&r(t,"t")||s).call(a,"Preview",{name:"t",hash:{},data:o,loc:{start:{line:32,column:65},end:{line:32,column:80}}}))+'</span>\n    </label>\n</div>\n\n<div class="connectionStatus"></div>\n\n<div class="profile">\n    <button>\n        <i class="fa fa-fw fa-user"></i>\n        <span class="user-name-wrap">\n            <span class="user-name"></span>\n        </span>\n    </button>\n\n    <div class="profile-menu"></div>\n</div>\n'+(null!=(l=r(i,"if").call(a,null!=t?r(t,"hideToolbar"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:48,column:0},end:{line:50,column:7}}}))?l:"")},useData:!0}),e.ManageDashWindow=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="manage-documents-toolbar">\n    <button class="open">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"open",{name:"t",hash:{},data:o,loc:{start:{line:2,column:25},end:{line:2,column:37}}}))+'</button>\n    <button class="view"> '+l((e(i,"t")||t&&e(t,"t")||s).call(a,"view on web",{name:"t",hash:{},data:o,loc:{start:{line:3,column:26},end:{line:3,column:45}}}))+'</button>\n    <button class="delete">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"delete",{name:"t",hash:{},data:o,loc:{start:{line:4,column:27},end:{line:4,column:41}}}))+'</button>\n    <button class="export" title="'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Export",{name:"t",hash:{},data:o,loc:{start:{line:5,column:34},end:{line:5,column:48}}}))+'">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"export",{name:"t",hash:{},data:o,loc:{start:{line:5,column:50},end:{line:5,column:64}}}))+'</button>\n    <input type="file" id="dashImportFile" name="files" accept=".json,application/xml" style="display: none;" multiple >\n    <button class="import">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Import",{name:"t",hash:{},data:o,loc:{start:{line:7,column:27},end:{line:7,column:41}}}))+'</button>\n    <div class="search-box">\n        <i class="fa fa-search"></i>\n        <input class="search-input">\n        <span class="clearSearch fa fa-times" style="display: none"></span>\n    </div>\n</div>\n\n<div class="dash-list-headers">\n\n    <span class="name-sort" style="margin-left: 11px;">\n        '+l((e(i,"t")||t&&e(t,"t")||s).call(a,"name",{name:"t",hash:{},data:o,loc:{start:{line:18,column:8},end:{line:18,column:20}}}))+'\n        <i class="fa fa-caret-down"></i>\n        <i class="fa fa-caret-up"></i>\n    </span>\n\n    <span class="last-modified-sort" style="float: right; margin-right: 31px;">\n        '+l((e(i,"t")||t&&e(t,"t")||s).call(a,"last modified",{name:"t",hash:{},data:o,loc:{start:{line:24,column:8},end:{line:24,column:29}}}))+'\n        <i class="fa fa-caret-down"></i>\n        <i class="fa fa-caret-up"></i>\n    </span>\n</div>\n\n<div class="content-container">\n    <div class="dashboards-list">\n\n    </div>\n</div>'},useData:!0}),e.MenuLayoutCheckbox=Handlebars.template({1:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <label><input type="checkbox" name="'+c(typeof(a=null!=(a=e(i,"title")||(null!=t?e(t,"title"):t))?a:l)==r?a.call(s,{name:"title",hash:{},data:o,loc:{start:{line:2,column:40},end:{line:2,column:49}}}):a)+'" class="GENERATED->'+c(typeof(a=null!=(a=e(i,"class")||(null!=t?e(t,"class"):t))?a:l)==r?a.call(s,{name:"class",hash:{},data:o,loc:{start:{line:2,column:69},end:{line:2,column:78}}}):a)+'" '+c(typeof(a=null!=(a=e(i,"checked")||(null!=t?e(t,"checked"):t))?a:l)==r?a.call(s,{name:"checked",hash:{},data:o,loc:{start:{line:2,column:80},end:{line:2,column:91}}}):a)+">"+c(typeof(a=null!=(a=e(i,"description")||(null!=t?e(t,"description"):t))?a:l)==r?a.call(s,{name:"description",hash:{},data:o,loc:{start:{line:2,column:92},end:{line:2,column:107}}}):a)+"</label>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(i=a(i,"each").call(null!=t?t:e.nullContext||{},null!=t?a(t,"checkboxes"):t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:3,column:9}}}))?i:""},useData:!0}),e.MenuLayoutItem=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div id="'+c(typeof(a=null!=(a=e(i,"id")||(null!=t?e(t,"id"):t))?a:l)==r?a.call(s,{name:"id",hash:{},data:o,loc:{start:{line:1,column:9},end:{line:1,column:15}}}):a)+'" class="ui-widget-content">\n    <div class="label">'+c(typeof(a=null!=(a=e(i,"label")||(null!=t?e(t,"label"):t))?a:l)==r?a.call(s,{name:"label",hash:{},data:o,loc:{start:{line:2,column:23},end:{line:2,column:32}}}):a)+'</div>\n    <img src="'+c(typeof(a=null!=(a=e(i,"image")||(null!=t?e(t,"image"):t))?a:l)==r?a.call(s,{name:"image",hash:{},data:o,loc:{start:{line:3,column:14},end:{line:3,column:23}}}):a)+'" style="width: 100%">\n    <div class="description">'+c(typeof(a=null!=(a=e(i,"description")||(null!=t?e(t,"description"):t))?a:l)==r?a.call(s,{name:"description",hash:{},data:o,loc:{start:{line:4,column:29},end:{line:4,column:44}}}):a)+"</div>\n</div>"},useData:!0}),e.MenuLayoutList=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="ui-widget-header title">'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"text")||(null!=t?a(t,"text"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"text",hash:{},data:o,loc:{start:{line:1,column:36},end:{line:1,column:44}}}):i)+'</div>\n<div class="ui-widget-content presets"></div>\n<div class="ui-widget-content checkboxes"></div>'},useData:!0}),e.MessageDialog=Handlebars.template({1:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<label><input type="checkbox" >'+e.escapeExpression("function"==typeof(i=null!=(i=a(i,"check")||(null!=t?a(t,"check"):t))?i:e.hooks.helperMissing)?i.call(null!=t?t:e.nullContext||{},{name:"check",hash:{},data:o,loc:{start:{line:3,column:31},end:{line:3,column:40}}}):i)+"</label>\n"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="msg">'+(null!=(a="function"==typeof(a=null!=(a=l(i,"message")||(null!=t?l(t,"message"):t))?a:e.hooks.helperMissing)?a.call(s,{name:"message",hash:{},data:o,loc:{start:{line:1,column:17},end:{line:1,column:30}}}):a)?a:"")+"</div>\n"+(null!=(a=l(i,"if").call(s,null!=t?l(t,"check"):t,{name:"if",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:2,column:0},end:{line:4,column:7}}}))?a:"")},useData:!0}),e.Notificator=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="panel ui-widget-content">\n    <div class="title"></div>\n    <div class="items"></div>\n    <button class="close-button">\n        Close\n    </button>\n</div>'},useData:!0}),e.PropertiesPanel=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="panel-header">\n    <span class="propertySearch">\n        <i class="searchIcon fa fa-search"></i>\n        <input class="searchInput" placeholder="search properties..." />\n    </span>\n    <i\n        class="fa fa-question-circle dashboardHelp panel-prop-btn"\n        title="Component Help / Documentation"\n        tabindex="0"\n        aria-label="Component Help / Documentation"\n    ></i>\n    <i\n        class="fa fa-fw watermark fa-database btn-datasource panel-prop-btn"\n        title="Data Dialog"\n        tabindex="0"\n        aria-label="Data Dialog"\n    ></i>\n    <i\n        class="fa fa-fw watermark fa-eye btn-viewstate panel-prop-btn"\n        title="View State Dialog"\n        tabindex="0"\n        aria-label="View State Dialog"\n    ></i>\n    <i\n        class="fa fa-fw watermark fa-sitemap btn-document-graph panel-prop-btn"\n        title="Document Graph"\n        tabindex="0"\n        aria-label="Document Graph"\n    ></i>\n    \n    <div\n        class="pin-button"\n        title="Expand/Collapse Properties"\n        tabindex="0"\n        aria-label="Expand/Collapse Properties"\n    >\n        <i class="fa fa-caret-right"></i><i class="fa fa-caret-right"></i>\n    </div>\n    <span class="lblWidgetName">'+e.escapeExpression((a(i,"t")||t&&a(t,"t")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"dashboard",{name:"t",hash:{},data:o,loc:{start:{line:39,column:32},end:{line:39,column:49}}}))+'</span>\n</div>\n<div class="panel-document"></div>\n<div class="panel-content"></div>\n\n<div class="expand-button">\n    <div class="header">\n        properties\n    </div>\n</div>\n'},useData:!0}),e.PropertiesPanelContent=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="tabs">\n  <ul>\n    <li><a href="#tabs-1">Nunc tincidunt</a></li>\n    <li><a href="#tabs-2">Proin dolor</a></li>\n    <li><a href="#tabs-3">Aenean lacinia</a></li>\n  </ul>\n  <div id="tabs-1">\n    <p>Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris. Nam elementum quam ullamcorper ante. Etiam aliquet massa et lorem. Mauris dapibus lacus auctor risus. Aenean tempor ullamcorper leo. Vivamus sed magna quis ligula eleifend adipiscing. Duis orci. Aliquam sodales tortor vitae ipsum. Aliquam nulla. Duis aliquam molestie erat. Ut et mauris vel pede varius sollicitudin. Sed ut dolor nec orci tincidunt interdum. Phasellus ipsum. Nunc tristique tempus lectus.</p>\n  </div>\n  <div id="tabs-2">\n    <p>Morbi tincidunt, dui sit amet facilisis feugiat, odio metus gravida ante, ut pharetra massa metus id nunc. Duis scelerisque molestie turpis. Sed fringilla, massa eget luctus malesuada, metus eros molestie lectus, ut tempus eros massa ut dolor. Aenean aliquet fringilla sem. Suspendisse sed ligula in ligula suscipit aliquam. Praesent in eros vestibulum mi adipiscing adipiscing. Morbi facilisis. Curabitur ornare consequat nunc. Aenean vel metus. Ut posuere viverra nulla. Aliquam erat volutpat. Pellentesque convallis. Maecenas feugiat, tellus pellentesque pretium posuere, felis lorem euismod felis, eu ornare leo nisi vel felis. Mauris consectetur tortor et purus.</p>\n  </div>\n  <div id="tabs-3">\n    <p>Mauris eleifend est et turpis. Duis id erat. Suspendisse potenti. Aliquam vulputate, pede vel vehicula accumsan, mi neque rutrum erat, eu congue orci lorem eget lorem. Vestibulum non ante. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Fusce sodales. Quisque eu urna vel enim commodo pellentesque. Praesent eu risus hendrerit ligula tempus pretium. Curabitur lorem enim, pretium nec, feugiat nec, luctus a, lacus.</p>\n    <p>Duis cursus. Maecenas ligula eros, blandit nec, pharetra at, semper at, magna. Nullam ac lacus. Nulla facilisi. Praesent viverra justo vitae neque. Praesent blandit adipiscing velit. Suspendisse potenti. Donec mattis, pede vel pharetra blandit, magna ligula faucibus eros, id euismod lacus dolor eget odio. Nam scelerisque. Donec non libero sed nulla mattis commodo. Ut sagittis. Donec nisi lectus, feugiat porttitor, tempor ac, tempor vitae, pede. Aenean vehicula velit eu tellus interdum rutrum. Maecenas commodo. Pellentesque nec elit. Fusce in lacus. Vivamus a libero vitae lectus hendrerit hendrerit.</p>\n  </div>\n</div>'},useData:!0}),e.PropertiesPanelDocument=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="document-properties">\n    <div class="property-editor"></div>\n</div>\n\n<span tabindex="0" class="documentGraphBtn">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Document Graph",{name:"t",hash:{},data:o,loc:{start:{line:5,column:44},end:{line:5,column:66}}}))+'</span>\n<span tabindex="0" class="connectionMgmtBtn">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Connections",{name:"t",hash:{},data:o,loc:{start:{line:6,column:45},end:{line:6,column:64}}}))+"</span>\n"},useData:!0}),e.RichTextEditorDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="toolbar ui-widget-header ui-corner-all" id="htmlxEdit">\n</div>\n<div class="editor" style="background:'+c(typeof(a=null!=(a=e(i,"background")||(null!=t?e(t,"background"):t))?a:l)==r?a.call(s,{name:"background",hash:{},data:o,loc:{start:{line:3,column:38},end:{line:3,column:52}}}):a)+'">\n    <textarea id="'+c(typeof(a=null!=(a=e(i,"uid")||(null!=t?e(t,"uid"):t))?a:l)==r?a.call(s,{name:"uid",hash:{},data:o,loc:{start:{line:4,column:18},end:{line:4,column:25}}}):a)+'"></textarea>\n</div>\n<div class="code" style="display: none">\n</div>\n'},useData:!0}),e.ScreenItem=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div style="display: table; width: 100%; height: 100%;">\n    <div style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center;">\n\n        <div class="screen-thumb-wrapper" tabindex="0" aria-label="Screen, '+c(typeof(a=null!=(a=e(i,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:4,column:75},end:{line:4,column:83}}}):a)+'">\n            <img class="screen-thumb" src="'+c(typeof(a=null!=(a=e(i,"thumb")||(null!=t?e(t,"thumb"):t))?a:l)==r?a.call(s,{name:"thumb",hash:{},data:o,loc:{start:{line:5,column:43},end:{line:5,column:52}}}):a)+'"></img>\n            <div class="default-thumb">\n                <div style="display: table; width: 100%; height: 100%;">\n                    <div style="display: table-cell; width: 100%; height: 100%; vertical-align: middle; text-align: center;">\n                        <i class="fa fa-pencil-square-o"></i>\n                    </div>\n                </div>\n            </div>\n            <div class="remove-screen-btn" title="'+c((e(i,"t")||t&&e(t,"t")||l).call(s,"Remove Screen",{name:"t",hash:{},data:o,loc:{start:{line:13,column:50},end:{line:13,column:72}}}))+'"  aria-label="Remove Screen">\n                <i class="fa fa-times"></i>\n            </div>\n\n            <div class="make-default-screen-btn" title="'+c((e(i,"t")||t&&e(t,"t")||l).call(s,"Make Default Screen",{name:"t",hash:{},data:o,loc:{start:{line:17,column:56},end:{line:17,column:84}}}))+'"  aria-label="Make Default Screen">\n                <i class="fa fa-star"></i>\n            </div>\n            <div class="duplicate-screen-btn" title="'+c((e(i,"t")||t&&e(t,"t")||l).call(s,"Duplicate Screen",{name:"t",hash:{},data:o,loc:{start:{line:20,column:53},end:{line:20,column:78}}}))+'" aria-label="Duplicate Screen">\n                <i class="fa fa-copy"></i>\n            </div>\n\n            <a class="camera" title="'+c((e(i,"t")||t&&e(t,"t")||l).call(s,null!=t?e(t,"Take"):t,null!=t?e(t,"Screenshot"):t,{name:"t",hash:{},data:o,loc:{start:{line:24,column:37},end:{line:24,column:58}}}))+'">\n                <i class="fa fa-camera" aria-label="Take Screenshot"></i>\n            </a>\n        </div>\n\n        <div class="screen-name">\n            '+c(typeof(a=null!=(a=e(i,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:30,column:12},end:{line:30,column:20}}}):a)+"\n        </div>\n\n    </div>\n</div>"},useData:!0}),e.ScreenList=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="screen-list">\n    \x3c!--<div class="screen-list-header">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Screens",{name:"t",hash:{},data:o,loc:{start:{line:2,column:40},end:{line:2,column:55}}}))+'</div>--\x3e\n\n    <div class="list-scroll-wrap">\n        <ul></ul>\n    </div>\n\n    <div style="text-align: right;">\n        <div class="add-screen-button" tabindex="0">\n            '+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Add Screen",{name:"t",hash:{},data:o,loc:{start:{line:10,column:12},end:{line:10,column:31}}}))+"\n        </div>\n    </div>\n</div>\n"},useData:!0}),e.SubscriptionSelect=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<fieldset>\n    <span>\n        <label>Subscription:</label> \n        <label class="staticRadio"><input type="radio" name="_subscriptionType" class="static" value="static" checked>'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Static",{name:"t",hash:{},data:o,loc:{start:{line:4,column:118},end:{line:4,column:132}}}))+'</label>\n        <label class="subscriptionRadio"><input type="radio" name="_subscriptionType" class="subscription" value="subscription">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Managed",{name:"t",hash:{},data:o,loc:{start:{line:5,column:128},end:{line:5,column:143}}}))+'</label>\n        <label class="streamingRadio"><input type="radio" name="_subscriptionType" class="streaming" value="streaming">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Streaming",{name:"t",hash:{},data:o,loc:{start:{line:6,column:119},end:{line:6,column:136}}}))+'</label>\n        <label class="pollingRadio"><input type="radio" name="_subscriptionType" class="polling" value="polling">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Polling",{name:"t",hash:{},data:o,loc:{start:{line:7,column:113},end:{line:7,column:128}}}))+'</label>\n        <label class="auto-execute-label" title="Auto-execute on parameter changes. For query mappers, also execute when loading the dashboard."><input class="auto-execute" type="checkbox">Auto-execute</label>\n        <span class="subscriptionParamInput"><input name="_forceReset" class="_forceReset" type="checkbox" >Force Reset</span>\n    </span>\n    <div>\n        <span class="subscriptionParamInput">Interval: <span class="subscriptionIntervalContainer bbf-editor"></span>s</span>\n        <span class="subscriptionParamInput">Key: <select name="_subscriptionKey" class="subscriptionKey"></select></span>\n        \n    </div>\n    <div class="legend-right">\n        <label class="server-paging" title="'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Page and sort results on the server",{name:"t",hash:{},data:o,loc:{start:{line:17,column:44},end:{line:17,column:87}}}))+'">\n            <input type="checkbox" name="_serverPaging" >'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Paged",{name:"t",hash:{},data:o,loc:{start:{line:18,column:57},end:{line:18,column:70}}}))+'\n        </label>\n        <label class="max-rows" title="'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Specify the maximum number of rows returned",{name:"t",hash:{},data:o,loc:{start:{line:20,column:39},end:{line:20,column:90}}}))+'">\n            Max rows:\n            <input name="_maxRows" class="_maxRows" type="number" min="0" max="10000" step="1" value="2000" >\n        </label>\n        <label class="page-size" title="'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Specify the number of rows per page",{name:"t",hash:{},data:o,loc:{start:{line:24,column:40},end:{line:24,column:83}}}))+'">\n            Page size:\n            <input name="_pageSize" class="_pageSize" type="number" min="0" max="10000" step="1" value="2000" >\n        </label>\n    </div>\n</fieldset>'},useData:!0}),e.TemplateDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="sidebar">\n    <div class="topnav">\n        <i class=\'fa fa-search\'></i>\n        <input type=\'text\' class=\'searchBox\' placeholder="Search ..." >\n        <span class="clearSearch fa fa-times" style="display: none"></span>\n    </div>\n    <div class="tree"></div>\n</div>\n<div class="template-editor">\n    <div class="toolbar ui-widget-header ui-corner-right" id="htmlxEdit">\n    </div>\n    <div class="toolbar ui-widget-header ui-corner-right" id="advanced-toolbar" style="display: none;">\n        <button class="basic-mode" title="Return to Basic editor">Basic mode</button>\n        <select class="gok-handlebarselect"></select>\n        <button class="add-helper" title="Add element">Add Helper</button>\n        <button class="beautify" title="Automatically format code with indents and line breaks">Auto-format</button>\n    </div>\n    <div class="editor" style="background:'+c(typeof(a=null!=(a=e(i,"background")||(null!=t?e(t,"background"):t))?a:l)==r?a.call(s,{name:"background",hash:{},data:o,loc:{start:{line:18,column:42},end:{line:18,column:56}}}):a)+'">\n        <textarea id="'+c(typeof(a=null!=(a=e(i,"uid")||(null!=t?e(t,"uid"):t))?a:l)==r?a.call(s,{name:"uid",hash:{},data:o,loc:{start:{line:19,column:22},end:{line:19,column:29}}}):a)+'"></textarea>\n    </div>\n    <div class="code" style="display: none"></div>\n    <div class="handlebar-errors" style="display:none">\n        <span><i class="fa fa-exclamation-triangle"></i> Template error:</span>\n        <div></div>\n    </div>\n</div>'},useData:!0}),e.TestingPage=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="close-box">\n    <a class="close" tabindex="0" aria-label="Close Document Graph"><i class="fa fa-close"></i></a>\n</div>\n'},useData:!0}),e.TooltipTemplateDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="toolbar ui-widget-header ui-corner-all" >\n    <table>\n        <tr>\n            <td><i class="fa fa-question-circle"></i></td>\n            <td style="padding: 0px 5px 0 25px;">\n                Value:\n            </td>\n            <td> <select class="tp-selectable js-example-basic-single"></select></td>\n\n            <td style="padding: 0px 5px 0 25px;">\n                Type:\n            </td>\n            <td>  \n                <div class="typeOfHandle">\n                 <input type="radio" id="div" checked="checked"><label for="div"><i class="fa fa-align-justify"></i></label>\n                 <input type="radio" id="li"><label for="li"><i class="fa fa-list-ul"></i></label>\n                 <input type="radio" id="td"><label for="td"><i class="fa fa-th-list"></i></label>\n                 <input type="radio" id="img"><label for="img"><i class="fa fa-picture-o"></i></label>\n                </div>\n            </td>\n            <td style="padding: 0px 5px 0 25px;">\n                Colour:\n            </td>\n            <td>\n                <label class="handlebar-colorPicker-tooltip" title="Pick Colour">\n                 <div class="handlebar-colorPicker">\n                        <i class="fa fa-square" style="color:#000000"></i>\n                 </div>\n                </label>\n            </td>\n            <td>\n                <label class="tp-selectable-add-tooltip" title="Add element">\n                    <div class="tp-selectable-add">\n                        <i class="fa fa-plus"></i>\n                    </div>\n                </label>\n            </td>\n        </tr>\n    </table>\n</div>\n<div class="code">\n    <textarea></textarea>\n</div>\n'},useData:!0}),e.TreeView=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="toolbar ui-widget-header ui-corner-all">\n    <button class="new">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"New",{name:"t",hash:{},data:o,loc:{start:{line:2,column:24},end:{line:2,column:35}}}))+'</button>\n    <button class="rename">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Rename",{name:"t",hash:{},data:o,loc:{start:{line:3,column:27},end:{line:3,column:41}}}))+'</button>\n    <button class="delete">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Delete",{name:"t",hash:{},data:o,loc:{start:{line:4,column:27},end:{line:4,column:41}}}))+'</button>\n    <button class="clean-up">'+l((e(i,"t")||t&&e(t,"t")||s).call(a,"Clean Up",{name:"t",hash:{},data:o,loc:{start:{line:5,column:29},end:{line:5,column:45}}}))+'</button>\n    <div>\n        <i class="fa fa-search"></i>\n        <input class="search" >\n        <span class="clearSearch fa fa-times" style="display: none"></span>\n    </div>\n</div>\n<div class="tree"></div>\n'},useData:!0}),e.ViewStateDialog=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="tree"></div>\n<div class="details-panel">\n    <div class="accordian-container">\n        <div class="viewstate-editor collapsible" >\n            <h3 class="ui-widget-header"><i class="fa fa-fw fa-caret-down"></i>Properties</h3>\n            <div class="content properties">\n            </div>\n        </div>\n        <div class="viewstate-graph collapsible" >\n            <h3 class="ui-widget-header"><i class="fa fa-fw fa-caret-down"></i>Graph</h3>\n            <div class="content graph">\n            </div>\n        </div>\n    </div>\n</div>'},useData:!0}),e.VirtualParameter=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,r="function",c=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="form-control">\n    \n    <label class="col1">'+c(typeof(a=null!=(a=e(i,"name")||(null!=t?e(t,"name"):t))?a:l)==r?a.call(s,{name:"name",hash:{},data:o,loc:{start:{line:3,column:24},end:{line:3,column:32}}}):a)+'</label>\n\n\t<div class="type-radio col2 btn-no-borders">\n        <input id="'+c(typeof(a=null!=(a=e(i,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:6,column:19},end:{line:6,column:31}}}):a)+'_datasource" type="radio" name="'+c(typeof(a=null!=(a=e(i,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:6,column:63},end:{line:6,column:75}}}):a)+'_parameter-type" value="datasource">\n        <label for="'+c(typeof(a=null!=(a=e(i,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:7,column:20},end:{line:7,column:32}}}):a)+'_datasource">Data Source</label>\n        \n        <input id="'+c(typeof(a=null!=(a=e(i,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:9,column:19},end:{line:9,column:31}}}):a)+'_viewstate" type="radio" name="'+c(typeof(a=null!=(a=e(i,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:9,column:62},end:{line:9,column:74}}}):a)+'_parameter-type" value="viewstate">\n        <label for="'+c(typeof(a=null!=(a=e(i,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:10,column:20},end:{line:10,column:32}}}):a)+'_viewstate">View State</label>\n\n        <input id="'+c(typeof(a=null!=(a=e(i,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:12,column:19},end:{line:12,column:31}}}):a)+'_text" type="radio" name="'+c(typeof(a=null!=(a=e(i,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:12,column:57},end:{line:12,column:69}}}):a)+'_parameter-type" value="text">\n        <label for="'+c(typeof(a=null!=(a=e(i,"uniqueId")||(null!=t?e(t,"uniqueId"):t))?a:l)==r?a.call(s,{name:"uniqueId",hash:{},data:o,loc:{start:{line:13,column:20},end:{line:13,column:32}}}):a)+'_text">Text</label>\n\t</div>\n\n\t<div class="input-div col3">\n\n\t\t<input class="value-input" type="text" value="'+c(typeof(a=null!=(a=e(i,"value")||(null!=t?e(t,"value"):t))?a:l)==r?a.call(s,{name:"value",hash:{},data:o,loc:{start:{line:18,column:48},end:{line:18,column:57}}}):a)+'" >\n\n\t\t<div class="binding-container">\n\t\t\t<i class="fa fa-fw watermark fa-eraser clear-binding"></i>\n            <i class="fa fa-fw watermark fa-database binding-icon"></i>\n\t\t\t<input class="value-display data-parameter-editor" type="text" value="'+c(typeof(a=null!=(a=e(i,"value")||(null!=t?e(t,"value"):t))?a:l)==r?a.call(s,{name:"value",hash:{},data:o,loc:{start:{line:23,column:73},end:{line:23,column:82}}}):a)+'" tabindex="-1" readonly />\n\t\t\t<label class="label-rolling virtual-parameter">\n\t\t\t\t<input class="checkbox-rolling" type="checkbox"/>Use Rolling Syntax\n\t\t\t</label>\n\t\t</div>\n\n\t</div>\n\n</div>'},useData:!0}),e.VirtualQuerySample=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a,s,l=null!=t?t:e.nullContext||{},r=e.hooks.helperMissing,c="function",e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"function (source, callback) {\n\n    // source is an object representing a data source, with the following properties:\n    // columns: an array of column names, for example,\n    // "+(null!=(a=typeof(s=null!=(s=e(i,"columns")||(null!=t?e(t,"columns"):t))?s:r)==c?s.call(l,{name:"columns",hash:{},data:o,loc:{start:{line:5,column:7},end:{line:5,column:20}}}):s)?a:"")+"\n\n    // meta: an object mapping column names to their kdb types\n    // "+(null!=(a=typeof(s=null!=(s=e(i,"meta")||(null!=t?e(t,"meta"):t))?s:r)==c?s.call(l,{name:"meta",hash:{},data:o,loc:{start:{line:8,column:7},end:{line:8,column:17}}}):s)?a:"")+"\n\n    // rows: an array of row objects, each one maps columns to values\n    // "+(null!=(a=typeof(s=null!=(s=e(i,"rows")||(null!=t?e(t,"rows"):t))?s:r)==c?s.call(l,{name:"rows",hash:{},data:o,loc:{start:{line:11,column:7},end:{line:11,column:17}}}):s)?a:"")+"\n\n    // you can perform operations on the source, generate values or fetch remote data using javascript\n    // when your are done pass an object in the same format as source to the callback function to return your data\n    \n    callback(source);\n\n}"},useData:!0}),e.app=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){return'<div class="toolbar hideMainMenu editor-ui" ></div>\n<div class="breadcrumbs-div" ></div>\n<div class="components-panel unpinned" ></div>\n<div class="properties-panel doc" contenteditable="false" ></div>\n<div class="content-panel Dark components-unpinned" tabindex="0" ></div>\n<div class="dialog-panel">\n    <div class="document" ></div>\n    <div class="environment" ></div>\n</div>\n<div class="notifications-div">\n\n</div>'},useData:!0}),e.dashboardDDL=Handlebars.template({compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l=e.escapeExpression,e=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="dashboardDLLForm">\n     <fieldset>\n         <legend>'+l((e(i,"t")||t&&e(t,"t")||s).call(a," Select a Dashboard",{name:"t",hash:{},data:o,loc:{start:{line:3,column:17},end:{line:3,column:44}}}))+'</legend>\n         <span class="fa fa-search"></span>\n         <select class="tags"></select>\n    </fieldset>\n    <fieldset class="screenFieldSet">\n        <legend>'+l((e(i,"t")||t&&e(t,"t")||s).call(a," Select a Screen",{name:"t",hash:{},data:o,loc:{start:{line:8,column:16},end:{line:8,column:40}}}))+'</legend>\n         <select class="tags-screens"></select>\n    </fieldset>\n    </div>'},useData:!0}),e.paramatersDialog=Handlebars.template({1:function(e,t,i,n,o){var a=null!=t?t:e.nullContext||{},s=e.hooks.helperMissing,l="function",r=e.escapeExpression,c=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},d='<div class="paramItem ',u=null!=(u=c(i,"required")||(null!=t?c(t,"required"):t))?u:s,p={name:"required",hash:{},fn:e.program(2,o,0),inverse:e.noop,data:o,loc:{start:{line:2,column:22},end:{line:2,column:56}}},h=typeof u==l?u.call(a,p):u;return null!=(h=c(i,"required")?h:e.hooks.blockHelperMissing.call(t,h,p))&&(d+=h),d+'">\n    <span class="paramName" data-id="'+r(typeof(u=null!=(u=c(i,"id")||(null!=t?c(t,"id"):t))?u:s)==l?u.call(a,{name:"id",hash:{},data:o,loc:{start:{line:3,column:37},end:{line:3,column:43}}}):u)+'" style="display: inline-block;width: 150px;font-weight:bold; margin-right: 5px">'+r(typeof(u=null!=(u=c(i,"id")||(null!=t?c(t,"id"):t))?u:s)==l?u.call(a,{name:"id",hash:{},data:o,loc:{start:{line:3,column:124},end:{line:3,column:130}}}):u)+'</span>\n    <input type="text" class="value" style="display: inline-block;margin-bottom: 10px; width: 200px;">\n    <span>'+r(typeof(u=null!=(u=c(i,"type")||(null!=t?c(t,"type"):t))?u:s)==l?u.call(a,{name:"type",hash:{},data:o,loc:{start:{line:5,column:10},end:{line:5,column:18}}}):u)+'</span>\n    <div class="paramDesc" data-id="'+r(typeof(u=null!=(u=c(i,"description")||(null!=t?c(t,"description"):t))?u:s)==l?u.call(a,{name:"description",hash:{},data:o,loc:{start:{line:6,column:36},end:{line:6,column:51}}}):u)+'" style="display: none;">'+r(typeof(u=null!=(u=c(i,"description")||(null!=t?c(t,"description"):t))?u:s)==l?u.call(a,{name:"description",hash:{},data:o,loc:{start:{line:6,column:76},end:{line:6,column:91}}}):u)+"</div>\n</div>\n"},2:function(e,t,i,n,o){return"required"},compiler:[8,">= 4.3.0"],main:function(e,t,i,n,o){var a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},s=null!=(s=a(i,"ParamList")||(null!=t?a(t,"ParamList"):t))?s:e.hooks.helperMissing,o={name:"ParamList",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:8,column:14}}},s="function"==typeof s?s.call(null!=t?t:e.nullContext||{},o):s;return null!=(s=a(i,"ParamList")?s:e.hooks.blockHelperMissing.call(t,s,o))?s:""},useData:!0}),e}(),DropzoneView=Backbone.View.extend({initialize:function(e){var t=this;this.documentImporter=e.documentImporter,this.router=e.router,this.$text=$("<p></p>").text("Drop dashboards to import  "),this.$icon=$("<i></i>").addClass("fa fa-upload"),this.$icon.appendTo(this.$text),this.$text.appendTo(this.$el),this.$el.on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),this.$el.on("dragleave",function(e){$(e.fromElement).is("p")||$(e.toElement).is("p")||(t.$el.parent().removeClass("dragging"),e.preventDefault(),e.stopPropagation())}),this.$el.on("drop",function(e){e.stopPropagation(),e.preventDefault();e=_.filter(e.originalEvent.dataTransfer.files,function(e){return _.includes(["application/json","text/xml"],e.type)||""===e.type&&_.endsWith(e.name,".json")});t.documentImporter.importFiles(e,function(e){t.router.navigate(e,{trigger:!0})},function(e){QuickBase.ErrorDialog.ShowError(e,_.noop)}),t.$el.parent().removeClass("dragging")})}}),DRAFT_STATE={iconDraft:{true:" fa-circle-o",false:" fa-check-circle"},textDraft:{true:"Unmark as Draft",false:"Mark as Draft"}},DashboardListView=Backbone.View.extend({$dashName:null,$delete:null,$input:null,$nameErrorInfo:null,$open:null,$preview:null,$starred:null,$starredNot:null,$draftIconButton:null,appModel:null,className:"dashboard-list-view",debouncedUpdateNameAndTags:null,viewModel:null,keyIndex:0,compareTags:function(e,t){if(!t)return!1;if(e.length!=t.length)return!1;for(var i=0,n=e.length;i<n;i++)if(e[i]instanceof Array&&t[i]instanceof Array){if(!compareTags(e[i],t[i]))return!1}else if(e[i]!=t[i])return!1;return!0},hideInput:function(){var e;this.$input&&(e=this.$input,this.$input=null,e.blur(),e.off(),e.remove())},initialize:function(e){var t=this;Handlebars.registerHelper("documentLocalDate",function(){var e=this.lastUpdateDate?moment(this.lastUpdateDate):moment();return e.format("DD/MM/YYYY HH:mm:ss")}),this.appModel=e.appModel,this.viewModel=e.viewModel,this.eventBus=e.eventBus,this.debouncedUpdateNameAndTags=_.debounce($.proxy(this.updateNameAndTags,this),500),this.render(),this.initializeEvents(),this.$el.attr("data-id",this.model.id),this.$el.attr("tabindex","0"),this.$el.on("focusout",function(e){t.$el.find(".selected").removeClass("selected"),t.keyIndex=0})},initializeEvents:function(){var i=this;this.$open.on("click",$.proxy(this.onOpen,this)),this.$preview.on("click",$.proxy(this.onPreview,this)),this.$delete.on("click",$.proxy(this.onDelete,this)),this.$dashName.on("click",$.proxy(this.onName,this)),this.$draftIconButton.on("click",$.proxy(this.updateDraftStatus,this)),this.listenTo(this.model,"change:name",this.onNameChanged),this.listenTo(this.model,"change:tags",this.onTagsChanged),this.$starred.on("click",function(e){e.stopPropagation(),e.preventDefault(),e=i.model.get("tags"),e=_.without(e,"starred"),i.model.set("tags",e),i.onTagsChanged(),i.debouncedUpdateNameAndTags()}),this.$starredNot.on("click",function(e){e.stopPropagation(),e.preventDefault(),e=i.model.get("tags").concat(["starred"]),i.model.set("tags",e),i.onTagsChanged(),i.debouncedUpdateNameAndTags()}),this.$isDefault.on("click",function(e){var t=i.model.get("tags");e.stopPropagation(),e.preventDefault(),_.includes(i.model.get("tags"),"defaultdash")||(t=i.model.get("tags").concat(["defaultdash"])),i.removeAllDefaultDashTags(),i.model.set({tags:t}),i.debouncedUpdateNameAndTags()}),this.$el.on("dblclick",$.proxy(this.onOpen,this)),this.$el.on("keydown",$.proxy(this.onKeyDown,this)),this.eventBus.on("dialog-resized",this.hideInput.bind(this))},isDraft:function(){return 0===this.model.get("name").indexOf("Draft")},onDelete:function(e){var n=this,t=this.$el.attr("data-id"),t=this.appModel.get("documents").get(t);"FSBL"in window&&t.id===window.finApi.documentId&&(window.finApi.dashRemoving=!0),t.destroy({success:function(e,t,i){console.log("document deleted without any issues",e,t,i);t=n.appModel.get("router").viewModel.get("selectedDocumentId");"FSBL"in window?_.debounce(function(){window.finApi.closeWindow(e.id)},10)():n.appModel.get("router").navigate(t,{trigger:!0})},error:function(e,t,i){console.log("document destroy error!",e,t,i)}})},onExport:function(e){var t=this.$el.attr("data-id"),i=this.appModel.get("documents").get(t),n=e?i.id:i.get("name"),o=this.appModel.get("isLite")?"json":"xml";t===this.viewModel.get("selectedDocumentId")?DashboardListView.exportModel(i,n,o):i.fetch({success:function(e){DashboardListView.exportModel(e,n,o)}.bind(this)})},onKeyDown:function(e){var t;"INPUT"===e.target.nodeName?13===e.keyCode?(e.preventDefault(),e.stopPropagation(),t=this.$input.val(),this.appModel.get("documents").findWhere({name:t})?this.showError.call(this,"Dashboard with this name already exists."):(this.model.set("name",t),this.hideInput(),this.debouncedUpdateNameAndTags())):27===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.hideInput()):"ArrowLeft"===e.key||"ArrowRight"===e.key?(e.preventDefault(),t=[this.$el,this.$dashName,this.$draftIconButton,this.$isDefault,_.includes(this.model.get("tags"),"starred")?this.$starred:this.$starredNot],this.$el.find(".selected").removeClass("selected"),"ArrowLeft"===e.key?this.keyIndex=(this.keyIndex-1+t.length)%t.length:"ArrowRight"===e.key&&(this.keyIndex=(this.keyIndex+1)%t.length),t[this.keyIndex].addClass("selected"),t[this.keyIndex].focus()):" "===e.key||"Enter"===e.key?(e.stopPropagation(),e.preventDefault(),(t=e.target.getElementsByClassName("selected")[0])===this.$dashName[0]?this.$dashName.click():t===this.$draftIconButton[0]?this.updateDraftStatus():t===this.$isDefault[0]?this.$isDefault.click():t===this.$starred[0]?this.$starred.click():t===this.$starredNot[0]?this.$starredNot.click():(this.trigger("keyboard-selection",this.$el),this.onOpen()),t.classList.add("selected")):46===e.keyCode&&this.onDelete()},onName:function(e){e.preventDefault(),e.stopPropagation(),this.showInput()},onNameChanged:function(){this.$dashName.text(this.model.get("name")),this.updateDraftIconState.call(this)},onOpen:function(e){var t;this.trigger("closeDialog"),t=this.$el.attr("data-id"),Backbone.history.fragment===t?Backbone.history.loadUrl(t):this.appModel.get("router").navigate(t,{trigger:!0})},onPreview:function(e){this.$el.attr("data-id");var t=(this.appModel.get("websiteUrl")||"").replace("edit","#")+this.model.id;window.open(t,"_blank","noopener,noreferrer,resizable")},onTagsChanged:function(){(_.includes(this.model.get("tags"),"starred")?(this.$starredNot.hide(),this.$starred):(this.$starred.hide(),this.$starredNot)).show(),_.includes(this.model.get("tags"),"defaultdash")?(this.$isDefault.addClass("active"),0<this.$el.siblings().length&&this.$el.siblings().find(".fa-home").removeClass("active")):this.$isDefault.removeClass("active")},render:function(){var e=this.model.get("name"),t=this.isDraft(),i=DRAFT_STATE.iconDraft[t],t=DRAFT_STATE.textDraft[t],e=_.extend({name:e,draftStateIcon:i,title:t},this.model.pick("lastUpdateDate"));this.$el.html(T.DashboardListView(e)),this.$open=this.$el.find(".open-dash"),this.$preview=this.$el.find(".preview-dash"),this.$delete=this.$el.find(".delete-dash"),this.$dashName=this.$el.find(".dash-name"),this.$isDefault=this.$el.find(".fa-home"),this.$starred=this.$el.find(".fa-star"),this.$starredNot=this.$el.find(".fa-star-o"),this.$nameErrorInfo=this.$el.find(".name-error-info"),this.$nameErrorInfo.hide(),this.$draftIconButton=this.$el.find(".dash-wip-icon"),this.onTagsChanged()},updateDraftIconState:function(){var e=this.isDraft();this.$draftIconButton.attr("class","dash-wip-icon fa"+DRAFT_STATE.iconDraft[e]),this.$draftIconButton.attr("title",DRAFT_STATE.textDraft[e])},remove:function(){this.$open.off(),this.$preview.off(),this.$delete.off(),this.$draftIconButton.off(),this.hideInput(),this.$el.off(),this.$el.remove()},removeAllDefaultDashTags:function(){var e,i=this;0<(e=this.appModel.get("documents").filter(function(e){return _.includes(e.get("tags"),"defaultdash")})).length&&_.each(e,function(e){var t;e!==i.model&&(t=_.without(e.get("tags"),"defaultdash"),e.fetch({success:function(e){e.set({tags:t},{silent:!0}),e.saveNow()}}))})},updateDraftStatus:function(){var e=this.model.get("name");e&&(e=this.isDraft()?e.substring(6).trim():"Draft: "+e,this.appModel.get("documents").findWhere({name:e})?this.showError.call(this,"Dashboard with this name already exists."):(this.model.set("name",e),this.debouncedUpdateNameAndTags()))},showError:function(e){this.$nameErrorInfo.text(t(e)),this.$nameErrorInfo.fadeIn(function(){$(this).delay(3e3).fadeOut("slow")})},showInput:function(){var t=this,e=this.$dashName.position(),i=this.$el.width()-this.$el.find(".right-side-span").width()-50,n=this.$dashName.height()+4;this.$input=$(document.createElement("input")),this.$input.addClass("name-input"),this.$input.css({left:e.left,top:e.top-4,width:i,height:n}),this.$input.val(this.model.get("name")),this.$input.appendTo(this.$el.find(".tile-content")),this.$input.focus(),this.$input.select(),this.$input.on("keydown",$.proxy(this.onKeyDown,this)),this.$input.on("focusout",function(e){t.hideInput()})},updateNameAndTags:function(){var s=this;new QuickBase.Document({id:this.model.id}).fetch({success:function(t){var e=t.get("name"),i=s.model.get("name"),n=t.get("tags"),o=$.extend(!0,[],s.model.get("tags")),a=!1;s.viewModel.get("selectedDocumentId")===s.model.id?(a=!0,t=s.model):(e!==i&&(t.set("name",i),a=!0),s.compareTags(n,o)||(t.set("tags",o),a=!0)),a&&t.saveNow(function(e){t.set("name",oldname),s.showError.call(s,e)},function(){var e;"FSBL"in window&&(window.finApi.dashRenamed=oldname,e=_.map(t.collection.models,function(e){return _.pick(e.toJSON(),["name","id"])}),window.finApi.applyUserConfig(window.finApi.generateConfig(e,!0)))})},error:function(e,t){QuickBase.Log.Error("Error fetching dashboards model",t)}})}},{exportModel:function(e,t,i){function n(e){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}var o,a,s=e.toJSONClone(),l=document.createElement("a"),r=(e="xml"===i?(a="data:application/xml;charset=utf-8","<ui>\r\n\t<name>"+e.id+"</name>\r\n\t<displayName>"+n(e.get("name"))+"</displayName>\r\n\t<description>"+n(JSON.stringify(_.pick(s,"creationDate","lastUpdateDate","tags"),null,2))+"</description>\r\n\t<data>"+n(JSON.stringify(s,null,2))+"</data>\r\n</ui>"):(a="data:application/json;charset=utf-8",JSON.stringify(s,null,2)),t+"."+i);window.Blob?(o=new Blob([e],{type:a}),window.navigator.msSaveOrOpenBlob?l.onclick=function(){window.navigator.msSaveOrOpenBlob(o,r)}:void 0!==l.download&&l.setAttribute("href",URL.createObjectURL(o))):l.setAttribute("href",encodeURI(a+","+e)),void 0!==l.download&&l.setAttribute("download",r),document.body.appendChild(l),l.click(),document.body.removeChild(l)}}),MessageDialog=Backbone.View.extend({className:"confirm-dialog",initialize:function(e){var i=this;i.options=e,i.$el.html(T.MessageDialog(e)),i.$dialog=i.$el.dialog(_.extend({appendTo:e.container,title:t("Confirm"),resizable:!0,height:190,width:360,minWidth:300,modal:!0,autoOpen:!0,buttons:[{text:t("OK"),click:$.proxy(i.onOKButtonClick,i),icon:"fa fa-check"},{text:t("Cancel"),click:i.close.bind(i),icon:"fa fa-times"}],close:function(){i.remove()},open:function(){$('<i class="fa fa-question-circle" />').insertBefore(i.$el.parent().find(".ui-dialog-title"))}},e)),LocalTools.moveDialogOnTop(i.$dialog.parent())},close:function(){this.$el.dialog("close")},onOKButtonClick:function(){this.$dialog.dialog("close")}}),ManageDashWindow=Backbone.View.extend({$closeButton:null,$dashboardsList:null,$dialog:null,$searchInput:null,$sortNameUp:null,$sortNameDown:null,$sortDateUp:null,$sortDateDown:null,searchClear:null,appModel:null,className:"quick-dash window manage-window",filterName:null,filterTags:null,selected:null,sortOrder:null,sortDirection:null,viewModel:null,views:null,initialize:function(e){this.views=[],this.options=e,this.appModel=e.appModel,this.container=e.container,this.viewModel=e.viewModel,this.filterTags=["all"],this.sortOrder="byLatest",this.sortDirection="descending",this.eventBus=_.extend({},Backbone.Events),this.render(),this.initializeEvents(),this.onSelected(null),this.filterNow()},initializeEvents:function(){var t=this;this.$el.on("click",$.proxy(this.onClose,this)),this.listenTo(this.appModel.get("documents"),"sort remove add",this.updateList.bind(this)),this.$searchInput.on("input",t.onSearchInput.bind(t)),this.$searchClear.on("click",t.onClearSearch.bind(t)),this.$searchInput.on("keydown",function(e){27===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.$searchInput.val(""),this.filterName=null,this.updateList())}.bind(this)),this.$el.find(".open").click(function(){t.selected.onOpen()}),this.$el.find(".view").click(function(){t.selected.onPreview()}),this.$el.find(".delete").click(function(){window.confirm("Do you want to delete this dashboard?")&&t.selected.onDelete()}),this.$el.find(".export").click(function(e){t.selected.onExport(e.altKey)}),this.$el.find(".import").click(function(e){t.$el.find("#dashImportFile").click()}),this.$el.find("#dashImportFile").change(t.onImportFileChange.bind(t))},addDocuments:function(){var t,i=this,e=this.filterNow();this.views.length&&(_.each(this.views,function(e){e.remove()}),this.views=[]),_.each(e,function(e){(t=new DashboardListView({model:e,appModel:i.appModel,viewModel:i.viewModel,eventBus:i.eventBus})).$el.appendTo(i.$dashboardsList),i.views.push(t),i.listenTo(t,"keyboard-selection",function(e){i.onBeforeSelected(e)}),i.listenTo(t,"closeDialog",i.remove),i.listenTo(t.model,"change:name",function(){i.selected&&i.selected.$el&&i.onBeforeSelected(i.selected.$el)})})},clearFileInput:function(e){try{e.value=null}catch(e){}e.value&&e.parentNode.replaceChild(e.cloneNode(!0),e)},filterNow:function(){var t,e=this.appModel.get("documents").models;return _.includes(this.filterTags,"recent")&&((e=_.sortBy(e,function(e){var t=e.get("lastUpdateDate");return t=t||e.get("creationDate"),new Date(t)})).reverse(),e=_.take(e,10)),_.includes(this.filterTags,"starred")&&(e=_.filter(e,function(e){return _.includes(e.get("tags"),"starred")})),this.filterName&&0<this.filterName.length&&(t=this.filterName.toLowerCase(),e=_.filter(e,function(e){return-1<e.get("name").toLowerCase().indexOf(t)})),"byLatest"===this.sortOrder?e=_.sortBy(e,function(e){var t=e.get("lastUpdateDate");return t=t||e.get("creationDate"),new Date(t)}):"byName"===this.sortOrder&&(e=_.sortBy(e,function(e){return e.get("name").toLowerCase()})),"descending"===this.sortDirection&&e.reverse(),e},onBeforeSelected:function(e){var t;e.addClass("ui-selected").siblings().removeClass("ui-selected"),e.focus(),(t=e.attr("data-id"))&&(e=_.find(this.views,function(e){return e.model.id===t}),this.onSelected(e))},onClearSearch:function(){this.$searchInput.val(""),this.onSearchInput()},onImportFileChange:function(e){var t=this;this.appModel.documentImporter.importFiles(_.filter(e.target.files,function(e){return _.includes(["application/json","text/xml"],e.type)||""===e.type&&_.endsWith(e.name,".json")}),function(){t.clearFileInput(t.$el.find("#dashImportFile")[0])},function(e){t.clearFileInput(t.$el.find("#dashImportFile")[0]),QuickBase.ErrorDialog.ShowError(e,_.noop)})},onSearchInput:function(){this.filterName=this.$searchInput.val(),this.updateList(),this.toggleHideSearch()},onSelected:function(e){this.selected=e,this.$el.find(".open").button("option","disabled",!e),this.$el.find(".view").button("option","disabled",!e||e.isDraft()),this.$el.find(".delete").button("option","disabled",!e),this.$el.find(".export").button("option","disabled",!e)},remove:function(){this.stopListening(),this.$searchClear.off(),this.$searchInput.off(),this.$el.off(),this.removeListElements(),this.trigger("close"),this.$dashboardsList&&this.$dashboardsList.data("uiSelectable")&&this.$dashboardsList.selectable("destroy"),this.$dialog&&this.$dialog.data("uiDialog")&&this.$dialog.dialog("destroy"),Backbone.View.prototype.remove.apply(this,arguments)},removeListElements:function(){this.onSelected(null),_.each(this.views,function(e){e.remove()})},render:function(){var i=this,e=Tools.calcDialogHeight(400,"dataDialog"),n=e<400?"top":"center";this.$el.html(T.ManageDashWindow({radio1:_.uniqueId("radio_"),radio2:_.uniqueId("radio_"),radio3:_.uniqueId("radio_")})),this.$contentContainer=this.$el.find(".content-container"),this.$dashboardsList=this.$el.find(".dashboards-list"),this.$searchInput=this.$el.find(".search-input"),this.$sortNameUp=this.$el.find(".name-sort .fa-caret-up"),this.$sortNameUp.hide(),this.$sortNameDown=this.$el.find(".name-sort .fa-caret-down"),this.$sortNameDown.hide(),this.$sortDateUp=this.$el.find(".last-modified-sort .fa-caret-up"),this.$sortDateUp.hide(),this.$sortDateDown=this.$el.find(".last-modified-sort .fa-caret-down"),this.$searchClear=this.$el.find(".clearSearch"),this.$el.find(".open").button({icon:"fa fa-play"}).hide(),this.$el.find(".view").button({icon:"fa fa-globe"}),this.$el.find(".delete").button({icon:"fa fa-trash"}),this.$el.find(".import").button({icon:"fa fa-upload",showLabel:!1}),this.$el.find(".export").button({icon:"fa fa-download",showLabel:!1}),this.$dashboardsList.selectable({autoRefresh:!0,filter:">*",cancel:".dash-name,i,.ui-selected,.title-content",selected:function(e,t){i.onBeforeSelected($(t.selected))},unselected:function(){i.onSelected(null)}}),this.$dialog=this.$el.dialog(_.extend({appendTo:this.container,classes:{"ui-dialog":"quick-dash manage-dashboards"},title:t("Dashboards"),resizable:!0,height:e,width:750,position:{my:"center",at:n,of:"#appdiv",collision:"fit"},modal:!0,autoOpen:!0,draggable:!0,buttons:[{text:t("Open"),icon:"fa fa-play",click:function(){i.selected&&i.selected.onOpen()}},{text:t("Cancel"),icon:"fa fa-times",click:function(){$(this).dialog("close")}}],open:function(){$('<i class="fa fa-list-alt" />').insertBefore(i.$el.parent().find(".ui-dialog-title")),i.updateList()},close:function(){i.remove(),Backbone.history.loadUrl()},resize:function(){i.eventBus.trigger("dialog-resized")}},i.options)),"FSBL"in window&&i.$el.parent().css("margin-top",window.finApi.DIALOGS_TOP_MARGIN),this.$el.find(".name-sort").on("click",$.proxy(this.nameSortClicked,this)),this.$el.find(".last-modified-sort").on("click",$.proxy(this.lastModifiedSortClicked,this))},nameSortClicked:function(){("byLatest"===this.sortOrder?(this.sortOrder="byName",this.$sortDateDown.hide(),this.$sortDateUp.hide(),"descending"===this.sortDirection?this.$sortNameDown:this.$sortNameUp):"descending"===this.sortDirection?(this.sortDirection="ascending",this.$sortNameDown.hide(),this.$sortNameUp):(this.sortDirection="descending",this.$sortNameUp.hide(),this.$sortNameDown)).show(),this.updateList()},lastModifiedSortClicked:function(){("byName"===this.sortOrder?(this.sortOrder="byLatest",this.$sortNameDown.hide(),this.$sortNameUp.hide(),"descending"===this.sortDirection?this.$sortDateDown:this.$sortDateUp):"descending"===this.sortDirection?(this.sortDirection="ascending",this.$sortDateDown.hide(),this.$sortDateUp):(this.sortDirection="descending",this.$sortDateUp.hide(),this.$sortDateDown)).show(),this.updateList()},toggleHideSearch:function(){this.$searchInput&&this.$searchInput.val()?this.$searchClear.show():this.$searchClear.hide()},updateList:function(){this.removeListElements(),this.addDocuments(),this.appModel.get("documents").length<=1?this.$el.find(".manage-documents-toolbar .delete").addClass("disabled"):this.$el.find(".manage-documents-toolbar .delete").removeClass("disabled")}}),LoadingScreen=Backbone.View.extend({className:"quick-dash loadingScreen",loadText:null,initialize:function(e){this.loadText=e.loadingText,this.render()},render:function(){return this.$el.html(T.LoadingScreen({text:this.loadText})),this.$el.hide(),this.$el.fadeIn(),this}}),DashboardNamePrompt=Backbone.View.extend({$closeButton:null,$dialog:null,$nameInput:null,$wip:null,$tooltip:null,$dashExistsInfo:null,appModel:null,create:!1,className:"quick-dash window dashboard-name-prompt",initialize:function(e){function i(e,t,i){return{text:e,click:t,icon:"fa fa-"+i}}var n=this,o=[],a=(this.appModel=e.appModel,this.container=e.container,this.$el.html(T.DashboardNamePrompt(this.model.toJSON())),this.$nameInput=this.$el.find(".name-input"),this.$wip=this.$el.find(".work-in-progress"),this.$wipIcon=this.$el.find(".wip-icon"),this.$tooltip=this.$el.find(".wip-tooltip"),this.$dashExistsInfo=this.$(".dash-exist-info"),this.$dashExistsInfo.hide(),"true"===$.cookie("dashboard-work-in-progress")?"Unmark as Draft":"Mark as Draft");this.$wipIcon.attr("aria-label",a);e.saveAs?o.push(i(t("Save As..."),function(){n.onOk()},"file-o")):(o.push(i(t("New"),function(){n.onOk()},"file-o")),o.push(i(t("Duplicate"),function(){n.onDuplicate()},"files-o"))),o.push(i(t("Cancel"),function(){$(this).dialog("close")},"times")),this.$dialog=this.$el.dialog(_.extend({appendTo:this.container,classes:{"ui-dialog":"quick-dash newdashboard-dialog"},title:e.saveAs?t("Save As..."):t("New Dashboard"),resizable:!1,height:150,width:311,modal:!0,autoOpen:!0,draggable:!1,buttons:o,closeOnEscape:!this.forced,open:function(){n.forced&&$(this).parent().find(".ui-dialog-titlebar-close").hide(),$('<i class="fa fa-file-o" />').insertBefore(n.$el.parent().find(".ui-dialog-title")),n.$nameInput.select(),n.$nameInput.focus(),$.cookie("dashboard-work-in-progress")||$.cookie("dashboard-work-in-progress",!1,{expires:90,path:"/;SameSite=Strict",secure:"https:"===_.get(window,"location.protocol")}),String(n.$wip.prop("checked"))!=$.cookie("dashboard-work-in-progress")&&n.updateWIPState(),n.$nameInput.on("keydown",function(e){0===n.$nameInput.val().indexOf("Draft:")?$.cookie("dashboard-work-in-progress",!0,{expires:90,path:"/;SameSite=Strict",secure:"https:"===_.get(window,"location.protocol")}):$.cookie("dashboard-work-in-progress",!1,{expires:90,path:"/;SameSite=Strict",secure:"https:"===_.get(window,"location.protocol")}),n.updateWIPState(),13==e.keyCode&&(e.preventDefault(),e.stopPropagation(),n.onOk.call(n))}),n.$wip.change(function(e){$.cookie("dashboard-work-in-progress",e.target.checked,{expires:90,path:"/"}),n.$tooltip.hide(),n.updateWIPState()}),n.$wipIcon.on("keyup",function(e){" "!==e.key&&"Enter"!==e.key||n.$wip.trigger("click")}),n.$el.find(".wip-icon").hover(function(){var e="true"===$.cookie("dashboard-work-in-progress")?"Unmark as Draft":"Mark as Draft";n.$tooltip.html(e),n.$tooltip.show()},function(){n.$tooltip.hide()})},close:function(){n.remove()}},e))},onDuplicate:function(){this.duplicate=!0,this.onOk()},onOk:function(){var t=DOMPurify.sanitize(this.$nameInput.val().trim());0<(t=0===t.indexOf("Draft:")?t.substring(6).trim():t).length&&(this.appModel.get("documents").find(function(e){e=e.attributes.name.trim();return e===t||e==="Draft:"+t||e==="Draft: "+t})?this.$dashExistsInfo.fadeIn(function(){$(this).delay(3e3).fadeOut("slow")}):(this.create=!0,this.$dialog.dialog("close")))},remove:function(){this.stopListening(),this.$nameInput.off(),this.$wip.off(),this.$dialog&&this.$dialog.dialog("destroy"),Backbone.View.prototype.remove.apply(this),this.trigger("close",{create:this.create,duplicate:this.duplicate,name:this.$nameInput.val()})},updateWIPState:function(){"true"===$.cookie("dashboard-work-in-progress")?(this.$wip.prop("checked",!0),this.$wipIcon.attr("aria-label","Unmark as Draft"),0!==this.$nameInput.val().indexOf("Draft:")&&this.$nameInput.val("Draft: "+this.$nameInput.val())):(this.$wip.prop("checked",!1),this.$wipIcon.attr("aria-label","Mark as Draft"),0===this.$nameInput.val().indexOf("Draft:")&&this.$nameInput.val(this.$nameInput.val().substring(6).trim()))}}),Log=QuickBase.Log,LoginHistoryDialog=Backbone.View.extend({$dialog:null,close:function(){this.$dialog.dialog("close")},dataGridStuff:function(){var n=["pk","time","machineID","status","url"],o=[11,15,11,11,11],a=["pk","Time","Machine Id","Status","Url"],s=["pk"];return{generateDatagridConfig:function(e){return this.Datagrid=e,(e=new QuickBase.DocumentDataModel({_subscriptionKey:"pk",_dataType:"copy",_maxRows:1e6})).apply(),e.onExecuteSuccess(this.getResponse(),!0),new Backbone.Model({data:e,columnsConfig:this.getColumnsConfiguration(),datagridConfig:this.datagridConfiguration(),sortColumns:this.sortColumns})},datagridConfiguration:function(){return{Selection:{Mode:"Multi Row"}}},columnsConfiguration:function(){var i;return MAP={1:"Boolean",14:"Date",15:"DateTime",19:"Time"},i=function(e){return MAP[e]||"General"},_.map(n,function(e,t){return{Field:e,DisplayName:a[t],Sortable:!0,Hidden:_.includes(s,n[t]),Format:i(o[t])}})},getResponse:function(e){return{rows:e||[],columns:n,meta:_.zipObject(n,o)}},getColumnsConfiguration:function(){var e=this.columnsConfiguration(),t=this;return _.map(e,function(e){return _.extend({},t.Datagrid.getColumnSettingsModel(),{DisplayName:e.Field,TextAlign:"left",IsReadonly:!0,MinWidthAbsolute:100},e)})},sortColumns:[{sortCol:"time",sortAsc:!1}]}}(),getLoginHistory:function(){var t=this;QuickBase.DeltaClientLib.getAPIQueryData("kdb",void 0,".session.getLoginsUI",[{IsKdbParam:!0,i:0,index:0,name:"clientType",type:"symbol"}],function(e){t.dgSourceModel.onExecuteSuccess(t.dataGridStuff.getResponse(_.map(e.rows,function(e){return _.extend({pk:_.uniqueId()},_.pick(e,"machineID","status","time","url"))})),!0),t.hideLoadingScreen(),t.onResize()},function(e){console.log("getLoginHistory session get logins error",e)},100,!1)},hideLoadingScreen:function(){this.$loadingScreen&&(this.$loadingScreen.fadeOut(function(){$(this).remove()}),this.$loadingScreen=null)},initialize:function(e){var i=this;i.$el.html(T.LoginHistoryDialog()),i.showLoadingScreen(),i.initializeDataGrid(),this.$dialog=this.$el.dialog(_.extend({classes:{"ui-dialog":"quick-base login-history-dialog"},title:t("Login History"),resizable:!0,height:302,width:552,modal:!0,autoOpen:!0,draggable:!0,buttons:[{text:t("OK"),click:$.proxy(i.close,i),icon:"fa fa-check"}],open:function(){$('<i class="fa fa-history" />').insertBefore(i.$el.parent().find(".ui-dialog-title"))},close:function(){_.isFunction(e.onClose)&&e.onClose(),i.remove()},resize:$.proxy(this.onResize,this)},e))},initializeDataGrid:function(e){var i=this;require(["Datagrid"],function(e){var t=i.dataGridStuff.generateDatagridConfig(e);i.dgSourceModel=t.get("data"),i.dgSource=new e.Master({el:i.$(".grid-div"),model:t}),i.getLoginHistory()})},onResize:function(){this.dgSource&&this.dgSource.onResize()},remove:function(){this.dgSource.off(),this.dgSource.remove(),Backbone.View.prototype.remove.apply(this)},showLoadingScreen:function(e){e=new LoadingScreen({loadingText:e});e.$el.appendTo(this.$el),this.$loadingScreen=e.$el}}),CustomEvents=function(){function e(){_.extend(this,Backbone.Events)}return e.prototype.on=function(e,t,i){},e.prototype.off=function(e,t,i){},e.prototype.trigger=function(e){for(var t=1;t<arguments.length;t++)t-1,0},e.prototype.bind=function(e,t,i){},e.prototype.unbind=function(e,t,i){},e.prototype.once=function(e,t,i){},e.prototype.listenTo=function(e,t,i){},e.prototype.listenToOnce=function(e,t,i){},e.prototype.stopListening=function(e,t,i){},e}(),ButtonMenu=function(){function o(e,t,i,n){this.isBusy=!1,this.clickEnabled=!0,this.longPressTimerId=null,this.$btn=e,this.initClickAndPress(e,t,n),this.initCombo(i)}return o.prototype.initCombo=function(e){var t=this;this.$cmbCommands=$("<select class='button-menu'></select>"),this.$btn.before(this.$cmbCommands),this.$cmbCommands.select2({minimumResultsForSearch:1e3,theme:"button-menu"}),this.$cmbCommands.on("select2:select",function(){t.isBusy||e(t.$cmbCommands.val())}),this.$cmbCommands.on("select2:open",function(){$("body > .select2-container--button-menu").addClass("select2--environment")})},o.prototype.showMenu=function(e){var i="<option></option>";_.each(e,function(e,t){i+='<option value="'+t+'">'+e+"</option>"}),this.$cmbCommands.val("").trigger("change"),this.$cmbCommands[0].innerHTML=i,this.$cmbCommands.trigger("change").select2("open")},o.prototype.initClickAndPress=function(e,t,i){var n=this;e.mousedown(function(){n.longPressTimerId=setTimeout(function(){n.longPressTimerId=null,e.button("option","disabled")||n.showMenu(i())},o.LONG_PRESS_DURATION)}).on("mouseup mouseout",function(){null===n.longPressTimerId?(n.clickEnabled=!1,_.defer(function(){n.clickEnabled=!0})):(clearTimeout(n.longPressTimerId),n.longPressTimerId=null)}).on("click",function(){n.clickEnabled&&t.call(n)}).on("keyup",function(e){n.clickEnabled&&"Enter"===e.key&&t.call(n)})},o.LONG_PRESS_DURATION=500,o}(),EditorCommand=function(e){this.title=e=void 0===e?null:e},UndoRedoManager=function(n){function e(e){function t(e){return{icon:"fa "+e,text:!1,disabled:!0,showLabel:!1}}var i=n.call(this)||this;i.isBusy=!1,i.viewModel=e.viewModel,i.$btnRedo=e.$btnRedo,i.$btnUndo=e.$btnUndo;return i.$btnRedo.button(t("fa-repeat")).hide(),i.$btnUndo.button(t("fa-undo")),i.redoBtn=new ButtonMenu(i.$btnRedo,i.onClickRedo.bind(i),i.onSelect.bind(i),function(){return i.getOptions(!1)}),i.undoBtn=new ButtonMenu(i.$btnUndo,i.onClickUndo.bind(i),i.onSelect.bind(i),function(){return i.getOptions(!0)}),i.updateButtonStates(),i.initializeEvents(),i}return __extends(e,n),e.prototype.initializeEvents=function(){this.listenTo(this.viewModel,"change:commandIndex",this.updateButtonStates)},e.prototype.onSelect=function(e){e=parseInt(e.replace(/^\D+/g,""),10);this.viewModel.goToCommandIndex(e)},e.prototype.clear=function(){this.updateButtonStates()},e.prototype.getButtonMethod=function(e){return e?"enable":"disable"},e.prototype.getOptions=function(e){var t=this.viewModel.get("commands"),i=this.viewModel.get("commandIndex"),n={};if(e)for(var o=i;0<=o;o--)n["_"+o]=t[o].title;else for(o=i+1;o<t.length;o++)n["_"+o]=t[o].title;return n},e.prototype.onClickRedo=function(){this.redoCommand(),this.updateButtonStates()},e.prototype.onClickUndo=function(){this.undoCommand(),this.updateButtonStates()},e.prototype.redoCommand=function(){this.isBusy||this.$btnRedo.button("option","disabled")||(this.isBusy=!0,this.viewModel.redo(),this.isBusy=!1)},e.prototype.undoCommand=function(){this.isBusy||this.$btnUndo.button("option","disabled")||(this.isBusy=!0,this.viewModel.undo(),this.isBusy=!1)},e.prototype.updateButtonStates=function(){var e=this.viewModel.get("commands"),t=this.viewModel.get("commandIndex"),i=!1,n=!1,t=(null!==t&&e.length&&(0<=t&&(n=!0),t!==e.length-1)&&(i=!0),this.getButtonMethod(i)),e=this.getButtonMethod(n);this.$btnRedo.button(t).toggle(i),this.$btnUndo.button(e),this.$btnRedo.attr("tabindex","enable"===t?"0":"-1"),this.$btnUndo.attr("tabindex","enable"===e?"0":"-1")},e}(CustomEvents),MainToolbar=Backbone.View.extend({$profileButton:null,$profileMenu:null,$loadingScreen:null,$newDash:null,$openDash:null,$saveDash:null,$saveDashAs:null,$printDash:null,appModel:null,manageDashWindow:null,viewModel:null,documentSelector:null,undoRedoManager:null,initialize:function(e){var i=this,t=(this.options=e,this.appModel=e.appModel,this.dialogContainer=e.dialogContainer,this.viewModel=e.viewModel,this.appModel.set("hideToolbar","FSBL"in window),this.$el.html(T.MainToolbar(this.appModel.toJSON())),this.mainMenuButton=this.el.querySelectorAll(".main-menu-btn")[0],this.initMainMenu(),this.documentSelector=new QuickBase.DocumentSelector({el:this.$el.find(".document-selector"),appModel:this.appModel,viewModel:e.viewModel,showManage:!0}),this.$newDash=this.$el.find(".new-dash"),this.$newDash.button({text:!1,icon:"fa fa-file-o",showLabel:!1}).on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||i.$newDash.click()}).on("click",$.proxy(this.onNewDash,this)),this.$saveDash=this.$el.find(".save-dash"),this.appModel.get("embedded")&&this.$saveDash.attr("title","Save View to Server"),this.$saveDash.button({icon:"fa fa-floppy-o",text:!1,showLabel:!1}),new ButtonMenu(this.$saveDash,this.onSaveDash.bind(this),function(e){"sa"==e?this.onSaveDashAs():"ex"==e&&this.onExportDash()}.bind(this),function(){return{sa:"Save As...",ex:"Export"}}),$("<span />").addClass("save-pending ui-icon fa fa-asterisk").appendTo(this.$saveDash),$("<span />").addClass("save-in-progress ui-icon fa fa-spinner fa-pulse").appendTo(this.$saveDash),this.$connectionStatus=this.$el.find(".connectionStatus"),this.appModel.set("undoRedoManager",this.undoRedoManager=new UndoRedoManager({$btnUndo:this.$(".undo-action"),$btnRedo:this.$(".redo-action"),appModel:this.appModel,viewModel:this.viewModel})),this.$printDash=this.$el.find(".print-dash"),this.appModel.get("embedded")?this.setUpPrintButton():this.$printDash.hide(),this.$el.find(".content-toggle > input").button().removeClass("ui-button").on("keyup",function(e){" "!==e.key&&"Enter"!==e.key||i.$el.find(".content-toggle > input").click()}).on("click",function(){var e=i.viewModel.get("buildMode");i.viewModel.set("buildMode",!e),i.$el.find(".content-toggle > label").toggleClass("ui-state-active",e)}),i.viewModel.get("buildMode")||(this.$el.find(".content-toggle > input").prop("checked",!0),this.$el.find(".content-toggle > label").toggleClass("ui-state-active",!0)),this.$el.find(".content-toggle > label").addClass("ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"),this.$profileButton=this.$el.find(".profile > button"),this.$profileMenu=this.$el.find(".profile > .profile-menu"),this.$profileButton=this.$el.find(".profile > button").button({text:!0}).click(function(){return i.$profileMenu.toggle(),i.$profileMenu.css("position","absolute"),i.$profileMenu.position({my:"right top",at:"right bottom",of:this}),$(document).on("click",function(){i.$profileMenu.hide()}),!1}),this.$toolbarToggle=this.$el.find(".toolbar-toggler"),this.$toolbarToggle.on("click",function(e){i.appModel.set("hideToolbar",!i.appModel.get("hideToolbar"))}),this.appModel.get("isLite")?this.initProfileMenu():$(QuickBase.DeltaClientLib).one("DeltaClientLogin",$.proxy(this.initProfileMenu,this)),this.listenTo(this.appModel,"change:userName",function(e,t){i.$el.find(".user-name").text(t)}),this.listenTo(this.viewModel,"change:selectedDocumentId",this.onSelectedDocumentIdChanged),this.listenTo(this.documentSelector,"manage",this.openDashManagerWindow),function(){$(QuickBase.DeltaClientLib).one("DeltaClientDisconnect",function(){i.changeConnectionStatus(!1),$(QuickBase.DeltaClientLib).one("DeltaClientConnect",function(){i.changeConnectionStatus(!0),t()})})});this.options.appModel.get("embedded")||t(),$(window).on("keydown",$.proxy(this.onKeyDown,this))},setUpPrintButton:function(){var a=this,e=(this.$printDash.button({icon:"fa fa-file-pdf-o",text:!1,label:"Generate PDF document",showLabel:!1}).click(function(){var e=a.viewModel.get("selectedDocumentId"),t=a.viewModel.get("selectedScreenId"),i=a.appModel.get("documents").get(e),n=i.get("name"),o=i.get("hidePdfGlobalVS"),i=i.get("viewState").getViewStateExport(o),o=a.appModel.get("sendSignal");o&&o({type:"print",param:{documentId:e,screenId:t,viewState:i,viewName:n}})}),new Headers);e.append("kxui","true"),fetch("".concat(window.location.origin,"/print/check"),{headers:e}).then(function(e){e.ok&&e.headers.get("Content-Type").startsWith("application/json")||a.$printDash.hide()})},createDashboard:function(o,a){var s=this;return new Promise(function(t,i){var n=s,e=s.getNewDashModel({name:a});return o&&e.set("id",o),n.$saveDash.addClass("saving"),e.saveNow(function(e,t){Log.Error("error creating dashboard",e),n.$saveDash.removeClass("saving"),MainToolbar.ShowError_unableToCreateNewDashboard(t),n.hideLoadingScreen(),i(e)},function(e){n.$saveDash.removeClass("saving"),e.set("wasChanged",!1),n.appModel.get("documents").add(e,{at:0}),n.hideLoadingScreen(),t(e.id)}),e})},initMainMenu:function(){this.mainMenuView=new QuickBase.MainMenu({mainMenuButton:this.mainMenuButton,appModel:this.appModel,viewModel:this.viewModel});var e=this.el.querySelectorAll(".dash-main-menu")[0];e.appendChild(this.mainMenuView.el),this.mainMenu=e.querySelectorAll(".main-menu")[0],this.mainMenuFocusOutHandler=this.onMainMenuFocusOut.bind(this),this.toggleMainMenuHandler=this.onToggleMainMenu.bind(this),this.mainMenuButton.addEventListener("click",this.toggleMainMenuHandler),this.mainMenu.addEventListener("focusout",this.mainMenuFocusOutHandler),this.listenTo(this.mainMenuView,"newDash saveDash saveDashAs manageDash exportDash showDocumentation",this.onMainMenuEventTriggered.bind(this)),this.listenTo(this.mainMenuView,"openDataDialog openConnectionsDialog openViewStateDialog showDocumentGraph",this.triggerMainToolBarEvent.bind(this))},onToggleMainMenu:function(e){"block"===this.mainMenu.style.display?(this.mainMenuView.hide(),this.mainMenuButton.focus()):this.mainMenuView.show()},onMainMenuEventTriggered:function(e){switch(this.mainMenuView.hide(),e){case"newDash":this.onNewDash();break;case"saveDash":this.onSaveDash();break;case"saveDashAs":this.onSaveDashAs();break;case"manageDash":this.openDashManagerWindow();break;case"exportDash":this.onExportDash();break;case"showDocumentation":this.showDocumentation();break;default:console.error("Main Menu: ".concat(e," not found"))}},triggerMainToolBarEvent:function(e){this.trigger(e),this.mainMenuView.hide()},onMainMenuFocusOut:function(e){e.relatedTarget===this.mainMenuButton||this.mainMenu.contains(e.relatedTarget)||this.mainMenuView.hide()},showDocumentation:function(){new QuickBase.HelpDialog({appModel:this.appModel,container:this.dialogContainer,viewModel:this.viewModel,tag:"home.htm"});this.mainMenuView.hide()},remove:function(){this.mainMenuButton.removeEventListener("click",this.toggleMainMenuHandler),this.mainMenu.removeEventListener("focusout",this.mainMenuFocusOutHandler),Backbone.View.prototype.remove.apply(this)},initProfileMenu:function(){this.profileMenu=new QuickBase.ProfileMenu({appModel:this.appModel,dialogContainer:this.dialogContainer,themes:this.options.themes,viewModel:this.viewModel}),this.$profileMenu.html(this.profileMenu.$el),this.listenTo(this.profileMenu,"themeChange",function(){this.trigger("themeChange")}.bind(this)),this.listenTo(this.profileMenu,"login-history",function(){this.onLoginHistory()}.bind(this)),this.$profileMenu.hide()},getNewDashModel:function(e){for(var t,i=!0,n="My New Dashboard",o=1,a=(this.appModel.get("documentAPI")&&(e.notSavedYet=!0),t=this.appModel.get("documents"),n=e&&e.name?e.name:n);t.some(function(e){e=e.get("name");return(e=0===e.indexOf("Draft:")?e.substring(6).trim():e)===n})?(n=a+" ("+o+")",o+=1):i=!1,i;);return(e=$.extend(e||{},{name:n,creationDate:(new Date).toUTCString(),id:null,lastUpdateDate:null}))&&e.screens&&e.screens.each(function(e){e.set("id",QuickBase.Helpers.getGUID())}),new QuickBase.Document(e)},changeConnectionStatus:function(e){var t=this;e?(t.$connectionStatus.html('<span class="fa fa-info-circle"></span>Delta Client has reconnected'),t.$connectionStatus.css({color:"#03B103",display:"inline-block"}),_.delay(function(){t.$connectionStatus.hide()},7e3)):(t.$connectionStatus.html('<span class="fa fa-warning"></span>Delta Client connection has been lost, reconnecting...'),t.$connectionStatus.css({color:"#FF6262",display:"inline-block"}))},getSelectedDoc:function(){var e=this.viewModel.get("selectedDocumentId");return this.appModel.get("documents").get(e)},getViewstate:function(){var e=this.getSelectedDoc().get("viewState").getViewStateList(!0),t={};return _.each(e,function(e){t[e.path]=e.model.get("value")}),t},hideLoadingScreen:function(){this.$loadingScreen&&(this.$loadingScreen.fadeOut(function(){$(this).remove()}),this.$loadingScreen=null)},onDocumentChanged:function(e){this.$saveDash.addClass("changed")},onDocumentSaved:function(){this.$saveDash.removeClass("changed")},onExportDash:function(){var e=this.getSelectedDoc();DashboardListView.exportModel(e,e.get("name"),this.appModel.get("isLite")?"json":"xml")},onKeyDown:function(e){var t=!0;if(!$(".ui-dialog-content:visible").length){if((e.ctrlKey||e.metaKey)&&(QuickBase.DeltaClientLib.clientLoggedIn||this.appModel.get("isLite")))switch(e.keyCode){case 78:this.appModel.get("embedded")||this.onNewDash();break;case 79:this.appModel.get("embedded")||this.onOpenDash();break;case 83:this.onSaveDash();break;case 89:this.undoRedoManager.redoCommand();break;case 90:this.undoRedoManager.undoCommand();break;default:t=!1}else t=!1;t&&(e.preventDefault(),e.stopPropagation())}},onLoginHistory:function(){new LoginHistoryDialog({appModel:this.appModel})},onNewDash:function(e){var e=e&&e.force,t=this.getNewDashModel();t.set("mainMenuButton","Show"),this.saveNewDash(t,e)},onOpenDash:function(){this.openDashManagerWindow()},onResize:function(){this.documentSelector.onResize()},onSaveDash:function(){var e=this.getSelectedDoc(),i=this;e&&(Log.Info("save dash now!",e),i.$saveDash.addClass("saving"),e.saveNow(function(e){var t;i.$saveDash.removeClass("saving"),t=arguments[1]||"No error information returned from the server.",Log.Error("ERROR DIALOG: ",e,arguments),QuickBase.ErrorDialog.ShowError(t)},function(){i.$saveDash.removeClass("saving")}))},onSaveDashAs:function(){var e,t=this.getSelectedDoc();t&&(e=this.getNewDashModel(t.toJSON()),t.set("wasChanged",!1),this.saveNewDash(e,!0))},onSelectedDocumentIdChanged:function(){var e=this.viewModel.previous("selectedDocumentId"),t=this.viewModel.get("selectedDocumentId");e&&(e=this.appModel.get("documents").get(e))&&(this.stopListening(e,"postCommand",this.onDocumentChanged),this.stopListening(e,"documentSaved",this.onDocumentSaved),this.stopListening(e,"detail-downloaded",this.onDetailDownloaded),this.stopListening(e,"change:mainMenuButton",this.onMainMenuButtonDisplayChanged),this.onDocumentSaved()),t&&(e=this.appModel.get("documents").get(t))&&(this.listenTo(e,"postCommand",this.onDocumentChanged),this.listenTo(e,"documentSaved",this.onDocumentSaved),this.listenTo(e,"detail-downloaded",this.onDetailDownloaded),this.listenTo(e,"change:mainMenuButton",this.onMainMenuButtonDisplayChanged))},onDetailDownloaded:function(){var e=this.getSelectedDoc();this.updateMainMenuButtonDisplay(e.get("mainMenuButton"))},onMainMenuButtonDisplayChanged:function(e){this.updateMainMenuButtonDisplay(e.get("mainMenuButton"))},updateMainMenuButtonDisplay:function(e){!e||["Show","Hide (End User only)"].includes(e)?this.el.classList.remove("hideMainMenu"):this.el.classList.add("hideMainMenu")},openDashManagerWindow:function(){var e=this;this.manageDashWindow||(this.manageDashWindow=new ManageDashWindow({appModel:this.appModel,container:this.dialogContainer,viewModel:this.viewModel}),this.manageDashWindow.on("close",function(){e.manageDashWindow&&(e.manageDashWindow.off(),e.manageDashWindow=null)}))},saveNewDash:function(i,e){var n=this;new DashboardNamePrompt({saveAs:e,appModel:n.appModel,container:n.dialogContainer,model:i}).once("close",function(e){var t;e.create?(e.duplicate&&(t=n.getSelectedDoc(),i=n.getNewDashModel(t.toJSON()),t.set("wasChanged",!1)),i.set("name",e.name),n.$saveDash.addClass("saving"),i.saveNow(function(e,t){Log.Error("error creating dashboard",e),n.$saveDash.removeClass("saving"),MainToolbar.ShowError_unableToCreateNewDashboard(t),n.hideLoadingScreen()},function(e){n.$saveDash.removeClass("saving"),e.set("wasChanged",!1);var t=n.options.appModel;t.get("embedded")?(t=t.get("sendSignal"))&&t({type:"load",param:[e.id,!0]}):(n.appModel.get("documents").add(e,{at:0}),"FSBL"in window?window.open("#"+e.id):location.hash="#"+e.id),n.hideLoadingScreen()})):n.hideLoadingScreen()})},showLoadingScreen:function(e){var t="FSBL"in window?"#appContainer":"body",e=new LoadingScreen({loadingText:e});e.$el.appendTo($(t)),this.$loadingScreen=e.$el},toggleTitle:function(e){e=e?t("Show Tools panel"):t("Hide Tools panel");this.$el.prop("title",e)},updateStatus:function(e){}},{ShowError_unableToCreateNewDashboard:function(e){QuickBase.ErrorDialog.ShowError("Error: Unable to create new Dashboard")}}),LocalTools=function(){function l(){}return l.applyViewStateMethods=function(t,i){Object.getOwnPropertyNames(ViewStateMethods.prototype).forEach(function(e){i.prototype.hasOwnProperty(e)||Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(ViewStateMethods.prototype,e))})},l.diff=function(o,a){var s={};if(!Object.is(o,a))return a&&"object"==typeof a?(Object.keys(o||{}).concat(Object.keys(a||{})).forEach(function(n){var e;a[n]===o[n]||Object.is(o[n],a[n])||(s[n]=a[n]),Array.isArray(a[n])&&Array.isArray(o[n])?o[n].forEach(function(e,t){var i=l.diff(o[n][t],a[n][t]);void 0!==i&&(s[n][t]=i)}):"object"==typeof a[n]&&"object"==typeof o[n]&&void 0!==(e=l.diff(o[n],a[n]))&&(s[n]=e)}),s):a},l.moveDialogOnTop=function(e){},l.getValue=function(e,t){for(var i=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),n=e;i.length;){var o=i.shift();if(!(o in n))return;n=n[o]}return n},l.setValue=function(e,t,i){if(e&&t){for(var n=t.split("."),o=e;n.length-1;){var a=n.shift();_.isObject(o[a])||(o[a]={}),o=o[a]}o[n[0]]=i}},l.typecast=function(e,t){return"boolean"===t?!!e:"number"===t?+e:"integer"===t?Math.floor(+e):""+e},l}(),BaseEditor=function(){function e(e,t,i,n){this.canPaste=!1,this.schemaOptions=e.options||{},this.api=i,this.onChange=t,this.options=n||{},this.schema=e,this.el=document.createElement("div")}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.rendered&&this.setInputValue()},enumerable:!1,configurable:!0}),e.prototype.postRender=function(){this.rendered=!0,this.setInputValue()},e.prototype.preRender=function(){},e.prototype.remove=function(){$(this.el).remove()},e.prototype.render=function(){return this.el},e.prototype.startRender=function(){return this.preRender(),this.render(),this.postRender(),this.el},e.prototype.hideError=function(){QuickBase.ErrorTooltip.clear(this.errorTooltip)},e.prototype.onInput=function(e){this.hideError();var t=this.validate(e);t?this.showError(t):this.onChange(this.processInput(e))},e.prototype.onWatchedFieldChange=function(e,t){},e.prototype.processInput=function(e){var t=this.schema&&this.schema.type,i=e;switch(t){case"number":case"integer":_.isNaN(Number(e))||(i=Number(e),"integer"===t&&(i=Math.round(i)))}return this.sanitize(i)},e.prototype.sanitize=function(e){return e},e.prototype.setInputValue=function(){this.input&&(this.input.value=this.value)},e.prototype.showError=function(e){this.errorTooltip=QuickBase.ErrorTooltip.show(e,this.el,null)},e.prototype.validate=function(e){return""},e.collapsible=!1,e.labelled=!0,e}(),CheckBoxEditor=function(o){function e(e,t,i,n){return o.call(this,e,t,i,n)||this}return __extends(e,o),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=_.isUndefined(e)?void 0:!!e,this.rendered&&this.setInputValue()},enumerable:!1,configurable:!0}),e.prototype.render=function(){return this.input=document.createElement("input"),this.input.setAttribute("type","checkbox"),this.input.style.width="auto",this.el.append(this.input),this.el},e.prototype.postRender=function(){var t=this;o.prototype.postRender.call(this),this.input.setAttribute("draggable","true"),this.input.addEventListener("dragstart",function(e){e.preventDefault(),e.stopPropagation()}),this.input.addEventListener("keyup",function(e){" "!==e.key&&"Enter"!==e.key||t.input.click()}),rxjs.fromEvent(this.input,"change").pipe(rxjs.operators.map(function(e){return e.target.checked})).subscribe(this.onInput.bind(this))},e.prototype.setInputValue=function(){this.input&&(this.input.checked=this.value)},e}(BaseEditor),ClickableStringEditor=function(o){function e(e,t,i,n){return o.call(this,e,t,i,n)||this}return __extends(e,o),e.prototype.applyBaseState=function(){this.editorClear&&(this.editorClear.onclick=null),this.value?(this.el.classList.add("input-hasvalue"),this.editorClear&&(this.editorClear.onclick=this.onEditorClear.bind(this))):this.el.classList.remove("input-hasvalue")},e.prototype.render=function(){var e;return o.prototype.render.call(this),this.input=document.createElement("input"),this.input.setAttribute("readonly","true"),this.input.setAttribute("type","text"),this.el.classList.add("dashboards-control"),this.options.watermark&&(e=document.createElement("i"),this.input.classList.add("wa"),e.className="fa fa-fw watermark fa-"+this.options.watermark,this.el.append(e)),this.options.eraser&&(this.el.classList.add("clickable-control"),this.editorClear=document.createElement("i"),this.editorClear.className="fa fa-fw watermark fa-eraser input-clear",this.el.append(this.editorClear)),this.schema.data&&this.input.setAttribute("data",this.schema.data),this.el.append(this.input),this.el},e.prototype.postRender=function(){var t=this;o.prototype.postRender.call(this),this.input.setAttribute("draggable","true"),this.input.addEventListener("dragstart",function(e){e.preventDefault(),e.stopPropagation()}),this.options.click&&(this.input.addEventListener("click",this.options.click.bind(this)),this.input.addEventListener("keydown",function(e){" "!==e.key&&"Enter"!==e.key||t.options.click(e,t)})),this.options.onFocusOrBlur&&(this.input.addEventListener("focus",this.options.onFocusOrBlur.bind(this)),this.input.addEventListener("blur",this.options.onFocusOrBlur.bind(this)))},e.prototype.onEditorClear=function(){this.applyBaseState(),this.onInput("")},e.prototype.sanitize=function(e){return e="string"==typeof e?DOMPurify.sanitize(e,{ADD_ATTR:["target"]}):e},e.prototype.setInputValue=function(){this.options.eraser&&this.applyBaseState(),this.input.value=this.value},e}(BaseEditor),ViewStateMethods=function(){function e(){}return e.prototype.applyControlState=function(){this.rendered?(this.viewStateApply.onclick=null,this.viewStateClear.onclick=null,this.viewStateIcon.onclick=null,this.viewStateInput.onclick=null,this.viewStateInput.onkeydown=null,this.isViewState?(this.el.classList.add("is-viewstate"),this.el.parentElement&&this.el.parentElement.classList.add("is-viewstate-active"),this.viewStateClear.onclick=this.onViewStateClear.bind(this),this.viewStateIcon.onclick=this.onViewStateClick.bind(this),this.viewStateInput.onclick=this.onViewStateClick.bind(this),this.viewStateInput.onkeydown=this.onViewStateKeyPress.bind(this),this.viewStateInput.removeAttribute("tabindex")):(this.el.classList.remove("is-viewstate"),this.el.parentElement&&this.el.parentElement.classList.remove("is-viewstate-active"),this.viewStateApply.onclick=this.onViewStateApply.bind(this),this.viewStateInput.setAttribute("tabindex","-1")),this.statePending=!1):this.statePending=!0},e.prototype.determineType=function(e){return e instanceof Backbone.Model?e.get("_viewType")?"viewstate":e.get("_dataType")?"datasource":void 0:"none"},e.prototype.formatValue=function(e){return e},e.prototype.getModel=function(){return this.model},e.prototype.getValue=function(){return this.isViewState?this.model||this.formatValue(""):this.formatValue(this._value)},e.prototype.remove=function(){this.rendered&&(this.viewStateApply.onclick=null,this.viewStateClear.onclick=null,this.viewStateIcon.onclick=null,this.viewStateInput.onclick=null)},e.prototype.render=function(){return this.cache={text:"",viewState:""},this.viewStateApply=document.createElement("i"),this.viewStateApply.className="fa fa-fw watermark fa-eye viewstate-apply",this.viewStateClear=document.createElement("i"),this.viewStateClear.className="fa fa-fw watermark fa-eraser viewstate-active viewstate-clear",this.viewStateIcon=document.createElement("i"),this.viewStateIcon.className="fa fa-fw watermark fa-eye viewstate-active viewstate-icon",this.viewStateInput=document.createElement("input"),this.viewStateInput.className="wa viewstate-input",this.viewStateInput.setAttribute("type","text"),this.viewStateInput.setAttribute("tabindex","-1"),this.viewStateInput.readOnly=!0,this.el.append(this.viewStateApply),this.el.append(this.viewStateClear),this.el.append(this.viewStateIcon),this.el.append(this.viewStateInput),this.el.classList.add("dashboards-control"),this.el.classList.add("viewstate-control"),this.isViewState=this.isViewState||!1,this.applyControlState(),this.el},e.prototype.setInputValue=function(){this.statePending&&this.applyControlState(),this.isViewState?this.viewStateInput.value=this._value?this._value.path:"":this.viewStateInput&&(this.viewStateInput.value=_.get(this.cache,"text")||"")},e.prototype.setModel=function(e){var t=e?e.path:"";this.model=e,this._value=null,this.isViewState||(this.isViewState=!0,this.applyControlState()),this.rendered&&t!==this.input.value&&this.setInputValue()},e.prototype.setValue=function(e){var t;this.ignoreModelChanges||("viewstate"===this.determineType(e)?(this.ignoreModelChanges=!0,this.setModel(e),t=e,this.ignoreModelChanges=!1,this._value=t,t=!1===this.isViewState,this.isViewState=!0):(this._value=e,t=!(this.model=null)===this.isViewState,this.isViewState=!1),this.rendered&&this.setInputValue()),t&&this.applyControlState()},e.prototype.onViewStateApply=function(){this.cache.text=this._value,this.onViewStateClick()},e.prototype.onViewStateClear=function(){this.isViewState=!1,this.model=null,this.viewStateInput.value="",this.onInput(this.cache.text),this.applyControlState()},e.prototype.onViewStateKeyPress=function(e){32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),this.onViewStateClick())},e.prototype.onViewStateClick=function(){var t=this;this.api.showViewStateDialog(this.model?this.model.path:"",function(e){t.isViewState=!0,t.onInput(e),t.applyControlState()})},e}(),ColSelectorEditor=function(a){function s(e,t,i,n){var o=this;return(o=a.call(this,e,t,i,n)||this).watchedValues={},LocalTools.applyViewStateMethods(o,s),o.columnProperty=e&&e.data?e.data:"possible_columns",o.isUserDefined=!n||!1!==n.isUserDefined,o.dropdownType=(null==(t=null==e?void 0:e.options)?void 0:t.dropdownType)||"column",o.dropdownMessage=(null==(i=null==e?void 0:e.options)?void 0:i.dropdownMessage)||"Please select a column",o}return __extends(s,a),Object.defineProperty(s.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),s.prototype.preRender=function(){var e=this;this.options.watermark="pencil",this.options.click=function(){e.api.showColSelectorDialog(e.watchedValues[e.columnProperty],e.value,e.el,e.isUserDefined,e.dropdownType,e.dropdownMessage,e.onInput.bind(e))}},s.prototype.render=function(){return a.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},s.prototype.onWatchedFieldChange=function(e,t){this.watchedValues[t]=e},s.prototype.setInputValue=function(){a.prototype.setInputValue.call(this),ViewStateMethods.prototype.setInputValue.apply(this)},s}(ClickableStringEditor),CSSEditor=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.preRender=function(){var e=this;this.schemaOptions.format="textarea",this.options.click=function(){e.api.showCssDialog(e.value,e.onInput.bind(e))}},t.prototype.sanitize=function(e){e=(e=e).replace(/>/g,",dash-ancestor");return DOMPurify.sanitize(e).replace(/,dash-ancestor/g,">")},t}(ClickableStringEditor),DataSourceEditor=function(o){function e(e,t,i,n){return o.call(this,e,t,i,n)||this}return __extends(e,o),Object.defineProperty(e.prototype,"value",{get:function(){if(void 0!==this._value)return this.model||""},set:function(e){!e&&this._value?(this._value="",this.model=""):(this._value,this._value=e,this.setModel(e)),this.rendered&&this.setInputValue()},enumerable:!1,configurable:!0}),e.prototype.onClick=function(){this.api.showDataDialog(this.model instanceof QuickBase.DocumentDataModel?this.model.path:"",_.bind(function(e){this.onInput(e)},this))},e.prototype.getModel=function(){return this.model},e.prototype.preRender=function(){this.options.watermark="database",this.options.eraser=!0,this.options.onFocusOrBlur=this.onFocusOrBlur.bind(this),this.options.click=this.onClick.bind(this)},e.prototype.setModel=function(e){this.model=e},e.prototype.onFocusOrBlur=function(e){var t=this;this.input.onkeyup=null,"focus"===e.type&&(this.input.onkeyup=_.bind(function(e){32!==e.keyCode&&13!==e.keyCode||t.onClick()},this))},e.prototype.onEditorClear=function(){this.applyBaseState(),this.onInput(null)},e.prototype.setInputValue=function(){this.applyBaseState(),this.value instanceof QuickBase.DocumentDataModel?this.input.value=this.value.path||"":this.input.value=this.value||""},e}(ClickableStringEditor),DataConnectionEditor=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.preRender=function(){var t=this;this.options.watermark="server",this.options.eraser=!0,this.options.click=function(){t.api.showDataConnectionDialog(t.value,function(e){t.onInput(e)})}},t}(ClickableStringEditor),DefaultEditor=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(BaseEditor),DropdownEditor=function(o){function e(e,t,i,n){e=o.call(this,e,t,i,n)||this;return e.enumDisplay=[],e.enumOptions=[],e.enumValues=[],e.schema.enumSource&&(e.defaultPending=!0),e}return __extends(e,o),e.prototype.preRender=function(){o.prototype.preRender.call(this),this.getOptions()},e.prototype.render=function(){return this.input=document.createElement("select"),this.el.append(this.input),this.renderOptions(),this.el.classList.add("select2-wrapper"),this.select2=$(this.input).select2({minimumResultsForSearch:10,theme:"dashboards-properties"}),this.el},e.prototype.postRender=function(){o.prototype.postRender.call(this),rxjs.fromEvent(this.select2,"select2:select").pipe(rxjs.operators.map(function(e){return e.params.data.id})).subscribe(this.onInput.bind(this))},e.prototype.onWatchedFieldChange=function(e,t){this.getOptions(e),this.rendered&&this.renderOptions(),this.defaultPending&&(this.defaultPending=!1,-1!==this.enumValues.indexOf(this.getStringValue())?this.setInputValue():void 0!==this.enumValues[0]&&this.onChange(this.enumValues[0]))},e.prototype.setInputValue=function(){this.input&&(this.input.value=this.value||"",this.select2.val(this.value).trigger("change"))},e.prototype.getOptions=function(e){var i,n=this,o=this.schema.options&&this.schema.options.enum_titles||[];this.enumDisplay=[],this.enumOptions=[],this.enumValues=[],e||this.schema.enum?(e=e||this.schema.enum,Array.isArray(e)||(e=[]),i=_.isObject(this.schema.enumSource),e.forEach(function(e,t){n.enumDisplay[t]=i&&_.isObject(e)?e[n.schema.enumSource.title]:""+(o[t]||e),n.enumOptions[t]=i&&_.isObject(e)?e[n.schema.enumSource.value]:""+e,n.enumValues[t]=LocalTools.typecast(i&&_.isObject(e)?e[n.schema.enumSource.value]:""+e,n.schema.type)})):this.schema.enumSource&&(this.enumSource=[],"string"==typeof this.schema.enumSource?this.enumSource=[{source:this.schema.enumSource}]:Array.isArray(this.schema.enumSource)&&this.schema.enumSource.forEach(function(e,t){n.enumSource[t]=e}))},e.prototype.getStringValue=function(){return this.value?this.value.toString():""},e.prototype.renderOptions=function(){var n=this;this.input.options.length=0,this.enumOptions.forEach(function(e,t){var i=document.createElement("option");i.value=e,i.text=n.enumDisplay[t],i.value.toString()===n.getStringValue()&&(i.selected=!0),n.input.appendChild(i)}),$(this.input).trigger("change")},e}(BaseEditor),Gradient=function(o){function e(e,t,i,n){return o.call(this,e,t,i,n)||this}return __extends(e,o),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.rendered&&this.setInputValue(),this.refreshValue()},enumerable:!1,configurable:!0}),e.prototype.preRender=function(){var t=this;this.options.watermark="tint",this.options.eraser=!1,this.options.click=function(e){t.api.showColorPickerDialog(e.target,t)}},e.prototype.render=function(){var t=this,e=(o.prototype.render.call(this),!1),i=!1,n=this.value||this.schema.default||"#ffffff";return this.schema.options&&(e=this.schema.options.gradient||!1,i=this.schema.options.noColor||!1),this.input.setAttribute("gradient",String(e)),this.input.setAttribute("noColor",String(i)),this.input.setAttribute("class","gradient"),$(this.input).css("background",n),this.input.addEventListener("focusin",_.bind(function(e){t.el.classList.add("has-focus")},this)),this.input.addEventListener("blur",_.bind(function(e){t.el.classList.remove("has-focus")},this)),this.el},e.prototype.refreshValue=function(){""===this.value?($(this.input).css("background","#ffffff"),0===$(this.input).next(".fa-times").length&&$(this.input).after('<i class="fa fa-times" style="color:red;" />')):$(this.input).css("background",this.value).next(".fa-times").remove()},e}(ClickableStringEditor),GradientViewState=function(a){function o(e,t,i,n){e=a.call(this,e,t,i,n)||this;return LocalTools.applyViewStateMethods(e,o),e}return __extends(o,a),Object.defineProperty(o.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),o.prototype.onClick=function(e){this.api.showColorPickerDialog(e,this)},o.prototype.preRender=function(){var t=this;this.options.click=function(e){t.onClick(e.target)}},o.prototype.render=function(){var t=this,e=(a.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),!1),i=!1,n=this.schema.default||"#ffffff",o=document.createElement("i");return o.className="fa fa-fw watermark fa-tint",this.el.append(o),this.schema.options&&(e=this.schema.options.gradient||!1,i=this.schema.options.noColor||!1),this.input.setAttribute("gradient",String(e)),this.input.setAttribute("noColor",String(i)),this.input.setAttribute("class","gradient gradient-viewstate"),$(this.input).css("background",n),this.input.addEventListener("keydown",function(e){32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),e.stopPropagation(),t.onClick(e.target))}),this.input.addEventListener("focusin",_.bind(function(e){t.el.classList.add("has-focus")},this)),this.input.addEventListener("blur",_.bind(function(e){t.el.classList.remove("has-focus")},this)),this.el},o.prototype.refreshValue=function(){var e,t,i=this;this.input&&void 0!==this.value&&!this.isViewState&&(e=this.value&&this.value.get instanceof Function?this.value.get("value"):this.value,_.isString(e)&&0===e.indexOf("#")?(t=QuickBase.Tools.calculateFontContrast(e),$(this.input).css({background:e,color:t}).next(".fa-times").remove()):($(this.input).css("background","#ffffff"),0===$(this.input).next(".fa-times").length&&($(this.input).after('<i class="fa fa-times" style="color:red;" />'),$(this.input).next(".fa-times").on("click",function(){i.onClick(i.input)}))))},o.prototype.setInputValue=function(){var e;ViewStateMethods.prototype.setInputValue.apply(this),this.input&&void 0!==this.input.value&&(e=this.value,this.value instanceof Backbone.Model&&(e=this.value.get("value")),this.input.value=e),this.refreshValue()},o}(ClickableStringEditor),HTMLEditor=function(o){function a(e,t,i,n){e=o.call(this,e,t,i,n)||this;return LocalTools.applyViewStateMethods(e,a),e}return __extends(a,o),Object.defineProperty(a.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),a.prototype.preRender=function(){var t=this;this.schemaOptions.format="textarea",this.options.eraser=!1,this.options.click=function(){t.api.showHtmlDialog(function(e){t.onInput(e)})}},a.prototype.render=function(){return o.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},a.prototype.sanitize=function(e){return e},a.prototype.setInputValue=function(){o.prototype.setInputValue.call(this),ViewStateMethods.prototype.setInputValue.apply(this)},a}(ClickableStringEditor),HandlebarEditor=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.preRender=function(){var t=this,e=this.schema&&this.schema.options;this.schemaOptions.format="textarea",this.options.eraser=!1,this.options.click=function(){t.api.showTemplateDialog(t.schema,t.value,e,function(e){t.onInput(e)})}},t.prototype.sanitize=function(e){return e},t}(ClickableStringEditor),IconEditor=function(o){function a(e,t,i,n){e=o.call(this,e,t,i,n)||this;return LocalTools.applyViewStateMethods(e,a),e}return __extends(a,o),Object.defineProperty(a.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),a.prototype.preRender=function(){var t=this;this.options.watermark="hand-pointer",this.options.click=function(){t.api.showIconDropDownDialog("fa"===t.schema.iconTypes,function(e){t.onInput(e)})}},a.prototype.render=function(){return o.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},a.prototype.setInputValue=function(){o.prototype.setInputValue.call(this),ViewStateMethods.prototype.setInputValue.apply(this)},a}(ClickableStringEditor),JSONEditor=function(o){function a(e,t,i,n){e=o.call(this,e,t,i,n)||this;return LocalTools.applyViewStateMethods(e,a),e}return __extends(a,o),Object.defineProperty(a.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),a.prototype.preRender=function(){var t=this;this.schemaOptions.format="json",this.options.click=function(){t.api.showJsonDialog(t,t.value,function(e){t.onInput(e)})}},a.prototype.onClick=function(){var t=this;this.api.showJsonDialog(this,this.value,function(e){t.onInput(e)})},a.prototype.render=function(){return o.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},a.prototype.sanitize=function(e){return e},a.prototype.setInputValue=function(){o.prototype.setInputValue.call(this),ViewStateMethods.prototype.setInputValue.apply(this)},a}(ClickableStringEditor),NavEditor=function(o){function a(e,t,i,n){e=o.call(this,e,t,i,n)||this;return e.enumDisplay=[],e.enumOptions=[],e.enumValues=[],LocalTools.applyViewStateMethods(e,a),e}return __extends(a,o),Object.defineProperty(a.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),a.prototype.preRender=function(){var t=this;this.dashCollection=new Backbone.Collection,this.screenCollection=new Backbone.Collection,this.dashCollection.comparator="title",this.dashOptions={options:[],titles:[]},this.screenOptions={options:[],titles:[]},t.dashCollection.add(new Backbone.Model({title:"<none>",value:"<none>"})),t.dashCollection.add(new Backbone.Model({title:"<this>",value:"<this>"})),this.api.appModel.get("documents").each(function(e){t.dashCollection.add(new Backbone.Model({title:e.get("name"),value:e.id}))})},a.prototype.render=function(){o.prototype.render.call(this);var e=document.createElement("div"),t=document.createElement("div");return e.className="dash-input",t.className="screen-input",this.input=this.dashInput=document.createElement("select"),this.screenInput=document.createElement("select"),_.isObject(this.value)||(this.value={}),this.getSelectOptions(this.dashOptions,this.dashCollection),this.setSelectOptions(this.dashInput,this.dashOptions.options,this.dashOptions.titles),$(this.dashInput).trigger("change"),this.value.dashboard||(this.value.dashboard=this.dashOptions.options[0]),this.getScreens(this.value.dashboard.id),this.value.screen||(this.value.screen=this.screenOptions.options[0]),e.appendChild(this.dashInput),t.appendChild(this.screenInput),this.el.appendChild(e),this.el.appendChild(t),this.dashSelect2=this.setupSelect2(this.dashInput),this.screenSelect2=this.setupSelect2(this.screenInput),ViewStateMethods.prototype.render.apply(this),this.el},a.prototype.postRender=function(){var n=this;this.rendered=!0,this.screenCollection.on("reset",function(){var e;n.getSelectOptions(n.screenOptions,n.screenCollection),n.setSelectOptions(n.screenInput,n.screenOptions.options,n.screenOptions.titles),$(n.screenInput).trigger("change"),n.value?n.value.screen?e=n.value.screen:(e=n.screenOptions.options[0],n.value.screen=e):e=n.screenOptions.options[0],$(n.screenInput).val(e).trigger("change")}),this.dashSelect2.on("select2:select",function(e){var e=e.params.data.id,t=Object.assign({},n.value),i=t.screen!==e;t.dashboard=e,i&&n.onInput(t)}),this.screenSelect2.on("select2:select",function(e){var e=e.params.data.id,t=Object.assign({},n.value),i=t.screen!==e;t.screen=e,i&&n.onInput(t)}),ViewStateMethods.prototype.applyControlState.apply(this),this.setInputValue()},a.prototype.getDefault=function(){return{dashboard:"<none>",screen:"<none>"}},a.prototype.setInputValue=function(){var e,t,i,n;this.isViewState?ViewStateMethods.prototype.setInputValue.apply(this):(t=this.options.linked_oneof_property,n=e=void 0,n=(i=this.value)&&"<none>"!==i?(e=this.parseId(i.dashboard),this.parseId(i.screen)):e="<none>",(!_.isObject(this.value)||this.value instanceof Backbone.Model)&&(this.value={}),t&&_.isObject(i)&&i[t.property]&&(this.value[t.property]=i[t.property]),this.value._dashboardsType="navigation",this.setValueDash(e),this.setValueScreen(n))},a.prototype.getScreens=function(e){function t(e){0===e.length&&e.push({title:"<none>",value:"<none>"}),i.screenCollection.reset(e)}var i=this,n=!0,o=("<this>"===e&&(n=!1,e=this.api.viewModel.get("selectedDocumentId")),this.api.appModel.get("documents").get(e));o&&(e===this.api.viewModel.get("selectedDocumentId")?t(_.map(o.get("screens").models,function(e){return{title:e.get("name"),value:n?e.get("id"):e.get("name")}})):_.isEmpty(o.get("screenDetails"))?o.fetch({success:function(e){t(_.map(e.get("screenDetails"),function(e){return{title:e.label,value:e.value}}))}}):t(_.map(o.get("screenDetails"),function(e){return{title:e.label,value:e.value}})))},a.prototype.getSelectOptions=function(t,e){t.options=[],t.titles=[],e.each(function(e){t.options.push(e.get("value")),t.titles.push(e.get("title"))})},a.prototype.parseId=function(e){return e=_.isObject(e)&&e.id?e.id:e},a.prototype.setSelectOptions=function(n,e,o){n.options.length=0,e.forEach(function(e,t){var i=document.createElement("option");i.value=e,i.text=o[t],n.appendChild(i)}),$(n).trigger("change")},a.prototype.setValueDash=function(e){var t=Object.assign({},this.value),i=t.dashboard===e;(t.dashboard=e)!==$(this.dashInput).val()&&$(this.dashInput).val(e).trigger("change"),i&&this.getScreens(e)},a.prototype.setValueScreen=function(e){(Object.assign({},this.value).screen=e)!==$(this.screenInput).val()&&$(this.screenInput).val(e).trigger("change")},a.prototype.setupSelect2=function(e){e=$(e).select2({minimumResultsForSearch:10,theme:"dashboards-properties"});return e.addClass("property-editor-select"),e},a}(BaseEditor),StringEditor=function(o){function e(e,t,i,n){e=o.call(this,e,t,i,n)||this;return e.inputType="text",e}return __extends(e,o),e.prototype.render=function(){return this.input=document.createElement("input"),this.input.setAttribute("type",this.inputType),this.options.readonly&&this.input.setAttribute("readonly","true"),this.el.append(this.input),this.el},e.prototype.postRender=function(){o.prototype.postRender.call(this),rxjs.fromEvent(this.input,"change").pipe(rxjs.operators.map(function(e){return e.target.value})).subscribe(this.onInput.bind(this)),this.input.setAttribute("draggable","true"),this.input.addEventListener("dragstart",function(e){e.preventDefault(),e.stopPropagation()})},e.prototype.sanitize=function(e){var t;return"string"==typeof e&&(t=DOMPurify.sanitize(e,{ADD_ATTR:["target"]}),e=(new DOMParser).parseFromString("<!doctype html><body>"+t,"text/html").body.textContent),e},e.prototype.setInputValue=function(){this.input&&void 0!==this.input.value&&(this.input.value=void 0!==this.value?this.value:"")},e}(BaseEditor),NumberEditor=function(o){function e(e,t,i,n){e=o.call(this,e,t,i,n)||this;return e.inputType="number",e}return __extends(e,o),e}(StringEditor),RegExpEditor=function(o){function e(e,t,i,n){e=o.call(this,e,t,i,n)||this;return e.inputType="text",e}return __extends(e,o),e.prototype.sanitize=function(e){var t;return 0!==e.indexOf("/")&&"string"==typeof e&&""!==e&&(t=DOMPurify.sanitize(e,{ADD_ATTR:["target"]}),e=(new DOMParser).parseFromString("<!doctype html><body>"+t,"text/html").body.textContent,this.showError("Invalid regular expression")),e},e}(StringEditor),ViewStateEditor=function(o){function e(e,t,i,n){return o.call(this,e,t,i,n)||this}return __extends(e,o),Object.defineProperty(e.prototype,"value",{get:function(){return this.model||""},set:function(e){!e&&this._value?(this._value="",this.model=""):(this._value,this._value=e,this.setModel(e)),this.rendered&&this.setInputValue()},enumerable:!1,configurable:!0}),e.prototype.onClick=function(){this.api.showViewStateDialog(this.model instanceof QuickBase.DocumentViewModel?this.model.path:"",_.bind(function(e){this.onInput(e)},this))},e.prototype.getModel=function(){return this.model},e.prototype.preRender=function(){this.options.watermark="eye",this.options.eraser=!0,this.options.onFocusOrBlur=this.onFocusOrBlur.bind(this),this.options.click=this.onClick.bind(this)},e.prototype.setModel=function(e){this.model=e},e.prototype.onFocusOrBlur=function(e){var t=this;this.input.onkeyup=null,"focus"===e.type&&(this.input.onkeyup=_.bind(function(e){32!==e.keyCode&&13!==e.keyCode||t.onClick()},this))},e.prototype.setInputValue=function(){this.applyBaseState(),this.input.value=this.value&&this.value.path||""},e}(ClickableStringEditor),CheckBoxViewStateEditor=function(o){function a(e,t,i,n){e=o.call(this,e,t,i,n)||this;return LocalTools.applyViewStateMethods(e,a),e}return __extends(a,o),Object.defineProperty(a.prototype,"value",{get:function(){return this._value},set:function(e){e instanceof Backbone.Model||(e=!!e),ViewStateMethods.prototype.setValue.call(this,e)},enumerable:!1,configurable:!0}),a.prototype.render=function(){return o.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},a.prototype.setInputValue=function(){ViewStateMethods.prototype.setInputValue.apply(this),o.prototype.setInputValue.call(this)},a}(CheckBoxEditor),DropDownViewStateEditor=function(o){function a(e,t,i,n){e=o.call(this,e,t,i,n)||this;return LocalTools.applyViewStateMethods(e,a),e}return __extends(a,o),Object.defineProperty(a.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),a.prototype.render=function(){return o.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},a.prototype.setInputValue=function(){ViewStateMethods.prototype.setInputValue.apply(this),o.prototype.setInputValue.call(this)},a.prototype.getStringValue=function(){var e=this.value||"";return(e=e instanceof Backbone.Model?e.get("value"):e).toString()},a.prototype.onWatchedFieldChange=function(e,t){this.isViewState||o.prototype.onWatchedFieldChange.call(this,e,t)},a}(DropdownEditor),StringViewStateEditor=function(o){function a(e,t,i,n){e=o.call(this,e,t,i,n)||this;return LocalTools.applyViewStateMethods(e,a),e}return __extends(a,o),Object.defineProperty(a.prototype,"value",{get:function(){return this._value},set:function(e){ViewStateMethods.prototype.setValue.apply(this,arguments)},enumerable:!1,configurable:!0}),a.prototype.onClick=function(){this.api.showViewStateDialog(this.model instanceof QuickBase.DocumentViewModel?this.model.path:"",_.bind(function(e){this.onInput(e)},this))},a.prototype.render=function(){return o.prototype.render.call(this),ViewStateMethods.prototype.render.apply(this),this.el},a.prototype.setInputValue=function(){ViewStateMethods.prototype.setInputValue.apply(this),o.prototype.setInputValue.call(this)},a}(StringEditor),NumberViewStateEditor=function(o){function e(e,t,i,n){e=o.call(this,e,t,i,n)||this;return e.maxWatchValue={},e.minWatchValue={},e.inputType="number",e}return __extends(e,o),e.prototype.postRender=function(){o.prototype.postRender.call(this),this.input.setAttribute("title","")},e.prototype.validate=function(e){var t;if(this.input.value){if(null!=(t=null==(t=this.schema)?void 0:t.watch)&&t.hasOwnProperty("section_max")&&this.maxWatchValue<this.input.value)return"Number must be less than "+this.maxWatchValue;if(null!=(t=null==(t=this.schema)?void 0:t.watch)&&t.hasOwnProperty("section_min")&&this.input.value<this.minWatchValue)return"Number must be greater than "+this.minWatchValue}else if(null!==this.schema.min&&e<this.schema.min)return"Number must be greater than "+this.schema.min;return this.schema.max&&e>this.schema.max?"Number must be less than "+this.schema.max:""},e.prototype.onInput=function(e){o.prototype.onInput.call(this,e=""===e?null:e)},e.prototype.onWatchedFieldChange=function(e,t){"section_max"===t&&(this.maxWatchValue=e),"section_min"===t&&(this.minWatchValue=e)},e}(StringViewStateEditor),STANDARD={boolean:CheckBoxEditor,booleanViewState:CheckBoxViewStateEditor,customDropdown:ColSelectorEditor,css:CSSEditor,data:DataSourceEditor,dataConnection:DataConnectionEditor,gradient:Gradient,gradientViewState:GradientViewState,default:DefaultEditor,dropdown:DropdownEditor,dropdownViewState:DropDownViewStateEditor,handlebar:HandlebarEditor,html:HTMLEditor,icon:IconEditor,json:JSONEditor,legendTemplate:HandlebarEditor,nav:NavEditor,number:NumberEditor,numberViewState:NumberViewStateEditor,integer:NumberEditor,integerViewState:NumberViewStateEditor,regex:RegExpEditor,string:StringEditor,stringViewState:StringViewStateEditor,tooltip:HandlebarEditor,tooltipTemplate:HandlebarEditor,viewstate:ViewStateEditor},VIEWSTATE={boolean:CheckBoxViewStateEditor,gradient:GradientViewState,dropdown:DropDownViewStateEditor,number:NumberViewStateEditor,integer:NumberViewStateEditor,string:StringViewStateEditor},Editors=function(){function i(){}return i.get=function(e){var t=i.EDITORS;return e.enum||e.enumSource?t.dropdown:t[e.type]||t.default},i.setViewStateEditors=function(e){i.EDITORS=(i.viewStateEditors=e)?Object.assign({},STANDARD,VIEWSTATE):STANDARD},i.viewStateEditors=!0,i}(),ItemContainer=([Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),i=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;i.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(i)}})}),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),i=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;i.appendChild(t?e:document.createTextNode(String(e)))}),this.insertBefore(i,this.firstChild)}})}),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},function(){function e(e,t,i,n){this.el=document.createElement("div"),this.el.classList.add("container"),this.options=n||{},this.root=i,this._path=t,this.watchSubscriptions={},this.defaultExpanded=!e.options||!e.options.collapsed;i=this.defaultExpanded;_.isEmpty(n.expanded)&&!_.isBoolean(n.expanded)||(i=n.expanded),this.expanded=_.isObject(i)?i:{_self:i},this.schema=e,this.schemaOptions=e.options||{},this.labelled=!!_.isUndefined(n.labelled)||n.labelled,this.updatePaths(),this.root.register(this)}return Object.defineProperty(e.prototype,"expanded",{get:function(){return this._expanded},set:function(e){this._expanded=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._path},set:function(e){this._path!==e&&(this._path=e,this.updatePaths(),this.watch())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this._schema},set:function(e){var t=this._schema;this._schema=e,this.value=this.getDefault(),_.isEqual(this._schema,t)||((t=this.rendered&&!_.isEqual(_.omit(t,["hidden","options.hidden"]),_.omit(e,["hidden","options.hidden"])))&&this.editor&&this.editor.remove(),this.editor=this.initEditor(e),t&&this.el.append(this.renderEditor()),this._schema.type&&this.el.setAttribute("data-type",this.schema.type)),this.rendered&&(this.isHidden()?this.hide():this.unhide())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.editor&&(this.editor.value=e),this.emit(),this.determineEmpty(e)&&"data"!==this.schema.type?this.el.classList.add("undefined"):this.el.classList.remove("undefined")},enumerable:!1,configurable:!0}),e.prototype.addListener=function(e){return this.listener||(this.listener=new rxjs.BehaviorSubject(this.value)),this.listener.subscribe(e)},e.prototype.expand=function(e){var t=_.isBoolean(e)?this.path+"._self":this.path;this.root.expand(e,t)},e.prototype.filter=function(e){if(e){if(new Fuse([this.getTitle()],{threshold:.4}).search(e).length)return this.el.classList.remove("filtered"),this.label&&(this.label.innerHTML=this.highlightText(this.getTitle(),e)),!0;this.el.classList.add("filtered")}else this.label&&(this.label.innerHTML=this.label.innerText),this.el.classList.remove("filtered")},e.prototype.getDefault=function(){if(void 0!==this.schema.default)return this.schema.default;if(this.schema.enum)return this.schema.enum[0];var e=this.schema.type||this.schema.oneOf;if("string"==typeof(e=(e=(e=e&&Array.isArray(e)?e[0]:e)&&"object"==typeof e?e.type:e)&&Array.isArray(e)?e[0]:e)){if("number"===e)return 0;if("boolean"===e)return!1;if("integer"===e)return 0;if("string"===e||"customDropdown"===e)return"";if("object"===e)return{};if("array"===e||"actions"===e||"popups"===e)return[]}return null},e.prototype.hide=function(){this.el.classList.add("hidden")},e.prototype.initEditor=function(e,t){var i=this,e=new(Editors.get(e))(e,function(e){i.setValueByPath(e,i.path)},this.root.api,t||{});return e.value=this.value,e},e.prototype.onClick=function(){this.editor&&this.editor.onClick&&this.editor.onClick()},e.prototype.paste=function(e){for(var t,i=_.get(this,"schema.properties")||_.get(this,"schema.items"),i=Object.keys(i),n=Object.keys(e),o=this.value,a=_.intersection(i,n).filter(function(e){return"ComponentName"!==e}),s=0;s<a.length;s++)o[a[s]]!==e[a[s]]&&("advanced"===a[s]&&(t=e[a[s]].substring(e[a[s]].indexOf("data-widgetid=")+15,e[a[s]].indexOf("data-widgetid=")+51),e[a[s]]=e[a[s]].split(t).join(this.root.api.getWidget().id)),o[a[s]]=e[a[s]]);this.setValueByPath(o,this.path)},e.prototype.postRender=function(){this.rendered=!0,this.updatePaths(),this.watch()},e.prototype.remove=function(){var t=this;this.editor&&this.editor.remove(),this.el.innerHTML="",this.schema.watch&&Object.keys(this.schema.watch).forEach(function(e){t.watchSubscriptions[e]&&(t.watchSubscriptions[e].unsubscribe(),delete t.watchSubscriptions[e])}),this.listener&&this.listener.unsubscribe(),this.rendered=!1,this.expand(null)},e.prototype.render=function(){return this.schema.headerTemplate&&(this.headerTemplate=Handlebars.compile(this.schema.headerTemplate)),this.schema&&this.schema.options&&this.schema.options.custom_class_name&&this.el.classList.add(this.schema.options.custom_class_name),this.editor&&(this.labelled&&void 0!==this.schema.type&&(this.label=this.renderLabel(),this.el.append(this.label)),this.el.append(this.renderEditor())),this.el},e.prototype.renderLabel=function(){var e=document.createElement("label"),t=this.getLabelText(),t=(e.textContent=t,e.className="label",this.getTooltipText()),t=(e.setAttribute("title",t),e.setAttribute("for",this.path),_.uniqueId("label"));return e.setAttribute("id",t),this.labelId=t,e},e.prototype.unhide=function(){this.el.classList.remove("hidden")},e.prototype.updatePaths=function(){var t,e;this.el.setAttribute("data-schemapath",this.path),this.key=this.path.split(".").pop(),this.path&&this.editor&&this.editor.input&&(t="",_.each(this.path.split("."),function(e){t+="root"!==e?"["+e+"]":e}),$(this.editor.input).attr("name",t),"SELECT"===this.editor.input.tagName?(e=this.editor.el.getElementsByClassName("select2-selection")[0],$(e).attr("aria-labelledby",this.labelId)):$(this.editor.input).attr("id",this.path))},e.prototype.determineEmpty=function(e){return void 0===e},e.prototype.emit=function(){this.listener&&this.listener.next(this.value)},e.prototype.getTitle=function(){return this.schema.title||this.key},e.prototype.highlightText=function(e,t){t=new RegExp("("+t+")","gi");return e.replace(t,"<mark>$1</mark>")},e.prototype.isHidden=function(){return _.get(this.schema,"hidden")||_.get(this.schema,"options.hidden")},e.prototype.renderEditor=function(){var e=this.editor.startRender();return e.classList.add("editor"),e},e.prototype.setValueByPath=function(e,t){return this.root.setValueByPath(e,t)},e.prototype.watch=function(){var i=this;this.schema.watch&&Object.keys(this.schema.watch).forEach(function(t){i.watchSubscriptions[t]&&i.watchSubscriptions[t].unsubscribe(),i.watchSubscriptions[t]=i.root.addListener(i.schema.watch[t],function(e){i.editor&&i.editor.onWatchedFieldChange(e,t)},i.path)})},e.prototype.getLabelText=function(){var e=this.options.custom,t=this.path.substr(this.path.lastIndexOf(".")+1),i=this.schema.title;return e||i||t},e.prototype.getTooltipText=function(){return _.isEmpty(this.schema.tooltip)?this.getLabelText():this.schema.tooltip},e}()),CollapsibleContainer=function(o){function e(e,t,i,n){t=o.call(this,e,t,i,n)||this;return t.canPaste=!0,t.canCollapse=!e.options||!e.options.disable_collapse,t.labelled=!_.isUndefined(n.labelled)&&n.labelled,e.options&&e.options.inline&&(t.inline=!0,t.canCollapse=!1),t}return __extends(e,o),Object.defineProperty(e.prototype,"expanded",{get:function(){return this._expanded},set:function(e){var t={};_.isNil(e)||(t=_.omit(e,"_self"),this._expanded=e),this._expanded._self?(this.el.classList.add("expanded"),this.setCaret(),this.rendered?this.renderChildren():this.pendingRenderChildren=!0):(this.el.classList.remove("expanded"),this.setCaret()),this.getChildren().forEach(function(e){e.expanded=t[e.key]})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this._schema},set:function(e){var i=this;this._schema=e,this.children={},_.each(this.schema.properties,function(e,t){i.initChild(t)}),this._value=this.getDefault(),_.each(this.schema.properties,function(e,t){i._value[t]=i.children[t].getDefault()}),this.schema.type&&this.el.setAttribute("data-type",this.schema.type),this.rendered&&(this.isHidden()?this.hide():this.unhide())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{set:function(e){this._value=e,this.setTitle(),this.emit()},enumerable:!1,configurable:!0}),e.prototype.filter=function(i){var n,o=this;return i?(n=!1,new Fuse([this.getTitle()],{threshold:.4}).search(i).length&&(n=!0,this.rendered)&&(this.titleText.innerHTML=this.highlightText(this.titleText.innerText,i)),this.getChildren().forEach(function(e,t){e.filter(i)&&(n=!0,o.rendered)&&!e.rendered&&(o.renderChild(e,t),e.expand&&e.expand(!0),e.filter(i))}),this.rendered&&(n?(this.renderChildren(),this.el.classList.remove("filtered"),this.expand(!0)):(this.el.classList.add("filtered"),this.expand(!1))),n):(this.rendered&&(this.getChildren().forEach(function(e){e.filter(null)}),this.el.classList.remove("filtered"),this.expand(this.defaultExpanded),this.titleText.innerHTML=this.titleText.innerText),!0)},e.prototype.getDefault=function(){var t,i=this;return void 0!==this.schema.default?this.schema.default:(t={},this.children&&Object.keys(this.children).forEach(function(e){t[e]=i.children[e].getDefault()}),t)},e.prototype.hide=function(){o.prototype.hide.call(this),this.hideChildren()},e.prototype.postRender=function(){var n=this;o.prototype.postRender.call(this),this.title.onblur=function(){return n.root.onFocus(null)},this.title.onfocus=function(){return n.root.onFocus(n.path)},this.title.onmouseover=function(){return n.root.setCopyPasteIcons()},this.canCollapse?(this.caret=document.createElement("i"),this.title.prepend(this.caret),this.setCaret(),this.el.classList.add("collapsible"),rxjs.fromEvent(this.title,"click").pipe(rxjs.operators.filter(function(e){var t=/MSIE|Trident/.test(window.navigator.userAgent),i=e.target;return t&&(t=e.clientX,e=e.clientY,i=document.elementFromPoint(t,e)),i===n.title||i===n.titleText||i===n.caret}),rxjs.operators.scan(function(e,t){return t.stopPropagation(),!n.expanded._self},this.expanded._self),rxjs.operators.startWith(this.expanded)).subscribe(this.expand.bind(this))):this.expand(!0),this.pendingRenderChildren&&(this.renderChildren(),this.pendingRenderChildren=!1)},e.prototype.reloadHeaderTemplates=function(){this.getChildren().forEach(function(e){_.has(e,"header_template")&&e.editor&&e.editor.onWatchedFieldChange&&e.editor.onWatchedFieldChange()})},e.prototype.remove=function(){this.getChildren().forEach(function(e){return e.remove()}),o.prototype.remove.call(this)},e.prototype.render=function(){return o.prototype.render.call(this),this.childrenEl=document.createElement("div"),this.childrenEl.classList.add("editor"),this.inline?this.el.classList.add("inline"):(this.renderTitle(),this.setTitle(),this.el.prepend(this.childrenEl),this.el.prepend(this.title),!/\d/.test(this.path)&&this.root.api.viewModel.get("selectedWidgetId")&&this.renderCopyPasteIcons()),this.el},e.prototype.setCopyState=function(e){e?this.el.classList.add("copied"):this.el.classList.remove("copied")},e.prototype.unhide=function(){o.prototype.unhide.call(this),this.expanded._self&&this.unhideChildren()},e.prototype.updatePaths=function(){o.prototype.updatePaths.call(this),this.setTitle()},e.prototype.appendChild=function(e,t){this.childrenEl.insertBefore(e.el,this.childrenEl.children[t]||null)},e.prototype.getChildren=function(){var t=this;return this.children instanceof Object?Object.keys(this.children).sort(this.sortIndexes.bind(this)).map(function(e){return t.children[e]}):this.children||[]},e.prototype.getChildSchema=function(e){return this.schema.properties[e]},e.prototype.getTitle=function(){var e=this.el.getAttribute("data-i"),t=this.schema.title||this.key;return t&&e&&(t+=" "+(Number(e)+1)),t},e.prototype.hideChildren=function(){this.getChildren().forEach(function(e){return e.hide()})},e.prototype.initChild=function(e){this.children[e]=this.root.initItem(this.getChildSchema(e),(this.path?this.path+".":"")+e,{expanded:this.expanded[e]})},e.prototype.removeChild=function(e){var t=this.children[e];t&&(t.remove(),delete this.children[e],this.childrenEl.contains(t.el))&&this.childrenEl.removeChild(t.el)},e.prototype.renderChild=function(e,t){e.render(),this.appendChild(e,t),e.postRender(),e.isHidden()&&e.hide()},e.prototype.renderCopyPasteIcons=function(){var e=this;this.copyPaste=document.createElement("span"),this.copyPaste.id="copyPaste",this.copyPaste.contentEditable="false",this.copyIcon=document.createElement("BUTTON"),this.copyIcon.id="copy",this.copyIcon.className="fa fa-copy",this.copyIcon.title="Copy property section to clipboard",this.pasteIcon=document.createElement("BUTTON"),this.pasteIcon.id="paste",this.pasteIcon.className="fa fa-paste",this.pasteIcon.title="Paste property section from clipboard",this.copyPaste.appendChild(this.copyIcon),this.copyPaste.appendChild(this.pasteIcon),this.title.append(this.copyPaste),this.copyIcon.onclick=function(){e.root.onFocus(e.path),e.root.startCopy()},this.pasteIcon.onclick=function(){e.root.onFocus(e.path),e.root.startPaste()}},e.prototype.renderTitle=function(){this.title=document.createElement(this.canCollapse?"button":"div"),this.titleText=document.createElement("span"),this.title.append(this.titleText),this.title.className="title",this.titleText.className="title-text",this.titleText.contentEditable="false",this.el.classList.add("titled")},e.prototype.setTitle=function(){this.titleText?this.titleText.textContent=this.generateTitle():this.title&&(this.title.textContent=this.generateTitle())},e.prototype.unhideChildren=function(){var i=this;this.getChildren().forEach(function(e,t){e.isHidden()||(e.rendered||i.renderChild(e,t),e.unhide())})},e.prototype.generateTitle=function(){return this.headerTemplate?this.headerTemplate({key:this.key,i:this.key,i0:Number(this.key),i1:Number(this.key)+1,self:this.unpackHandlebarsValues(),title:this.getTitle()}):this.getTitle()},e.prototype.renderChildren=function(){var i=this;this.getChildren().forEach(function(e,t){e.rendered||i.renderChild(e,t)})},e.prototype.setCaret=function(){this.caret&&(this.expanded._self?this.caret.className="caret fa fa-caret-down":this.caret.className="caret fa fa-caret-right")},e.prototype.sortIndexes=function(e,t){var i=this.children[e],n=this.children[t];return e&&t?(Number.isInteger(i.schema.propertyOrder)?i.schema.propertyOrder:1e3)-(Number.isInteger(n.schema.propertyOrder)?n.schema.propertyOrder:1e3):0},e.prototype.unpackHandlebarsValues=function(){return this.value instanceof Object?_.mapValues(this.value,function(e){return e instanceof Backbone.Model?e.get("value"):e}):this.value},e}(ItemContainer),ArrayContainer=function(o){function e(e,t,i,n){t=o.call(this,e,t,i,n)||this;return t.bulkEditor=!!e.options&&e.options.bulkEditor,t.canAdd=!e.options||!e.options.disable_array_add,t.canDrag=!e.options||!e.options.disable_array_reorder,t.canRemove=!e.options||!e.options.disable_array_delete,t.reset=!!e.options&&e.options.reset,t}return __extends(e,o),Object.defineProperty(e.prototype,"schema",{get:function(){return this._schema},set:function(e){var t=this;this._schema=e,this.getChildren().forEach(function(e){t.removeChild(e)}),this.children=[],this._value=this.getDefault(),this.schema.type&&this.el.setAttribute("data-type",this.schema.type),this.rendered&&(this.isHidden()?this.hide():this.unhide())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){if(void 0!==this._value)return this.children.map(function(e){return e.value})},set:function(e){var i=this;if(this._value=e,Array.isArray(e)){e.forEach(function(e,t){i.children[t]||i.initChild(t),i.rendered&&!i.children[t].rendered&&i.renderChild(i.children[t],t),i.children[t].value=e});for(var t=this.children.length-1;t>e.length-1;t--)this.removeChild(this.children[t])}this.emit(),this.determineEmpty(e)?this.el.classList.add("undefined"):this.el.classList.remove("undefined")},enumerable:!1,configurable:!0}),e.prototype.onClick=function(){0===this.value.length&&this.addRow(0)},e.prototype.paste=function(e){var t,i=this,n=this.value;e instanceof Array?_.each(e,function(e){var t=i.children.length;i.addRow(t),n.push(_.extend(i.children[t].getDefault(),e))}):e instanceof Object&&(t=this.children.length,this.addRow(t),n.push(_.extend(this.children[t].getDefault(),e))),this.setValueByPath(n,this.path)},e.prototype.render=function(){return o.prototype.render.call(this),this.bulkEditor&&(this.btnBulkEdit=document.createElement("i"),this.btnBulkEdit.className="bulkEditor fa fa-pencil-square-o",this.copyPaste?this.title.insertBefore(this.btnBulkEdit,this.copyPaste):this.title.append(this.btnBulkEdit)),this.reset&&(this.btnReset=document.createElement("i"),this.btnReset.className="btnReset fa fa-refresh",this.copyPaste?this.title.insertBefore(this.btnReset,this.copyPaste):this.title.append(this.btnReset)),this.endOfList=document.createElement("button"),this.endOfList.classList.add("end-of-list"),this.el.append(this.endOfList),this.canAdd&&(this.endOfList.classList.add("add-item"),this.endOfList.innerHTML="+ "+(this.schema.items&&this.schema.items.title?this.schema.items.title:"Item")),this.canDrag&&(this.dragContainer=this.childrenEl,this.placeholder=document.createElement("div"),this.placeholder.classList.add("placeholder"),this.el.append(this.placeholder)),this.el},e.prototype.postRender=function(){var i=this;o.prototype.postRender.call(this),this.bulkEditor&&this.btnBulkEdit.addEventListener("click",function(){i.root.api.showBulkColumnEditor(i)}),this.reset&&this.btnReset.addEventListener("click",this.onResetClick.bind(this)),this.canAdd&&this.endOfList.addEventListener("click",function(){var e=i.children.length,t=i.value.slice();i.addRow(e),i.renderChild(i.children[e],i.children.length-1),t[e]=i.children[e].value,i.setValueByPath(t,i.path)}),this.canDrag&&this.endOfList.addEventListener("dragenter",function(e){i.fromElement&&(i.dragContainer.append(i.fromElement),i.setPlaceholder(i.fromElement))})},e.prototype.updatePaths=function(){var i=this;o.prototype.updatePaths.call(this),this.getChildren().forEach(function(e,t){e.path=(i.path?i.path+".":"")+t,e.el.setAttribute("data-i",t)})},e.prototype.addDragListeners=function(e){function i(e){for(var t=0;null!==(e=e.previousSibling);)t++;return t}var n=this;e.setAttribute("draggable",!0),e.addEventListener("dragstart",function(e){var t=e.target;e.stopPropagation(),n.fromElement=t,n.fromIndex=i(t),n.el.classList.add("moving")}),e.addEventListener("dragenter",function(e){e.stopPropagation(),n.fromElement&&(n.dragContainer.insertBefore(n.fromElement,e.currentTarget),n.setPlaceholder(n.fromElement))}),e.addEventListener("dragend",function(e){var t=i(e.currentTarget);e.stopPropagation(),n.el.classList.remove("moving"),n.setPlaceholder(null),n.children.splice(t,0,n.children.splice(n.fromIndex,1)[0]),n.updatePaths(),n.setValueByPath(n.value,n.path),n.expand(n.expanded),n.fromElement=null})},e.prototype.addRow=function(e){this.children[e]||this.initChild(e)},e.prototype.getChildSchema=function(){return this.schema.items||{type:"string"}},e.prototype.removeChild=function(e){var t=this.children.indexOf(e);e.remove(),this.rendered&&this.childrenEl.removeChild(e.el),this.children.splice(t,1)},e.prototype.renderChild=function(e,t){var i,n=this;o.prototype.renderChild.call(this,e,t),e.el.setAttribute("data-i",t),e.expanded=this.expanded[t],this.canRemove&&((i=document.createElement("i")).className="remove fa fa-trash",i.onclick=function(){event.stopPropagation(),event.preventDefault(),n.children.splice(Number(i.parentElement.getAttribute("data-i")),1),i.parentElement.parentElement.removeChild(i.parentElement),n.updatePaths(),n.setValueByPath(n.value,n.path),n.expand(n.expanded)},e.el.append(i)),this.canDrag&&this.addDragListeners(e.el)},e.prototype.onResetClick=function(){this.setValueByPath(["reset",Date.now()],"root.notificationEvent")},e.prototype.setPlaceholder=function(e){e?(e=e.getBoundingClientRect(),this.placeholder.classList.add("active"),this.placeholder.style.marginLeft=this.fromElement.offsetLeft+"px",this.placeholder.style.width=e.width+"px",this.placeholder.style.height=e.height+"px",this.placeholder.style.top=e.top-36+"px"):this.placeholder.classList.remove("active")},e}(CollapsibleContainer),ActionsContainer=function(o){function e(e,t,i,n){t=o.call(this,e,t,i,n)||this;return t.originalSchema=_.cloneDeep(e),t.extendSchema(),t}return __extends(e,o),e.prototype.extendSchema=function(){var t={},i=(_.each(["map","nav","query","url","rollingOrDefault"],_.bind(function(e){t[e]={_Type:{default:e,type:"string",options:{hidden:!0}}},this.originalSchema&&this.originalSchema.fields&&_.extend(t[e],this.originalSchema.fields[e])},this)),_.extend(this.originalSchema,{options:{custom_class_name:"actions-array"},items:{title:"Action",headerTemplate:"Action {{ i1 }}",options:{keep_oneof_values:!1},oneOf:[{type:"object",title:"View State Mapping",uniqueItems:!1,options:{no_title:!0,custom_class_name:"mapping-object",linked_oneof_property:{property:"_Type",value:"map"}},properties:_.extend({Current:{propertyOrder:10,default:"",type:"string",options:{custom_class_name:"mapping-current"}},Target:{default:"",propertyOrder:11,type:"string",options:{custom_class_name:"mapping-target"}},Async:{type:"boolean",format:"checkbox",title:"Run Actions Asynchronously",default:!1}},t.map)},{type:"object",title:"Open Dashboard/Screen",options:{linked_oneof_property:{property:"_Type",value:"nav"}},properties:_.extend({SelectDashboardScreen:{type:"nav",title:"Select Dashboard/Screen",default:{dashboard:"<none>",screen:"<none>"}},Target:{type:"string",enum:["_self","_blank"],options:{enum_titles:["This Window","New Window"]}}},t.nav)},{type:"object",title:"Run Query",options:{linked_oneof_property:{property:"_Type",value:"query"}},properties:_.extend({DataSource:{type:"data"},Async:{type:"boolean",format:"checkbox",title:"Run Actions Asynchronously",default:!1}},t.query)},{type:"object",title:"Open Url",options:{linked_oneof_property:{property:"_Type",value:"url"}},properties:_.extend({Url:{type:"string"},Target:{type:"string",enum:["_self","_blank"],options:{enum_titles:["This Window","New Window"]}}},t.url)},{type:"object",title:"Apply Rolling Syntax / View State Default",options:{linked_oneof_property:{property:"_Type",value:"rollingOrDefault"}},properties:_.extend({ViewState:{title:"View State",type:"viewstate"}},t.rollingOrDefault)}]}}),this.originalSchema.excludedFields);i&&_.remove(this.originalSchema.items.oneOf,function(e){return _.includes(i,e.options.linked_oneof_property.value)}),this.schema=this.originalSchema,_.extend(this.schemaOptions,this.schema.options)},e}(ArrayContainer),BackboneContainer=function(o){function e(e,t,i,n){t=o.call(this,e,t,i,n)||this;return t.parameters=e.options.parameters,t.view=e.options.view,t}return __extends(e,o),e.prototype.remove=function(){this.instance&&(this.instance.remove(),this.instance=null),o.prototype.remove.call(this)},e.prototype.render=function(){var i=this;return o.prototype.render.call(this),this.instance=new this.view(Object.assign({el:this.childrenEl},_.reduce(this.parameters,function(e,t){return e[t]=i.root.api.getParameter(t),e},{}))),this.el},e.prototype.hideChildren=function(){this.instance&&this.instance.$el.hide()},e.prototype.unhideChildren=function(){this.instance&&this.instance.$el.show()},e}(CollapsibleContainer),ObjectContainer=function(o){function e(e,t,i,n){return o.call(this,e,t,i,n)||this}return __extends(e,o),Object.defineProperty(e.prototype,"schema",{get:function(){var t=this,i=this._schema;return Object.keys(this.children).forEach(function(e){i.properties[e]=t.children[e].schema}),i},set:function(e){var i=this;this._schema=e,this.getChildren().forEach(function(e){i.removeChild(e.key)}),this.children={},_.each(this.schema.properties,function(e,t){i.initChild(t)}),this._value=this.getDefault(),_.each(this.schema.properties,function(e,t){i._value[t]=i.children[t].getDefault()}),this.schema.type&&this.el.setAttribute("data-type",this.schema.type),this.rendered&&(this.isHidden()?this.hide():this.unhide())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var t=this,i={};if(void 0!==this._value)return Object.keys(this.children).forEach(function(e){void 0!==t.children[e].value&&(i[e]=t.children[e].value)}),i},set:function(t){var i=this;this._value=t,this.determineEmpty(t)?this.el.classList.add("undefined"):(this.el.classList.remove("undefined"),_.isEmpty(t)||Object.keys(this.children).forEach(function(e){i.children[e].value=t[e]})),this.setTitle()},enumerable:!1,configurable:!0}),e.prototype.updatePaths=function(){var t=this;o.prototype.updatePaths.call(this),this.getChildren().forEach(function(e){e.path=(t.path?t.path+".":"")+e.key})},e}(CollapsibleContainer),OneOfContainer=function(a){function e(e,t,i,n){var o=a.call(this,e,t,i,n)||this;return o.editors={},o.inline=o.schema.options&&o.schema.options.inline,o.keepValues=!o.schema.options||void 0===o.schema.options.keep_oneof_values||o.schema.options.keep_oneof_values,o.schema.oneOf.forEach(function(t,e){["headerTemplate","type"].forEach(function(e){!t[e]&&o.schema[e]&&(t[e]=o.schema[e])}),["collapsed","custom_class_name","disable_collapse","inline","title"].forEach(function(e){t.options&&!t.options.hasOwnProperty(e)&&o.schema.options&&o.schema.options[e]&&(t.options[e]=o.schema.options[e])}),t.headerTemplate||(t.headerTemplate=o.schema.title||o.key||"Item","array"===t.type&&(t.headerTemplate+=" {{ i1 }}")),o.editors[e]={linkedProperty:t.options?t.options.linked_oneof_property:null,title:t.title}}),o.selectedEditor=0,o.switchEditor(),o}return __extends(e,a),Object.defineProperty(e.prototype,"expanded",{get:function(){return this._expanded},set:function(e){_.isNil(e)||(this._expanded=e,this.childItem&&((this.childItem.expanded=e)&&e._self?this.el.classList.add("child-expanded"):this.el.classList.remove("child-expanded")))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"schema",{get:function(){return this._schema},set:function(e){this.childItem&&this.childItem.remove(),this._schema=e,this._value=this.getDefault(),this.schema.type&&this.el.setAttribute("data-type",this.schema.type)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.childItem?this.childItem.value:this._value},set:function(e){var t=this.determineEditor(e);t!==this.selectedEditor&&(this.selectedEditor=t,this.switchEditor(e),this.rendered)&&this.renderChildItem(),this._value=e,this.childItem&&(this.childItem.value=this._value),this.emit(),this.determineEmpty(e)?this.el.classList.add("undefined"):this.el.classList.remove("undefined")},enumerable:!1,configurable:!0}),e.prototype.filter=function(e){var t,i;return this.childItem?(t=this.childItem.rendered,(i=this.childItem.filter(e))?(this.el.classList.remove("filtered"),t||this.renderChildItem()):this.el.classList.add("filtered"),i):a.prototype.filter.call(this,e)},e.prototype.getDefault=function(){return this.childItem?this.childItem.getDefault():a.prototype.getDefault.call(this)},e.prototype.hide=function(){a.prototype.hide.call(this),this.childItem&&this.childItem.hide()},e.prototype.postRender=function(){a.prototype.postRender.call(this),this.select2=$(this.input).select2({minimumResultsForSearch:10,theme:"dashboards-properties"}),this.select2El=this.el.getElementsByClassName("select2-container")[0],rxjs.fromEvent(this.select2,"select2:select").pipe(rxjs.operators.map(function(e){return e.params.data.id})).subscribe(this.onSelectEditor.bind(this))},e.prototype.remove=function(){this.childItem&&this.childItem.remove(),a.prototype.remove.call(this)},e.prototype.render=function(){return this.input=document.createElement("select"),this.el.append(this.input),this.renderOptions(),this.switchEditor(this.value),this.renderChildItem(),this.el.classList.add("select2-wrapper"),this.el.classList.add("oneOf"),this.updatePaths(),this.watch(),this.el},e.prototype.switchEditor=function(e){this.select2El&&this.el.append(this.select2El),this.childItem&&this.childItem.remove(),this.initChild();var t=this.childItem.getDefault();e&&_.mergeWith(t,e,function(e,t,i,n){void 0===t&&_.set(n,i,void 0)}),this._value=t,void 0===(this.childItem.value=t)?this.el.classList.add("undefined"):this.el.classList.remove("undefined")},e.prototype.unhide=function(){a.prototype.unhide.call(this),this.childItem&&this.childItem.unhide()},e.prototype.updatePaths=function(){a.prototype.updatePaths.call(this),this.childItem&&(this.childItem.path=this.path,this.childItem.el.setAttribute("data-i",this.el.getAttribute("data-i")))},e.prototype.renderChildItem=function(){this.select2&&this.select2.val(this.selectedEditor).trigger("change"),this.rendered=!0;var e=this.childItem.render();return this.el.append(e),this.childItem.postRender(),_.defer(function(){this.select2El&&(this.inline?this.childItem.el.insertBefore(this.select2El,this.childItem.editor):this.childItem.title&&this.childItem.title.append(this.select2El))}.bind(this)),this.el},e.prototype.determineEditor=function(l){var r=0;return this.schema.oneOf.some(function(e,t){if(e.options&&e.options.linked_oneof_property){for(var i=e.options.linked_oneof_property,n=i.property.split("."),o=l,a=void 0,s=!1;o&&(a=n.shift());)n.length?o=o[a]:s=o[a]===i.value;if(s)return r=t,!0}}),r},e.prototype.initChild=function(){this.childItem=this.root.initItem(this.schema.oneOf[this.selectedEditor||0],this.path,{expanded:this.expanded,labelled:this.inline,label:this.schema.title})},e.prototype.onSelectEditor=function(e){var e=this.editors[e].linkedProperty,t=this.value,i=(e&&LocalTools.setValue(t,e.property,e.value),this.determineEditor(t)),i=(i!==this.selectedEditor&&(this.selectedEditor=i,this.switchEditor(this.keepValues?t:null),this.renderChildItem()),this.value);e&&LocalTools.setValue(i,e.property,e.value),this.setValueByPath(i,this.path),this.childItem.expanded=this.expanded},e.prototype.renderOptions=function(){var i=this;this.input.options.length=0,Object.keys(this.editors).forEach(function(e){var t=document.createElement("option");t.value=e,t.text=i.editors[e].title,Number(t.value)===i.selectedEditor&&(t.selected=!0),i.input.append(t)}),$(this.input).trigger("change")},e.labelled=!1,e}(ItemContainer),PopupsContainer=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return __extends(e,o),e.prototype.renderChild=function(e,t){var i,n=this;o.prototype.renderChild.call(this,e,t),this.schemaOptions.editPopupButton&&((i=document.createElement("i")).className="fa fa-pencil editPopup",i.setAttribute("title","Edit Popup"),i.addEventListener("click",function(){event.preventDefault(),event.stopPropagation(),n.root.api.showPopupEditor(e.value.id)}),this.children[t].el.appendChild(i))},e}(ArrayContainer),TableContainer=function(o){function e(e,t,i,n){e=o.call(this,e,t,i,n)||this;return e.el.setAttribute("data-format","table"),e}return __extends(e,o),e.prototype.render=function(){return o.prototype.render.call(this),this.table=document.createElement("table"),this.tableBody=document.createElement("tbody"),this.table.append(this.tableBody),this.childrenEl.prepend(this.table),this.canDrag&&(this.dragContainer=this.tableBody),this.el},e.prototype.updatePaths=function(){if(o.prototype.updatePaths.call(this),this.rendered)for(var e=this.tableBody.children,t=0;t<e.length;t++)e[t].setAttribute("data-i",t.toString())},e.prototype.removeChild=function(e){var t=this.children.indexOf(e);e.remove(),this.children.splice(t,1),this.rendered&&(e=this.tableBody.querySelector("[data-i='"+t+"']"))&&this.tableBody.removeChild(e)},e.prototype.renderChild=function(i,e){var t,n,o=this,a=[],s=document.createElement("tr");this.tableHeader||this.renderTableHeader(i.schema),i.render().setAttribute("data-i",e),s.setAttribute("data-i",e),i.children?Object.keys(i.children).filter(function(e){return!(i.children[e].schemaOptions&&i.children[e].schemaOptions.hidden)}).forEach(function(e){var e=i.children[e],t=document.createElement("td");t.classList.add("container"),t.setAttribute("data-type",e.schema.type),e.rendered||(e.render(),t.append(e.editor.el),s.append(t),a.push(e))}):((t=document.createElement("td")).classList.add("container"),t.setAttribute("data-type",i.schema.type),t.append(i.editor.el),s.append(t)),this.canRemove&&(t=document.createElement("td"),e=document.createElement("i"),n=document.createElement("span"),e.classList.add("remove","fa","fa-trash"),e.onclick=function(e){e.stopPropagation(),e.preventDefault(),o.children.splice(Number(s.getAttribute("data-i")),1),s.remove(),o.updatePaths(),o.setValueByPath(o.value,o.path),o.children.length||(o.tableHeader.remove(),o.tableHeader=null)},n.append(e),t.classList.add("container"),t.classList.add("remove-icon"),t.append(n),s.append(t)),this.tableBody.append(s),i.pendingRenderChildren=!1,i.postRender(),a.forEach(function(e){return e.postRender()}),this.canDrag&&this.addDragListeners(s)},e.prototype.renderTableHeader=function(e){var t=e.properties||{},i=[],n=document.createElement("tr");Object.keys(t).forEach(function(e){t[e].options&&t[e].options.hidden||i.push(t[e].title||e)}),this.tableHeader=document.createElement("thead"),this.tableHeader.append(n),i.forEach(function(e){var t=document.createElement("th");t.innerHTML=e,n.append(t)}),this.canRemove&&((e=document.createElement("th")).className="remove",n.append(e)),this.table.prepend(this.tableHeader)},e}(ArrayContainer),CONTAINERS={actions:ActionsContainer,array:ArrayContainer,backbone:BackboneContainer,object:ObjectContainer,oneOf:OneOfContainer,popups:PopupsContainer,table:TableContainer},Containers=function(){function e(){}return e.get=function(e){return e.oneOf?CONTAINERS.oneOf:"array"===e.type&&"table"===e.format?CONTAINERS.table:CONTAINERS[e.type]||ItemContainer},e}(),ChangeType,PropertyEditor=(!function(e){e[e.Expanded=0]="Expanded",e[e.Value=1]="Value"}(ChangeType=ChangeType||{}),function(){function e(e,t,i,n,o,a){this.el=n,this.el.classList.add("property-editor"),this.registerHandlebarsHelpers(),this.itemsById={},this.expanded=i||{},this.listeners={},this.debouncedApplyExpanded=_.debounce(this.applyExpanded.bind(this),50),this.api=o,this.schema=e,Editors.setViewStateEditors(a),this.subject=new rxjs.Subject(""),this.item=this.initItem(e,"root",{expanded:this.expanded}),this.el.append(this.item.render()),this.item.postRender(),this.el.append(this.getMask()),this.setValueByPath(t,"root")}return e.prototype.addListener=function(e,t,i){e=this.getItemByPath(e,i);return e?e.addListener(t):null},e.prototype.canPaste=function(e){e=this.itemsById[e];return!!e&&e.canPaste},e.prototype.copy=function(){return this.copiedItem&&this.copiedItem.setCopyState(!1),this.copiedItem=this.itemsById[this.getFocusedPath()],this.copiedItem?(this.copiedItem.setCopyState(!0),this.copiedItem.value):null},e.prototype.expand=function(e,t){var i=_.cloneDeep(this.expanded);null===e?_.unset(i,this.trimPath(t)):"root"===t?_.extend(i,e):LocalTools.setValue(i,this.trimPath(t),e),_.isEqual(i,this.expanded)||(this.expanded=i,this.debouncedApplyExpanded())},e.prototype.filter=function(e){e&&2<e.length?this.item.filter(e):e||this.item.filter(null)},e.prototype.focusItemByPath=function(e){this.getItemByPath(e).onClick()},e.prototype.getItemByPath=function(e,t){e=this.getNodes(e,t);return e[e.length-1]},e.prototype.getExpanded=function(){return this.item.expanded},e.prototype.getFocusedPath=function(){return this.focusedPath},e.prototype.getSchema=function(){return this.item.schema},e.prototype.getValue=function(){return this.item.value},e.prototype.initItem=function(e,t,i){return new(Containers.get(e))(e,t,this,i||{})},e.prototype.onChange=function(e){this.subject.closed||this.subject.next(e)},e.prototype.onFocus=function(e){QuickBase.ErrorTooltip.clearAll(!1),this.focusedPath=e||""},e.prototype.pasteProperties=function(i,n){var t=this,e=this.itemsById[n];this.copiedItem&&this.copiedItem.setCopyState(!1),e&&rxjs.concat.apply(rxjs,this.getModifiers("paste",n).map(function(e){return rxjs.Observable.create(function(t){e.fn(i,n,function(e){t.next(e),t.complete()})})})).pipe(rxjs.operators.timeout(1e4)).subscribe({next:function(e){i=e},error:function(e){t.setEditorState(!0),console.error(e)},complete:function(){e.paste(i),t.setEditorState(!0),t.onChange(ChangeType.Value)}})},e.prototype.register=function(e){var t=e.schema&&e.schema.id?e.schema.id+"."+e.key:e.path;this.itemsById[t]=e},e.prototype.reloadHeaderTemplates=function(){this.item.reloadHeaderTemplates()},e.prototype.remove=function(){this.item.remove(),QuickBase.ErrorTooltip.clearAll(!1),this.el.innerHTML="",this.subject.unsubscribe()},e.prototype.setExpanded=function(e){this.expand(e,"root")},e.prototype.setSchema=function(e){this.item.schema=e},e.prototype.setValue=function(e){this.item.value=e},e.prototype.setValueByPath=function(e,t){var i=this,n=e;this.setEditorState(!1),this.transform(e,t).subscribe({next:function(e){n=e},error:function(e){i.setEditorState(!0),console.error(e)},complete:function(){i.item.value=n,i.setEditorState(!0),i.onChange(ChangeType.Value)}})},e.prototype.subscribe=function(e){this.subject.subscribe(e)},e.prototype.startCopy=function(){$(window).trigger($.Event("keydown",{ctrlKey:!0,keyCode:67}))},e.prototype.startPaste=function(){$(window).trigger($.Event("keydown",{ctrlKey:!0,keyCode:86}))},e.prototype.setCopyPasteIcons=function(){this.setCopyIcon(!0),this.setPasteIcon(!0)},e.prototype.setCopyIcon=function(e){e?this.item.el.classList.add("clipboardCopy"):this.item.el.classList.remove("clipboardCopy")},e.prototype.setPasteIcon=function(e){e?this.item.el.classList.add("clipboardPaste"):this.item.el.classList.remove("clipboardPaste")},e.prototype.applyExpanded=function(){this.item.expanded=this.expanded,this.onChange(ChangeType.Expanded)},e.prototype.getAbsolutePath=function(e,t){var i,n,o=e.split(".");return"root"===o[0]?e:((i=(i=(e=this.getNodes(t))[e.map(function(e){return e.schema.id||e.key}).indexOf(o[0])])?i:(n=e[e.length-1].children)?n[o[0]]:null)||1<e.length&&(i=(n=e[e.length-2].children)?n[o[0]]:null),t&&i?(o.shift(),__spreadArray([i.path],o,!0).join(".")):"")},e.prototype.getMask=function(){var e=document.createElement("div"),t=document.createElement("i");return e.className="mask",t.className="mask-icon fa fa-spinner fa-pulse",e.append(t),e},e.prototype.getNodes=function(e,t){var e=this.getAbsolutePath(e,t),i=this.item,n=[i],t=e.split(".");return t.shift(),t.forEach(function(e){(i=i&&("object"===(i=i.schema.oneOf?i.childItem||i.children[i.selectedEditor]:i).schema.type||"array"===i.schema.type?i.children[e]:i))&&n.push(i)}),n},e.prototype.getModifiers=function(t,e){var i=[];return this.getNodes(e).forEach(function(e){e.schema["_"+t]&&"function"==typeof e.schema["_"+t]&&i.push({fn:e.schema["_"+t],path:e.path})}),i.reverse()},e.prototype.transform=function(i,a){var s,l=this,e=this.trimPath(a);return"root"===e?s=i:(s=this.item.value,LocalTools.setValue(s,e,i)),rxjs.concat.apply(rxjs,this.getModifiers("transform",a).map(function(e){var n=l.getItemByPath(e.path),t=n.path,o="root"===t?s:n.value;return a!==n.path&&(t=a.replace(n.path+".",""),LocalTools.setValue(o,t,i)),rxjs.Observable.create(function(i){e.fn(o,_.cloneDeep(n.schema),t,function(e,t){t&&(n.schema=t),_.isUndefined(e)||("root"===n.path?s=e:LocalTools.setValue(s,n.path.substring(5),e),i.next(s)),i.complete()})})})).pipe(rxjs.operators.startWith(s),rxjs.operators.timeout(1e4))},e.prototype.trimPath=function(e){return"root."===e.substring(0,5)?e.substring(5):e},e.prototype.registerHandlebarsHelpers=function(){Handlebars.registerHelper("valueProp",function(e){return"string"==typeof e?e:"object"==typeof e&&new Handlebars.SafeString(e.get("value"))})},e.prototype.setEditorState=function(e){e?this.el.classList.remove("loading"):this.el.classList.add("loading")},e.ChangeType=ChangeType,e}()),BulkColumnEditorDialog=(!function(){var l=jQuery;l.widget("ui.dialogExtend",{version:"2.0.0",modes:{},options:{closable:!0,dblclick:!1,titlebar:!1,icons:{close:"ui-icon-closethick",restore:"ui-icon-newwin"},load:null,beforeRestore:null,restore:null},_create:function(){this._state="normal",l(this.element[0]).data("ui-dialog")||l.error("jQuery.dialogExtend Error : Only jQuery UI Dialog element is accepted"),this._verifyOptions(),this._initStyles(),this._initButtons(),this._initTitleBar(),this._setState("normal");var t=l("#appdiv");l(this.element[0]).dialog("option","draggable")&&0<t.length&&l(this.element[0]).dialog("widget").draggable("option","containment",t),this._on("load",function(e){return console.log("test",e)});return l(window).resize(function(e){e.target===window&&l(this.element[0]).hasClass("ui-dialog-content")&&l(this.element[0]).dialog("option","position")&&l(this.element[0]).dialog("option","position",{my:"center",at:"center",of:0<(null==t?void 0:t.length)?t:window})}.bind(this)),this._trigger("load")},_setState:function(e){return l(this.element[0]).removeClass("ui-dialog-"+this._state).addClass("ui-dialog-"+e),this._state=e},_verifyOptions:function(){var e,t,i;for(e in!this.options.dblclick||this.options.dblclick in this.modes||(l.error("jQuery.dialogExtend Error : Invalid <dblclick> value '"+this.options.dblclick+"'"),this.options.dblclick=!1),this.options.titlebar&&"none"!==(t=this.options.titlebar)&&"transparent"!==t&&(l.error("jQuery.dialogExtend Error : Invalid <titlebar> value '"+this.options.titlebar+"'"),this.options.titlebar=!1),i=[],this.modes)this["_verifyOptions_"+e]?i.push(this["_verifyOptions_"+e]()):i.push(void 0);return i},_initStyles:function(){var e,t;for(e in l(".dialog-extend-css").length||l('<style class="dialog-extend-css" type="text/css">.ui-dialog .ui-dialog-titlebar-buttonpane>a { float: right; }.ui-dialog .ui-dialog-titlebar-restore { width: 19px; height: 18px; }.ui-dialog .ui-dialog-titlebar-restore span { display: block; margin: 1px; }.ui-dialog .ui-dialog-titlebar-restore:hover,.ui-dialog .ui-dialog-titlebar-restore:focus { padding: 0; }.ui-dialog .ui-dialog-titlebar ::selection { background-color: transparent; }</style>').appendTo("body"),t=[],this.modes)t.push(this["_initStyles_"+e]());return t},_initButtons:function(){var e,t,i,n=this,o=l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar"),a=l('<div class="ui-dialog-titlebar-buttonpane"></div>').appendTo(o);for(t in a.css({position:"absolute",top:"50%",right:"0.3em","margin-top":"-10px",height:"18px"}),o.find(".ui-dialog-titlebar-close").css({position:"relative",float:"right",top:"auto",right:"auto",margin:0}).find(".ui-icon").removeClass("ui-icon-closethick").addClass(this.options.icons.close).end().appendTo(a).end(),a.append('<a class="ui-dialog-titlebar-restore ui-corner-all ui-state-default" href="#"><span class="ui-icon '+this.options.icons.restore+'" title="restore">restore</span></a>').find(".ui-dialog-titlebar-restore").attr("role","button").mouseover(function(){return l(this).addClass("ui-state-hover")}).mouseout(function(){return l(this).removeClass("ui-state-hover")}).focus(function(){return l(this).addClass("ui-state-focus")}).blur(function(){return l(this).removeClass("ui-state-focus")}).end().find(".ui-dialog-titlebar-close").toggle(this.options.closable).end().find(".ui-dialog-titlebar-restore").hide().click(function(e){return e.preventDefault(),n.restore()}).end(),i=this.modes)e=i[t],this._initModuleButton(t,e);return o.dblclick(function(e){if(n.options.dblclick)return"normal"!==n._state?n.restore():n[n.options.dblclick]()}).select(function(){return!1})},_initModuleButton:function(t,e){var i=this;return l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar-buttonpane").append('<a class="ui-dialog-titlebar-'+t+' ui-corner-all ui-state-default" href="#" title="'+t+'"><span class="ui-icon '+this.options.icons[t]+'">'+t+"</span></a>").find(".ui-dialog-titlebar-"+t).attr("role","button").mouseover(function(){return l(this).addClass("ui-state-hover")}).mouseout(function(){return l(this).removeClass("ui-state-hover")}).focus(function(){return l(this).addClass("ui-state-focus")}).blur(function(){return l(this).removeClass("ui-state-focus")}).end().find(".ui-dialog-titlebar-"+t).toggle(this.options[e.option]).click(function(e){return e.preventDefault(),i[t]()}).end()},_initTitleBar:function(){var e;switch(this.options.titlebar){case!1:return 0;case"none":return l(this.element[0]).dialog("option","draggable")&&(e=l("<div />").addClass("ui-dialog-draggable-handle").css("cursor","move").height(5),l(this.element[0]).dialog("widget").prepend(e).draggable("option","handle",e)),l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar").find(".ui-dialog-title").html("&nbsp;").end().css({"background-color":"transparent","background-image":"none",border:0,position:"absolute",right:0,top:0,"z-index":9999}).end();case"transparent":return l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar").css({"background-color":"transparent","background-image":"none",border:0});default:return l.error("jQuery.dialogExtend Error : Invalid <titlebar> value '"+this.options.titlebar+"'")}},state:function(){return this._state},restore:function(){return this._trigger("beforeRestore"),this._restore(),this._toggleButtons(),this._trigger("restore")},_restore:function(){if("normal"!==this._state)return this["_restore_"+this._state](),this._setState("normal"),l(this.element[0]).dialog("widget").focus()},_saveSnapshot:function(){if("normal"===this._state)return this.original_config_resizable=l(this.element[0]).dialog("option","resizable"),this.original_config_draggable=l(this.element[0]).dialog("option","draggable"),this.original_size_height=l(this.element[0]).dialog("widget").outerHeight(),this.original_size_width=l(this.element[0]).dialog("option","width"),this.original_size_maxHeight=l(this.element[0]).dialog("option","maxHeight"),this.original_position_mode=l(this.element[0]).dialog("widget").css("position"),this.original_position_left=l(this.element[0]).dialog("widget").offset().left-l("body").scrollLeft(),this.original_position_top=l(this.element[0]).dialog("widget").offset().top-l("body").scrollTop(),this.original_titlebar_wrap=l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar").css("white-space")},_loadSnapshot:function(){return{config:{resizable:this.original_config_resizable,draggable:this.original_config_draggable},size:{height:this.original_size_height,width:this.original_size_width,maxHeight:this.original_size_maxHeight},position:{mode:this.original_position_mode,left:this.original_position_left,top:this.original_position_top},titlebar:{wrap:this.original_titlebar_wrap}}},_toggleButtons:function(e){var t,i,n,o,a,s=e||this._state;for(i in l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar-restore").toggle("normal"!==s).css({right:"1.4em"}).end(),n=this.modes)t=n[i],l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar-"+i).toggle(s!==t.state&&this.options[t.option]);for(i in a=[],o=this.modes)(t=o[i]).state===s?a.push(l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar-restore").insertAfter(l(this.element[0]).dialog("widget").find(".ui-dialog-titlebar-"+i)).end()):a.push(void 0);return a}})}.call(this),!function(){var i=jQuery;i.extend(!0,i.ui.dialogExtend.prototype,{modes:{collapse:{option:"collapsable",state:"collapsed"}},options:{collapsable:!1,icons:{collapse:"ui-icon-triangle-1-s"},beforeCollapse:null,collapse:null},collapse:function(){var e,t=i(this.element[0]).dialog("widget").find(".ui-dialog-titlebar").height()+15;return this._trigger("beforeCollapse"),"normal"!==this._state&&this._restore(),this._saveSnapshot(),e=i(this.element[0]).dialog("widget").position(),i(this.element[0]).dialog("option",{resizable:!1,height:t,maxHeight:t,position:[e.left-i(document).scrollLeft(),e.top-i(document).scrollTop()]}).on("dialogclose",this._collapse_restore).hide().dialog("widget").find(".ui-dialog-buttonpane:visible").hide().end().find(".ui-dialog-titlebar").css("white-space","nowrap").end().find(".ui-dialog-content"),this._setState("collapsed"),this._toggleButtons(),this._trigger("collapse")},_restore_collapsed:function(){var e=this._loadSnapshot();return i(this.element[0]).show().dialog("widget").find(".ui-dialog-buttonpane:hidden").show().end().find(".ui-dialog-titlebar").css("white-space",e.titlebar.wrap).end().find(".ui-dialog-content").dialog("option",{resizable:e.config.resizable,height:e.size.height,maxHeight:e.size.maxHeight}).off("dialogclose",this._collapse_restore)},_initStyles_collapse:function(){if(!i(".dialog-extend-collapse-css").length)return""+'<style class="dialog-extend-collapse-css" type="text/css">'+".ui-dialog .ui-dialog-titlebar-collapse { width: 19px; height: 18px; }"+".ui-dialog .ui-dialog-titlebar-collapse span { display: block; margin: 1px; }"+".ui-dialog .ui-dialog-titlebar-collapse:hover,"+".ui-dialog .ui-dialog-titlebar-collapse:focus { padding: 0; }"+"</style>",i('<style class="dialog-extend-collapse-css" type="text/css">.ui-dialog .ui-dialog-titlebar-collapse { width: 19px; height: 18px; }.ui-dialog .ui-dialog-titlebar-collapse span { display: block; margin: 1px; }.ui-dialog .ui-dialog-titlebar-collapse:hover,.ui-dialog .ui-dialog-titlebar-collapse:focus { padding: 0; }</style>').appendTo("body")},_collapse_restore:function(){return i(this).dialogExtend("restore")}})}.call(this),!function(){var i=jQuery;i.extend(!0,i.ui.dialogExtend.prototype,{modes:{maximize:{option:"maximizable",state:"maximized"}},options:{maximizable:!1,icons:{maximize:"ui-icon-extlink"},beforeMaximize:null,maximize:null},maximize:function(){var e=i(window).height()-11,t=i(window).width()-11;return this._trigger("beforeMaximize"),"normal"!==this._state&&this._restore(),this._saveSnapshot(),i(this.element[0]).dialog("option","draggable")&&i(this.element[0]).dialog("widget").draggable("option","handle",null).find(".ui-dialog-draggable-handle").css("cursor","text").end(),i(this.element[0]).dialog("widget").css("position","fixed").find(".ui-dialog-content").show().dialog("widget").find(".ui-dialog-buttonpane").show().end().find(".ui-dialog-content").dialog("option",{resizable:!1,draggable:!1,height:e,width:t,position:{my:"left top",at:"left top",of:window}}),this._setState("maximized"),this._toggleButtons(),this._trigger("maximize")},_restore_maximized:function(){var e=this._loadSnapshot();if(i(this.element[0]).dialog("widget").css("position",e.position.mode).find(".ui-dialog-titlebar").css("white-space",e.titlebar.wrap).end().find(".ui-dialog-content").dialog("option",{resizable:e.config.resizable,draggable:e.config.draggable,height:e.size.height,width:e.size.width,maxHeight:e.size.maxHeight,position:{my:"left top",at:"left+"+e.position.left+" top+"+e.position.top,of:window}}),i(this.element[0]).dialog("option","draggable"))return 0<(e=i("#appdiv")).length&&i(this.element[0]).dialog("widget").draggable("option","containment",e),i(this.element[0]).dialog("widget").draggable("option","handle",i(this.element[0]).dialog("widget").find(".ui-dialog-draggable-handle").length?i(this.element[0]).dialog("widget").find(".ui-dialog-draggable-handle"):".ui-dialog-titlebar").find(".ui-dialog-draggable-handle").css("cursor","move")},_initStyles_maximize:function(){if(!i(".dialog-extend-maximize-css").length)return""+'<style class="dialog-extend-maximize-css" type="text/css">'+".ui-dialog .ui-dialog-titlebar-maximize { width: 19px; height: 18px; }"+".ui-dialog .ui-dialog-titlebar-maximize span { display: block; margin: 1px; }"+".ui-dialog .ui-dialog-titlebar-maximize:hover,"+".ui-dialog .ui-dialog-titlebar-maximize:focus { padding: 0; }"+"</style>",i('<style class="dialog-extend-maximize-css" type="text/css">.ui-dialog .ui-dialog-titlebar-maximize { width: 19px; height: 18px; }.ui-dialog .ui-dialog-titlebar-maximize span { display: block; margin: 1px; }.ui-dialog .ui-dialog-titlebar-maximize:hover,.ui-dialog .ui-dialog-titlebar-maximize:focus { padding: 0; }</style>').appendTo("body")}})}.call(this),!function(){var i=jQuery;i.extend(!0,i.ui.dialogExtend.prototype,{modes:{minimize:{option:"minimizable",state:"minimized"}},options:{minimizable:!1,minimizeLocation:"left",icons:{minimize:"ui-icon-minus"},beforeMinimize:null,minimize:null},minimize:function(){var e,t;return this._trigger("beforeMinimize"),"normal"!==this._state&&this._restore(),i("#dialog-extend-fixed-container").length?t=i("#dialog-extend-fixed-container"):(t=i('<div id="dialog-extend-fixed-container"></div>').appendTo("body")).css({position:"fixed",bottom:1,left:1,right:1,"z-index":9999}),this._toggleButtons("minimized"),e=i(this.element[0]).dialog("widget").clone().children().remove().end(),i(this.element[0]).dialog("widget").find(".ui-dialog-titlebar").clone(!0,!0).appendTo(e),e.css({float:this.options.minimizeLocation,margin:1}),t.append(e),i(this.element[0]).data("dialog-extend-minimize-controls",e),i(this.element[0]).dialog("option","draggable")&&e.removeClass("ui-draggable"),e.css({height:"auto",width:200,position:"static"}),i(this.element[0]).on("dialogbeforeclose",this._minimize_restoreOnClose).dialog("widget").hide(),this._setState("minimized"),this._trigger("minimize")},_restore_minimized:function(){return i(this.element[0]).dialog("widget").show(),i(this.element[0]).off("dialogbeforeclose",this._minimize_restoreOnClose),i(this.element[0]).data("dialog-extend-minimize-controls").remove(),i(this.element[0]).removeData("dialog-extend-minimize-controls")},_initStyles_minimize:function(){if(!i(".dialog-extend-minimize-css").length)return""+'<style class="dialog-extend-minimize-css" type="text/css">'+".ui-dialog .ui-dialog-titlebar-minimize { width: 19px; height: 18px; }"+".ui-dialog .ui-dialog-titlebar-minimize span { display: block; margin: 1px; }"+".ui-dialog .ui-dialog-titlebar-minimize:hover,"+".ui-dialog .ui-dialog-titlebar-minimize:focus { padding: 0; }"+"</style>",i('<style class="dialog-extend-minimize-css" type="text/css">.ui-dialog .ui-dialog-titlebar-minimize { width: 19px; height: 18px; }.ui-dialog .ui-dialog-titlebar-minimize span { display: block; margin: 1px; }.ui-dialog .ui-dialog-titlebar-minimize:hover,.ui-dialog .ui-dialog-titlebar-minimize:focus { padding: 0; }</style>').appendTo("body")},_verifyOptions_minimize:function(){var e;if(!this.options.minimizeLocation||"left"!==(e=this.options.minimizeLocation)&&"right"!==e)return i.error("jQuery.dialogExtend Error : Invalid <minimizeLocation> value '"+this.options.minimizeLocation+"'"),this.options.minimizeLocation="left"},_minimize_restoreOnClose:function(){return i(this).dialogExtend("restore")}})}.call(this),Backbone.View.extend({className:"dlgBulkColumnEditorDialog",initialize:function(e){var i=this;this.editor=(e=e||{}).editor,i.$el.html(T.BulkColumnEditorDialog()),i.initControls(),i.initRenderedDialogOnce=_.once(i.initRenderedDialog),this.$dialog=i.$el.dialog(_.extend({appendTo:e.container,title:t("Multi Column Editor "),classes:{"ui-dialog":"quick-dash"},resizable:!0,height:540,width:600,minWidth:600,modal:!0,autoOpen:!1,buttons:[{text:t("Apply"),disabled:!0,click:$.proxy(i.applyChanges,i),icon:"fa fa-check-square-o"},{text:t("Close"),click:$.proxy(i.onCloseButtonClick,i),icon:"fa fa-times"}],open:function(){i.initRenderedDialogOnce()}},e))},applyChanges:function(){var e=this,i=e.bulkEditor.value,n=e.editor.getValue(),o=!1,a=$.map(e.$lstProperties.find("> .ui-selected"),function(e){return $(e).data("schemapath").replace("root.","")});_.each(e.$lstColumns.find(">li"),function(e,t){$(e).is(".ui-selected")&&_.each(a,function(e){i[t][e]!==n[e]&&(i[t][e]=n[e],o=!0)})}),o&&e.bulkEditor.setValueByPath(i,e.bulkEditor.path)},initControls:function(){this.$pnlPropertyEditor=this.$(".pnlPropertyEditor"),this.$propertiesPanel=this.$(".properties-panel"),this.$lstColumns=this.$(".lstColumns"),this.$pnlInfo=this.$(".pnlInfo")},initRenderedDialog:function(){$('<i class="fa fa-columns" />').insertBefore(this.$el.parent().find(".ui-dialog-title")),this.$btnApply=this.$el.next().find("button:nth-of-type(1)")},checkSelectableStatuses:function(){var e=!0,t=this.$lstColumns.find(">.ui-selected").length,i=this.$lstProperties?this.$lstProperties.find(">.ui-selected").length:0;0===t&&0===i?this.$pnlInfo.html("Use the mouse to select items, individually or in a group.<br> Hold down the CTRL key to make multiple non-adjacent selections."):0===t?this.$pnlInfo.html(i+(1===i?" property":" properties")+" selected. Please select columns to format.<br>Hold down the CTRL key to make multiple non-adjacent selections."):0==i?this.$pnlInfo.html(t+(1===t?" column":" columns")+" selected. Please select properties to be changed.<br>Hold down the CTRL key to make multiple non-adjacent selections."):(this.$pnlInfo.html("Click 'Apply' to change format for selected columns.<br>Changes ("+i+(1===i?" property":" properties")+") will be applied to "+t+(1===t?" column.":" columns.")),e=!1),this.$btnApply.button({disabled:e})},onCloseButtonClick:function(){this.$el.dialog("close")},open:function(){this.$propertiesPanel.removeClass("kx-light"),"kx-light"===$.cookie("dashboard-theme")&&this.$propertiesPanel.addClass("kx-light"),this.$el.dialog("open"),this.checkSelectableStatuses()},remove:function(){self.$lstColumns.is(":ui-selectable")&&self.$lstColumns.selectable("destroy"),this.$dialog.dialog("destroy"),Backbone.View.prototype.remove.call(this)},setEditor:function(e){var t,i=this,n=(i.bulkEditor=e,i.$lstColumns.is(":ui-selectable")&&i.$lstColumns.selectable("destroy"),i.$lstColumns.empty(),t=i.bulkEditor.value,i.$lstColumns.append(_.map(t,function(e){var t=document.createElement("li");return t.textContent=_.get(e.DisplayName,"attributes.value",e.DisplayName)||_.get(e.Field,"attributes.value",e.Field),t})),i.$lstColumns.selectable({stop:function(){i.checkSelectableStatuses()}}),(t=_.cloneDeep(i.bulkEditor.getChildSchema())).headerTemplate=null,t.title="Properties",t.options.disable_collapse=!0,t.options.collapsed=!1,t.properties=_.omit(t.properties,"Field","DisplayName","Filter"),i.bulkEditor.root.getSchema()),n=_.pickBy(n.properties,{type:"readOnlyArray"}),o=_.keys(n),a=i.bulkEditor.root.getValue(),a=_.cloneDeep(_.pick(a,o)),o=_.extend(_.mapValues(t.properties,"default"),a);delete t._transform,_.extend(t.properties,n),i.$pnlPropertyEditor.empty(),i.editor=new PropertyEditor(t,o,null,i.$pnlPropertyEditor[0],e.root.api,!0),i.$lstProperties=i.$pnlPropertyEditor.find("> .container > .editor"),i.$lstProperties.selectable({filter:">.container",stop:function(){i.checkSelectableStatuses()}})}}));function ctrlPtComparator(e,t){return e.position-t.position}function bind(e,t){return"function"==typeof e.bind?e.bind(t):function(){e.apply(t,arguments)}}!function(n){n.fn.extend({collapsiblePanel:function(){n(this).each(function(){var e=n(this).find(".ui-expander").first(),t=n(this).find(".ui-widget-header").first(),i=n(this).find(".ui-widget-content").first();i.is(":visible")?e.removeClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"):e.removeClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-s"),t.click(function(){i.slideToggle(500,function(){console.log(i.is(":visible")),i.is(":visible")?e.removeClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"):e.removeClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-s")})})})}})}(jQuery),!function(a){e={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!(t=65)},n=function(e,t){e=E(e);a(t).data("colorpicker").fields.eq(1).val(e.r).end().eq(2).val(e.g).end().eq(3).val(e.b).end()},o=function(e,t){a(t).data("colorpicker").fields.eq(4).val(e.h).end().eq(5).val(e.s).end().eq(6).val(e.b).end()},s=function(e,t){a(t).data("colorpicker").fields.eq(0).val(_(e)).end()},l=function(e,t){a(t).data("colorpicker").selector.css("backgroundColor","#"+_({h:e.h,s:100,b:100})),a(t).data("colorpicker").selectorIndic.css({left:parseInt(200*e.s/100,10),top:parseInt(200*(100-e.b)/100,10)})},r=function(e,t){a(t).data("colorpicker").hue.css("top",parseInt(200-200*e.h/360,10))},c=function(e,t){a(t).data("colorpicker").newColor.css("backgroundColor","#"+_(e))},d=function(e){var t,i=a(this).parent().parent();0<this.parentNode.className.indexOf("_hex")?i.data("colorpicker").color=t=C(w(this.value)):0<this.parentNode.className.indexOf("_hsb")?i.data("colorpicker").color=t=v({h:parseInt(i.data("colorpicker").fields.eq(4).val(),10),s:parseInt(i.data("colorpicker").fields.eq(5).val(),10),b:parseInt(i.data("colorpicker").fields.eq(6).val(),10)}):i.data("colorpicker").color=t=S(y({r:parseInt(i.data("colorpicker").fields.eq(1).val(),10),g:parseInt(i.data("colorpicker").fields.eq(2).val(),10),b:parseInt(i.data("colorpicker").fields.eq(3).val(),10)})),e&&(n(t,i.get(0)),s(t,i.get(0)),o(t,i.get(0))),l(t,i.get(0)),r(t,i.get(0)),c(t,i.get(0)),i.data("colorpicker").onChange.apply(i,[t,_(t),E(t)])},i=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val+e.pageY-e.data.y,10)))),e.data.preview&&d.apply(e.data.field.get(0),[!0]),!1},u=function(e){return d.apply(e.data.field.get(0),[!0]),e.data.el.removeClass("colorpicker_slider").find("input").focus(),a(document).unbind("mouseup",u),a(document).unbind("mousemove",i),!1},p=function(e){return d.apply(e.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(200-Math.max(0,Math.min(200,e.pageY-e.data.y)))/200,10)).get(0),[e.data.preview]),!1},h=function(e){return p(e),n(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),s(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),a(document).unbind("mouseup",h),a(document).unbind("mousemove",p),!1},m=function(e){return d.apply(e.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(200-Math.max(0,Math.min(200,e.pageY-e.data.pos.top)))/200,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(200,e.pageX-e.data.pos.left))/200,10)).get(0),[e.data.preview]),!1},g=function(e){return m(e),n(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),s(e.data.cal.data("colorpicker").color,e.data.cal.get(0)),a(document).unbind("mouseup",g),a(document).unbind("mousemove",m),!1},f=function(e){b(e.data.cal.get(0),e.target,e.data.cal.get(0))||(0!=e.data.cal.data("colorpicker").onHide.apply(this,[e.data.cal.get(0)])&&e.data.cal.hide(),a(document).unbind("mousedown",f))},b=function(e,t,i){if(e==t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));for(var n=t.parentNode;n&&n!=i;){if(n==e)return!0;n=n.parentNode}return!1},v=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},y=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},w=function(e){var t=6-e.length;if(0<t){for(var i=[],n=0;n<t;n++)i.push("0");i.push(e),e=i.join("")}return e},C=function(e){return S((e=e,{r:(e=parseInt(-1<e.indexOf("#")?e.substring(1):e,16))>>16,g:(65280&e)>>8,b:255&e}))},S=function(e){var t={h:0,s:0,b:0},i=Math.min(e.r,e.g,e.b),n=Math.max(e.r,e.g,e.b),i=n-i;return t.b=n,t.s=0!=n?255*i/n:0,0!=t.s?e.r==n?t.h=(e.g-e.b)/i:e.g==n?t.h=2+(e.b-e.r)/i:t.h=4+(e.r-e.g)/i:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},E=function(e){var t,i={},n=Math.round(e.h),o=Math.round(255*e.s/100),e=Math.round(255*e.b/100);return 0==o?i.r=i.g=i.b=e:(e=n%60*((t=e)-(o=(255-o)*e/255))/60,(n=360==n?0:n)<60?(i.r=t,i.b=o,i.g=o+e):n<120?(i.g=t,i.b=o,i.r=t-e):n<180?(i.g=t,i.r=o,i.b=o+e):n<240?(i.b=t,i.r=o,i.g=t-e):n<300?(i.b=t,i.g=o,i.r=o+e):n<360?(i.r=t,i.g=o,i.b=t-e):(i.r=0,i.g=0,i.b=0)),{r:Math.round(i.r),g:Math.round(i.g),b:Math.round(i.b)}},T=function(e){var i=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return a.each(i,function(e,t){1==t.length&&(i[e]="0"+t)}),i.join("")},_=function(e){return T(E(e))};var t,e,n,o,s,l,r,c,d,i,u,p,h,m,g,f,b,v,y,w,C,S,E,T,_,k={init:function(i){if("string"==typeof(i=a.extend({},e,i||{})).color)i.color=C(i.color);else if(null!=i.color.r&&null!=i.color.g&&null!=i.color.b)i.color=S(i.color);else{if(null==i.color.h||null==i.color.s||null==i.color.b)return this;i.color=v(i.color)}return this.each(function(){var e,t;a(this).data("colorpickerId")||((e=a.extend({},i)).origColor=i.color,t="collorpicker_"+parseInt(1e3*Math.random()),a(this).data("colorpickerId",t),t=a('<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>').attr("id",t),e.flat?t.appendTo(this).show():t.appendTo(document.body),e.fields=t.find("input").bind("keyup",D).bind("change",d).bind("blur",x).bind("focus",A),t.find("span").bind("mousedown",M).end().find(">div.colorpicker_current_color").bind("click",B),e.selector=t.find("div.colorpicker_color").bind("mousedown",$),e.selectorIndic=e.selector.find("div div"),e.el=this,e.hue=t.find("div.colorpicker_hue div"),t.find("div.colorpicker_hue").bind("mousedown",I),e.newColor=t.find("div.colorpicker_new_color"),e.currentColor=t.find("div.colorpicker_current_color"),t.data("colorpicker",e),t.find("div.colorpicker_submit").bind("mouseenter",R).bind("mouseleave",L).bind("click",N),n(e.color,t.get(0)),o(e.color,t.get(0)),s(e.color,t.get(0)),r(e.color,t.get(0)),l(e.color,t.get(0)),P(e.color,t.get(0)),c(e.color,t.get(0)),e.flat?t.css({position:"relative",display:"block"}):a(this).bind(e.eventName,O))})},showPicker:function(){return this.each(function(){a(this).data("colorpickerId")&&O.apply(this)})},hidePicker:function(){return this.each(function(){a(this).data("colorpickerId")&&a("#"+a(this).data("colorpickerId")).hide()})},setColor:function(t){if("string"==typeof t)t=C(t);else if(null!=t.r&&null!=t.g&&null!=t.b)t=S(t);else{if(null==t.h||null==t.s||null==t.b)return this;t=v(t)}return this.each(function(){var e;a(this).data("colorpickerId")&&((e=a("#"+a(this).data("colorpickerId"))).data("colorpicker").color=t,e.data("colorpicker").origColor=t,n(t,e.get(0)),o(t,e.get(0)),s(t,e.get(0)),r(t,e.get(0)),l(t,e.get(0)),P(t,e.get(0)),c(t,e.get(0)))})}};function P(e,t){a(t).data("colorpicker").currentColor.css("backgroundColor","#"+_(e))}function D(e){if(e=e.charCode||e.keyCode||-1,t<e&&e<=90||32==e)return!1;!0===a(this).parent().parent().data("colorpicker").livePreview&&d.apply(this)}function x(e){a(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus")}function A(){t=0<this.parentNode.className.indexOf("_hex")?70:65,a(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),a(this).parent().addClass("colorpicker_focus")}function M(e){var t=a(this).parent().find("input").focus(),e={el:a(this).parent().addClass("colorpicker_slider"),max:0<this.parentNode.className.indexOf("_hsb_h")?360:0<this.parentNode.className.indexOf("_hsb")?100:255,y:e.pageY,field:t,val:parseInt(t.val(),10),preview:a(this).parent().parent().data("colorpicker").livePreview};a(document).bind("mouseup",e,u),a(document).bind("mousemove",e,i)}function I(e){var t={cal:a(this).parent(),y:a(this).offset().top};t.preview=t.cal.data("colorpicker").livePreview,a(document).bind("mouseup",t,h),a(document).bind("mousemove",t,p)}function $(e){var t={cal:a(this).parent(),pos:a(this).offset()};t.preview=t.cal.data("colorpicker").livePreview,a(document).bind("mouseup",t,g),a(document).bind("mousemove",t,m)}function R(e){a(this).addClass("colorpicker_focus")}function L(e){a(this).removeClass("colorpicker_focus")}function N(e){var t=a(this).parent(),i=t.data("colorpicker").color;t.data("colorpicker").origColor=i,P(i,t.get(0)),t.data("colorpicker").onSubmit(i,_(i),E(i),t.data("colorpicker").el)}function O(e){var t=a("#"+a(this).data("colorpickerId")),i=(t.data("colorpicker").onBeforeShow.apply(this,[t.get(0)]),a(this).offset()),n=(n="CSS1Compat"==document.compatMode,{l:window.pageXOffset||(n?document.documentElement:document.body).scrollLeft,t:window.pageYOffset||(n?document.documentElement:document.body).scrollTop,w:window.innerWidth||(n?document.documentElement:document.body).clientWidth,h:window.innerHeight||(n?document.documentElement:document.body).clientHeight}),o=i.top+this.offsetHeight,i=i.left;return n.t+n.h<o+176&&(o-=this.offsetHeight+176),n.l+n.w<i+356&&(i-=356),t.css({left:i+"px",top:o+"px"}),0!=t.data("colorpicker").onShow.apply(this,[t.get(0)])&&t.show(),a(document).bind("mousedown",{cal:t},f),!1}function B(){var e=a(this).parent(),t=e.data("colorpicker").origColor;e.data("colorpicker").color=t,n(t,e.get(0)),s(t,e.get(0)),o(t,e.get(0)),l(t,e.get(0)),r(t,e.get(0)),c(t,e.get(0))}a.fn.extend({ColorPicker:k.init,ColorPickerHide:k.hidePicker,ColorPickerShow:k.showPicker,ColorPickerSetColor:k.setColor})}(jQuery),$.event.special.destroyed||($.event.special.destroyed={remove:function(e){e.handler&&e.handler()}});var browserPrefix="",agent=window.navigator.userAgent;function GradientSelection(e,t){this.$el=e,this.$el.css("position","relative"),this.opts=t;var e=$("<canvas class='gradientPicker-preview'></canvas>"),i=(this.$el.append(e),e[0]),i=(i.width=i.clientWidth,i.height=i.clientHeight,this.g2d=i.getContext("2d"),$("<div class='gradientPicker-ctrlPts'></div>"));this.$el.append(i),this.$ctrlPtContainer=i,this.updatePreview=bind(this.updatePreview,this),this.controlPoints=[],this.ctrlPtConfig=new ControlPtConfig(this.$el,t);for(var n=0;n<t.controlPoints.length;++n){var o=this.createCtrlPt(t.controlPoints[n]);this.controlPoints.push(o)}this.docClicked=bind(this.docClicked,this),this.destroyed=bind(this.destroyed,this),$(document).bind("click",this.docClicked),this.$el.bind("destroyed",this.destroyed),this.previewClicked=bind(this.previewClicked,this),e.click(this.previewClicked),this.updatePreview()}function ControlPoint(e,t,i,n,o){this.$el=$("<div class='gradientPicker-ctrlPt'></div>"),e.append(this.$el),this.$parentEl=e,this.configView=o,"string"==typeof t?(t=t.split(" "),this.position=parseFloat(t[1])/100,this.color=t[0]):(this.position=t.position,this.color=t.color),this.listener=n,this.outerWidth=this.$el.outerWidth(),this.$el.css("background-color",this.color),"horizontal"==i?(o=(e.width()-this.$el.outerWidth())*this.position,this.$el.css("left",o)):(t=(e.height()-this.$el.outerHeight())*this.position,this.$el.css("top",t)),this.drag=bind(this.drag,this),this.stop=bind(this.stop,this),this.clicked=bind(this.clicked,this),this.colorChanged=bind(this.colorChanged,this),this.$el.draggable({axis:"horizontal"==i?"x":"y",drag:this.drag,stop:this.stop,containment:e}),this.$el.css("position","absolute"),this.$el.click(this.clicked)}function ControlPtConfig(e,t){var i=this,e=(this.$el=$('<div class="gradientPicker-ptConfig" style="visibility: hidden"></div>'),e.append(this.$el),$('<div class="color-chooser"></div>')),n=(this.$el.append(e),$("<div class='gradientPicker-close'></div>"));this.$el.append(n),this.$txtPerc=$("<input class='gradientPicker-locationPerc' type='text'/>").appendTo(this.$el),this.$txtPerc.spinner({min:0,max:100,numberFormat:"n",spin:function(e,t){_.defer(function(){i.onValueChange()})}}),this.$txtPerc.on("input",$.proxy(i.onValueChange,i)),this.$txtPerc.parent().click(function(e){e.stopPropagation()}),this.colorChanged=bind(this.colorChanged,this),this.removeClicked=bind(this.removeClicked,this),e.ColorPicker({onChange:this.colorChanged}),this.$cpicker=e,this.opts=t,this.visible=!1,n.click(this.removeClicked)}browserPrefix=0<=agent.indexOf("WebKit")?"-webkit-":0<=agent.indexOf("Mozilla")?"-moz-":0<=agent.indexOf("Microsoft")?"-ms-":"",GradientSelection.prototype={docClicked:function(){this.ctrlPtConfig.hide()},createCtrlPt:function(e){return new ControlPoint(this.$ctrlPtContainer,e,this.opts.orientation,this,this.ctrlPtConfig)},destroyed:function(){$(document).unbind("click",this.docClicked)},updateOptions:function(e){$.extend(this.opts,e),this.updatePreview()},updatePreview:function(){var e,t=[];if(this.controlPoints.sort(ctrlPtComparator),"horizontal"==this.opts.orientation)for(var i=this.g2d.createLinearGradient(0,0,this.g2d.canvas.width,0),n=0;n<this.controlPoints.length;++n){var o=this.controlPoints[n];i.addColorStop(o.position,o.color),t.push({position:o.position,color:o.color})}this.g2d.fillStyle=i,this.g2d.fillRect(0,0,this.g2d.canvas.width,this.g2d.canvas.height),this.opts.generateStyles&&(e=this._generatePreviewStyles()),this.opts.change(t,e)},removeControlPoint:function(e){var t=this.controlPoints.indexOf(e);-1!=t&&(this.controlPoints.splice(t,1),e.$el.remove())},previewClicked:function(e){var t=$(e.target).offset(),i=e.pageX-t.left,e=e.pageY-t.top,t=this.g2d.getImageData(i,e,1,1),e="rgb("+t.data[0]+","+t.data[1]+","+t.data[2]+")",t=this.createCtrlPt({position:i/this.g2d.canvas.width,color:e});this.controlPoints.push(t),this.controlPoints.sort(ctrlPtComparator)},_generatePreviewStyles:function(){for(var e=this.opts.type+"-gradient("+("linear"==this.opts.type?this.opts.fillDirection+", ":""),t=!0,i=0;i<this.controlPoints.length;++i){var n=this.controlPoints[i];t?t=!1:e+=", ",e+=n.color+" "+(100*n.position|0)+"%"}return[e+=")",browserPrefix+e]}},ControlPoint.prototype={drag:function(e,t){t=t.position.left;this.position=t/(this.$parentEl.width()-this.outerWidth),this.listener.updatePreview()},stop:function(e,t){this.listener.updatePreview(),this.configView.show(this.$el.position(),this.color,this)},clicked:function(e){return this.configView.show(this.$el.position(),this.color,this),e.stopPropagation(),!1},colorChanged:function(e){this.color=e,this.$el.css("background-color",this.color),this.listener.updatePreview()},removeClicked:function(){this.listener.removeControlPoint(this),this.listener.updatePreview()}},ControlPtConfig.prototype={onValueChange:function(){var e=this,t=e.$txtPerc.spinner("value"),t=parseInt(t)/100;$.isNumeric(t)&&(e.listener.position=t,t=(e.listener.$parentEl.width()-e.listener.$el.outerWidth())*e.listener.position,e.listener.$el.css("left",t),e.listener.listener.updatePreview())},show:function(e,t,i){var n=Math.round(100*i.position);this.visible=!0,this.listener=i,this.$txtPerc.spinner("value",n),this.$el.css("visibility","visible"),this.$cpicker.ColorPickerSetColor(t),this.$cpicker.css("background-color",t),"horizontal"===this.opts.orientation?this.$el.css("left",e.left):this.$el.css("top",e.top)},hide:function(){this.visible&&(this.$el.css("visibility","hidden"),this.visible=!1)},colorChanged:function(e,t,i){this.listener.colorChanged(t="#"+t),this.$cpicker.css("background-color",t)},removeClicked:function(){this.listener.removeClicked(),this.hide()}};var methods={init:function(i){i=$.extend({controlPoints:["#FFF 0%","#000 100%"],orientation:"horizontal",type:"linear",fillDirection:"left",generateStyles:!0,change:function(){}},i),this.each(function(){var e=$(this),t=new GradientSelection(e,i);e.data("gradientPicker-sel",t)})},update:function(t){this.each(function(){var e=$(this).data("gradientPicker-sel");null!=e&&e.updateOptions(t)})}},ColorPickerDialog=($.fn.gradientPicker=function(e,t){"string"==typeof e&&"init"!==e?methods[e].call(this,t):methods.init.call(this,t=e)},Backbone.View.extend({initialize:function(e){var i=this,n=[];i.options=e,i.showGradient="true"===e.values,i.noColor="true"===e.noColor,i.path=void 0===i.options.path?"none":i.options.path,i.$el.html(T.ColorPickerDialog()),i.$el.tabs({activate:function(){1===i.$el.tabs("option","active")?(i.loadGradient(),i.gradient=!0):i.gradient=!1}}),i.showGradient?i.height=333:i.height=293,n.push({text:"OK",click:$.proxy(i.onOKButtonClick,i),type:"submit"}),i.noColor&&n.push({text:"No Color",click:$.proxy(i.onNoColorClick,i),type:"submit"}),n.push({text:"Cancel",click:$.proxy(i.onCancelButtonClick,i),type:"submit"}),i.$el.dialog(_.extend({appendTo:e.container,classes:{"ui-dialog":"quick-dash color-picker-dialog"},title:t("Select Background Color ..."),resizable:!0,height:i.height,width:458,minWidth:i.height,modal:!0,autoOpen:!0,buttons:n,close:function(){},open:function(){i.initColorPicker(),i.initOverlayClick(),i.$el.dialog("option",{position:{my:"left top",at:"left bottom",collision:"flip flip",of:$(i.options.target)}}),i.showGradient?i.$el.find(".ui-tabs-nav").show():i.$el.find(".ui-tabs-nav").hide()}},e))},colorChanged:function(){},cssToControlPoint:function(e){var t=[],i=e.split("(");return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.path)||"none"===e||i.length<2?t=["black 0%","grey 50%","black 100%"]:(0<=i[0].indexOf("linear")?this.$el.find(".colorPickerType").val("linear"):this.$el.find(".colorPickerType").val("radial"),this.$el.find(".colorPickerType").selectmenu("refresh"),_.each(i[1].split(","),function(e){0<=_.indexOf(e,"%")&&t.push(e.toString().trim().replace(")",""))})),t},initColorPicker:function(){var e=this,t=this.$el.find(".solid_color"),i="ff00ff";/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.path)&&(i=this.path.replace("#","")),t.ColorPicker({flat:!0,onChange:function(){e.colorChanged()}}),this.$el.find(".colorpicker_hex").change(function(){e.colorChanged()}),this.$el.find(".colorpicker_color div").dblclick(function(){e.onOKButtonClick()}),this.$cpicker=t,this.$cpicker.ColorPickerSetColor(i),this.$cpicker.css("background-color",i)},initGradient:function(){var i,n=this,o=n.$el.find(".left"),a=n.$el.find(".cssGradient"),e=n.$el.find(".colorPickerType"),t=n.$el.find(".colorPickerDirection");n.$el.find(".grad_ex").html(""),n.$el.find("#ex1").gradientPicker({change:function(e,t){for(i=0;i<t.length;i+=1)o.css("background-image",t[i]),a.val(t[i]),n.path=t[i],n.colorChanged()},fillDirection:t.val(),type:e.val(),controlPoints:n.cssToControlPoint(n.path)}),n.setFillDirection(n.path)},initOverlayClick:function(){var e=this;$(this.$el.parent().parent().find(".ui-widget-overlay")).on("click",function(){e.onCancelButtonClick(),$(e.$el.parent().parent().find(".ui-widget-overlay")).off("click")})},loadGradient:function(){var t=this,e=t.$el.find(".colorPickerType"),i=t.$el.find(".colorPickerDirection");e.selectmenu({width:90}).on("selectmenuchange",function(){var e=t.$el.find(".colorPickerDirection").next(".ui-selectmenu-button");"linear"===$(this).val()?e.show():e.hide(),t.initGradient()}),i.selectmenu({width:90}).on("selectmenuchange",function(){t.initGradient()}),t.setFillDirection(t.path),t.initGradient()},onCancelButtonClick:function(){this.$el.dialog("close"),this.remove()},onNoColorClick:function(){var e=this.options.selectCallback;e&&e(""),this.$el.dialog("close"),this.remove()},onOKButtonClick:function(){var e=this.options.selectCallback;this.gradient||(this.path="#"+this.$cpicker.find(".colorpicker_hex input").val()),e&&e(this.path),this.$el.dialog("close"),this.remove()},onSelectButtonClick:function(){this.options.model.tooltips=this.result,this.options.editor.setValue(this.options.model),this.onCancelButtonClick()},setFillDirection:function(e){var i="left",t=e.split("(");!/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.path)&&"none"!==e&&1<t.length?_.each(t[1].split(","),function(e,t){-1===_.indexOf(e,"%")&&0===t&&(i=e.toString().trim())}):this.cssControls="linear-gradient("+i+", black 0%, grey 50%, black 100%)",this.$el.find(".colorPickerDirection").val(i),this.$el.find(".colorPickerDirection").selectmenu("refresh")}})),ColSelectorDialog=Backbone.View.extend({className:"dropdown-dialog",initialize:function(e){var i=this;i.options=e,i.path=void 0,this.$el.html(T.DropDownSelectableDialog()),this.$el.find(".pnlCustom").toggle(this.options.isUserDefined),this.options.isUserDefined&&this.$el.find(".customDropwdownInput").val(e.selected||""),i.$el.dialog(_.extend({appendTo:this.options.container,classes:{"ui-dialog":"quick-dash dd-Panel"},title:t(this.options.dropdownMessage),resizable:!0,width:280,modal:!0,autoOpen:!0,close:function(){i.remove()},open:function(){var t="",e=(i.$el.closest(".ui-dialog").siblings(".ui-widget-overlay:last").on("click",function(){i.closeDialog()}),_.each(i.options.values,function(e){e===i.options.selected?(t=t+'<li class="ui-widget-content ui-selected">'+e+"</li>",i.result=e):t=t+'<li class="ui-widget-content">'+e+"</li>"}),_.indexOf(i.options.values,i.options.selected)<0&&i.options.selected&&(t=t+'<li class="ui-widget-content ui-selected">'+i.options.selected+"</li>"),i.$el.find(".tp-selectable").append(t),i.initSelect(),i.options.dropdownType);i.$el.find(".wildcard-message").append('To create a "wild" '+e+" please use * "),i.$el.find(".customDropwdownSelect").append("Add Custom "+_.capitalize(e)).button().click(_.bind(i.onCustomColumnAdded,i)),i.$el.find(".customDropwdownInput").on("keydown",function(e){13===e.keyCode&&i.onCustomColumnAdded()}),i.$el.dialog("option",{position:{my:"left top",at:"left bottom",collision:"flip flip",of:$(i.options.target)}})}},this.options))},initSelect:function(){var t=this;t.$el.find(".tp-selectable").selectable({selected:function(){t.$el.find(".ui-selected",this).addClass("ui-selected").siblings().removeClass("ui-selected"),t.$el.find(".ui-selected",this).each(function(){t.result=this.textContent;var e=t.options.selectCallback;e&&e(this.textContent)}),t.closeDialog()}})},closeDialog:function(){this.$el.closest(".ui-dialog").siblings(".ui-widget-overlay:last").off("click"),this.$el.dialog("close")},onCustomColumnAdded:function(){var e=this.$el.find(".customDropwdownInput"),t=e.val(),i=this.options.selectCallback;t?(i&&i(t),this.closeDialog()):e.effect("highlight").focus()},onCancelButtonClick:function(){this.closeDialog()},onSelectButtonClick:function(){this.options.model.tooltips=this.result,this.onCancelButtonClick()},remove:function(){this.$(".tp-selectable").data("uiSelectable")&&this.$(".tp-selectable").selectable("destroy"),this.$(".customDropwdownSelect").data("uiButton")&&this.$(".customDropwdownSelect").off().button("destroy"),this.$(".customDropwdownInput").off(),this.$el.data("uiDialog")&&this.$el.dialog("destroy"),Backbone.View.prototype.remove.apply(this,arguments)}}),DomOutline=function(e){var s={},l={opts:{namespace:(e=e||{}).namespace||"DomOutline",borderWidth:e.borderWidth||2,filter:e.filter||!1,onClick:e.onClick||!1,onHover:e.onHover||!1,parentElement:e.parentElement||!1},keyCodes:{BACKSPACE:8,ESC:27,DELETE:46},active:!1,initialized:!1,elements:{}};function t(){var e,t;!0!==l.initialized&&(e="."+l.opts.namespace+" {    background: #09c;    position: absolute;    z-index: 1000000;    pointer-events: none;}."+l.opts.namespace+"_label {    background: #09c;    border-radius: 2px;    color: #fff;    font: bold 12px/12px Helvetica, sans-serif;    padding: 4px 6px;    position: absolute;    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.25);    z-index: 1000001;}",e=e,(t=document.createElement("style")).type="text/css",t.setAttribute("class",l.opts.namespace),document.getElementsByTagName("head")[0].appendChild(t),t.styleSheet?t.styleSheet.cssText=e:t.innerHTML=e,l.initialized=!0)}function i(e){var t,i,n,o,a=jQuery(e.target);a.attr("class")&&-1!==a.attr("class").indexOf(l.opts.namespace)||l.opts.filter&&!a.is(l.opts.filter)||l.opts.parentElement&&!a.is(l.opts.parentElement)&&!a.parents(l.opts.parentElement).length||(s.element=e.target,s.clickHandler=_.once(function(){l.opts.parentElement&&!jQuery(s.element).is(l.opts.parentElement)&&!jQuery(s.element).parents(l.opts.parentElement).length||(s.stop(),l.opts.onClick(s.element))}),a=l.opts.borderWidth,l.elements.window||(l.elements.window=jQuery(window)),e=l.elements.window.scrollTop(),i=(t=s.element.getBoundingClientRect()).top+e,n=s.element,t.width,t.height,o=n.tagName.toLowerCase(),n.id&&(o+="#"+n.id),$(n).attr("class")&&(o+=("."+jQuery.trim($(n).attr("class")).replace(/ /g,".")).replace(/\.\.+/g,".")),n=o,o=Math.max(0,i-20-a,e),e=Math.max(0,t.left-a),l.elements.label.css({top:o,left:e}).text(n),l.elements.top.css({top:Math.max(0,i-a),left:t.left-a,width:t.width+a,height:a}),l.elements.bottom.css({top:i+t.height,left:t.left-a,width:t.width+a,height:a}),l.elements.left.css({top:i-a,left:Math.max(0,t.left-a),width:a,height:t.height+a}),l.elements.right.css({top:i-a,left:t.left+t.width,width:a,height:t.height+2*a}),l.elements.clickBlocker.css({top:i,left:t.left,width:t.width,height:t.height}),l.opts.onHover&&l.opts.onHover(n),jQuery(s.element).off("mousedown."+l.opts.namespace),jQuery("body").off("mouseup."+l.opts.namespace),jQuery(s.element).on("mousedown."+l.opts.namespace,function(e){jQuery(s.element).off("mousedown."+l.opts.namespace),l.elements.clickBlocker.show(),jQuery("body").on("mouseup."+l.opts.namespace,function(e){if(jQuery("body").off("mouseup."+l.opts.namespace),l.elements.clickBlocker.hide(),l.opts.filter&&!jQuery(e.target).is(l.opts.filter))return!1;s.clickHandler()})}))}function n(e){return e.keyCode!==l.keyCodes.ESC&&e.keyCode!==l.keyCodes.BACKSPACE&&e.keyCode!==l.keyCodes.DELETE||s.stop(),!1}return s.start=function(){t(),!0!==l.active&&(l.active=!0,l.elements.label=jQuery("<div></div>").addClass(l.opts.namespace+"_label").appendTo("body"),l.elements.top=jQuery("<div></div>").addClass(l.opts.namespace).appendTo("body"),l.elements.bottom=jQuery("<div></div>").addClass(l.opts.namespace).appendTo("body"),l.elements.left=jQuery("<div></div>").addClass(l.opts.namespace).appendTo("body"),l.elements.right=jQuery("<div></div>").addClass(l.opts.namespace).appendTo("body"),l.elements.clickBlocker=jQuery("<div></div>").addClass(l.opts.namespace).appendTo("body").hide().css("background","none"),jQuery("body").on("mousemove."+l.opts.namespace,i),jQuery("body").on("keyup."+l.opts.namespace,n),l.opts.onClick)&&setTimeout(function(){},50)},s.stop=function(){l.active=!1,jQuery.each(l.elements,function(e,t){t.remove()}),jQuery("body").off("mousemove."+l.opts.namespace).off("mousedown."+l.opts.namespace).off("mouseup."+l.opts.namespace).off("keyup."+l.opts.namespace).off("click."+l.opts.namespace)},s},CssDialog=(jQuery.fn.extend({getPath:function(e,t,i,n,o,a){var s,l,r,c;return e=e||"html",this.is(e=void 0===(o=void 0===o?"":o)?"html":e)?e+o:this.is(n)?this.parent().getPath(e,t,i,n,o.substring(o.indexOf(">")+1),!0):(s=this.get(0).nodeName.toLowerCase(),l=this.attr("id"),c=this.attr("class"),t&&(r=this.data(t)),l&&_.every(i.id,function(e){return 0!==l.indexOf(e)})&&!i.ignoreIds&&(s+="#"+l),void 0!==c&&""!==c&&(c=c.split(/[\s\n]+/),(c=_.reject(c,function(t){return _.some(i.class,function(e){return 0===t.indexOf(e)})})).length)&&(s+="."+c.join(".")),void 0!==r?(s="[data-"+t+'="'+r+'"]')+o:a?this.parent().getPath(e,t,i,n,o,a):this.parent().getPath(e,t,i,n," > "+s+o,a))}}),Backbone.View.extend({DIALOG_HEIGHT:540,DIALOG_HEIGHT_INSPECTING:0,INSPECTING_PROP:"isInspecting",IGNORE_ID_WIDGET_KEYS:["TreeView"],className:"css-dialog",dataView:null,propertiesView:null,initialize:function(i){var e,n=this;n.applyCallback=i.applyCallback,n.viewModel=i.viewModel,n.isPropertiesCollapsed=!1,e=n.viewModel.get("selectedWidget")?'[data-widgetid="'+n.viewModel.get("selectedWidgetId")+'"]':"div.worksheet",n.path=void 0,n.$el.html(T.CssDialog()),n.$elementPicker=n.$el.find(".element-picker"),n.$highlightedElement=n.$el.find(".highlighted-element"),n.domOutline=new DomOutline({namespace:"DomOutline",onClick:function(e){var t;n.stopInspecting(),e&&(t=(t=$(e).parents("div[data-componentid]")).length&&-1!==n.IGNORE_ID_WIDGET_KEYS.indexOf(t.attr("data-componentid")),e=$(e).getPath(".content-panel","widgetid",{id:["date_","graphHeader_","graphing_","upload","slickgrid_"],class:["active","component-build-view","has-tools","hover","mouseDown","nv-chart-","selected","slickgrid_","ui-sortable","ui-state-","ui-widget","grid-stack-instance-"],ignoreIds:t},".app-div"),n.viewModel.get("selectedWidgetView")&&_.isFunction(n.viewModel.attributes.selectedWidgetView.app.getCssPrefix)&&(e=n.viewModel.attributes.selectedWidgetView.app.getCssPrefix()+e),t=n.editor.getValue(),n.editor.setValue(t=t+(t?"\n\n":"")+e+" {\n    \n}"),t&&(e=t.split("\n").length-1,n.editor.setPosition({column:4,lineNumber:e}),n.editor.revealLine(1+e)),n.editor.focus())},onHover:function(e){n.$highlightedElement.text(e)},parentElement:i.parentElement||e}),n.$dialog=n.$el.dialog({appendTo:i.container,title:t("Advanced CSS"),resizable:!0,height:n.DIALOG_HEIGHT,width:800,minWidth:354,modal:!1,autoOpen:!0,buttons:[{text:t("Element Selector"),click:$.proxy(n.toggleInspecting,n),icon:"fa fa-mouse-pointer"},{text:t("Apply"),click:$.proxy(n.onApplyButtonClick,n),icon:"fa fa-check"},{text:t("Close"),click:function(){n.$el.dialog("close")},icon:"fa fa-times"}],beforeClose:function(){i.beforeClose&&i.beforeClose()},close:function(){n.stopInspecting(),n.remove(),i.close&&i.close()},open:function(){$('<i class="fa fa-css3" />').insertBefore(n.$el.parent().find(".ui-dialog-title")),MonacoHelpers.require({language:"css"},function(e){var e=e.monaco,t=n.$el.find(".query-editor")[0];n.editor=e.editor.create(t,_.assign({},MonacoHelpers.DEFAULT_OPTIONS(),{value:i.styles,language:"css",peekWidgetDefaultFocus:!0}))})}}),n.initializeEvents()},initializeEvents:function(){this.listenTo(this.viewModel,"change:"+this.INSPECTING_PROP,this.onViewInspectingChange),this.listenTo(this.viewModel,"change:buildMode",this.remove),this.$elementPicker.on("click",$.proxy(this.toggleInspecting,this))},onApplyButtonClick:function(){this.applyCallback(this.editor.getValue())},onViewInspectingChange:function(){var e=this.viewModel.get(this.INSPECTING_PROP);this.$el.toggleClass("inspecting",e),this.setDialogCompact(e),e?(this.domOutline.start(),this.viewModel.get("selectedWidgetView")&&_.isFunction(this.viewModel.attributes.selectedWidgetView.app.startInspecting)&&this.viewModel.attributes.selectedWidgetView.app.startInspecting()):(this.domOutline.stop(),this.$highlightedElement.text(""),this.viewModel.get("selectedWidgetView")&&_.isFunction(this.viewModel.attributes.selectedWidgetView.app.stopInspecting)&&this.viewModel.attributes.selectedWidgetView.app.stopInspecting())},onResize:function(){MonacoHelpers.adjustAfterResize(this.editor)},remove:function(){$(".DomOutline_label").remove(),$(".DomOutline").remove(),Backbone.View.prototype.remove.call(this)},setDialogCompact:function(e){this.$el.dialog("option","height",e?this.DIALOG_HEIGHT_INSPECTING:this.DIALOG_HEIGHT)},stopInspecting:function(){this.viewModel.set(this.INSPECTING_PROP,!1)},toggleInspecting:function(){this.viewModel.set(this.INSPECTING_PROP,!this.viewModel.get(this.INSPECTING_PROP))}})),DataModelPropertiesView=Backbone.View.extend({initialize:function(e){var t=this,i=[];t.model&&_.each(_.filter(_.keys(t.model.attributes),function(e){return 0===e.indexOf("_")}),function(e){i.push({key:e,val:t.model.get(e)})}),t.$el.html(T.DataModelProperties(i)),t.$el.find(".config-btn").button({icon:"fa fa-cog fa-fw"}).click(function(e){e.preventDefault(),e.stopPropagation(),t.trigger("configure")})}}),AccordionView=function(){function e(e){var t=this;this.className="accordion",this.HEADING_HEIGHT=32,this.el=e.el,this.$el=$(e.el),this.el.classList.add("accordion"),this.onUpdate=e.onUpdate,this.sections=e.sections||[{heading:"Section 1",weight:2,isExpanded:!0,$el:$("<div>yooo1</div>")},{heading:"Section 2",weight:1,isExpanded:!0,$el:$("<div>yooo2</div>")}],_.each(this.sections,function(e){e.$el&&(e.$heading=e.$el.find(e.$heading),e.$content=e.$el.find(e.$content))}),this.debouncedRemoveAnimate=_.debounce(function(){t.el.classList.remove("animate"),t.onUpdate&&t.onUpdate(t.sections)},300),this.updateLayout(!1)}return e.prototype.adjustWeights=function(e,i){var n=this.sum(_.map(e,function(e){return e.weight})),o=this.sum(i);_.each(e,function(e,t){e.weight=n*(i[t]/o)})},e.prototype.onSectionResize=function(e,t,i){for(var n=e.$el.height(),o=n-i.originalSize.height,a=[e],s=[n],l=0,r=this.sections.indexOf(e)+1;r<this.sections.length;r+=1){var c=this.sections[r];if(c.isExpanded&&!c.fixed&&!c.hidden){var d=Math.max(this.HEADING_HEIGHT,c.startHeight-(o-l));if(l+=Math.min(c.startHeight-this.HEADING_HEIGHT,o-l),c.$el.height(d+"px"),a.push(c),s.push(d),l===o)break}}this.adjustWeights(a,s)},e.prototype.resize=function(){this.updateLayout(!1)},e.prototype.sum=function(e){return _.reduce(e,function(e,t){return e+t},0)},e.prototype.updateLayout=function(e){var n=this,t=this.$el.height(),i=(this.$el.toggleClass("animate",e),_.filter(this.sections,function(e){return e.isExpanded&&!e.hidden})),i=(t=(t-=_.filter(this.sections,function(e){return!e.hidden&&!e.isExpanded}).length*this.HEADING_HEIGHT)-this.sum(_.map(_.filter(i,function(e){return e.isExpanded&&e.fixed}),function(e){return e.fixed||0})),this.sum(_.map(i,function(e){return e.fixed?0:e.weight}))),o=t/i;this.sections.forEach(function(e,t){var i;e.$el.toggleClass("expanded",e.isExpanded),e.isExpanded&&!e.hidden?(i=e.fixed||e.weight*o,e.$el.height(i)):e.$el.height(0),e.resize&&!e.hidden&&e.resize(),e.hidden?e.$el.hide():(e.$el.show(),e.isExpanded&&!e.fixed&&!e.hidden&&t<n.sections.length-1&&_.some(n.sections.slice(t+1),function(e){return e.isExpanded&&!e.fixed})?e.resizeable=e.$el.resizable({handles:"s",resize:$.proxy(n.onSectionResize,n,e),start:function(){_.each(n.sections,function(e){e.startHeight=e.$el.height()}),e.$el.resizable("option","maxHeight",n.$el.height()-(n.sections.length-1)*n.HEADING_HEIGHT)},stop:function(){return n.updateLayout()}}):e.resizeable&&(e.$el.resizable("destroy"),delete e.resizeable))}),e?this.debouncedRemoveAnimate():this.onUpdate&&this.onUpdate(this.sections)},e}(),PropertiesTagView=(jQuery.fn.caret=function(e){var t,i=this[0],n="true"===i.contentEditable;if(0!=arguments.length)return-1==e&&(e=this[n?"text":"val"]().length),window.getSelection?n?(i.focus(),window.getSelection().collapse(i.firstChild,e)):i.setSelectionRange(e,e):document.body.createTextRange&&(n?((a=document.body.createTextRange()).moveToElementText(i),a.moveStart("character",e),a.collapse(!0)):(a=i.createTextRange()).move("character",e),a.select()),n||i.focus(),e;if(window.getSelection)return n?(i.focus(),(o=(t=window.getSelection().getRangeAt(0)).cloneRange()).selectNodeContents(i),o.setEnd(t.endContainer,t.endOffset),o.toString().length):i.selectionStart;if(document.selection){if(i.focus(),n)return t=document.selection.createRange(),(o=document.body.createTextRange()).moveToElementText(i),o.setEndPoint("EndToEnd",t),o.text.length;var o,e=0,a=i.createTextRange(),n=(o=document.selection.createRange().duplicate()).getBookmark();for(a.moveToBookmark(n);0!==a.moveStart("character",-1);)e++;return e}return i.selectionStart||0},!function(b){b.fn.tagEditorInput=function(){var t=" ",i=b(this),n=parseInt(i.css("fontSize")),o=b("<span></span>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:i.css("fontSize"),fontFamily:i.css("fontFamily"),fontWeight:i.css("fontWeight"),letterSpacing:i.css("letterSpacing"),whiteSpace:"nowrap"});return o.insertAfter(i),i.bind("keyup keydown focus",function(){var e;t!==(t=i.val())&&(o.text(t),(e=(e=o.width()+n)<20?20:e)!=i.width())&&i.width(e)})},b.fn.tagEditor=function(n,o,a){function m(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var g,s,f=b.extend({},b.fn.tagEditor.defaults,n);return f.dregex=new RegExp("["+f.delimiter.replace("-","-")+"]","g"),"string"==typeof n?(s=[],this.each(function(){var e=b(this),t=e.data("options"),i=e.next(".tag-editor");if("getTags"==n)s.push({field:e[0],editor:i,tags:i.data("tags")});else if("addTag"==n){if(t.maxTags&&i.data("tags").length>=t.maxTags)return!1;b('<li><div class="tag-editor-spacer">&nbsp;'+t.delimiter[0]+'</div><div class="tag-editor-tag"></div><div class="tag-editor-delete"><i></i></div></li>').appendTo(i).find(".tag-editor-tag").html('<input type="text" maxlength="'+t.maxLength+'">').addClass("active").find("input").val(o).blur(),a?b(".placeholder",i).remove():i.click()}else"removeTag"==n?(b(".tag-editor-tag",i).filter(function(){return b(this).text()==o}).closest("li").find(".tag-editor-delete").click(),a||i.click()):"destroy"==n&&e.removeClass("tag-editor-hidden-src").removeData("options").off("focus.tag-editor").next(".tag-editor").remove()}),"getTags"==n?s:this):(window.getSelection&&b(document).off("keydown.tag-editor").on("keydown.tag-editor",function(e){if(8==e.which||46==e.which||e.ctrlKey&&88==e.which){try{var t=getSelection(),n="INPUT"!=document.activeElement.tagName?b(t.getRangeAt(0).startContainer.parentNode).closest(".tag-editor"):0}catch(e){n=0}if(0<t.rangeCount&&n&&n.length){var o=[],a=t.toString().split(n.prev().data("options").dregex);for(i=0;i<a.length;i++){var s=b.trim(a[i]);s&&o.push(s)}return b(".tag-editor-tag",n).each(function(){~b.inArray(b(this).text(),o)&&b(this).closest("li").find(".tag-editor-delete").click()}),!1}}}),this.each(function(){var t,i,r=b(this),c=[],d=b("<ul "+(f.clickDelete?'oncontextmenu="return false;" ':"")+'class="tag-editor"></ul>').insertAfter(r),u=(r.addClass("tag-editor-hidden-src").data("options",f).on("focus.tag-editor",function(){d.click()}),d.append('<li style="width:1px">&nbsp;</li>'),'<li><div class="tag-editor-spacer">&nbsp;'+f.delimiter[0]+'</div><div class="tag-editor-tag"></div><div class="tag-editor-delete"><i></i></div></li>');function o(){!f.placeholder||c.length||b(".deleted, .placeholder, input",d).length||d.append('<li class="placeholder"><div>'+f.placeholder+"</div></li>")}function p(e){var t=c.toString();c=b(".tag-editor-tag:not(.deleted)",d).map(function(e,t){t=b.trim(b(this).hasClass("active")?b(this).find("input").val():b(t).text());if(t)return t}).get(),d.data("tags",c),r.val(c.join(f.delimiter[0])),e||t!=c.toString()&&f.onChange(r,d,c),o()}function a(e){for(var t,i=e.closest("li"),n=e.val().replace(/ +/," ").split(f.dregex),o=e.data("old_tag"),a=c.slice(0),s=!1,l=0;l<n.length;l++)if(h=b.trim(n[l]).slice(0,f.maxLength),f.forceLowercase&&(h=h.toLowerCase()),t=f.beforeTagSave(r,d,a,o,h),h=t||h,!1!==t&&h&&(f.removeDuplicates&&~b.inArray(h,a)&&b(".tag-editor-tag",d).each(function(){b(this).text()==h&&b(this).closest("li").remove()}),a.push(h),i.before('<li><div class="tag-editor-spacer">&nbsp;'+f.delimiter[0]+'</div><div class="tag-editor-tag">'+m(h)+'</div><div class="tag-editor-delete"><i></i></div></li>'),f.maxTags)&&a.length>=f.maxTags){s=!0;break}e.attr("maxlength",f.maxLength).removeData("old_tag").val(""),s?e.blur():e.focus(),p()}d.click(function(n,o){var a,s,l=99999;if(!window.getSelection||""==getSelection())return f.maxTags&&d.data("tags").length>=f.maxTags?d.find("input").blur():(g=!0,b("input:focus",d).blur(),g&&(g=!0,b(".placeholder",d).remove(),o&&o.length?s="before":b(".tag-editor-tag",d).each(function(){var e=b(this),t=e.offset(),i=t.left,t=t.top;n.pageY>=t&&n.pageY<=t+e.height()&&(a=n.pageX<i?(s="before",i-n.pageX):(s="after",n.pageX-i-e.width()))<l&&(l=a,o=e)}),("before"==s?b(u).insertBefore(o.closest("li")):"after"==s?b(u).insertAfter(o.closest("li")):b(u).appendTo(d)).find(".tag-editor-tag").click())),!1}),d.on("click",".tag-editor-delete",function(e){var t,i;return b(this).prev().hasClass("active")?b(this).closest("li").find("input").caret(-1):(i=(t=b(this).closest("li")).find(".tag-editor-tag"),!1!==f.beforeTagDelete(r,d,c,i.text())&&(i.addClass("deleted").animate({width:0},f.animateDelete,function(){t.remove(),o()}),p())),!1}),f.clickDelete&&d.on("mousedown",".tag-editor-tag",function(e){var t;if(e.ctrlKey||1<e.which)return e=(t=b(this).closest("li")).find(".tag-editor-tag"),!1!==f.beforeTagDelete(r,d,c,e.text())&&(e.addClass("deleted").animate({width:0},f.animateDelete,function(){t.remove(),o()}),p()),!1}),d.on("click",".tag-editor-tag",function(e){var t,i,n;return f.clickDelete&&(e.ctrlKey||1<e.which)||b(this).hasClass("active")||(i=b(this).text(),e=Math.abs((b(this).offset().left-e.pageX)/b(this).width()),e=parseInt(i.length*e),(t=b(this).html('<input type="text" maxlength="'+f.maxLength+'" value="'+m(i)+'">').addClass("active").find("input")).data("old_tag",i).tagEditorInput().focus().caret(e),f.autocomplete&&(i=b.extend({},f.autocomplete),n="select"in i?f.autocomplete.select:"",i.select=function(e,t){n&&n(e,t),setTimeout(function(){d.trigger("click",[b(".active",d).find("input").closest("li").next("li").find(".tag-editor-tag")])},20)},t.autocomplete(i))),!1}),d.on("blur","input",function(e){e.stopPropagation();var t=b(this),i=t.data("old_tag"),n=b.trim(t.val().replace(/ +/," ").replace(f.dregex,f.delimiter[0]));if(n){if(0<=n.indexOf(f.delimiter[0]))return void a(t);if(n!=i)if(f.forceLowercase&&(n=n.toLowerCase()),cb_val=f.beforeTagSave(r,d,c,i,n),n=cb_val||n,!1===cb_val){if(i)return t.val(i).focus(),g=!1,void p();try{t.closest("li").remove()}catch(e){}i&&p()}else f.removeDuplicates&&b(".tag-editor-tag:not(.active)",d).each(function(){b(this).text()==n&&b(this).closest("li").remove()})}else{if(i&&!1===f.beforeTagDelete(r,d,c,i))return t.val(i).focus(),g=!1,void p();try{t.closest("li").remove()}catch(e){}i&&p()}t.parent().html(m(n)).removeClass("active"),n!=i&&p(),o()}),d.on("paste","input",function(e){b(this).removeAttr("maxlength"),t=b(this),setTimeout(function(){a(t)},30)}),d.on("keypress","input",function(e){0<=f.delimiter.indexOf(String.fromCharCode(e.which))&&(i=b(this),setTimeout(function(){a(i)},20))}),d.on("keydown","input",function(e){var t,i,n=b(this);if((37==e.which||!f.autocomplete&&38==e.which)&&!n.caret()||8==e.which&&!n.val())return(t=n.closest("li").prev("li").find(".tag-editor-tag")).length?t.click().find("input").caret(-1):!n.val()||f.maxTags&&d.data("tags").length>=f.maxTags||b(u).insertBefore(n.closest("li")).find(".tag-editor-tag").click(),!1;if((39==e.which||!f.autocomplete&&40==e.which)&&n.caret()==n.val().length)return(i=n.closest("li").next("li").find(".tag-editor-tag")).length?i.click().find("input").caret(0):n.val()&&d.click(),!1;if(9==e.which){if(e.shiftKey)if((t=n.closest("li").prev("li").find(".tag-editor-tag")).length)t.click().find("input").caret(0);else{if(!n.val()||f.maxTags&&d.data("tags").length>=f.maxTags)return r.attr("disabled","disabled"),void setTimeout(function(){r.removeAttr("disabled")},30);b(u).insertBefore(n.closest("li")).find(".tag-editor-tag").click()}else if((i=n.closest("li").next("li").find(".tag-editor-tag")).length)i.click().find("input").caret(0);else{if(!n.val())return;d.click()}return!1}if(!(46!=e.which||b.trim(n.val())&&n.caret()!=n.val().length))return(i=n.closest("li").next("li").find(".tag-editor-tag")).length?i.click().find("input").caret(0):n.val()&&d.click(),!1;if(13==e.which)return d.trigger("click",[n.closest("li").next("li").find(".tag-editor-tag")]),f.maxTags&&d.data("tags").length>=f.maxTags&&d.find("input").blur(),!1;if(36!=e.which||n.caret()){if(35==e.which&&n.caret()==n.val().length)d.find(".tag-editor-tag").last().click();else if(27==e.which)return n.val(n.data("old_tag")?n.data("old_tag"):"").blur(),!1}else d.find(".tag-editor-tag").first().click()});for(var e=f.initialTags.length?f.initialTags:r.val().split(f.dregex),n=0;n<e.length&&!(f.maxTags&&n>=f.maxTags);n++){var h=b.trim(e[n].replace(/ +/," "));h&&(f.forceLowercase&&(h=h.toLowerCase()),c.push(h),d.append('<li><div class="tag-editor-spacer">&nbsp;'+f.delimiter[0]+'</div><div class="tag-editor-tag">'+m(h)+'</div><div class="tag-editor-delete"><i></i></div></li>'))}p(!0),f.sortable&&b.fn.sortable&&d.sortable({distance:5,cancel:".tag-editor-spacer, input",helper:"clone",update:function(){p()}})}))},b.fn.tagEditor.defaults={initialTags:[],maxTags:0,maxLength:50,delimiter:",;",placeholder:"",forceLowercase:!0,removeDuplicates:!0,clickDelete:!1,animateDelete:175,sortable:!0,autocomplete:null,onChange:function(){},beforeTagSave:function(){},beforeTagDelete:function(){}}}(jQuery),Backbone.View.extend({tagName:"textarea",className:"tagEditor",preventModelUpdate:!1,visibleTagsList:[],initialize:function(e){this.options=e,this.$el.addClass(this.className),this.render(),this.initializeEvents()},initializeEvents:function(){this.listenTo(this.model,"change:"+this.options.property,this.render)},addMultipleTags:function(e){var t=this;_.each(e,function(e){t.$el.tagEditor("addTag",e)})},onTagsChanged:function(e,t,i){this.preventModelUpdate||(this.stopListening(),this.visibleTagsList=i,this.model.set(this.options.property,i),this.initializeEvents())},render:function(){var e=this.model.get(this.options.property),t=(this.options.placeholder,this.options.removeDuplicates||!1);this.$el.tagEditor("destroy"),this.$el.val(""),this.$el.tagEditor({initialTags:e,forceLowercase:!1,animateDelete:0,sortable:!0,removeDuplicates:t,delimiter:" |",onChange:$.proxy(this.onTagsChanged,this),autocomplete:this.options.autocomplete||null})},refreshTags:function(e){0<this.visibleTagsList.length&&(this.preventModelUpdate=!0,this.removeAllTags(),this.addMultipleTags(e),this.visibleTagsList=e,this.preventModelUpdate=!1)},removeAllTags:function(){var t=this;_.each(_.uniq(t.visibleTagsList),function(e){t.$el.tagEditor("removeTag",e)})}})),DataConfigAggregateRow=Backbone.View.extend({tagName:"li",className:"pivotRow",AGGREGATE_FNS:["count","sum","avg","max","min","first","last"],events:{"change input":"onValueChange"},initialize:function(e){this.options=e,this.render()},checkAggregateFn:function(e){return-1<this.AGGREGATE_FNS.indexOf(e)||-1<e.indexOf(";")},handleInvalidEntry:function(e){$(e).addClass("invalidEntry"),_.delay(function(){$(e).removeClass("invalidEntry")},3e3)},onValueChange:function(e){var t=$.trim(this.$el.find(".aggregateColItm").val()),i=this.model.get("_aggregateCols"),n=$.trim(this.$el.find(".aggregateFnItm").val()),o=this.model.get("_aggregateFns"),a=this.model.get("_aggregateLabels"),s=$.trim(this.$el.find(".aggregateLabelItm").val());-1===a.indexOf(s)||""===s||$(e.currentTarget).hasClass("aggregateColItm")||$(e.currentTarget).hasClass("aggregateFnItm")?($(e.currentTarget).hasClass("aggregateFnItm")&&!this.checkAggregateFn(n)&&this.handleInvalidEntry(e.currentTarget),i[i=this.$el.index()]=t,o[i]=n,a[i]=s,this.model.trigger("change:_aggregateCols")):this.handleInvalidEntry(e.currentTarget)},removeModelDetails:function(){var e=this.$el.index();-1<e&&(this.model.get("_aggregateCols").splice(e,1),this.model.get("_aggregateFns").splice(e,1),this.model.get("_aggregateLabels").splice(e,1),this.model.trigger("change:_aggregateCols"),this.remove())},render:function(){this.$el.html(T.DataConfigAggregateRow(this.options.aggregateDetails)),this.$el.find(".deleteRow").button({icon:"fa fa-trash",text:!1}).click($.proxy(this.removeModelDetails,this))}}),TreeView=function(t){function m(r){var e=t.call(this,_.extend({},r,{className:"dataView"}))||this;return e.contextMenuFn=r.contextMenuFn,e.determineTypeFn=r.determineTypeFn,e.disabledNodes=r.disabledNodes,e.initialSelection=r.selected,e.newGroupFn=r.newGroupFn,e.newNodeFn=r.newNodeFn,e.nodeLabel=r.nodeLabel||"Node",e.nodeTypes=r.nodeTypes||{},e.setPathFn=r.setPathFn,e.cleanUpFn=r.cleanUpFn,e.saveCb=r.saveCb,e.noSaveCb=r.noSaveCb,e.areYouSureMessage=r.areYouSureMessage,e.viewOptions=r.viewOptions,e.getCleanUpButtonState=r.getCleanUpButtonState,e.getDocumentGraph=r.getDocumentGraph,e.eventBus=r.eventBus,e.treeViewType=r.treeViewType,e.$el.addClass("dataView"),e.$el.html(T.TreeView()),e.$createButton=e.$el.find(".new").button({icon:"fa fa-square-o"}),e.$renameButton=e.$el.find(".rename").button({icon:"fa fa-pencil-square-o",disabled:!0}),e.$deleteButton=e.$el.find(".delete").button({icon:"fa fa-trash-o",disabled:!0}),e.$cleanUpButton=e.$el.find(".clean-up").button({icon:"fa fa-magic",disabled:e.getCleanUpButtonState()}),e.$searchInput=e.$el.find(".search"),e.$searchInput.attr("placeholder","Search "+e.nodeLabel+"s..."),e.$clearSearch=e.$el.find(".clearSearch"),e.debouncedSearch=_.debounce(_.bind(e.jstreeSearch,e),250),require(["jstree"],function(){var u=e;e.$tree=e.$el.find(".tree").jstree({core:{data:e.convertModelToJSTreeModel(_.omit(e.model.attributes,".settings")),error:function(e){var t,i,n,o,a,s=JSON.parse(e.data);switch(e.id){case"unique_01":_.defer(function(){this.edit(s.obj)}.bind(this)),QuickBase.ErrorTooltip.clear(u.$errorTooltip),u.$errorTooltip=QuickBase.ErrorTooltip.show("Name already exists",u.$el.find("#"+s.obj),!0),_.delay(function(){QuickBase.ErrorTooltip.clear(u.$errorTooltip,!0)},5e3);break;case"core_01":case"types_02":case"unique_02":if(n=this.get_json(s.obj),"core_01"!==e.id||"group"!==n.type)if(i="unique_02"===e.id?m.calculatePath({node:this.get_node(s.par),instance:this},s.par):m.calculateParentPath({node:this.get_node(s.par),instance:this}),t=u.getModelFromPath(u.model,i),"types_02"===e.id&&"move_node"===s.chk&&t.get(n.text))u.showTargetExistsError(s);else{for(o=n.text;t.get(n.text);)n.text+=" copy";if(delete n.id,delete n.a_attr,delete n.li_attr,a="unique_02"===e.id?s.par:this.get_node(s.par).parent,"move_node"!==s.chk)if("group"===n.type&&n.children.length){n.children.length=0;for(var l=this.create_node("#"===a?null:a,n),r=this.get_json(s.obj).children,c=[],d=0;d<r.length;d++)c.push(this._model.data[r[d].id]);this.copy_node(c,this.get_node(l)),_.defer(function(){u.trigger("select_property")})}else{this.create_node("#"===a?null:a,n),u.onTreeNodeCopy(i,m.calculateParentPath({node:this.get_node(s.obj),instance:this}),n.text,o);l=_.find(this._model.data,function(e){return e.text==n.text&&e.parent==a});l&&(l.data=t.attributes[n.text].cid)}else this.move_node(this.get_node(s.obj),this.get_node(a)),u.onTreeNodeMove(i,m.calculateParentPath({node:this.get_node(s.obj),instance:this}),n.text)}break;case"core_03":break;case"unique_03":u.showTargetExistsError(s)}},check_callback:function(e,t,i,n,o){t=this.get_node(t);return"move_node"!==e||t.parent!==this.get_node(i).id&&!u.hasDashboardSystemPath(this.get_type(this.get_node(i)),this.get_path(i))},themes:{dots:!0}},dnd:{is_draggable:function(e){for(var t=!0,i=0;i<e.length;i++){var n=this.get_type(e[i]),o=this.get_path(e[i]);if(u.hasDashboardSystemPath(n,o)){t=!1;break}}return t}},sort:function(e,t){var i=(this.get_type(e)||"").match(/^[a-z]+/)[0],n=(this.get_type(t)||"").match(/^[a-z]+/)[0];return i===n?this.get_text(e)>this.get_text(t)?1:-1:n<=i?1:-1},contextmenu:{items:function(e){if(!u.pending||!u.selectionChanged){for(var t=$.jstree.defaults.contextmenu.items(),i=this.get_type(e),n=(this.get_path(e),this.get_selected()),o=!1,a=0;a<n.length;a++){var s=this.get_type(n[a]),l=this.get_path(n[a]);if(u.hasDashboardSystemPath(s,l)){o=!0;break}}if(!(r.viewOptions&&r.viewOptions.hideToolBarBtns||o))return delete t.create.action,t.create.label="New",t.create._disabled=u.$createButton.button("option","disabled"),t.create._disabled||(t.create.submenu={create_node:{label:u.nodeLabel,action:function(e){return u.onCreateNode(e,"node")}},create_group:{label:"Group",action:function(e){return u.onCreateNode(e,"group")}}}),t.ccp&&(t.ccp.submenu.paste._disabled=u.$createButton.button("option","disabled")),t.rename&&(t.rename._disabled=u.$renameButton.button("option","disabled")),t.remove&&(t.remove._disabled=u.$deleteButton.button("option","disabled"),t.remove.title=u.$deleteButton.attr("title")),_.isFunction(u.contextMenuFn)&&_.extend(t,u.contextMenuFn(i,t.create._disabled)),t}}},search:{show_only_matches:!0,show_only_matches_children:!0},types:_.extend({node:{valid_children:[],icon:"fa fa-fw fa-file-text"},group:{icon:"fa fa-fw fa-folder"}},e.nodeTypes),unique:{duplicate:function(e,t){return e+" "+t}},plugins:["contextmenu","dnd","search","stackedicon","state","types","wholerow","unique","sort"]}),e.setupViewOptions(),e.initializeEvents()}),e}return __extends(m,t),m.prototype.setupViewOptions=function(){this.viewOptions&&this.viewOptions.hideToolBarBtns&&(this.$el.find(".toolbar > button").hide(),this.$el.find(".jstree").addClass("tree-top"))},m.prototype.getConnectedNodes=function(){var e=this.getDocumentGraph();return"VIEW_STATE"===this.treeViewType?e.getConnectedViewStates():e.getDataSourcesConnectedToComponents()},m.prototype.updateTheme=function(){var e=$("#appdiv .toolbar").hasClass("kx-light")?"kx-light":"kx-darkroom",t=$(document).find(".vakata-context.jstree-contextmenu");t&&(t.removeClass("kx-light kx-darkroom"),t.addClass(e))},m.prototype.initializeEvents=function(){var l=this,e=_.debounce(function(){l.onSearchInputKeyUp()},250);l.$createButton.click(l.onCreateClick.bind(l)),l.$renameButton.click(l.onRenameClick.bind(l)),l.$deleteButton.click(l.onDeleteClick.bind(l)),l.$cleanUpButton.click(l.onCleanUpClick.bind(l)),l.$searchInput.keyup(e),l.$clearSearch.click(l.onClearSearchClick.bind(l)),l.$tree.on("contextmenu.jstree",{passive:!0},function(e){var t;e.target==l.$tree[0]&&(e.preventDefault(),$(document).one("context_show.vakata.jstree",function(e,t){$(t.element).addClass("jstree-contextmenu jstree-default-contextmenu")}),t={create:{label:"New",submenu:{create_node:{label:l.nodeLabel,action:function(e){return l.onCreateNode(e,"node")}},create_group:{label:"Group",action:function(e){return l.onCreateNode(e,"group")}}}},ccp:{label:"Edit",submenu:{paste:{label:"Paste",_disabled:_.isEmpty($.jstree.core.prototype.get_buffer().node),action:function(e){return l.$tree.jstree("paste","#")}}}}},$.vakata.context.show($(this),{x:e.pageX,y:e.pageY},t),l.updateTheme())}),l.$tree.on("show_contextmenu.jstree",$.proxy(l.updateTheme,l)),this.$tree.on("ready.jstree",function(e,s){var t,i;l.$tree.jstree("deselect_all"),l.$tree.on("copy_node.jstree",function(e,t){var i,n,o=t.node.text,a=(t.parent===s.old_parent&&(n=o,o+=" copy"),i=m.calculateParentPath(t),a=m.calculatePath({node:t.instance._model.data[t.old_parent],instance:t.instance},t.old_parent),l.onTreeNodeCopy(i,a,o,n),l.getModelFromPath(l.model,i));t.node.data=a.get(o).cid}),l.$tree.on("create_node.jstree",function(e,t){var i="group"===t.node.original.type,n=m.calculateParentPath(t),o=t.instance._model.data[t.node.id].text,a=(i?l.onTreeGroupCreate(n,o):l.onTreeNodeCreate(n,o,t.node.original),l.getModelFromPath(l.model,n));t.node.data=a.get(o).cid,l.$tree.jstree("deselect_all",!0),l.$tree.jstree("select_node",t.node.id,!0),l.trigger("select_property",i?"":n?n+"/"+o:o,!0)}),l.$tree.on("delete_node.jstree",function(e,t){var i=m.calculateParentPath(t),t=t.instance._model.data[t.node.id].text;l.onTreeNodeDelete(i,t)}),l.$tree.on("move_node.jstree",function(e,t){var i=t.node.text,n=m.calculateParentPath(t),o=m.calculatePath({node:t.instance._model.data[t.old_parent],instance:t.instance},t.old_parent);l.onTreeNodeMove(n,o,i),l.pending&&l.pending.id===t.node.id&&l.setPending(t.node),_.includes(l.$tree.jstree("get_selected"),t.node.id)?"node"===t.node.type&&(l.selectionChanged=!1,l.trigger("select_property",m.calculatePath(t,t.node.id))):(l.$tree.jstree("deselect_all"),l.$tree.jstree("select_node",l.selectedNode))}),l.$tree.on("rename_node.jstree",function(e,t){var i=m.calculateParentPath(t);l.onTreeNodeRename(t.node.id,i,t.old,t.text),_.includes(l.$tree.jstree("get_selected"),t.node.id)&&(l.$tree.jstree("deselect_all"),l.$tree.jstree("select_node",t.node.id)),l.setPending(l.pending)}),l.$tree.on("search.jstree",function(e,t,i){0===t.nodes.length&&l.$tree.jstree(!0).hide_all(!1)}),l.$tree.on("changed.jstree",$.proxy(l.onTreeItemSelectionChanged,l)),l.initialSelection&&(t=l.model.getByPath(l.initialSelection),i=s.instance._model.data,t)&&(i=_.find(i,function(e){return e.data===t.cid}))&&(l.$tree.jstree("select_node",i),l.selectedNode=i,l.scrollSelectedNodeIntoView())})},m.prototype.convertJSTreeModelToJSON=function(t,e){var i=this,e=t[e],n={};return e.type&&"node"===e.type?e.original.value||"":(_.each(e.children,function(e){n[t[e].text]=i.convertJSTreeModelToJSON(t,e)}),n)},m.prototype.convertModelToJSTreeModel=function(i){var n,o=this,a=[];return _.each(_.keys(i),function(e){var t=i[e];t instanceof Backbone.Model&&!t.has("_dataType")&&!t.has("_viewType")?a.push({data:t.cid,text:e,type:"group",children:o.convertModelToJSTreeModel(t.attributes)}):(n={data:t.cid,text:e,type:_.isFunction(o.determineTypeFn)?o.determineTypeFn(t):"node",value:t||""},_.includes(o.disabledNodes,t.path)&&(n.state={disabled:!0}),_.get(n,"text")&&0!==n.text.indexOf("_repeatable_")&&a.push(n))}),a},m.prototype.getModelFromPath=function(e,t){var i,n=t.indexOf("/");return 0<t.length?-1!==n?(i=e.get(t.substring(0,n)),this.getModelFromPath(i,t.substring(n+1))):e.get(t):e},m.prototype.getTreeReference=function(){return this.$el.find(".tree").jstree(!0)},m.prototype.onSearchInputKeyUp=function(){var e=this.$searchInput.val();this.$clearSearch.toggle(!_.isEmpty(e)),this.debouncedSearch(e)},m.prototype.onClearSearchClick=function(){this.$searchInput.val("").trigger("keyup"),this.$searchInput.focus()},m.prototype.onCreateClick=function(){var e,t;if(!this.pending)return(t=(t=(e=this.getTreeReference()).get_selected()).length?t[t.length-1]:null)&&"group"!==e._model.data[t].type&&(t=e._model.data[t].parent),(t=e.create_node(t||null,{type:"node"}))&&e.edit(t),!0;this.renderAreYouSure(this.onCreateClick.bind(this))},m.prototype.onCreateNode=function(e,t){var i;this.pending?this.renderAreYouSure(this.onCreateNode.bind(this,e,t)):((e=(i=$.jstree.reference(e.reference)).get_node(e.reference)||null)&&"group"!==e.type&&(e=i.get_node(e.parent)||null),i.create_node(e,{type:t},"last",function(e){_.defer(function(){i.edit(e)})}))},m.prototype.onRenameClick=function(){var e=this.getTreeReference(),t=e.get_selected();return!!t.length&&(t=t[t.length-1],e.edit(t),!0)},m.prototype.onDeleteClick=function(){var e=this.getTreeReference(),t=e.get_selected();return!!t.length&&(e.delete_node(t),!0)},m.prototype.onCleanUpClick=function(){this.cleanUpFn()},m.prototype.onTreeItemSelectionChanged=function(e,n){var o="";if("select_node"===n.action||"deselect_node"===n.action){for(var a=!0,s=!0,l=!0,r=!1,t=1<n.selected.length,c=n.instance,d=[],u=[],i="",p=this,h=0;h<n.selected.length;h++)!function(e){var t,e=c.get_node(n.selected[e]),i=m.calculateParentPath(n,e);a=(l="group"!==e.type?(r=r||"_settings"===i,u.includes(i)||u.push(i),o=m.calculatePath(n,e.id,e),p.getConnectedNodes().find(function(e){return e.path===o})&&d.push({path:o,isGroup:!1}),s=s&&!(0===o.length||"_settings"===i),l&&!(0===o.length||"_settings"===i||0<d.length)):(e=e.text,r=r||"_settings"===e&&0===i.length,t=0===i.length?e:i+"/"+e+"/",u.includes(t)||u.push(t),p.getConnectedNodes().find(function(e){return null==(e=e.path)?void 0:e.startsWith(t)})&&d.push({path:e,isGroup:!0}),s=s&&!r,l&&!(r||0<d.length)),a&&!(r||1<u.length))}(h);this.$createButton.button("option","disabled",!a),this.$renameButton.button("option","disabled",!s||t),this.$deleteButton.button("option","disabled",!l),(r||0<d.length)&&(i=r?m.TEXT_SEL_ITEM_NOT_AVAILABLE_FOR_DELETION:m.TEXT_SEL_ITEM_IN_USE),this.$deleteButton.attr("title",i),this.selectionChanged=!this.selectedNode||this.selectedNode&&this.selectedNode.id!==n.node.id,this.lastSelectedNode=this.selectedNode||n.node,this.selectedNode=n.node,this.trigger("select_property",o)}else"delete_node"===n.action&&(this.$renameButton.button("option","disabled",!0),this.$deleteButton.button("option","disabled",!0),this.$cleanUpButton.button("option","disabled",this.getCleanUpButtonState()))},m.prototype.onTreeNodeCreate=function(e,t,i){e=this.getModelFromPath(this.model,e);e.set(t,this.newNodeFn(i)),e.trigger("materialChange"),this.$renameButton.button("option","disabled",!1),this.$deleteButton.button("option","disabled",!1),this.$cleanUpButton.button("option","disabled",!1)},m.prototype.onTreeGroupCreate=function(e,t){e=this.getModelFromPath(this.model,e);e.set(t,this.newGroupFn()),e.trigger("materialChange"),this.$renameButton.button("option","disabled",!1),this.$deleteButton.button("option","disabled",!1)},m.prototype.cloneModel=function(n,o){var a=this;_.keys(n.attributes).forEach(function(e){var t,i=n.get(e);i instanceof Backbone.Model&&(t=i.clone(),(i.group||_.isFunction(i.isGroup)&&i.isGroup())&&a.cloneModel(i,t),o.set(e,t))})},m.prototype.onTreeNodeCopy=function(t,e,i,n){var o=this,a=this.getModelFromPath(this.model,t),e=this.getModelFromPath(this.model,e),s=e.get(n||i),e=e.get(n||i).clone();(s.group||_.isFunction(s.isGroup)&&s.isGroup())&&this.cloneModel(s,e),a.set(i,e),a.trigger("materialChange"),this.setPathFn(e,t?t+"/"+i:i,!0),_.defer(function(e){o.trigger("select_property",e.group||_.isFunction(e.isGroup)&&e.isGroup()?"":t?t+"/"+i:i)},e)},m.prototype.onTreeNodeDelete=function(e,t){e=this.getModelFromPath(this.model,e);e.unset(t),e.trigger("materialChange"),this.trigger("select_property"),this.eventBus.trigger("treeNodeDelete")},m.prototype.onTreeNodeMove=function(e,t,i){var n=this.getModelFromPath(this.model,e),t=this.getModelFromPath(this.model,t),o=t.get(i);t.unset(i),n.set(i,o),n.trigger("materialChange"),this.setPathFn(o,e?e+"/"+i:i)},m.prototype.onTreeNodeRename=function(e,t,i,n){var o=this,t=this.getModelFromPath(this.model,t),a=t.get(i);QuickBase.ErrorTooltip.clear(this.$errorTooltip),n===_.unescape(n)&&/^[\w&.\- ]+$/.test(n)?(t.unset(i),a&&(t.set(n,a),t.trigger("materialChange"),this.setPathFn(a,t.path?t.path+"/"+n:n))):(this.$errorTooltip=QuickBase.ErrorTooltip.show("Invalid name (a-Z 0-9 _-. allowed)",this.$el.find("#"+e+"_anchor"),!0),_.delay(function(){QuickBase.ErrorTooltip.clear(o.$errorTooltip,!0)},5e3),this.$tree.jstree("rename_node",e,i))},m.prototype.jstreeSearch=function(e){this.$tree.jstree(!0).show_all(!1),this.$tree.jstree().search(e)},m.prototype.renderAreYouSure=function(e){var t=this;this.areYouSureDialog=new QuickBase.AreYouSureDialog({saveCb:function(){t.saveCb(),t.setPending(),t.selectionChanged=null,e()},onClose:function(){t.areYouSureDialog.remove(),delete t.areYouSureDialog},noSaveCb:function(){t.noSaveCb(),t.setPending(),t.selectionChanged=null,e()},dashChanged:!0,message:this.areYouSureMessage||"There are unsaved changes to the selected item"})},m.prototype.setPending=function(e){var t,i=e||this.pending,n=!!e;this.pending=e||null,i&&((t=(e=this.$tree.jstree())._model.data[i.id]?null==(t=e._model.data[i.id])?void 0:t.li_attr.class:null)?(t=t.split(" "),n&&!_.includes(t,"save-pending")?t.push("save-pending"):n||_.remove(t,function(e){return"save-pending"===e})):n&&(t=["save-pending"]),"boolean"!=typeof e.get_node(i,!0)?e.get_node(i,!0).toggleClass("save-pending",n):this.pending=null,t)&&e._model.data[i.id]&&(e._model.data[i.id].li_attr.class=t.join(" "))},m.prototype.showTargetExistsError=function(e){var t=this;QuickBase.ErrorTooltip.clear(this.$errorTooltip),this.$errorTooltip=QuickBase.ErrorTooltip.show("Target already exists",this.$el.find("#"+e.obj),!0),_.delay(function(){QuickBase.ErrorTooltip.clear(t.$errorTooltip,!0)},5e3)},m.prototype.updateNodeValue=function(e,t,i){e=e.substring(0,e.lastIndexOf("/")),e=this.getModelFromPath(this.model,e);t.original.value=i,e.set(t.text,i)},m.prototype.cleanUpNodes=function(e,t){var i,n,o;0<e.length&&(i=this.selectedNode,n=this.getTreeReference(),o=!1,_.each(e,function(t){var e=_.find(n._model.data,function(e){return e.data===t});e&&(o=!!i&&e.data===i.data,n.delete_node(e))}),this.$tree.jstree("deselect_all"),this.selectedNode=null,i&&!o&&this.$tree.jstree("select_node",i),this.$cleanUpButton.button("option","disabled",t))},m.prototype.scrollSelectedNodeIntoView=function(){var e;this.selectedNode&&this.selectedNode.id&&(e=this.$el.find("#".concat(this.selectedNode.id))[0])&&"function"==typeof e.scrollIntoView&&e.scrollIntoView()},m.prototype.hasDashboardSystemPath=function(e,t){return"group"===e&&1===t.length&&"_settings"===t[0]||"node"===e&&2===t.length&&"_settings"===t[0]},m.calculatePath=function(t,e,i){i=(i||t.node).parents;return _.map([e].concat(i.slice(0,-1)),function(e){return t.instance._model.data[e].text}).reverse().join("/")},m.calculateParentPath=function(t,e){e=(e||t.node).parents;return _.map(e.slice(0,-1),function(e){return t.instance._model.data[e].text}).reverse().join("/")},m.TEXT_SEL_ITEM_NOT_AVAILABLE_FOR_DELETION="A selected item is not available for deletion.",m.TEXT_SEL_ITEM_IN_USE="A selected item is in use and is not available for deletion.",m}(Backbone.View),CleanUpDialog=function(e){function i(i){var n=e.call(this)||this;return n.deletedNodeIds=[],n.$el.html(T.CleanUpDialog({})),n.$tree=n.$el.find(".tree"),n.documentGraphVisual=i.documentGraphVisual,n.dataModel=n.documentGraphVisual.documentGraph.dataSources,n.viewModel=n.documentGraphVisual.documentGraph.viewState,n.dialogOptions=i.dialogOptions,n.$el.dialog({appendTo:i.dialogContainer,classes:{"ui-dialog":"clean-up-dialog"},height:600,width:400,modal:!0,autoOpen:!0,title:i.dialogOptions&&i.dialogOptions.dialogTitle?i.dialogOptions.dialogTitle:"Clean Up Isolated Objects",buttons:[{text:t("Delete Selected"),click:function(){return n.onDelete()},class:"delete",disabled:!0,icon:"fa fa-trash"},{text:t("Close"),click:function(){n.$el.dialog("close")},icon:"fa fa-times"}],open:function(){$('<i class="fa fa-magic"></i>').insertBefore(n.$el.parent().find(".ui-dialog-title"));var e=n.documentGraphVisual.documentGraph.getDataSourcesNotConnectedToComponents(),t=n.documentGraphVisual.documentGraph.getIsolatedViewStates(),i=[n.getItemConfig("datasources","Data Sources","","folder",[],{opened:!0,hidden:_.isEmpty(e)||n.dialogOptions&&n.dialogOptions.hideDataSources}),n.getItemConfig("viewstates","View States","","folder",[],{opened:!0,hidden:_.isEmpty(t)||n.dialogOptions&&n.dialogOptions.hideViewStates})];_.each(e,function(e){i[0].children.push(n.getItemConfig("ds:"+e.path,e.path,n.documentGraphVisual.onDataSourceSelect?"Double-click to inspect":"","datasource"))}),_.each(t,function(e){i[1].children.push(n.getItemConfig("vs:"+e.path,e.path,n.documentGraphVisual.onViewStateSelect?"Double-click to inspect":"","viewstate"))}),n.$delete=n.$el.closest(".ui-dialog").find(".delete"),require(["jstree"],n.initializeTree.bind(n,i))},close:function(){var e;n.documentGraphVisual.refreshCleanUpButton&&n.documentGraphVisual.refreshCleanUpButton(),i.onClose&&(e=n.dialogOptions.hideViewStates?_.isEmpty(n.documentGraphVisual.documentGraph.getDataSourcesNotConnectedToComponents()):_.isEmpty(n.documentGraphVisual.documentGraph.getIsolatedViewStates()),i.onClose(n.deletedNodeIds,e))}}),n}return __extends(i,e),i.prototype.getItemConfig=function(e,t,i,n,o,a){return{id:e,text:t,a_attr:{title:i},type:n,children:o,state:a}},i.prototype.getModelFromPath=function(e,t){var i,n=t.indexOf("/");return 0<t.length?-1!==n?(i=e.get(t.substring(0,n)),this.getModelFromPath(i,t.substring(n+1))):e.get(t):e},i.prototype.getNodeMetaFromId=function(e){e=e.split(":");return{type:e[0],name:e[1]}},i.prototype.getTreeReference=function(){return this.$tree.jstree(!0)},i.prototype.initializeTree=function(e){var n=this,e=(this.$tree.jstree({core:{data:e,multiple:!0,check_callback:!0},checkbox:{whole_node:!this.documentGraphVisual.onDataSourceSelect,tie_selection:!this.documentGraphVisual.onDataSourceSelect},types:{datasource:{icon:"fa fa-database"},folder:{icon:"fa fa-folder"},viewstate:{icon:"fa fa-eye"}},plugins:["types","checkbox"]}),this.$tree.on("dblclick.jstree",function(e){var t;e.target.className.includes("jstree-checkbox")||(e=n.getTreeReference().get_selected()[0])&&e.length&&(t=(e=n.getNodeMetaFromId(e)).type,e=e.name,"ds"===t&&n.documentGraphVisual.onDataSourceSelect?n.documentGraphVisual.onDataSourceSelect(e,null,null,{hideToolBarBtns:!0,hideSelectBtn:!0}):"vs"===t&&n.documentGraphVisual.onViewStateSelect&&n.documentGraphVisual.onViewStateSelect(e,null,{hideToolBarBtns:!0,dialogTitle:"View States",hideSelectBtn:!0,cancelBtnText:"Close"}))}),this.documentGraphVisual.onDataSourceSelect?"uncheck_node.jstree check_node.jstree":"deselect_node.jstree select_node.jstree");this.$tree.on(e,function(e){var t=n.getTreeReference().get_checked(!1);n.$delete.button(t.length?"enable":"disable")}),this.$tree.on("delete_node.jstree",function(e,t){var i=t.instance._model.data[t.node.id].text.split("/"),t=n.getNodeMetaFromId(t.node.id).type,t=n.getModelFromPath("ds"===t?n.dataModel:n.viewModel,_.join(_.initial(i),"/"));t.get(_.last(i))&&n.deletedNodeIds.push(t.get(_.last(i)).cid),t.unset(_.last(i)),t.trigger("materialChange")})},i.prototype.onDelete=function(){var t=this.getTreeReference(),e=t.get_checked(!1);e.length&&t.delete_node(_.without(e,"datasources","viewstates")),_.each(t.get_json(),function(e){e.children.length||t.delete_node(e.id)}),this.$delete.button("disable"),this.documentGraphVisual.deleteNodes&&this.documentGraphVisual.deleteNodes(e)},i}(Backbone.View),DocumentGraphVisual=function(){function d(e,t,i,n,o,a,s,l,r,c,d,u){this.nodes={},this.edges={},this.data={},this.nodeSettings=[],this.activeViewStateToSubscriptions={},this.searchStr="",this.onCleanUpClick=c,this.onViewStateSelect=s,this.onDataSourceSelect=l,this.onClose=d,this.componentDefs=_.filter(n,function(e){return!_.isNil(e.get("appKey"))}),this.dashboardTheme=a,this.options=u,this.documentGraph=new QuickBase.DocumentGraph(e,t,i,n,o,r,this.onNodeUpdate.bind(this)),this.nodes=this.documentGraph.nodes,this.edges=this.documentGraph.edges,this.activeViewStateToSubscriptions=this.documentGraph.activeViewStateToSubscriptions,this.debouncedSearch=_.debounce(this.onSearch.bind(this),300)}return d.prototype.displayGraph=function(r){var c=this;require(["vis"],function(e){function i(){c.hierarchical?s.layout.hierarchical={enabled:!0,nodeSpacing:400,treeSpacing:200,blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,levelSeparation:150,direction:"UD",sortMethod:"directed"}:(s.layout.hierarchical=!1,s.physics={barnesHut:{gravitationalConstant:c.options&&c.options.nodePath?-2e3:-5e3},stabilization:{iterations:200},timestep:1},delete s.edges),l.show(),c.network=new e.Network(c.$overlay[0],c.data,s),c.network.on("doubleClick",function(e){var t;e.nodes[0]&&(t=e.nodes[0].split(":")[0],e=e.nodes[0].split(":")[1],_.includes(["ds","dsa","vds"],t)&&c.onDataSourceSelect?c.onDataSourceSelect(e,null,null,{hideToolBarBtns:!0,hideSelectBtn:!0}):_.includes(["dsm","vdsm","vdsa"],t)?c.onDataSourceSelect(e,null,1,{hideToolBarBtns:!0,hideSelectBtn:!0}):"vs"===t&&c.onViewStateSelect&&c.onViewStateSelect(e,null,{hideToolBarBtns:!0,dialogTitle:"View States",hideSelectBtn:!0,cancelBtnText:"Close"}))}),c.network.on("stabilizationIterationsDone",function(){c.network.setOptions({physics:!1}),!c.hierarchical&&_.isNil(c.options)&&_.isEmpty(c.searchStr)&&c.network.storePositions()}),c.network.on("afterDrawing",function(){l.hide(),c.drawGraph(t)})}var t=c.getTheme(),a="kx-light"===t?"#606060":"white",n="#48c2fa",o=(c.nodesView=new e.DataView(new e.DataSet(_.map(c.nodes,function(e){return e=e,_.extend({group:c.determineDataSourceType(e.model),borderWidthSelected:1,color:{border:"#999",highlight:{background:"#FFFF7A",border:"#1795D3"}},font:c.getFontSettings(),labelHighlightBold:!1,shape:"box",shapeProperties:{borderRadius:3},x:void 0,y:void 0},e)})),{filter:function(e){return!c.searchStr||e.searched}}),c.data={nodes:c.nodesView,edges:new e.DataSet(_.reduce(c.edges,function(e,t,i){return e.concat(_.map(t,function(e){return{id:i+"->"+e,labelHighlightBold:!1,width:1,selectionWidth:function(e){return e},shadow:!1,from:i,to:e,arrows:{to:!0}}}))},[]))},c.data.nodes.getDataSet()),s=(_.each(c.data.nodes.getIds(),function(e){var t=c.data.nodes.get(e),i=t.model.attributes?t.model.attributes._subscriptionType:"";c.nodeSettings.push({id:e,counter:"streaming"===i?t.model.getExecutionRate().toFixed():1,metrics:t.model.performance?c.getPerformanceSummary(t):"",color:"#2bac76",strokeStyle:"#2bac76"}),t.model.agent&&t.model.agent.subscriberCount()&&o.update({id:e,title:c.getNodeDescription(t)})}),c.options&&c.options.nodePath&&(c.searchStr=c.options.nodePath,c.onSearch()),{groups:{vs:c.getIconSettings("",a),ds:c.getIconSettings("",a),dsa:c.getIconSettings("",a),dsm:c.getIconSettings("",n),vds:c.getIconSettings("",a),vdsa:c.getIconSettings("",a),vdsm:c.getIconSettings("",n)},edges:{smooth:{type:"continuous"}},layout:{improvedLayout:!0},interaction:{dragNodes:!0,selectConnectedEdges:!1},physics:{barnesHut:{gravitationalConstant:c.options&&c.options.nodePath?-2e3:-5e3},stabilization:{iterations:200},timestep:1}}),l=(s.groups=_.extend(s.groups,_.reduce(c.componentDefs,function(e,t,i){var n,o=t.get("id");return t.get("listViewThumb").startsWith("<svg")?e[o]={shape:"image",size:25,image:"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(t.get("listViewThumb").replace("<svg",function(e,t,i){return i.includes("xmlns")?"<svg":i.includes("width=")?"<svg xmlns='http://www.w3.org/2000/svg'":"<svg xmlns='http://www.w3.org/2000/svg' width='25' height='25'"}).replace(/#ffffff/gi,a))}:t.get("listViewThumb").startsWith(d.DATA_IMAGE_PREFIX)&&(n=(n=t.get("listViewThumb")).substring(d.DATA_IMAGE_PREFIX.length,n.indexOf(";base64,")),d.IMAGE_TYPES.includes(n.toLowerCase()))?(n=d.DATA_IMAGE_PREFIX+n.toLowerCase()+";base64,",e[o]={shape:"image",size:25,image:n+t.get("listViewThumb").substring(n.length),brokenImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAYAAACXpx/YAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTMzQURFOTkxOEY2MTFFNUFDMEJBRDUyMDNDODMyQkMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTMzQURFOUExOEY2MTFFNUFDMEJBRDUyMDNDODMyQkMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBMzNBREU5NzE4RjYxMUU1QUMwQkFENTIwM0M4MzJCQyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBMzNBREU5ODE4RjYxMUU1QUMwQkFENTIwM0M4MzJCQyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pnt3JAMAABOnSURBVHja7FxpdBzVlb61dFV19d6tVrd2ybJWLxLeMGAgGAM2sTMD5kDOTAJkYRlmCXNmmJksJ2TCARKSyY+cnGGGGUMyYcZkbBaDccY2tsEsNtjyImwtXmTt6pa61Yt6qequrpp3qyVhvKnbBNkRfj7tLlVX1at637vf/e597xWlaRpMR6l7bLv+jdXNKTaDzWiA6kIR/EkK3BYBMurU90GOERZXWZ+dW2JawjI0p2S0TFxWkpKiRZ0i628bjA9GpUy/aKC6Nx8NddW5BX/fqOwXWEpJpDJQ4uBh48EAJNIq0FT2mlirwAAYmew2lhq3CHcv8YKqqrDp0AhUOgXgWBrG5AxQ5LwxKQNGloJURoUG8ixvd4zqJ1uMLJTaeTg+nICW3ghwDD3lMx388bLPtd1ZuEQFgRYMDEjhBNTOMsPNjW5QpgbZ7TDz91Ok3TSV/EUam6YE/NLPrXQb9YNSigq3zS+AaFKJEDCG/BH5+Ggsvf+YP/GyrKhHM6TyiZo0/V4omKmFvdQ3IKUz8MJ7fVBBrIQnVpImVkGdv1OkDSwTFnnWrmqnQzRp4ZPbaGl20WBzmgy2WW5jPU1Rawjg/0Ss/dHXDo08Jxg+sS6F1KnpPSZb8DITn1yY5QrAFyik4XVgkdYYAlahVdBBPhfKBFOlQtXS+m/a1AyBlpoh2+lM9mATzxgfuLHk6XZfbH1SUccYKlvJSESCuKQBTWcBZRnKZuToZpWcbDOyvWTfEGEFSSLUTn4bB526AnCuhSEOMZxIw8GeMPzF8iowEN+lnkMbEJdIk2MZuEijwtNSaSXhFTWCEaV3LoXsFGkha8kEOK+Va3hkRcUmr42vwXtYWO1IhuOp/nBc6RgISQf7Q1LLYEhuldOZbgQcz8Hj6MsUcPZyuRH0x51DMVj3bj84zTwB89MoojVaBZb/Sy/5MQcLPhdTGIj1/eeO409tb/UlRI7R6yi0m6Cq0KpvJwlgyxudf1XjEWtiREhhxzPxtNEqGGsqCqiaqyqta5ANYpIS90XktlMjiffJ37uMBmZfJKEMGVgVNO0KwBcsvlASghH5LMGFf3usvJOmKTFfcBnCCCJ50v/Y1vb4+n0jz3IcD3EVJpV078gYYDSRICpZyxS6sGpt3ORxv3qGrzcLrKlONCxuLLEsJtT96DWzHaOkc35wzBd/dSQiv0lcjB9pPENpVwA+IwyC2UQJN5XbzhI3SIOkYZ0sMUUtD4RJOAWxZEr+t7c7v/H2x0PrDZyR+FpKvwICnMmkdQA1vf4MtHQFt3x5YfE9U93n6fdHhJzzhnrX6hvqnKuDsbR/3Tu9jxI6f8lIWOIKwOcInY4RwXVwIAYEzEnPhvR5Y52zEKkVt3MpFKFlltZg/a62B366Y2R9uZgB3gC638UrZ5QUDATlye6CWuyN/b0b7lpS/FhDuWtuMpXJqR5kF2X8WI+N8xSYmCaOyrwk0HAF4LNBAQjGJDASuypzGCEzjqVEGtBr4SqByl3M8CQU2nmob8P2Vv9viy0ccMT25XHuRTDNWoLsS6Atj1cOhKaV5LNbWh995lvXb6UpmlHzcKro54lYTO9uG/ptQpJASdNXAD53QxFfTEIXhsQtiprNaCRTChSYudqcO4quujV48UPfs0fDNFh4DcY0A6F6Rbc4nkUBxYHhjBiaE3g42B3esadtcONNTeX35GrFEx1q/8nA3r5Ass3CsZdFJHVJM1kKMSNMIcaJuMFtZTxeRUsYIgDPKbaATRR0/yulVCi08ZU55x0o0OPpUUkdZlgGFCobyCjoy40sfKma+HmF0H6jC2LxJBTZ+Ulhh2CLHP0/clq9J1/2ae8L/85hYsn5bP5Sf6YALJOGtRnBUuQQbl1bZFlALM1gFZiuAgv3BgF5IJt6VMEXlcDMswQoPWQRPTa+OtfMEnYgTKA0ekyzomPyURQ82FEwgdVYYobqAhE6BseI0mVh+9FRuHVeoR5/I3tgjCxllACmPA3E0nNhaRRuJF5OtQ9EttmJZGd0iU6d1QEmbh81AEXNMICxoZLpDKrktd9eXvVUscNYi0l8ajzbtKDK8aPW7tB31+/tfwGfvjuYwHSj3iEKrXypTTQUqWo+CpqCRVX2tVsODb0h8gzYieV6zJzucSeyW2hlGPNaTUbYfSwII7EUUdYaNFfa3V8m5yDIuRQcWDjiGzt8uDd6gmXp86pvTJGSPqMPVCiZz9/Cp00FoEXKaQW+dk3pQ4+vbdxY7hJrdYqWsxSNDeky855bm4uev7bW9c/IbqFEGvpJXMwRoJwmrlbkWS4f0YNqe2WT9+7ZReZFfsIGmOhAP3lmH0FLMuh1GKDlVBi2HhmGYrtwD+7LPRsHcPDU6FtRKa3JpBOf/kkp2W8TR0OFywgVTh6SkgzHh6Mzx4Kt5OEaq+yLfnBH4y+RoKRzhDroM1E1P7B81g9jSSX2k80dP5tXZgWJdID6YksTNng+vR6tXeAY46/ubf7f773UetfJ4fiBIit3zmPT5Ni6IjPMKxLh+lrn6jULi+9KptS83E4sLr+9uMKqDy2eHkIhI+DHQjoQMreWofQQkJlJFO0xG+Chm2c9KXA0h1Z7XlAIfkTcwIM3V/9EU9Wj88rtW17b12+f7bV8VVXzrxcb3mM3Vv3sa81vv9Ey8C+HukZ/Q/Z1I2PgSBYCgEoZOxcBVFg+1/ONP11S9gxL04Z0Rs3ReikIjsmRQFRqNQusLhInG5jwcSSW1sHMaNM/SDFtANvM3PzmSucKKQerGB/RoR++tWZDYEz+/fdK59QX2oQ5spI/wticSI/Ef1u+edOsHw0vKPn7wVDio0BEai2wCl0lDmP8lqYi9yyPpabAwi9z24Q6dAO5gjvh6/2hZMdgKOnDzBk1XjHWW+Wxks00qHBpyrQBvKy24HaTwNAXst4zQSaWQJSzsJYaD3k+kwbQwzAdaLPLbF+ulcFytDS87jW1BcRPanreOXURnQgV9EAw3ioTJqD5rOrGfR4SKhi5S5vsmDaAr6l1zctXNeqC6g8sNM/MI2PJtdNdiCVODsdaZHK/FA4fEl9yc70HfGHpkk8YmDaAg/F0AVJZSoEZVZBd0Ic7RLbr6monEVgMfNwX0cXi5TB0OG0Ak1Ano2kw4woOaCRlRdl1xNfrCyeJErdiiDXJFPjQ2AEymgoqlR1MoWciwEpK7pmB+GZz3pqWPhFMxgdHk7DyqlIIxWSQCFU5zfzcMrdp1bJ6TxMOYPUH43s6ByPrY4lUcMYB/OZHp95c3lz+cL7WoV3mZo8ultCysGpOYWEwKvVjsoRnqab5la7H51c61wgcy542RffPhsPJx17cdfxvDveGNk3Hk00bW+xv796652j/+2Zh6kFwnIGB4QbOjcURpcu5YAfkDQz1lasrvt9Qal9UWmD+6b3La/curi28g6ZpFkMlpGj84JAnCc3K/3rNnJebK12rMxl15liwL5JM//x3795X7Lxta1mRszpF4uEz044IKsdSMByKD2zd2/bEyYHQ0fvXLH2l2GVxKxn1sgUZ7212ke3OcrflTj0VquLkvnMrcwzDSIdg/uGOec+Fx5Lzya7AjLBgVJcjodjJ1985fMPxHv+LaUWRyYMCWjR+G1gaguFY/6bdR57afaBzYUe3/98H4tR7g8F4C8tc/lNUs8kZWo+3p8qXo1WXu01F1zV47p0xFjxhoYTSBjtODX195/5jTzqtpls1iq4vLbAmDx/v35OU0zu7hkKjNzZVgkwZYXaxA6wiT/2xTD7PRy/gIzWUO1eSzV/MGIAnhBNHLDYSS3YMDEc6dhzogrU3zoGBQBS8TjOYBAPIKgtpioNTvghLDi+jYOYtLUkrGlQUmCpmlAV/SkgR8cQZWDAZOf0bKRwtPJxQoDuYAq/DiNTt8jjEkoyqzjiA0do5ljbMGBWdwyPr47cOVwEkiI8aiUo4KF9t5FjbZ2FoZAzMOVPjn8ulYGcORKXwjLXgM5MFCELniAKShtadwuwQlHtsc0wCe1G5Ykz2I0ukFRxwV1Lo9sjfgsAbJpWv+gfw7QgUDhem87weRn/D4fhxANfMBlhfOUA+cU3UR3sERtUzAgqJgeu8lusvSrETHx9Pyv4Tvb4X3z90cpuiUScbKgszu/Z3ehY3VjTVVXhvLy9yrTKLAne+cCZXcH3BSFefL7hjfk3Zn/OcQcw1nNMHKPoDW2FB+cwFGDM8JoGDAz0xoDkjAYYaBx3AyLNcdbH9aiXP9sew68OjPZt7h4KPaJraNzw6BrTBoE8X8o+OdbefGvowEBp7bue+9uaV1859uqbCuzKVyuQ9aIV0Tzpk5vnN++6TkvH3Nr/f/vsffPO2jSzD0FOpfuyAPf6ob097/yuPfGXBzPLBSJ04e9GAY6hhGXh7IRgEI+BiEsxgMeOr4otd5oYSl3l2PuPAOLHurQNd//fD59+6k7R9n8Cx4xRKZ1c5MFlhh590Wjn08lv7V7+68+B/GYX8l5hg3N7jjxw/MSx90B/OwM59na+++c6hv8Xbv5Cvx3thKA3WbWn57lut/TPHB6f1WYQUROIp2HMsAB+diEA8haAyMBqLfOrYuKRAc7X7ZrORpeNSbiaMDReMJELrXv/owXAslR4IxKCmxHHOqanoM5FK2/tCmW37Tz3YUFXUVF/pbZLzoGtkn0AkcdBtE1WKEmF4xAQ9Q4Ffnuzz26pKvT8GioaMvrBcm+zY2MFShEn2Hel5/GjX4K9N/OcuoqcP4OoSN+CC6329SeJfk0AzLNjE7Hg+dQaR4CzKq2s9a/KJjgSOgpff7XqpKyD3WWx2eK1lEBaOSlAokkY97ToMlQX3uH8MxtLEFVgs8ht7Op6or/RszCvMIwCf9I91ftwfApGEegajWZ86G47Gn9h7uHOQgPx3Lru5wcBmmzielFKBUHTPuweO/ZwGbbORx8l/iZkD8LL64pyyPahEjbxh1pyKgqVyOr/4t+XU6K4QAS0la/p7N945EQYzUeQrm4on1S5a6YmhMWBYAUoKRF3gDQbiu0fCiZDDKjpyHQCQFQ2cRnboziWVOuWPRmLk4ZK6pfqD4XWdPf7/HgklmjlGKye9OWky8scIxp24MtLrME9fODZdFXUMjOZ0XIKERysXVa2xmTkhmU94pOHrFjjRLvIgCuykWEspDAySti8IjEF3IAEtfg2iiVR2aiu+h4P8RyLkwANRyee2mwjAuQisbH0HukaOd/aN6kkaFFZXlZt16iZCC12G1OcP7VXkxF6KsFV9VUk2VTvNy1mmDWADTeWEEnG79ILZnq/nm7zCZlta612992jfb0Se/RQYfSNx6PWFwekqBAfNTAKE31r2RSu8wDFi7pPqKUgQZ7qo2u1vqnBlr0f+U5X0p+ZgGQjwtMoCAkzTlybJMm0Aex3ilMcohPbKCi1L68tdC/KNT5HOl9QXrbKYhFl9I9EutKpPYu2syHHbBX2K60RCYmI+VXOtu7mi0FqqKLnPg44lU9ENu9uDeJ8T86BxjvWfLK0EC3f5JAinz4JzGPIjoQ3Uljm/ZeIZKiblBzBajsPCm+68ruYf/3VTy0OigT4rseALRPRkyuwSJ3gcJti456Q+Oe7+2+b9mIQ9jJLJvU6iJcKNlYUhtPqJwRA9O6YLxswXD2AmM7Vi5DQVfD7/psER50Kb1dyECQFFX/aRm2XhUpPbF1ffd7Bz8FdDwdjHpy8CQ+tMpdIkXKPAYxfB6zTB3ctq4Ib55U9fM6fslnz8Pca5sYTcaxcNKbzHCbc6wQhUJg0sTX2xAI4nU1NTNAFyOBh9/b2W9q0kjlxZXe79qtdtv8VpNbsQLPTLymmx5bkUuEU08CsWVn3nld3t38ZEx8QLeUjMqo/B4qnjeWNuaUPJM9fNLftOvmodMR0MxiIbdncQQWc44xk0qCw0waJKG1BfpAXguYzk4DGYySL+Ug6GY5u2fdC6SZLT3hsX1V9P4saVLodlmafAPps3GGiGocYXkWdfXTQBOlbjsAgFhOZBB5jKHoOLv9B3ZlQK0umMfdXSmg1FTssKDJsuZl6frKj4op6zVyrSNPQEklDhEoH+Iq/wn5LSCdA8iS9jCck3Go5t6PUFNvQMjfI3La6v43nDYpHnl7gc1gXeAns1UasOzIihrZJ4dHjHh22/3tfepwOMwMsarSdWdBqX07D2S41PVnmsK8aki/OVuDKysdwV/8XDK86pjjGrFo7GYcO2oM4qDHMF4CmtGpMJFEXLBKDW4dFoqz84ti6WSMC1TTXuYCQ6a9UNCwsH/KOpD1raDg+NJHwYi2bVMw0mPf4cp2FGhdICc8Nnuifyj6hnJSGlx1fyn13MJiMQFwNt7Scu6dTfyx7gMxMMGJKwJATiiXXKaRZV8Ug8IY+gmsU8L47/suMmg/tcJg6uqrRPxqcK+f1Ud+/3Z3mtLzhs1jojj0Iu67/x+NzA0Fc/MjhZ8HzxLa5PumlJPRRYeNj5URtol+j1ln9UAJ/Pwica+XyzNk5/WwayQTIp73lpy/sLrmqsuo5Y4srqMs91doupzmIS7XgtnsOJAuMditbfkal/9CyUll0uahZ5M2bB6AtoC7yX6xc3YqXgGw7pObMrAH8ORYNPFilO0Dax1EQymdq+9YMj2+srPWA1G4ujyVRpTam7cSAQKZ0/u7SK5bjCWCzpcNhEMxF5AnETHDmXkWQ5tqf11Ibh0djUE/MpnDLMQmRMApfdCNM9QfT/BRgAj7qO9qX403UAAAAASUVORK5CYII="}):e[o]=c.getIconSettings(t.get("unicodeThumb")||"",a),e},{})),c.$graph=$('<div class="document-graph" />'),c.$graph.addClass(t),c.$graph.html(T.DocumentGraph({hierarchical:c.hierarchical})),c.$cleanUp=c.$graph.find(".clean-up"),c.$cleanUp.button({icon:"fa fa-magic",label:"Clean Up"}),c.$cleanUp.on("click",function(){return c.onCleanUpClick(c)}),c.refreshCleanUpButton(),c.$search=c.$graph.find(".searchInput"),c.$search.on("keyup",function(e){c.searchStr=e.target.value.toLowerCase(),c.$clearSearch.css("visibility",""!==c.searchStr?"visible":"hidden"),c.debouncedSearch(c.searchStr)}),c.$clearSearch=c.$graph.find(".clearSearch"),c.$clearSearch.on("click",function(){c.$search.val("").trigger("keyup")}),c.$contentPanel=$(r),c.$contentPanel.append(c.$graph),c.options&&c.options.hideToolbar&&c.$graph.find(".graph-toolbar").hide(),c.$contentPanel.removeClass(c.getDocumentTheme()),c.$close=c.$graph.find(".close"),c.$options=c.$graph.find(".options"),c.$overlay=c.$graph.find(".overlay"),c.$graph.find(".loading"));c.$close.on("click",c.remove.bind(c)).on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||c.$close.click()}),c.$options.on("change",function(e){var t=c.$options.find("input[name='hierarchical']:checked").val();c.hierarchical="hierarchical"===t,c.network.destroy(),i()}),i()}.bind(this))},d.prototype.deleteNodes=function(e){this.nodes=_.omit(this.nodes,e),this.nodesView.getDataSet().remove(e)},d.prototype.remove=function(){this.$close&&this.$close.off(),this.$options&&this.$options.off(),this.$graph&&this.$graph.remove(),this.network&&this.network.destroy(),this.documentGraph.unsubscribeAll(),_.isFunction(this.onClose)&&this.onClose(),this.$contentPanel&&this.$contentPanel.addClass(this.getDocumentTheme())},d.prototype.determineDataSourceType=function(e){var t,i,n,o;return e.get("_viewType")?"vs":e instanceof QuickBase.Component?(t="",i=e.get("definitionId"),0<this.componentDefs.filter(function(e){return e.get("id").toString()===i}).length?i:(n=e.get("key"),0<(o=this.componentDefs.filter(function(e){return e.get("appKey")===n})).length?o[o.length-1].get("id"):t)):e instanceof QuickBase.Popup?_.find(this.componentDefs,function(e){return"Popup"===e.get("appKey")}).get("id"):"virtual"===(o=e).get("_dataType")?o.isMapping()?"vdsm":o.agent.subscriberCount()?"vdsa":"vds":o.isMapping()?"dsm":o.agent.subscriberCount()?"dsa":"ds"},d.prototype.drawGraph=function(v){var y=this;_.each(this.nodesView.getIds(),function(e){var t=y.nodesView.get(e),i=t.model,n=i.path,o=y.$graph.find("canvas")[0].getContext("2d"),a=(o.font="12px Arial",y.network.getPositions([e])),s="kx-light"===v?"white":"black";if(a[e]&&!_.isEmpty(y.nodeSettings)){var l=_.find(y.nodeSettings,{id:e}),r=l.metrics,c=-1!==l.id.indexOf("vds")||-1!==l.id.indexOf("vs")?10:13,d=-1!==l.id.indexOf("vds")?13:-1!==l.id.indexOf("vs")?5:10,u=i.attributes?i.attributes._subscriptionType:"",p="streaming"===u||l.counter<100?l.counter:"99+";if(o.lineWidth=3,_.includes(["ds","dsa","vds","dsm","vdsm","vdsa"],t.group)&&(o.beginPath(),o.arc(a[e].x+c,a[e].y-d,5,0,2*Math.PI),i.agent&&i.agent.subscriberCount()||n in y.activeViewStateToSubscriptions?(o.fillStyle=l.color,o.strokeStyle=l.strokeStyle):(o.fillStyle="kx-light"===v?"white":"#282828",o.strokeStyle="#999999"),o.fill(),o.stroke()),i.agent&&i.agent.subscriberCount()||n in y.activeViewStateToSubscriptions){t=a[e].x+c-6,d=a[e].y+6,l="streaming"===u?o.measureText(p+"pm").width:Math.max(12,o.measureText(p).width+4);if(o.beginPath(),o.fillStyle="#c9675b",o.save(),o.translate(t,d),o.moveTo(l/2,0),o.arcTo(l,0,l,12,Math.min(6,5)),o.arcTo(l,12,0,12,Math.min(l/2,5)),o.arcTo(0,12,0,0,Math.min(6,5)),o.arcTo(0,0,5,0,Math.min(l/2,5)),o.lineTo(l/2,0),o.restore(),o.fill(),o.fillStyle="white",o.textAlign="left",o.textBaseline="middle","streaming"===u&&(o.font="7px Arial",o.fillText(" pm",t+o.measureText(p).width+8,d+7.7)),o.font="10px Arial",o.fillText(p,3+t,d+7),i.performance&&r&&!isNaN(r.totalTime)){o.fillStyle=s;for(var h=a[e].x-20,m=a[e].y+35,g=["#e37466","#7bb6be","#fcba02"],f=[100*r.subscriptionPercent,100*r.executionPercent,100*r.dataModelPercent],b=0;b<g.length;b++)o.beginPath(),o.fillStyle=g[b],o.rect(h,m,f[b]/2.5,5),o.closePath(),o.fill(),h+=f[b]/2.5}}}})},d.prototype.getFontSettings=function(e){return{color:e?"#00AEFF":"kx-light"===this.getTheme()?"black":"white",face:"FontAwesome, Arial",multi:"markdown",size:12}},d.prototype.getIconSettings=function(e,t){return{shape:"icon",icon:{face:"FontAwesome",code:e,size:30,color:t}}},d.prototype.getNodeDescription=function(e){var t,i,n,o=$('<div class="document-graph" />'),a=void 0;if(e.model instanceof QuickBase.DocumentDataModel&&e.model.agent.subscriberCount())return(n=e.model.agent.getSubscribers().filter(function(e){return!_.includes(e.substring(0,3),"ds")})).length&&(a=n.length+" subscriber",1<n.length)&&(a+="s"),_.isEmpty(this.nodeSettings)||(t=(i=_.find(this.nodeSettings,{id:e.id})).metrics,i="streaming"===(e=e.model.attributes?e.model.attributes._subscriptionType:"")?"Execution rate per minute: "+i.counter:"Total executions: "+i.counter,e=!isNaN(t.totalTime)&&"streaming"!==e,o.html(T.DocumentGraphTooltip({bool:e,executions:i,label:a,subscribers:n,totalTime:t.totalTime.toFixed(0),subscriptionPercent:100*t.subscriptionPercent,executionPercent:100*t.executionPercent,dataModelPercent:100*t.dataModelPercent,subscriptionTime:t.subscriptionTime.toFixed(0),executionTime:t.executionTime.toFixed(0),dataModelTime:t.dataModelTime.toFixed(0)}))),o.html()},d.prototype.getPerformanceSummary=function(e){var e=e.model.performance.perf,t=e.paramChange||e.apply,i=(e.serverStart<t&&(t=e.apply),e.onAgentNotify-t),t=e.serverStart?e.serverStart-t:0,n=e.serverStart&&e.serverEnd?e.serverEnd-e.serverStart:i,e=e.serverEnd?e.onAgentNotify-e.serverEnd:0;return{totalTime:i,subscriptionTime:t,executionTime:n,dataModelTime:e,subscriptionPercent:t/i,executionPercent:n/i,dataModelPercent:e/i}},d.prototype.getTheme=function(){for(var e="dashboard-theme=",t=decodeURIComponent(document.cookie).split(";"),i=0;i<t.length;i++){for(var n=t[i];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(e))return n.substring(e.length,n.length)}return""},d.prototype.getDocumentTheme=function(){return"kx-"+("Light"===this.dashboardTheme?"light":"darkroom")},d.prototype.onNodeUpdate=function(i){var n=this;return function(){var e,t;_.isEmpty(n.nodeSettings)||(e=_.find(n.nodeSettings,{id:i}),"streaming"===((t=n.data.nodes._data._data[i]).model.attributes?t.model.attributes._subscriptionType:"")?e.counter=t.model.getExecutionRate().toFixed():e.counter++,e.color="kx-light"===n.getTheme()?"white":"#282828",e.strokeStyle="#7fb4f5",setTimeout(function(){e.color="#2bac76",e.strokeStyle="#2bac76",t.model.agent&&t.model.agent.subscriberCount()&&n.nodesView.getDataSet().update({id:i,title:n.getNodeDescription(t)})},300),n.nodesView.getDataSet().update({id:i}))}},d.prototype.onSearch=function(){var t=this,i=_.filter(_.keys(this.nodes),function(e){return t.options&&t.options.nodesView?e===t.options.nodesView+":"+t.searchStr:e.toLowerCase().includes(t.searchStr)}),e=(this.documentGraph.onSearch(i,this.options&&this.options.nodesView),this.nodesView.getDataSet()),n=_.map(_.keys(this.nodes),function(e){return{id:e,searched:t.nodes[e].searched,font:t.getFontSettings(t.searchStr&&i.includes(e))}});e.update(n),this.hierarchical&&this.$options.trigger("change")},d.prototype.refreshCleanUpButton=function(){_.isEmpty(this.documentGraph.getDataSourcesNotConnectedToComponents())&&_.isEmpty(this.documentGraph.getIsolatedViewStates())&&this.$cleanUp.button("disable")},d.IMAGE_TYPES=["png","svg+xml","jpeg","bmp","gif"],d.DATA_IMAGE_PREFIX="data:image/",d}(),dialogResizeHelper=function(e,t,i,n){var o,e=e.getBoundingClientRect(),a=t.originalSize.width,s=t.originalSize.height,l=t.position.top,r=t.position.left,c=l,d=r,u=t.size.width,p=t.size.height,h=(n&&(o=parseFloat(getComputedStyle(n).width)),t.originalPosition.left-e.left),m=t.originalPosition.top-e.top,t=e.left-t.position.left;r<e.left&&(d=e.left,u=a+h,n)&&(n.style.width=o-t+"px"),l<e.top&&(c=e.top,p=s+m),i.dialog("option",{width:u,height:p,position:{my:"left top",at:"left+"+d+" top+"+c,of:window}})},adjustDialogPositionIfNeeded=function(e,t){var e=e.getBoundingClientRect(),i=t.getBoundingClientRect();i.left<e.left&&(t.style.left=e.left+"px",t.style.width=i.width-i.left-e.left+"px"),i.top<e.top&&(t.style.top=e.top+"px")},ViewStateDialog=Backbone.View.extend({className:"view-state-dialog",dialogCookieKey:"dashboard-viewStateDialog-settings",accordionCookieKey:"dashboard-viewStateDialog-accordion-settings",initialize:function(e){var a=this,i=this.getJSON(this.accordionCookieKey),n=(a.isPropertiesCollapsed=!_.isNil(i.isPropertiesCollapsed)&&i.isPropertiesCollapsed,a.isGraphCollapsed=!_.isNil(i.isGraphCollapsed)&&i.isGraphCollapsed,a.cancelCallback=e.cancelCallback,a.dialogContainer=e.dialogContainer,a.disabledNodes=e.disabledNodes,a.docDataModel=e.docDataModel,a.selectCallback=e.selectCallback,this.dialogOptions=e.dialogOptions,this.components=e.components,this.componentDefs=e.componentDefs,this.dashboardTheme=e.dashboardTheme,this.isEmbedded=e.isEmbedded,this.eventBus=_.extend({},Backbone.Events),a.path=void 0,a.$el.html(T.ViewStateDialog()),a.$tree=a.$el.find("> .tree"),a.$detailsPanel=a.$el.find("> .details-panel"),a.$collapsibleEditor=a.$el.find(".accordian-container > .viewstate-editor"),a.$propsHeader=a.$collapsibleEditor.find("> h3"),a.$icon=a.$propsHeader.find("i"),a.$collapsibleProperties=a.$collapsibleEditor.find("> .properties"),a.$collapsibleGraph=a.$el.find(".accordian-container > .viewstate-graph"),a.$graphHeader=a.$collapsibleGraph.find("> h3"),this.debounceResizeAccordion=_.debounce(_.bind(this.resizeAccordion,this),100),this.debounceUpdateDialogSizePosCookie=_.debounce(_.bind(this.updateDialogSizePosCookie,this),100),this.getJSON(this.dialogCookieKey)),o=(this.sideBarWidth=e.isEmbedded?64:0,this.marginSize=7,Math.max(_.isNil(n.left)?this.sideBarWidth:n.left,this.sideBarWidth)),s=Math.max(_.isNil(n.width)?990:n.width,990),l=(o+s+this.marginSize>window.innerWidth?(o=null,this.sideBarWidth+s+this.marginSize>window.innerWidth&&(s=window.innerWidth-this.marginSize-this.sideBarWidth)):_.isNil(n.left)&&(o=null),_.isNil(n.left)||null===o||(o=Math.max(this.sideBarWidth,o)),Math.max(_.isNil(n.top)?0:n.top,0)),r=Math.max(_.isNil(n.height)?750:n.height,200);l+r+this.marginSize>window.innerHeight?(l=null,r+this.marginSize>window.innerHeight&&(r=window.innerHeight-this.marginSize)):_.isNil(n.top)&&(l=null),r=Tools.calcDialogHeight(r,"viewStateDialog"),this.$dialog=this.$el.dialog(_.extend({appendTo:e.dialogContainer,title:e.dialogOptions&&e.dialogOptions.dialogTitle?e.dialogOptions.dialogTitle:t("Select View State... "),classes:{"ui-dialog":"quick-dash viewstate-dialog"},resizable:!0,height:r,width:s,minWidth:990,minHeight:200,position:{my:"center",at:"center",of:"#appdiv",collision:"fit"},modal:!0,autoOpen:!0,buttons:[{text:t("Select Item"),click:$.proxy(a.onSelectButtonClick,a),disabled:!0,icon:"fa fa-check"},{text:e.dialogOptions&&e.dialogOptions.cancelBtnText?e.dialogOptions.cancelBtnText:t("Cancel"),click:$.proxy(a.onCancelButtonClick,a),icon:"fa fa-times"}],close:function(){a.cancelCallback&&a.cancelCallback(),a.updateDialogSizePosCookie(),a.updateAccordionCookieKey(),a.remove()},open:function(){$('<i class="fa fa-eye" />').insertBefore(a.$el.parent().find(".ui-dialog-title")),_.isNil(n.left)||_.isNil(n.top)||(a.$el[0].parentElement.style.left=o+"px",a.$el[0].parentElement.style.top=l+"px"),a.isEmbedded&&adjustDialogPositionIfNeeded(document.querySelector("#appdiv"),a.$el[0].parentElement),a.dataView=new TreeView({el:a.$el.find(".tree"),disabledNodes:a.disabledNodes,model:a.model,eventBus:a.eventBus,treeViewType:"VIEW_STATE",nodeLabel:"View State",nodeTypes:{node:{icon:"fa fa-fw fa-eye",valid_children:[]}},selected:e.path,viewOptions:e.dialogOptions,getCleanUpButtonState:a.getCleanUpButtonState.bind(a),getDocumentGraph:a.getDocumentGraph.bind(a),newGroupFn:function(){return new QuickBase.DocumentViewModel},newNodeFn:function(){return new QuickBase.DocumentViewModel({_viewType:!0,_default:""})},setPathFn:function(t,i,e){var n,o=t.path;i!==o&&(t.path=i,n=new RegExp("^"+o),t.getViewStateList().forEach(function(e){e=e.model;e.path&&(e.path=e.path.replace(n,i))}),e||a.docDataModel.getTreeList().forEach(function(e){e.updateParameterPath("vs",o,i,t.isGroup())}))},cleanUpFn:function(){a.documentGraph=new QuickBase.DocumentGraph(this.model,a.docDataModel,a.components,a.componentDefs,a.isEmbedded,this.model.getByPath.bind(this.model)),a.documentGraphVisual={documentGraph:a.documentGraph},a.cleanUpDialog=new CleanUpDialog({documentGraphVisual:a.documentGraphVisual,dialogContainer:a.dialogContainer,onClose:this.cleanUpNodes.bind(this),dialogOptions:{dialogTitle:"Unused View States",hideDataSources:!0}})}}),a.setDialogOptions(),a.initHorizontalResize(),a.sections=[{$el:a.$collapsibleEditor,heading:a.$propsHeader,isExpanded:!a.isPropertiesCollapsed,hidden:!1,weight:isNaN(parseFloat(i.propertiesWeight))?1:parseFloat(i.propertiesWeight)},{$el:a.$collapsibleGraph,heading:a.$graphHeader,isExpanded:!a.isGraphCollapsed,hidden:!1,weight:isNaN(parseFloat(i.graphWeight))?2:parseFloat(i.graphWeight)}],a.accordion=new AccordionView({el:a.$detailsPanel.get(0),sections:a.sections}),a.$propsHeader[0].querySelector("i").className=a.isPropertiesCollapsed?"fa fa-fw fa-caret-right":"fa fa-fw fa-caret-down",a.$graphHeader[0].querySelector("i").className=a.isGraphCollapsed?"fa fa-fw fa-caret-right":"fa fa-fw fa-caret-down",a.$el.find("h3").click(function(e){e.target===a.$propsHeader[0]?(a.isPropertiesCollapsed=!a.isPropertiesCollapsed,a.$collapsibleProperties.toggle(!a.isPropertiesCollapsed),a.accordion.sections[0].isExpanded=!a.isPropertiesCollapsed,a.accordion.sections[0].fixed=a.isPropertiesCollapsed?28:0,e.target.querySelector("i").className=a.isPropertiesCollapsed?"fa fa-fw fa-caret-right":"fa fa-fw fa-caret-down"):e.target==a.$graphHeader[0]&&(a.isGraphCollapsed=!a.isGraphCollapsed,a.$collapsibleGraph.toggle(!a.isGraphCollapsed),a.accordion.sections[1].isExpanded=!a.isGraphCollapsed,a.accordion.sections[1].fixed=a.isGraphCollapsed?28:0,e.target.querySelector("i").className=a.isGraphCollapsed?"fa fa-fw fa-caret-right":"fa fa-fw fa-caret-down",a.isGraphCollapsed||a.updateGraph(a.path)),a.accordion.updateLayout()}),a.dataView.on("select_property",$.proxy(a.onTreeViewSelectProperty,a)),"FSBL"in window&&a.$el.parent().css("margin-top",window.finApi.DIALOGS_TOP_MARGIN),a.$el.parent().find(".ui-dialog-buttonpane > div > button:last-child").focus()},dragStart:function(e){var t=a.$dialog.parent();a.isOutsideOfScreen=t.outerWidth()>window.innerWidth-a.sideBarWidth||t.outerHeight()>window.innerHeight,a.isOutsideOfScreen&&a.$dialog.parent().hide()},dragStop:function(e){a.isOutsideOfScreen&&(a.$dialog.dialog("option",{width:Math.min(window.innerWidth-a.sideBarWidth-a.marginSize,a.$dialog.dialog("option","width")),height:Math.min(window.innerHeight-a.marginSize,a.$dialog.dialog("option","height")),position:{my:"center",at:"center",of:"#appdiv",collision:"fit"}}),a.$el.parent().show(),a.onHorizontalResize(),a.isOutsideOfScreen=!1)},drag:function(e){a.isOutsideOfScreen||a.debounceUpdateDialogSizePosCookie()},resize:function(){a.onHorizontalResize(),a.debounceUpdateDialogSizePosCookie(),a.debounceResizeAccordion()},resizeStop:function(){a.dataView.scrollSelectedNodeIntoView()}},this.options)).dialogExtend({maximizable:!0,maximize:function(){a.debounceResizeAccordion(),a.onHorizontalResize(),_.defer(function(){a.initHorizontalResize()}),a.debounceUpdateDialogSizePosCookie()},restore:function(){a.resizeAccordion(),a.onHorizontalResize(),_.defer(function(){a.initHorizontalResize(),a.dataView.scrollSelectedNodeIntoView()}),a.debounceUpdateDialogSizePosCookie()}}),this.isEmbedded&&this.onDialogResize(),n.isMaximized&&this.$dialog.dialogExtend("maximize"),this.resizeEvent=function(){a.maximizedResize()},window.addEventListener("resize",this.resizeEvent)},getJSON:function(e){var t;try{t=JSON.parse($.cookie(e)||"{}")}catch(e){t={}}return t},maximizedResize:function(){var e;"maximized"===this.$dialog.dialogExtend("state")?this.$dialog.dialogExtend("maximize"):((e=this.$dialog.parent()).outerWidth()>window.innerWidth-this.sideBarWidth||e.outerHeight()>window.innerHeight)&&(this.$dialog.dialog("option",{width:Math.min(window.innerWidth-this.sideBarWidth-this.marginSize,this.$dialog.dialog("option","width")),height:Math.min(window.innerHeight-this.marginSize,this.$dialog.dialog("option","height")),position:{my:"center",at:"center",of:"#appdiv",collision:"fit"}}),this.onHorizontalResize())},updateDialogSizePosCookie:function(){var e,t,i,n,o;this.el.parentElement&&(o=((e="maximized"===this.$dialog.dialogExtend("state"))?(t=(o=this.getJSON(this.dialogCookieKey)).left,i=o.top,n=o.width,o):(t=(o=this.el.parentElement.style).left,i=o.top,n=o.width,o)).height,$.cookie(this.dialogCookieKey,JSON.stringify({left:parseInt(t),top:parseInt(i),width:parseInt(n),height:parseInt(o),isMaximized:e}),{expires:90,secure:!0,path:"/;SameSite=Strict"}))},updateAccordionCookieKey:function(){$.cookie(this.accordionCookieKey,JSON.stringify({propertiesWeight:this.accordion.sections[0].weight,graphWeight:this.accordion.sections[1].weight,isPropertiesCollapsed:this.isPropertiesCollapsed,isGraphCollapsed:this.isGraphCollapsed}),{expires:90,secure:!0,path:"/;SameSite=Strict"})},getDocumentGraph:function(){return new QuickBase.DocumentGraph(this.model,this.docDataModel,this.components,this.componentDefs,this.isEmbedded,this.model.getByPath.bind(this.model))},setDialogOptions:function(){this.dialogOptions&&(this.dialogOptions.hideSelectBtn&&this.$el.next().find("button:nth-of-type(1)").hide(),this.dialogOptions.hideCleanUpBtn)&&this.$el.find(".toolbar>.clean-up").hide(),this.showDetailsPanel()},showDetailsPanel:function(){this.path?this.$detailsPanel.show():this.$detailsPanel.hide()},getCleanUpButtonState:function(){var e;return!this.docDataModel||!this.components||(e=this.getDocumentGraph(),_.isEmpty(e.getIsolatedViewStates()))},onDialogResize:function(){var i=this;this.$dialog.on("dialogresizestop",function(e,t){dialogResizeHelper(document.querySelector("#appdiv"),t,$(this)),i.onHorizontalResize(),i.debounceUpdateDialogSizePosCookie(),i.debounceResizeAccordion()})},initHorizontalResize:function(){try{this.dataView.$el.resizable("destroy")}catch(e){}this.dataView.$el.resizable({handles:"e",minWidth:300,maxWidth:400}).on("resize",$.proxy(this.onHorizontalResize,this))},onHorizontalResize:function(){var e=this.$el.width();this.$detailsPanel.css({width:e-this.$el.find("> .tree").width()+22+"px",left:"auto"}),this.debounceResizeAccordion()},resizeAccordion:function(){this.accordion.resize()},onCancelButtonClick:function(){this.cancelCallback&&this.cancelCallback(),this.$el.dialog("close"),this.remove()},onSelectButtonClick:function(){this.selectCallback&&this.selectCallback(this.path),this.trigger("selected",this.model,this.path),this.onCancelButtonClick()},onTreeViewSelectProperty:function(e){this.path=e,this.$el.next().find("button:first").button({disabled:void 0===e}),this.showDetailsPanel(),this.updateProperties(e),e&&e.startsWith("_settings/")&&(this.$collapsibleProperties.find(":input").prop("disabled",!0),this.form)&&this.form.el.classList.add("ui-state-disabled"),this.updateGraph(e)},remove:function(){this.removeProperties(),window.removeEventListener("resize",this.resizeEvent),QuickBase.ErrorTooltip.clearAll(),Backbone.View.prototype.remove.call(this)},removeDialog:function(){this.$el.dialog&&this.$el.dialog("destroy"),Backbone.View.prototype.remove.call(this)},removeProperties:function(){this.form&&(this.form.remove(),this.form=null)},sayNoToSubmit:function(){return!1},removeViewStateGraph:function(){this.viewStateGraph&&(this.viewStateGraph.remove(),this.viewStateGraph=null)},updateGraph:function(e){this.model.getByPath(e);if(this.removeViewStateGraph(),e&&""!==e&&!this.isGraphCollapsed)try{this.viewStateGraph||(this.viewStateGraph=new DocumentGraphVisual(this.model,this.docDataModel,this.components,this.componentDefs,this.isEmbedded,this.dashboardTheme,null,null,this.docDataModel.getByPath.bind(this.docDataModel),null,null,{hideToolbar:!0,nodePath:e,nodesView:"vs"}),this.viewStateGraph.displayGraph(this.$collapsibleGraph.find(".content")[0]))}catch(e){}},updateProperties:function(t){var e,o=this,a=!1,s=o.model.getByPath(t);o.removeProperties(),s&&(s.get("value")||(a=!0),s.has("value")||s.set("value","",{silent:!0}),s.has("_default")||s.set("_default","",{silent:!0}),"dict"===s.get("_type")&&(s.schema.value.type="ThreeColumnDict",delete s.schema._default),_.includes(QuickBase.DocumentViewModel.DATA_TYPES_ROLLING,s.get("_type"))&&s.schema?(s.schema._default=BBForm.RTTI.getByName(s.get("_type")+"Rolling").editor,s.schema._default.options.editorModel=new Backbone.Model,s.get("_rolling")?(s.schema._default.options.editorModel.set("rolling",!0),(e=this.getDocumentGraph()).getConnectedViewStates().find(function(e){return e.path===s.path})?(e=_.some(e.getConnectedDataSources(),function(e){var t;switch(e.get("_dataType")){case"virtual":t="_virtualParams";break;case"analytic":case"api":t="streaming"!==e.get("_subscriptionType")||_.isNil(e.get("_streamingParameters"))?"_analyticParams":"_streamingParameters";break;case"insightsStreaming":t="_streamingParameters";break;case"builder":t="_builderParams";break;default:t="_queryParams"}return 0<e.get(t).length&&_.find(e.get(t),function(e){var t;return e.isVirtual?e.value===s.path&&!0===e.useRollingSyntax:"dict"===e.type?(t=e.value,_.find(t,function(e){return e.value==="<%"+s.path+"%>"&&!0===e.useRollingSyntax})):e.value==="<%"+s.path+"%>"&&!0===e.useRollingSyntax})}),s.schema._default.options.editorModel.set("enableRollingCheckbox",!e)):s.schema._default.options.editorModel.set("enableRollingCheckbox",!0)):(s.schema._default.options.editorModel.set("rolling",!1),s.schema._default.options.editorModel.set("enableRollingCheckbox",!0)),this.listenTo(s.schema._default.options.editorModel,"change:rolling",function(e,t){s.set("_rolling",t),this.stopListening(s,"change:_default"),s.get("_rolling")&&(this.listenTo(s,"change:_default",function(){s.set("value",QuickBase.Helpers.convertRollingToDate(s.get("_default"),s.get("_type")))}),s.trigger("change:_default"))}),this.stopListening(s,"change:_default"),s.get("_rolling")&&this.listenTo(s,"change:_default",function(){s.set("value",QuickBase.Helpers.convertRollingToDate(s.get("_default"),s.get("_type")))})):s.unset("_rolling",{silent:!0}),"list"!==s.get("_type")||s.get("_listtype")||s.set("_listtype","symbol"),s.schema._type.width="off",o.form=new BBForm({model:s,openViewStateDialog:function(e,t){new ViewStateDialog({dialogContainer:o.dialogContainer,disabledNodes:_.map(_.filter(o.model.attributes,function(e){return"dict"===e.get("_type")}),"path"),docDataModel:o.docDataModel,model:o.model,path:e,components:o.components,componentDefs:o.componentDefs,dashboardTheme:o.dashboardTheme,isEmbedded:o.isEmbedded,dialogOptions:{hideCleanUpBtn:!0},selectCallback:function(e){e=o.model.getByPath(e);t(e)}})},theme:"environment",viewStates:o.model.getViewStateList()}).render(),o.form.on("changeList",function(e,t){s.set("_default",e.getValue()._default),s.set("value",e.getValue().value)}),o.form.$el.on("submit",o.sayNoToSubmit),e=o.form.el.getElementsByTagName("li"),_.each(e,function(e,t){var i,n=e.getElementsByTagName("select")[0];n&&(e=e.getElementsByTagName("label")[0],i=_.uniqueId("label"),e.setAttribute("id",i),n.setAttribute("aria-labelledby",i))}),_.includes(["dict","list"],s.get("_type"))&&(e=$("<span />"),"list"===s.get("_type")&&e.addClass("fa fa-level-up fa-rotate-90 reset-to-default").prop("title","Copy Default field to Value field"),o.form.$el.find(".field-value label").append(e),e.click(function(){s.forceRender=!0,s.set("value",_.clone(s.get("_default"))),s.forceRender=!1}),e=$("<span />").addClass("fa fa-level-down fa-rotate-270 reset-to-default").prop("title","Copy Value field to Default field"),o.form.$el.find(".field-_default label").append(e),e.click(function(){s.forceRender=!0,s.set("_default",_.clone(s.get("value"))),s.forceRender=!1})),o.$collapsibleProperties.append(o.form.el),o.$collapsibleProperties.scrollTop=0,o.form.fields._type&&s.schema&&s.schema._type&&o.form.fields._type.editor.setOptions(s.schema._type.options),_.includes(QuickBase.DocumentViewModel.DATA_TYPES_ROLLING,s.get("_type"))&&!s.schema._default.options.editorModel.get("enableRollingCheckbox")&&(e=$(o.form.fields._type.el).find("option"),_.forEach(e,function(e){_.includes(QuickBase.DocumentViewModel.DATA_TYPES_ROLLING,e.value)||(e.disabled="disabled")})),o.debouncedUpdate=_.debounce(function(){var i,e,n;o.form&&(s.get("_type")!==o.form.getValue()._type?(s.set("_type",o.form.getValue()._type),o.removeProperties(),s.unset("value",{silent:!0}),s.unset("_default",{silent:!0}),s.updateSchema(),o.updateProperties(t),s.set("value",o.form.getValue().value),"dict"!==s.get("_type")&&s.set("_default",o.form.getValue()._default)):(i=o.form.getValue(),e=o.form.validate({appendToBody:!0,onLeft:!1}),"dict"!==i._type||i._default||(i._default={},_.each(i.value,function(e,t){i._default[t]=e._default,i.value[t]=e.value})),e?(n=_.keys(e),_.each(i,function(e,t){_.includes(n,t)||s.set(t,e)})):s.set(i),a&&(s.get("_rolling")?s.set("value",QuickBase.Helpers.convertRollingToDate(s.get("_default"),s.get("_type"))):"month"!==s.get("_type")&&s.set("value",_.isDate(s.get("_default"))?s.get("_default").toISOString():_.clone(s.get("_default"))))))},300),o.listenTo(o.form,"change",o.debouncedUpdate),o.listenTo(o.form,"_default:blur value:focus",function(){a=!1}))}}),DataConfigQuery_Pivot=Backbone.View.extend({AGGREGATE_FNS:["count","sum","avg","max","min","first","last"],AGGREGATE_COLS_PROP:"_aggregateCols",AGGREGATE_FNS_PROP:"_aggregateFns",AGGREGATE_LABELS_PROP:"_aggregateLabels",BREAKDOWN_PROP:"_breakdownCols",initialize:function(e){var t=this;t.options=e,t.$el.html(T.DataConfigQuery_Pivot(_.extend({guid:_.uniqueId("pivot_"),hasAggregateViewState:t.model.get(t.AGGREGATE_COLS_PROP)instanceof Backbone.Model},this.model.toJSON()))),t.$el.find("._columnLabel").change(function(){t.model.set("_columnLabel",$(this).val())}),t.$el.find("._columnLabel").val(t.model.get("_columnLabel")||""),t.$aggregateContainer=t.$el.find(".aggregateContainer"),t.$aggregateList=t.$aggregateContainer.find(".aggregateList"),t.$aggregateViewStateCheckBox=t.$aggregateContainer.find(".viewStateCheckbox"),t.switchCache={},t.upgradeModel(),t.initPivotOptions(),t.initializeAggregateEvents(),t.updateLayout(),t.$aggregateViewStateCheckBox.is(":checked")?(t.aggregateViewStateCache=!0,t.aggregateColsCache=t.model.get(t.AGGREGATE_COLS_PROP),t.aggregateFnCache=t.model.get(t.AGGREGATE_FNS_PROP),t.aggregateLabelsCache=t.model.get(t.AGGREGATE_LABELS_PROP)):(t.aggregateViewStateCache=!1,t.aggregateColsCache=$.extend(!0,[],t.model.get(t.AGGREGATE_COLS_PROP)),t.aggregateFnCache=$.extend(!0,[],t.model.get(t.AGGREGATE_FNS_PROP)),t.aggregateLabelsCache=$.extend(!0,[],t.model.get(t.AGGREGATE_LABELS_PROP))),t.initializeEvents()},initializeEvents:function(){this.listenTo(this.model,"change:_aggregateFns",this.onAggregateDetailsChang),this.listenTo(this.model,"change:_aggregateCols",this.onAggregateDetailsChange),this.listenTo(this.model,"change:_columnLabel",this.displayColumnLabel)},addAggregateRow:function(e,t,i){e=new DataConfigAggregateRow({model:this.model,aggregateDetails:{aggCol:e,aggFn:t||"avg",aggLabel:i||""}});this.$aggregateList.find("ul").append(e.$el)},checkNewAggregateEntry:function(e,t,i){return(-1<this.AGGREGATE_FNS.indexOf(t)||-1<t.indexOf(";"))&&0<e.length&&0<t.length},displayColumnLabel:function(){this.$el.find("._columnLabel").val(this.model.get("_columnLabel"))},initializeAggregateEvents:function(){function t(){e=i.$el.find(".newAggregate .aggregateColItm").val(),newAggregateFn=i.$el.find(".newAggregate .aggregateFnItm").val(),newAggregateLabel=i.$el.find(".newAggregate .aggregateLabelItm").val(),i.model.get(i.AGGREGATE_COLS_PROP).push(e),i.model.get(i.AGGREGATE_FNS_PROP).push(newAggregateFn),i.model.get(i.AGGREGATE_LABELS_PROP).push(newAggregateLabel),i.$el.find(".newAggregate .aggregateFnItm, .newAggregate .aggregateColItm, .newAggregate .aggregateLabelItm").val(""),i.$el.find(".newAggregate .aggregateFnItm").focus(),i.checkNewAggregateEntry(e,newAggregateFn,newAggregateLabel)||(i.$el.find(".newAggregate input").addClass("invalidEntry"),_.delay(function(){i.$el.find(".newAggregate input").removeClass("invalidEntry")},3e3)),i.model.trigger("change:_aggregateCols")}var e,i=this;i.$aggregateAddBtn=i.$el.find(".newAggregate .addBtn"),i.$aggregateCancelBtn=i.$el.find(".newAggregate .cancelBtn"),i.$aggregateResetBtn=i.$el.find(".resetBtn"),i.$aggregateSaveBtn=i.$el.find(".newAggregate .saveBtn"),i.$aggregateAddBtn.button({icon:"fa fa-plus",showLabel:!1}).click(t),i.$aggregateResetBtn.button({icon:"fa fa-repeat",showLabel:!1}).click($.proxy(i.resetAggregateCols,i)),i.$aggregateViewStateCheckBox.button({icon:"fa fa-eye",showLabel:!1}).click($.proxy(i.onViewStateCheckBoxClick,i)),i.$el.find(".newAggregate input").on("keydown",function(e){13===e.which&&t()}),i.initializeAggregateViewstate()},initializeAggregateViewstate:function(){var i=this,e={};e[i.AGGREGATE_COLS_PROP]={title:"Columns:",type:"ViewState"},e[i.AGGREGATE_FNS_PROP]={title:"Functions:",type:"ViewState"},e[i.AGGREGATE_LABELS_PROP]={title:"Labels:",type:"ViewState"},this.aggregateViewStateForm=new BBForm({model:i.model,openViewStateDialog:function(e,t){new ViewStateDialog({dialogContainer:i.options.dialogContainer,docDataModel:i.options.docDataModel,model:i.options.docViewModel,components:i.options.components,componentDefs:i.options.componentDefs,isEmbedded:i.options.isEmbedded,path:e,selectCallback:function(e){e=i.options.docViewModel.getByPath(e);t(e)}})},placeholder:"Type aggregate column name and hit enter",removeDuplicates:!0,schema:e}).render(),this.aggregateViewStateForm.on("change",function(){i.aggregateViewStateForm.commit()}),i.$el.find(".aggregateViewState").append(i.aggregateViewStateForm.el)},initPivotOptions:function(){var i=this;this.model.schema={},this.model.schema[this.BREAKDOWN_PROP]="ListViewState",this.breakdownPanel=new BBForm({model:this.model,openViewStateDialog:function(e,t){new ViewStateDialog({dialogContainer:i.options.dialogContainer,docDataModel:i.options.docDataModel,model:i.options.docViewModel,components:i.options.components,componentDefs:i.options.componentDefs,isEmbedded:i.options.isEmbedded,path:e,selectCallback:function(e){e=i.options.docViewModel.getByPath(e);t(e)}})},placeholder:"Type breakdown column name and hit enter",removeDuplicates:!0}).render(),this.breakdownPanel.on("change",function(){i.breakdownPanel.commit()}),this.breakdownPanel.on("changeList",function(e){i.model.set(i.BREAKDOWN_PROP,e.getValue()[i.BREAKDOWN_PROP])}),this.$el.find("."+this.BREAKDOWN_PROP).append(this.breakdownPanel.el),this.populateAggregateDetails()},onAggregateDetailsChange:function(e){e&&e.forceRender&&this.breakdownPanel&&this.aggregateViewStateForm?(e=this.model.get(this.AGGREGATE_COLS_PROP)instanceof Backbone.Model,this.breakdownPanel.off(),this.breakdownPanel.remove(),this.aggregateViewStateForm.off(),this.aggregateViewStateForm.remove(),this.$aggregateViewStateCheckBox.prop("checked",e),this.initPivotOptions(),this.initializeAggregateViewstate(),this.updateLayout()):this.populateAggregateDetails()},onViewStateCheckBoxClick:function(){var n=this;_.each([n.AGGREGATE_COLS_PROP,n.AGGREGATE_FNS_PROP,n.AGGREGATE_LABELS_PROP],function(e){var t=n.model.get(e),i=(i=n.switchCache[e])||(n.$aggregateViewStateCheckBox.is(":checked")?"":[]);n.model.set(e,i),n.switchCache[e]=t}),this.updateLayout()},populateAggregateDetails:function(){var o=this;o.model.get(o.AGGREGATE_COLS_PROP);o.$aggregateViewStateCheckBox.is(":checked")||(o.$aggregateList.find("li").remove(),0<o.model.get(o.AGGREGATE_COLS_PROP).length?o.$aggregateList.find("ul").addClass("populated-list"):o.$aggregateList.find("ul").removeClass("populated-list"),_.each(o.model.get(o.AGGREGATE_COLS_PROP),function(e,t){var i=o.model.get(o.AGGREGATE_FNS_PROP)||[],n=o.model.get(o.AGGREGATE_LABELS_PROP)||[];i[t]||(i[t]="avg"),n[t]||(n[t]=""),o.addAggregateRow(e,i[t],n[t])}),o.$aggregateList.find("ul").sortable({handle:".moveRow",placeholder:"ui-state-highlight",scrollSensitivity:5,scrollSpeed:5,axis:"y",stop:function(){o.model.set({_aggregateCols:[],_aggregateFns:[],_aggregateLabels:[]},{silent:!0}),_.each(o.$aggregateList.find("li"),function(e){o.model.get(o.AGGREGATE_COLS_PROP).push($(e).find(".aggregateColItm").val()),o.model.get(o.AGGREGATE_FNS_PROP).push($(e).find(".aggregateFnItm").val()),o.model.get(o.AGGREGATE_LABELS_PROP).push($(e).find(".aggregateLabelItm").val())}),o.model.trigger("change:_aggregateCols")}}))},refreshPivotDetails:function(){},remove:function(){this.$aggregateAddBtn.off(),this.$aggregateResetBtn.off(),this.$aggregateViewStateCheckBox.off(),Backbone.View.prototype.remove.call(this)},resetAggregateCols:function(){this.$aggregateViewStateCheckBox.prop("checked",this.aggregateViewStateCache),this.model.set(this.AGGREGATE_COLS_PROP,this.aggregateColsCache),this.model.set(this.AGGREGATE_FNS_PROP,this.aggregateFnCache),this.model.set(this.AGGREGATE_LABELS_PROP,this.aggregateLabelsCache),this.populateAggregateDetails(),this.updateLayout()},updateLayout:function(){this.$aggregateViewStateCheckBox.is(":checked")?this.$aggregateContainer.addClass("isViewState"):this.$aggregateContainer.removeClass("isViewState")},upgradeModel:function(){var e;this.model.has(this.AGGREGATE_LABELS_PROP)||(e=this.model.get(this.AGGREGATE_COLS_PROP),this.model.set(this.AGGREGATE_LABELS_PROP,_.map(e instanceof Backbone.Model?e.get("value"):e,function(){return""})))}}),qFunctionKeywordsOutsideSheet="aj0|wj1",qFunctionKeywords="abs|aj|acos|all|and|any|asc|asin|asof|atan|attr|avg|avgs|bin|binr|by|ceiling|cols|cor|cos|count|cov|cross|csv|cut|delete|deltas|desc|dev|differ|distinct|div|do|dsave|each|ej|ema|enlist|eval|except|exec|exit|exp|fby|fills|first|flip|floor|fkeys|from|get|getenv|group|gtime|hclose|hcount|hdel|hopen|hsym|iasc|idesc|if|ij|in|insert|inter|inv|key|keys|last|ljf|like|lj|load|log|lower|lsq|ltime|ltrim|mavg|max|maxs|mcount|md5|mdev|med|meta|min|mins|mmax|mmin|mmu|mod|msum|neg|next|not|null|or|over|parse|peach|pj|prd|prds|prev|prior|rand|rank|ratios|raze|read0|read1|reciprocal|reval|reverse|rload|rotate|rsave|rtrim|save|scan|scov|sdev|svar|select|set|setenv|show|signum|sin|sqrt|ss|ssr|string|sublist|sum|sums|sv|system|tables|tan|til|trim|type|uj|ungroup|union|update|upper|upsert|value|var|view|views|vs|wavg|where|while|within|wj|wsum|ww|xasc|xbar|xcol|xcols|xdesc|xexp|xgroup|xkey|xlog|xprev|xrank",helperFunctionKeywords="asBoolean|asByte|asChar|asDate|asDatetime|asFloat|asGUID|asInt|asList|asLong|asMinute|asMonth|asReal|asSecond|asShort|asString|asSymbol|asTime|asTimespan|asTimestamp|asType|catch|INFINITY|isAtom|isBoolean|isByte|isChar|isCompound|isDate|isDatetime|isDict|isDictionary|isEmpty|isEnum|isFloat|isFunction|isGeneral|isGUID|isInfinity|isInt|isKeyedTable|isLinked|isList|isLong|isMinute|isMonth|isNull|isNumber|isReal|isSecond|isShort|isString|isSymbol|isTable|isTime|isTimespan|isTimestamp|isType|isVector|NULL|parseBoolean|parseByte|parseChar|parseDate|parseDatetime|parseFloat|parseGUID|parseInt|parseLong|parseMinute|parseMonth|parseReal|parseSecond|parseShort|parseSymbol|parseTime|parseTimespan|parseTimestamp|parseType|typeOf|typeSymbol|until|xor",illegalQKeywords="Mlim|Q7|access|accp|adict|arch|assign|badtail|branch|cast|char|conn|constants|domain|elim|glim|globals|length|limit|locals|loop|mismatch|mq|noamend|nosocket|noupdate|nyi|os|par|params|part|pl|pwuid|splay|srv|stack|step|stop|stype|sys|threadview|unmappable|upd|user|utf8|vd1|wha|wsfull|wsm",illegalQKeywordsRegex=new RegExp("^("+illegalQKeywords+")\\b"),StringStream=function(){function e(e,t,i){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=i}return e.prototype.eol=function(){return this.pos>=this.string.length},e.prototype.sol=function(){return this.pos==this.lineStart},e.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},e.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},e.prototype.eat=function(e){var t=this.string.charAt(this.pos),e="string"==typeof e?t==e:t&&(e.test?e.test(t):e(t));if(e)return++this.pos,t},e.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},e.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},e.prototype.skipToEnd=function(){this.pos=this.string.length},e.prototype.skipTo=function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},e.prototype.backUp=function(e){this.pos-=e},e.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},e.prototype.indentation=function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},e.prototype.match=function(e,t,i){var n;return"string"!=typeof e?(n=this.string.slice(this.pos).match(e))&&0<n.index?null:(n&&!1!==t&&(this.pos+=n[0].length),n):(n=function(e){return i?e.toLowerCase():e})(this.string.substr(this.pos,e.length))==n(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},e.prototype.current=function(){return this.string.slice(this.start,this.pos)},e.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},e.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},e.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)},e}();function countColumn(e,t,i,n,o){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var a=n||0,s=o||0;;){var l=e.indexOf("\t",a);if(l<0||t<=l)return s+(t-a);s=(s+=l-a)+(i-s%i),a=l+1}}var State=function(){function e(e){var t=e.mode,i=e.prevToken,n=e.braceDepth,o=e.qukeMixed,e=e.depth;this.mode=t,this.prevToken=i,this.braceDepth=n,this.qukeMixed=o,this.depth=e}return e.prototype.clone=function(){return new e(this)},e.prototype.equals=function(e){return e===this},e}(),tokenFunction=function(t,e){function o(e,t){return t.mode!==O.afterCloseBracket&&e.match(U,!0,!1)?(t.mode=O.afterVarNumSym,m(t,"number")):(t.mode=O.afterPunctuation,m(t,"keyword"))}function n(e,t,i){return e.match(V,!0,!1),t.mode=O.afterVarNumSym,m(t,i)}function a(e,t){for(;;){if(e.eat('"'))return t.mode=O.afterPunctuation,m(t,"string");if(e.eol())return t.mode=O.unclosedString,m(t,"string");if(e.eat("\\")){if(!e.eat(N))return e.next(),m(t,"error-invalidEscape")}else e.next()}}function s(e,t){return e.eat(_)?e.match(P,!0,!1):e.eat(":")&&e.match(k,!0,!1),t.mode=O.afterVarNumSym,m(t,"symbol")}function l(e,t){var i=e.match(B,!0,!1);return t.mode=O.afterVarNumSym,E.test(i[0])?m(t,"error-datetime"):G.test(i[0])?m(t,"keyword"):S.test(i[0])?m(t,"error-illegalKeyword"):e.eat(".")?n(e,t,"variable"):g&&i[0].match(D)?m(t,"cell"):m(t,"variable")}function r(e,t){return e.match(A,!0)?(e.skipToEnd(),m(t,"toDo")):(e.skipToEnd(),m(t,"comment"))}function c(e,t){return e.eol()||e.match(M)?(e.eatSpace(),t.mode=O.commentTilEnd,e.skipToEnd(),m(t,"error-multilineComment")):0<t.depth?(t.mode=O.afterPunctuation,m(t,"error-unindentedToken")):(t=t,((e=e).match(x,!0,!1)?function(e,t){return e.eat(" ")||e.eol()?m(t,"command"):i(e,t)}:i)(e,t))}function i(e,t){return e.skipToEnd(),m(t,"command")}function d(e,t){return e.match(v,!1,!1)?n(e,t,"keyword"):e.match(F,!0,!1)?m(t,"error-reservedInContext"):e.match(T,!1,!1)?n(e,t,"variable"):e.match(H,!0,!1)?(t.mode=O.afterVarNumSym,m(t,"number")):(t.mode=O.afterPunctuation,m(t,"keyword"))}function u(e,t){return e.eatWhile(":"),t.mode=O.afterPunctuation,m(t,"keyword")}function p(e){return e.depth--,e.mode=O.afterCloseBracket,null}function h(e){return e.depth++,e.mode=O.afterOpenBracket,null}function m(e,t){return e.prevToken=t}var g=!!e.isSpreadsheet,f=/^[\[({]/,b=/^[\])}]/,v=/^[a-zA-Z](\.|$|(?![a-zA-Z0-9_]))/,y=/^[~!@#$%^&*:<>,\?|+=_-]/,w=/^[012]:/,C=/^(&&|\|\||(<>|[<>]=):|[~!@#$%\^&*\-_+\\,?]=)/,S=new RegExp("^("+illegalQKeywords+")\\b"),E=/^(asDatetime|parseDatetime)$/,T=/^[a-zA-Z]/,_=/^[a-zA-Z0-9.]/,k=/^[a-zA-Z0-9._/:]*/,P=/^[a-zA-Z0-9._]*(:[a-zA-Z0-9._/:]*)?/,D=/^[a-zA-Z][a-zA-Z]?[1-9][0-9]*\b/,x=/^([abBcCdefgopPsStTuvwWxz]|ts)\b/,A=/^\/*\s*@?TODO\b/i,L=/^k\)/,N=/^([\\\/nrt"0-7])/,M=/^\s+$/,B=/^[a-zA-Z0-9_]*/,V=/^[a-zA-Z0-9_]*(\.[a-zA-Z0-9_]+)*\.?/,F=new RegExp("^[a-zA-Z0-9_]+\\.("+qFunctionKeywords+"|"+helperFunctionKeywords+")(\\.[a-zA-Z0-9_]+)*\\.?\\b"),H=/^([0-9]+(f|e(-?[0-9]+e?)?)?|(f|e(-?[0-9]+e?)?))/,I="0x[\\da-fA-Fa-f]*",$=["0[nNwW][hjemdzuvtifpgn]?","[10]+b",I,"\\d{4}\\.\\d{2}([ptnm]|\\.\\d{2}([DPtdp](\\d{2}(:\\d{2}(:\\d{2}(\\.\\d{0,9})?)?)?)[pn]?|[pnd]?))","\\d{2}:\\d{2}(:\\d{2}(\\.\\d{0,9})?)?[ptnvu]?|\\d{2}[ptnvu]","\\d{1,6}D(\\d{1,2}(:\\d{2}(:\\d{2}(\\.\\d{0,9}|\\.?)?)?)?)?[np]?","\\d{1,6}P\\d{2}:\\d{2}([np]|:\\d{2}([np]|\\.[np]|\\.\\d{0,9}[np]|\\.\\d{3,9}[np]?))","(\\d+(\\.\\d*)?|\\d*\\.\\d+)(e[+-]?\\d+)[ef]?|(\\d+\\.\\d*|\\d*\\.\\d+)[ef]?|\\d+[eihjf]?"].join("|"),R=new RegExp("^([10]+b|"+I+"|"+$+")"),U=new RegExp("^("+$+")"),G=new RegExp("^("+qFunctionKeywords+"|"+helperFunctionKeywords+(g?"":"|"+qFunctionKeywordsOutsideSheet)+")\\b"),O={SOL:0,afterSpace:1,afterVarNumSym:2,afterPunctuation:3,unclosedString:4,multilineComment:5,commentTilEnd:6,afterOpenBracket:7,afterCloseBracket:8};return{startState:function(){return new State({mode:O.SOL,prevToken:null,braceDepth:0,qukeMixed:!!e.qukeMixed,depth:0})},indent:function(e){return t.indentUnit*e.depth},token:function(e,t){if(e.sol()&&t.mode!==O.commentTilEnd&&t.mode!==O.multilineComment&&t.mode!==O.unclosedString&&(t.mode=O.SOL,t.prevToken="SOL"),t.mode===O.unclosedString)return e.eat("\\")?m(t,"error-SOLBackslashInString"):a(e,t);if(t.mode===O.SOL){if(e.eatSpace())return t.mode=O.afterSpace,null;if(e.eat("/"))return n=t,(i=e).eol()||i.match(M)?(i.eatSpace(),n.mode=O.multilineComment,m(n,"error-multilineComment")):r(i,n);if(!t.qukeMixed&&0<t.depth&&")"!==e.peek()&&"]"!==e.peek()&&"}"!==e.peek())return e.next(),m(t,"error-unindentedToken");if(e.match(L,!1,!1))return i=t,e.skipToEnd(),m(i,"command");if(e.match(T,!1,!1))return l(e,t);if(e.eat(";"))return t.mode=O.afterPunctuation,null;if(e.eat("\\"))return c(e,t);if(e.eat("`"))return s(e,t);if(e.eat("."))return d(e,t);if(e.eat('"'))return a(e,t);if(e.eat("'"))return u(e,t);if(e.eat("-"))return o(e,t);if(e.match(C,!0,!1))return t.mode=O.afterPunctuation,m(t,"error");if(e.eat(y))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.eat(f))return h(t);if(e.eat(b))return p(t),m(t,"error-unindentedToken");if(e.match(w,!0,!1))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.match(R,!0,!1))return t.mode=O.afterVarNumSym,m(t,"number")}else if(t.mode===O.afterSpace){if(e.eatSpace(),e.match(T,!1,!1))return l(e,t);if(e.eat(";"))return t.mode=O.afterPunctuation,null;if(e.eat("/"))return r(e,t);if(e.eat("`"))return s(e,t);if(e.eat("."))return d(e,t);if(e.eat('"'))return a(e,t);if("\\"===e.peek()&&"SOL"===t.prevToken)return e.next(),m(t,"error-indentedCommand");if(e.eat(/['\\]/))return u(e,t);if(e.eat("-"))return o(e,t);if(e.match(C,!0,!1))return t.mode=O.afterPunctuation,m(t,"error");if(e.eat(y))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.eat(f))return h(t);if(e.eat(b))return p(t);if(e.match(w,!0,!1))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.match(R,!0,!1))return t.mode=O.afterVarNumSym,m(t,"number")}else if(t.mode===O.afterVarNumSym){if(e.eatSpace())return t.mode=O.afterSpace,null;if(e.eat(";"))return t.mode=O.afterPunctuation,null;if(e.eat("`"))return s(e,t);if(e.eat('"'))return a(e,t);if(e.eat(/['/\\]/))return u(e,t);if(e.match(C,!0,!1))return t.mode=O.afterPunctuation,m(t,"error");if(e.eat(y))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.eat(f))return h(t);if(e.eat(b))return p(t);if(e.match(/^[Tz]/))return t.mode=O.afterPunctuation,m(t,"error-datetime")}else if(t.mode===O.afterPunctuation||t.mode===O.afterOpenBracket||t.mode===O.afterCloseBracket){if(e.eatSpace())return t.mode=O.afterSpace,null;if(e.match(T,!1,!1))return l(e,t);if(e.eat(";"))return t.mode=O.afterPunctuation,null;if(e.eat("`"))return s(e,t);if(e.eat("."))return d(e,t);if(e.eat('"'))return a(e,t);if(e.eat(/['/\\]/))return u(e,t);if(e.eat("-"))return o(e,t);if(e.match(C,!0,!1))return t.mode=O.afterPunctuation,m(t,"error");if(e.eat(y))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.eat(f))return h(t);if(e.eat(b))return p(t);if(e.match(w,!0,!1))return t.mode=O.afterPunctuation,m(t,"keyword");if(e.match(R,!0,!1))return t.mode=O.afterVarNumSym,m(t,"number")}else{if(t.mode===O.commentTilEnd)return e.skipToEnd(),m(t,"comment");if(t.mode===O.multilineComment)return n=t,(t=e).eat("\\")&&(t.eol()||t.match(M))?(t.eatSpace(),n.mode=O.SOL):t.skipToEnd(),m(n,"error-multilineComment")}var i,n;return e.next()}}},tokenizer=tokenFunction({},{name:"q",isSpreadsheet:"false"}),MonacoHelpers=function(){function a(){}return a.DEFAULT_OPTIONS=function(){return{automaticLayout:!0,contextmenu:!0,autoIndent:"advanced",fixedOverflowWidgets:!0,fontSize:12,lineDecorationsWidth:0,lineNumbersMinChars:2,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",dragAndDrop:!1}},a.adjustAfterResize=function(e){e&&e._domElement&&e.updateOptions({minimap:{enabled:800<e._domElement.clientWidth}})},a.require=function(e,n){var t=e.language;require(a.MONACO_PATH,function(i){switch(t){case"handlebars":a.registerHandlebarFormatting(function(){a.registerHandlebarIntellisense(function(e){var t=e.docs,e=e.disposable;n({monaco:i,docs:t,disposable:e})})});break;case"javascript":a.registerLodashIntellisense(function(e){n({monaco:i,unload:e})});break;case"q":a.registerQLanguage(),a.fetchAutoCompleteItems(function(e){n({monaco:i,autocompleteItems:e})});break;default:n({monaco:i})}i.editor.setTheme("kx-light"!==$.cookie("dashboard-theme")?"vs-dark":"vs")})},a.fetchAutoCompleteItems=function(t){$.ajax(requirejs.toUrl("vendor/types/q.json")).then(function(e){e=e.autocompleteItems;t(e)})},a.registerHandlebarFormatting=function(e){require(["polyfill"],function(){require(["beautify-html"],function(n){monaco.languages.registerDocumentFormattingEditProvider("handlebars",{provideDocumentFormattingEdits:function(e){var t=e.getValue(),i=["and","compare","contains","eq","filter","gt","gte","has","ifEven","ifNth","ifOdd","inArray","is","isnt","lengthEqual","lt","lte","neither","or","unlessEq","unlessGt","unlessLt","unlessGteq","unlessLteq","startsWith","with"].map(function(e){return e.toLowerCase()}),t=n.html_beautify(t,{handlebar_helpers:i});return[{range:e.getFullModelRange(),text:t}]}}),e()})})},a.registerLodashIntellisense=function(t){monaco.languages.typescript.javascriptDefaults.setCompilerOptions({target:monaco.languages.typescript.ScriptTarget.ES5,allowNonTsExtensions:!0}),$.ajax(requirejs.toUrl("vendor/types/lodash.d.ts")).then(function(e){t(monaco.languages.typescript.javascriptDefaults.addExtraLib(e))})},a.registerHandlebarIntellisense=function(t){$.ajax(requirejs.toUrl("vendor/types/handlebarhelpersdocs.json")).then(function(o){var e=monaco.languages.registerHoverProvider("handlebars",{provideHover:function(e,t){var i=t.lineNumber,t=t.column,e=e.getLineContent(i),i={lineNumber:i,column:t},t=i.lineNumber,n=i.column;if((i=function(e){var t=0,i=[];while(true){var n=e.substring(t);var o=n.indexOf("{{");if(t>e.length||o<0)break;var a=n.indexOf("}}");i.push([o+t,a+t]);t=a+t+2}return i}(e).find(function(e){return n>=e[0]&&n<=e[1]}))&&e.match(/{{#?([A-Za-z]+)/))return e=e.match(/{{#?([A-Za-z]+)/)[1],{range:{startLineNumber:t,startColumn:i[0]+1,endColumn:i[1]+3,endLineNumber:t},contents:o[e]?[{value:o[e].comment.replace(/(\/\*\*|\*\/|\*)/g,"").replace(/\n/g,"  \n").replace(/(```handlebars|```)/g,"`")}]:[]}}});t({docs:o,disposable:e})})},a.getScopeFromStyle=function(e){switch(e){case null:return"default";case"error-multilineComment":return"comment.block";case"symbol":return"symbol";case"error-unindentedToken":return"invalid";default:return e}},a.registerQLanguage=function(){monaco.languages.register({id:"q"}),monaco.editor.defineTheme("q-theme",{base:"vs-dark",inherit:!0,rules:[{background:"#161616",foreground:"#aaaaaa"},{token:"number",background:"#ce3595",foreground:"#ce3595"},{token:"keyword",background:"#161616",foreground:"#bd9c39"},{token:"string",background:"#161616",foreground:"#78abd2"},{token:"variable",background:"#161616",foreground:"#bdbdbd"},{token:"symbol",background:"#161616",foreground:"#8e7bbb"}],colors:{"editor.background":"#161616","editorLineNumber.foreground":"#8d8d8d"}}),monaco.editor.defineTheme("q-theme-light",{base:"vs",inherit:!0,rules:[{background:"#ffffff",foreground:"#09026f"},{token:"number",background:"#ffffff",foreground:"#0000ef"},{token:"keyword",background:"#ffffff",foreground:"#996900"},{token:"comment",background:"#ffffff",foreground:"#109900"},{token:"string",background:"#ffffff",foreground:"#006b99"},{token:"variable",background:"#ffffff",foreground:"#09026f"},{token:"symbol",background:"#ffffff",foreground:"#845df4"}],colors:{"editor.background":"#ffffff","editorLineNumber.foreground":"#09026f"}}),monaco.languages.setTokensProvider("q",{getInitialState:function(){return tokenizer.startState()},tokenize:function(e,t){for(var i=new StringStream(e),n=[];!i.eol();){var o=tokenizer.token(i,t);n.push({scopes:a.getScopeFromStyle(o),startIndex:i.start}),i.start=i.pos}return{endState:t,tokens:n}}}),monaco.languages.setLanguageConfiguration("q",{brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[],indentationRules:{decreaseIndentPattern:void 0,increaseIndentPattern:/[{(\[]/},onEnterRules:[{beforeText:/^[^\[]*[})\]]/,action:{indentAction:3}}]})},a.MONACO_PATH=["vs/editor/editor.main"],a}(),DataParameter=(Handlebars.registerHelper("type-cast",function(e,t){return e.toLowerCase()}),function(l){function c(e,t,i,n,o,a){var s=l.call(this,{className:"data-parameter "+_.get(e.get("options"),"cssClass",""),model:e})||this;return s.parameters=[],s.keyIndex=0,s.supressTypeNavigation=!1,s.viewStateName="",s.triggerChangeOnBlurEvent=!1,s.hasPendingChanges=!1,s.triggerChangeOnBlurEvent=_.get(e.get("options"),"triggerChangeOnBlurEvent",!1),s.originalValue=s.model.get("value"),s.model.set({type:s.model.get("type").toLowerCase()},{silent:!0}),s.model=e,s.docViewModel=i,s.dataModel=t,s.vsCallback=n,s.$el.html(T.DataParameter(s.model.toJSON())),s.$form=s.$(".form-control"),s.$viewStateApply=s.$(".viewstate-apply"),s.$viewStateClear=s.$(".binding-clear"),s.$viewStateContainer=s.$(".binding-container"),s.$viewStateInput=s.$("input:not(.name-input, .checkbox-rolling)").attr("type","text"),s.$viewStateDisplay=s.$(".value-display"),s.$valueInput=s.$(".value-input"),s.$generateValue=s.$(".generate-value"),s.$typeSelect=s.$(".type-select"),s.$typeSelect.val(s.model.get("type")),s.$addItemBtn=s.$(".add-item-btn"),s.$listItems=s.$(".list-items"),s.$buttonRow=s.$(".button-row"),s.$nameInput=s.$(".name-input"),s.$removeItemBtn=s.$(".remove-item-btn"),s.$rollingCheckbox=s.$(".checkbox-rolling"),s.$addItemBtn.button({icon:"fa fa-plus",showLabel:!1,classes:{"ui-button":"btn-no-borders"}}).click($.proxy(s.onAddItemClicked,s)),0<s.$removeItemBtn.length&&s.$removeItemBtn.button({icon:"fa fa-minus",showLabel:!1,classes:{"ui-button":"btn-no-borders"}}).click($.proxy(s.onRemoveClick,s)),o&&o.length&&s.$typeSelect.find("option").filter(function(e,t){return!_.includes(o,t.text)}).remove(),s.$typeSelect.select2({theme:"dashboards",width:"100%"}),s.$typeSelect.on("select2:open",function(){$("body > .select2-container--dashboards.select2-container--open").addClass("select2--environment")}),s.$viewStateInput.on("focus",function(e){s.keyIndex=0}),s.model.get("isViewState")&&s.model.get("value")?s.onSelectViewState(s.model.get("value").split("%")[1]):"dict"!==s.model.get("type")&&s.valueInput&&s.valueInput.setValue(s.model.get("value")),s.onTypeChanged(),s.supressTypeNavigation=!!a,_.defer(function(){s.supressTypeNavigation&&s.$(".type-dropdown .select2-selection").prop("tabindex",-1),s.viewStateName=s.getPath(),s.initializeEvents()}),s}return __extends(c,l),c.prototype.addParam=function(e,t,i,n,o,a,s,l){var r=this,e=new Backbone.Model({id:_.uniqueId("param_"),name:e,type:t,value:i,required:n,description:o,editable:!0,isViewState:s,useRollingSyntax:l}),t=(this.listenTo(e,"change",this.updateValue),new c(e,this.dataModel,this.docViewModel,this.vsCallback,void 0,this.supressTypeNavigation));this.listenTo(t,"paramRemoved",this.onParamRemoved),this.listenTo(t,"ValueChanged",function(){return r.updateValue()}),t.$el.appendTo(this.$listItems),this.parameters.push(t),a||this.updateValue()},c.prototype.initializeEvents=function(){var o=this,e=this;this.listenTo(this.model,"change:type",this.onTypeChanged),this.listenTo(this.model,"change:name",function(){e.updateValue()}),this.$viewStateApply.on("click",this.showViewStateDialog.bind(this)).on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),o.showViewStateDialog())}).on("focusout",function(e){o.el.contains(e.relatedTarget)||o.removeViewStateIconsInlineDisplayStyle()}),this.$viewStateDisplay.on("click",this.showViewStateDialog.bind(this)).on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),o.showViewStateDialog())}),this.$viewStateClear.on("click",this.onViewStateClear.bind(this)).on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),o.onViewStateClear())}),this.$generateValue.on("click",this.generateViewState.bind(this)).on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),o.generateViewState())}).on("focusout",function(e){o.el.contains(e.relatedTarget)||o.removeViewStateIconsInlineDisplayStyle()}),this.$el.on("keyup",function(e){var t,i,n=o.model.get("type");"Tab"===e.key?(t="month"===n,i=-1!==c.TEMPORAL_TYPES.indexOf(n),!t&&"Select"!==(null==(t=o.model.attributes.options)?void 0:t.format)||(e.target.classList.contains("select2-selection")?o.showViewStateIcons():o.hideViewStateIcons()),i&&"INPUT"===e.target.nodeName&&!o.$form.hasClass("use-rolling")&&o.showViewStateIcons(),"list"===o.model.get("type")&&("INPUT"===e.target.nodeName?o.showViewStateIcons():o.hideViewStateIcons())):"list"!==n||"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||(i=o.getInputElement(e,null==(t=o.valueInput)?void 0:t.el),o.navigateViewstateIcons(e,i))}),this.$el.on("keydown",function(e){var t,i=o.getInputElement(e,null==(i=o.valueInput)?void 0:i.el);"Enter"===e.key?"INPUT"===(null==i?void 0:i.nodeName)&&"checkbox"===(null==i?void 0:i.type)&&i.click():"Tab"===e.key?("Select"===(null==(t=o.model.attributes.options)?void 0:t.format)&&o.hideViewStateIcons(),"list"===o.model.get("type")&&(t=_.filter(o.$el.find(".tag-editor")[0].getElementsByTagName("li"),function(e){return!e.classList.contains("ui-sortable-handle")}),t=_.map(t,function(e){return e.getElementsByTagName("input")[0]}),e.target!==t[0]&&e.target!==t[t.length-1]||o.hideViewStateIcons())):"list"===o.model.get("type")||"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||o.navigateViewstateIcons(e,i)}),this.$typeSelect.on("change",this.onTypeChange.bind(this)),this.$nameInput.on("change",this.onNameChange.bind(this)),this.$rollingCheckbox.on("change",this.onUseRollingChange.bind(this))},c.prototype.applyControlState=function(){this.model.get("isViewState")?this.$form.addClass("is-bound"):this.$form.removeClass("is-bound")},c.prototype.removeRolling=function(){this.$form.removeClass("use-rolling"),this.$rollingCheckbox.prop("checked",!1),this.model.unset("useRollingSyntax")},c.prototype.disableListEditing=function(){this.$buttonRow.hide(),this.$listItems.hide()},c.prototype.enableListEditing=function(){"dict"===this.model.get("type")&&(this.$buttonRow.show(),this.$listItems.show())},c.prototype.getPath=function(){var e=this.dataModel.path;return e.substring(e.lastIndexOf("/")+1)+"/"+this.model.get("name")},c.prototype.getInputElement=function(e,t){var i,n=e.target===this.$viewStateInput[0],o=this.model.get("type");return-1!==c.TEMPORAL_TYPES.indexOf(o)&&"DIV"===(null==t?void 0:t.nodeName)&&"value"===t.getAttribute("name")?t=t.getElementsByTagName("input")[0]:"Select"===(null==(i=this.model.attributes.options)?void 0:i.format)?t=this.$el.find(".select2-selection")[1]:"list"!==o||"INPUT"!==e.target.nodeName||n?"month"===o&&(t=_.map(this.valueInput.el.getElementsByClassName("select2-selection"),function(e){return $(e)})[0]):(i=_.filter(this.$el.find(".tag-editor")[0].getElementsByTagName("li"),function(e){return!e.classList.contains("ui-sortable-handle")}),n=_.map(i,function(e){return e.getElementsByTagName("input")[0]}),("ArrowLeft"===e.key&&e.target===n[0]||"ArrowRight"===e.key&&e.target===n[n.length-1])&&(t=e.target)),t},c.prototype.getInputValue=function(){var e=this.valueInput.getValue()||"";return _.isString(e)?e.replace("&lt;","<").replace("&gt;",">"):e},c.prototype.generateViewState=function(){var i,n=this,o=this.docViewModel,a=(this.viewStateName=this.getPath(),this.viewStateName.split("/")||[]);return a.forEach(function(e,t){t===a.length-1?(o.has(e)||(i=new QuickBase.DocumentViewModel({_viewType:!0,_type:n.model.get("type").toLowerCase(),_default:n.model.get("value"),value:n.model.get("value")},{root:o,path:n.viewStateName},null),o.set(e,i)),n.selectGeneratedViewState(n.viewStateName)):(o.has(e)||(t=new QuickBase.DocumentViewModel({},null,null),o.set(e,t)),o=o.getByPath(e))}),i},c.prototype.navigateViewstateIcons=function(e,t){var i,n,o,a="INPUT"===(null==t?void 0:t.nodeName)&&"text"===(null==t?void 0:t.type),s="TEXTAREA"===(null==t?void 0:t.nodeName),l=!1,r=!0,c=!0,d=0;(a||s)&&(l=document.activeElement===t,d=t.value.length,o=t.selectionStart,i=t.selectionStart!==(null==t?void 0:t.selectionEnd),n=0===o&&"ArrowLeft"===e.key,o=o===d&&"ArrowRight"===e.key,r=l&&!i&&n,c=l&&!i&&o),l&&!r&&!c||this.setElementFocus(e,t,a,s,d)},c.prototype.onAddItemClicked=function(){var e=this.model.get("addValue"),e=e?e(this.model.attributes):{name:"parameter0",type:"symbol",value:""},t=e.name,i=e.type,e=e.value;this.addParam(t,i,e,!1,"")},c.prototype.onNameChange=function(){var e=this.$nameInput.val();this.model.set({name:e})},c.prototype.onUseRollingChange=function(){var e=this.$rollingCheckbox.prop("checked");this.model.set({useRollingSyntax:e})},c.prototype.onParamRemoved=function(e){this.parameters=_.without(this.parameters,e),this.updateValue()},c.prototype.onRemoveClick=function(){this.trigger("paramRemoved",this),this.remove()},c.prototype.onSelectViewState=function(e){var t=this.docViewModel.getByPath(e);t?t&&t.has("_type")&&(this.model.set({type:t.get("_type"),isViewState:!0}),this.model.set("value","<%"+e+"%>"),this.$viewStateInput.val(e),this.$viewStateInput.attr("tabindex",0),this.$viewStateDisplay.val(e),this.applyControlState(),t.has("_rolling")&&!0===t.get("_rolling")?(this.$form.addClass("use-rolling"),this.$rollingCheckbox.prop("checked",!!this.model.has("useRollingSyntax")&&this.model.get("useRollingSyntax"))):this.removeRolling(),this.disableListEditing(),this.trigger("ValueChanged")):this.onViewStateClear()},c.prototype.onTypeChange=function(){var e=this.$typeSelect.val();"dict"===e?this.model.set({value:{},type:e}):this.model.set({type:e})},c.prototype.onTypeChanged=function(){var e,t,i=this.model.get("type"),n=this;_.each(this.parameters,function(e){e.remove()}),this.parameters=[],this.$el.attr("data-type",i),this.$typeSelect.val(i).trigger("change"),"dict"===i?(this.model.get("isViewState")?this.disableListEditing():this.enableListEditing(),this.removeValueInput(),"string"==typeof(i=n.model.get("value")||this.originalValue)?(e=i.split(""),_.each(e,function(e){6==(t=e.split("")).length&&n.addParam(t[0],t[1],t[2],t[3],t[4])})):"object"==typeof i&&_.each(i,function(t,e){try{n.addParam(t.name,t.type,t.value,!1,"",void 0,t.isViewState&&0===t.value.indexOf("<%"),t.useRollingSyntax||void 0)}catch(e){console.error("Param error ",t)}})):(this.disableListEditing(),this.renderInput()),this.trigger("ValueChanged")},c.prototype.onViewStateClear=function(){this.model.set("isViewState",!1),this.model.set("value",null),this.$viewStateInput.val(""),this.$viewStateInput.attr("tabindex",-1),this.applyControlState(),this.removeRolling(),this.$generateValue.removeClass("disabled"),this.enableListEditing(),this.trigger("ValueChanged"),this.$valueInput.children().first().trigger("focus")},c.prototype.onValueInput=function(){this.model.set({value:this.getInputValue(),isViewState:!1}),this.trigger("ValueChanged")},c.prototype.remove=function(){return _.each(this.parameters,function(e){e.remove()}),this.parameters=[],Backbone.View.prototype.remove.apply(this)},c.prototype.removeValueInput=function(){this.valueInput&&(this.stopListening(this.valueInput),this.valueInput.remove(),this.valueInput=null)},c.prototype.renderInput=function(){var e,t,i,n,o,a=this;this.removeValueInput(),this.$valueInput.empty(),(e=this.model.get("type"))&&(e=BBForm.RTTI.getByName(e),t=BBForm.editors[e.editor.type],i=void 0,(n=this.model.get("options"))&&n.format&&(t=BBForm.editors[n.format],i=n.schema),this.valueInput=new t({id:_.uniqueId("valueInput_"),key:"value",model:this.model,schema:_.extend({editorClass:"data-parameter-editor",options:e.editor.options,validators:e.editor.validators},i)}).render(),this.$valueInput.append(this.valueInput.el),this.model.get("isViewState")||this.model.get("value")===this.getInputValue()||this.onValueInput(),(n=this.$valueInput.children().first()).on("focus",function(e){a.keyIndex=0,a.showViewStateIcons()}),o=this.el.getElementsByClassName("input-div")[0],n.on("focusout",function(e){o.contains(e.relatedTarget)||a.removeViewStateIconsInlineDisplayStyle()})),this.listenTo(this.valueInput,"change changeList",function(){var e=a.valueInput.validate();e?a.setError(e.message):(a.setError(null),a.triggerChangeOnBlurEvent?a.hasPendingChanges=!0:a.onValueInput())}),this.triggerChangeOnBlurEvent&&this.listenTo(this.valueInput,"blur",function(){a.hasPendingChanges&&(a.hasPendingChanges=!1,a.onValueInput())})},c.prototype.sayNoToSubmit=function(){return!1},c.prototype.selectGeneratedViewState=function(e){this.onSelectViewState(e),this.$generateValue.addClass("disabled")},c.prototype.setElementFocus=function(t,e,i,n,o){var a=[$(e),this.$generateValue,this.$viewStateApply],s=[this.$viewStateInput,this.$viewStateClear],l="month"===this.model.get("type")?_.map(this.valueInput.el.getElementsByClassName("select2-selection"),function(e){return $(e)}):[],l=l[1]&&t.target===l[1][0],r=a.filter(function(e){return t.target===e[0]}),c=s.filter(function(e){return t.target===e[0]}),l=l||r.length?a:c.length?s:[];l.length&&(t.preventDefault(),"ArrowLeft"===t.key?(this.keyIndex=(this.keyIndex-1+l.length)%l.length,(i||n)&&document.activeElement===this.$generateValue[0]&&e.setSelectionRange(o,o)):"ArrowRight"===t.key&&(this.keyIndex=(this.keyIndex+1)%l.length,i||n)&&document.activeElement===this.$viewStateApply[0]&&e.setSelectionRange(0,0),l[this.keyIndex].trigger("focus"))},c.prototype.setError=function(e){e&&this.valueInput?(this.valueInput.$el.addClass("error"),this.$errorTooltip&&BBForm.ErrorTooltip.clear(this.$errorTooltip),this.$errorTooltip=BBForm.ErrorTooltip.show(e,this.$valueInput)):(this.valueInput.$el.removeClass("error"),BBForm.ErrorTooltip.clear(this.$errorTooltip))},c.prototype.showViewStateIcons=function(){this.$generateValue.show(),this.$viewStateApply.show()},c.prototype.hideViewStateIcons=function(){this.$generateValue.hide(),this.$viewStateApply.hide()},c.prototype.removeViewStateIconsInlineDisplayStyle=function(){this.$generateValue[0].style.display="",this.$viewStateApply[0].style.display=""},c.prototype.showViewStateDialog=function(){var t=this;this.vsCallback({beforeClose:function(){},close:function(){},cancelCallback:function(e){},path:this.$viewStateInput.val(),selectCallback:function(e){return t.onSelectViewState(e)}})},c.prototype.updateValue=function(){var t;"dict"===this.model.get("type")&&(t={},_.each(this.parameters,function(e){t[e.model.get("name")]={type:e.model.get("type"),IsKdbParam:!0,isViewState:e.model.get("isViewState"),useRollingSyntax:e.model.get("useRollingSyntax"),name:e.model.get("name"),value:e.model.get("value")},e.model.has("useRollingSyntax")||delete t[e.model.get("name")].useRollingSyntax}),this.model.set({value:t})),this.trigger("ValueChanged")},c.TEMPORAL_TYPES=["date","datetime","timestamp","time","timespan","minute","second"],c}(Backbone.View)),KdbTableCompletionProvider=function(){function e(e){this.possibleTokens=e}return e.prototype.provideCompletionItems=function(e,t,i,n){if(t.column<=1)return{suggestions:[]};try{var o=e.getLineContent(t.lineNumber).substring(0,t.column),a=o.lastIndexOf(" "),s=o.substring(a).trim(),l=new RegExp(_.escapeRegExp(s));return{suggestions:this.possibleTokens.filter(function(e){return!(t.column<=1)&&e.match(l)}).map(function(e){return{label:e,insertText:e,kind:monaco.languages.CompletionItemKind.Variable,range:{startLineNumber:t.lineNumber,startColumn:t.column-s.length,endLineNumber:t.lineNumber,endColumn:t.column+e.length-s.length}}})}}catch(e){return{suggestions:[]}}},e}(),KdbFunctionCompletionProvider=function(){function e(e){this.possibleFns=e}return e.prototype.provideCompletionItems=function(e,t,i,n){if(t.column<=1)return{suggestions:[]};try{var o=e.getLineContent(t.lineNumber).substring(0,t.column),a=o.lastIndexOf(" "),s=o.substring(a).trim(),l=new RegExp(_.escapeRegExp(o.substring(a).trim()));return{suggestions:this.possibleFns.filter(function(e){return!(t.column<=1)&&e.label.match(l)}).map(function(e){return{label:e.label,detail:e.detail,insertText:e.insertText,kind:monaco.languages.CompletionItemKind.Function,range:{startLineNumber:t.lineNumber,startColumn:t.column-s.length,endLineNumber:t.lineNumber,endColumn:t.column+e.insertText.length-s.length}}})}}catch(e){return{suggestions:[]}}},e}(),AutoCompleteParams=function(){function e(){}return e.sqlBuiltInFunctions=["AVG","CHECKSUM_AGG","COUNT","COUNT_BIG","GROUPING","GROUPING_ID","MAX","MIN","SUM","STDEV","STDEVP","VAR","VARP","CUME_DIST","FIRST_VALUE","LAG","LAST_VALUE","LEAD","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","COLLATE","COLLATIONPROPERTY","TERTIARY_WEIGHTS","FEDERATION_FILTERING_VALUE","CAST","CONVERT","PARSE","TRY_CAST","TRY_CONVERT","TRY_PARSE","ASYMKEY_ID","ASYMKEYPROPERTY","CERTPROPERTY","CERT_ID","CRYPT_GEN_RANDOM","DECRYPTBYASYMKEY","DECRYPTBYCERT","DECRYPTBYKEY","DECRYPTBYKEYAUTOASYMKEY","DECRYPTBYKEYAUTOCERT","DECRYPTBYPASSPHRASE","ENCRYPTBYASYMKEY","ENCRYPTBYCERT","ENCRYPTBYKEY","ENCRYPTBYPASSPHRASE","HASHBYTES","IS_OBJECTSIGNED","KEY_GUID","KEY_ID","KEY_NAME","SIGNBYASYMKEY","SIGNBYCERT","SYMKEYPROPERTY","VERIFYSIGNEDBYCERT","VERIFYSIGNEDBYASYMKEY","CURSOR_STATUS","DATALENGTH","IDENT_CURRENT","IDENT_INCR","IDENT_SEED","IDENTITY","SQL_VARIANT_PROPERTY","CURRENT_TIMESTAMP","DATEADD","DATEDIFF","DATEFROMPARTS","DATENAME","DATEPART","DATETIME2FROMPARTS","DATETIMEFROMPARTS","DATETIMEOFFSETFROMPARTS","DAY","EOMONTH","GETDATE","GETUTCDATE","ISDATE","MONTH","SMALLDATETIMEFROMPARTS","SWITCHOFFSET","SYSDATETIME","SYSDATETIMEOFFSET","SYSUTCDATETIME","TIMEFROMPARTS","TODATETIMEOFFSET","YEAR","CHOOSE","COALESCE","IIF","NULLIF","ABS","ACOS","ASIN","ATAN","ATN2","CEILING","COS","COT","DEGREES","EXP","FLOOR","LOG","LOG10","PI","POWER","RADIANS","RAND","ROUND","SIGN","SIN","SQRT","SQUARE","TAN","APP_NAME","APPLOCK_MODE","APPLOCK_TEST","ASSEMBLYPROPERTY","COL_LENGTH","COL_NAME","COLUMNPROPERTY","DATABASE_PRINCIPAL_ID","DATABASEPROPERTYEX","DB_ID","DB_NAME","FILE_ID","FILE_IDEX","FILE_NAME","FILEGROUP_ID","FILEGROUP_NAME","FILEGROUPPROPERTY","FILEPROPERTY","FULLTEXTCATALOGPROPERTY","FULLTEXTSERVICEPROPERTY","INDEX_COL","INDEXKEY_PROPERTY","INDEXPROPERTY","OBJECT_DEFINITION","OBJECT_ID","OBJECT_NAME","OBJECT_SCHEMA_NAME","OBJECTPROPERTY","OBJECTPROPERTYEX","ORIGINAL_DB_NAME","PARSENAME","SCHEMA_ID","SCHEMA_NAME","SCOPE_IDENTITY","SERVERPROPERTY","STATS_DATE","TYPE_ID","TYPE_NAME","TYPEPROPERTY","DENSE_RANK","NTILE","RANK","ROW_NUMBER","PUBLISHINGSERVERNAME","OPENDATASOURCE","OPENQUERY","OPENROWSET","OPENXML","CERTENCODED","CERTPRIVATEKEY","CURRENT_USER","HAS_DBACCESS","HAS_PERMS_BY_NAME","IS_MEMBER","IS_ROLEMEMBER","IS_SRVROLEMEMBER","LOGINPROPERTY","ORIGINAL_LOGIN","PERMISSIONS","PWDENCRYPT","PWDCOMPARE","SESSION_USER","SESSIONPROPERTY","SUSER_ID","SUSER_NAME","SUSER_SID","SUSER_SNAME","SYSTEM_USER","USER","USER_ID","USER_NAME","ASCII","CHAR","CHARINDEX","CONCAT","DIFFERENCE","FORMAT","LEFT","LEN","LOWER","LTRIM","NCHAR","PATINDEX","QUOTENAME","REPLACE","REPLICATE","REVERSE","RIGHT","RTRIM","SOUNDEX","SPACE","STR","STUFF","SUBSTRING","UNICODE","UPPER","BINARY_CHECKSUM","CHECKSUM","CONNECTIONPROPERTY","CONTEXT_INFO","CURRENT_REQUEST_ID","ERROR_LINE","ERROR_NUMBER","ERROR_MESSAGE","ERROR_PROCEDURE","ERROR_SEVERITY","ERROR_STATE","FORMATMESSAGE","GETANSINULL","GET_FILESTREAM_TRANSACTION_CONTEXT","HOST_ID","HOST_NAME","ISNULL","ISNUMERIC","MIN_ACTIVE_ROWVERSION","NEWID","NEWSEQUENTIALID","ROWCOUNT_BIG","XACT_STATE","TEXTPTR","TEXTVALID","COLUMNS_UPDATED","EVENTDATA","TRIGGER_NESTLEVEL","UPDATE","CHANGETABLE","CHANGE_TRACKING_CONTEXT","CHANGE_TRACKING_CURRENT_VERSION","CHANGE_TRACKING_IS_COLUMN_IN_MASK","CHANGE_TRACKING_MIN_VALID_VERSION","CONTAINSTABLE","FREETEXTTABLE","SEMANTICKEYPHRASETABLE","SEMANTICSIMILARITYDETAILSTABLE","SEMANTICSIMILARITYTABLE","FILETABLEROOTPATH","GETFILENAMESPACEPATH","GETPATHLOCATOR","PATHNAME","GET_TRANSMISSION_STATUS"],e.sqlOperators=["ALL","AND","ANY","BETWEEN","EXISTS","IN","LIKE","NOT","OR","SOME","EXCEPT","INTERSECT","UNION","APPLY","CROSS","FULL","INNER","JOIN","LEFT","OUTER","RIGHT","CONTAINS","FREETEXT","IS","NULL","PIVOT","UNPIVOT","MATCHED"],e.pythonOperators=["or","and","not","is not","==",">","<",">=","<=","is","!=","|","^","&","<<",">>"],e.pythonBuiltInFunctions=["abs","aiter","all","anext","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],e.pythonKeywords=["False","None","True","_","and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","exec","finally","for","from","global","if","import","in","is","lambda","match","nonlocal","not","or","pass","print","raise","return","try","type","while","with","yield","int","float","long","complex","hex","abs","all","any","apply","basestring","bin","bool","buffer","bytearray","callable","chr","classmethod","cmp","coerce","compile","complex","delattr","dict","dir","divmod","enumerate","eval","execfile","file","filter","format","frozenset","getattr","globals","hasattr","hash","help","id","input","intern","isinstance","issubclass","iter","len","locals","list","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","reversed","range","raw_input","reduce","reload","repr","reversed","round","self","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","unichr","unicode","vars","xrange","zip","__dict__","__methods__","__members__","__class__","__bases__","__name__","__mro__","__subclasses__","__init__","__import__"],e.sqlKeywords=["ABORT_AFTER_WAIT","ABSENT","ABSOLUTE","ACCENT_SENSITIVITY","ACTION","ACTIVATION","ACTIVE","ADD","ADDRESS","ADMIN","AES","AES_128","AES_192","AES_256","AFFINITY","AFTER","AGGREGATE","ALGORITHM","ALL_CONSTRAINTS","ALL_ERRORMSGS","ALL_INDEXES","ALL_LEVELS","ALL_SPARSE_COLUMNS","ALLOW_CONNECTIONS","ALLOW_MULTIPLE_EVENT_LOSS","ALLOW_PAGE_LOCKS","ALLOW_ROW_LOCKS","ALLOW_SINGLE_EVENT_LOSS","ALLOW_SNAPSHOT_ISOLATION","ALLOWED","ALTER","ANONYMOUS","ANSI_DEFAULTS","ANSI_NULL_DEFAULT","ANSI_NULL_DFLT_OFF","ANSI_NULL_DFLT_ON","ANSI_NULLS","ANSI_PADDING","ANSI_WARNINGS","APPEND","APPLICATION","APPLICATION_LOG","ARITHABORT","ARITHIGNORE","AS","ASC","ASSEMBLY","ASYMMETRIC","ASYNCHRONOUS_COMMIT","AT","ATOMIC","ATTACH","ATTACH_REBUILD_LOG","AUDIT","AUDIT_GUID","AUTHENTICATION","AUTHORIZATION","AUTO","AUTO_CLEANUP","AUTO_CLOSE","AUTO_CREATE_STATISTICS","AUTO_SHRINK","AUTO_UPDATE_STATISTICS","AUTO_UPDATE_STATISTICS_ASYNC","AUTOMATED_BACKUP_PREFERENCE","AUTOMATIC","AVAILABILITY","AVAILABILITY_MODE","BACKUP","BACKUP_PRIORITY","BASE64","BATCHSIZE","BEGIN","BEGIN_DIALOG","BIGINT","BINARY","BINDING","BIT","BLOCKERS","BLOCKSIZE","BOUNDING_BOX","BREAK","BROKER","BROKER_INSTANCE","BROWSE","BUCKET_COUNT","BUFFER","BUFFERCOUNT","BULK","BULK_LOGGED","BY","CACHE","CALL","CALLED","CALLER","CAP_CPU_PERCENT","CASCADE","CASE","CATALOG","CATCH","CELLS_PER_OBJECT","CERTIFICATE","CHANGE_RETENTION","CHANGE_TRACKING","CHANGES","CHAR","CHARACTER","CHECK","CHECK_CONSTRAINTS","CHECK_EXPIRATION","CHECK_POLICY","CHECKALLOC","CHECKCATALOG","CHECKCONSTRAINTS","CHECKDB","CHECKFILEGROUP","CHECKIDENT","CHECKPOINT","CHECKTABLE","CLASSIFIER_FUNCTION","CLEANTABLE","CLEANUP","CLEAR","CLOSE","CLUSTER","CLUSTERED","CODEPAGE","COLLATE","COLLECTION","COLUMN","COLUMN_SET","COLUMNS","COLUMNSTORE","COLUMNSTORE_ARCHIVE","COMMIT","COMMITTED","COMPATIBILITY_LEVEL","COMPRESSION","COMPUTE","CONCAT","CONCAT_NULL_YIELDS_NULL","CONFIGURATION","CONNECT","CONSTRAINT","CONTAINMENT","CONTENT","CONTEXT","CONTINUE","CONTINUE_AFTER_ERROR","CONTRACT","CONTRACT_NAME","CONTROL","CONVERSATION","COOKIE","COPY_ONLY","COUNTER","CPU","CREATE","CREATE_NEW","CREATION_DISPOSITION","CREDENTIAL","CRYPTOGRAPHIC","CUBE","CURRENT","CURRENT_DATE","CURSOR","CURSOR_CLOSE_ON_COMMIT","CURSOR_DEFAULT","CYCLE","DATA","DATA_COMPRESSION","DATA_PURITY","DATABASE","DATABASE_DEFAULT","DATABASE_MIRRORING","DATABASE_SNAPSHOT","DATAFILETYPE","DATE","DATE_CORRELATION_OPTIMIZATION","DATEFIRST","DATEFORMAT","DATETIME","DATETIME2","DATETIMEOFFSET","DAY","DAYOFYEAR","DAYS","DB_CHAINING","DBCC","DBREINDEX","DDL_DATABASE_LEVEL_EVENTS","DEADLOCK_PRIORITY","DEALLOCATE","DEC","DECIMAL","DECLARE","DECRYPTION","DEFAULT","DEFAULT_DATABASE","DEFAULT_FULLTEXT_LANGUAGE","DEFAULT_LANGUAGE","DEFAULT_SCHEMA","DEFINITION","DELAY","DELAYED_DURABILITY","DELETE","DELETED","DENSITY_VECTOR","DENY","DEPENDENTS","DES","DESC","DESCRIPTION","DESX","DHCP","DIAGNOSTICS","DIALOG","DIFFERENTIAL","DIRECTORY_NAME","DISABLE","DISABLE_BROKER","DISABLED","DISK","DISTINCT","DISTRIBUTED","DOCUMENT","DOUBLE","DROP","DROP_EXISTING","DROPCLEANBUFFERS","DUMP","DURABILITY","DYNAMIC","EDITION","ELEMENTS","ELSE","EMERGENCY","EMPTY","EMPTYFILE","ENABLE","ENABLE_BROKER","ENABLED","ENCRYPTION","END","ENDPOINT","ENDPOINT_URL","ERRLVL","ERROR","ERROR_BROKER_CONVERSATIONS","ERRORFILE","ESCAPE","ESTIMATEONLY","EVENT","EVENT_RETENTION_MODE","EXEC","EXECUTABLE","EXECUTE","EXIT","EXPAND","EXPIREDATE","EXPIRY_DATE","EXPLICIT","EXTENDED_LOGICAL_CHECKS","EXTENSION","EXTERNAL","EXTERNAL_ACCESS","FAIL_OPERATION","FAILOVER","FAILOVER_MODE","FAILURE_CONDITION_LEVEL","FALSE","FAN_IN","FAST","FAST_FORWARD","FETCH","FIELDTERMINATOR","FILE","FILEGROUP","FILEGROWTH","FILELISTONLY","FILENAME","FILEPATH","FILESTREAM","FILESTREAM_ON","FILETABLE_COLLATE_FILENAME","FILETABLE_DIRECTORY","FILETABLE_FULLPATH_UNIQUE_CONSTRAINT_NAME","FILETABLE_NAMESPACE","FILETABLE_PRIMARY_KEY_CONSTRAINT_NAME","FILETABLE_STREAMID_UNIQUE_CONSTRAINT_NAME","FILLFACTOR","FILTERING","FIRE_TRIGGERS","FIRST","FIRSTROW","FLOAT","FMTONLY","FOLLOWING","FOR","FORCE","FORCE_FAILOVER_ALLOW_DATA_LOSS","FORCE_SERVICE_ALLOW_DATA_LOSS","FORCED","FORCEPLAN","FORCESCAN","FORCESEEK","FOREIGN","FORMATFILE","FORMSOF","FORWARD_ONLY","FREE","FREEPROCCACHE","FREESESSIONCACHE","FREESYSTEMCACHE","FROM","FULL","FULLSCAN","FULLTEXT","FUNCTION","GB","GEOGRAPHY_AUTO_GRID","GEOGRAPHY_GRID","GEOMETRY_AUTO_GRID","GEOMETRY_GRID","GET","GLOBAL","GO","GOTO","GOVERNOR","GRANT","GRIDS","GROUP","GROUP_MAX_REQUESTS","HADR","HASH","HASHED","HAVING","HEADERONLY","HEALTH_CHECK_TIMEOUT","HELP","HIERARCHYID","HIGH","HINT","HISTOGRAM","HOLDLOCK","HONOR_BROKER_PRIORITY","HOUR","HOURS","IDENTITY","IDENTITY_INSERT","IDENTITY_VALUE","IDENTITYCOL","IF","IGNORE_CONSTRAINTS","IGNORE_DUP_KEY","IGNORE_NONCLUSTERED_COLUMNSTORE_INDEX","IGNORE_TRIGGERS","IMAGE","IMMEDIATE","IMPERSONATE","IMPLICIT_TRANSACTIONS","IMPORTANCE","INCLUDE","INCREMENT","INCREMENTAL","INDEX","INDEXDEFRAG","INFINITE","INFLECTIONAL","INIT","INITIATOR","INPUT","INPUTBUFFER","INSENSITIVE","INSERT","INSERTED","INSTEAD","INT","INTEGER","INTO","IO","IP","ISABOUT","ISOLATION","JOB","KB","KEEP","KEEP_CDC","KEEP_NULLS","KEEP_REPLICATION","KEEPDEFAULTS","KEEPFIXED","KEEPIDENTITY","KEEPNULLS","KERBEROS","KEY","KEY_SOURCE","KEYS","KEYSET","KILL","KILOBYTES_PER_BATCH","LABELONLY","LANGUAGE","LAST","LASTROW","LEVEL","LEVEL_1","LEVEL_2","LEVEL_3","LEVEL_4","LIFETIME","LIMIT","LINENO","LIST","LISTENER","LISTENER_IP","LISTENER_PORT","LOAD","LOADHISTORY","LOB_COMPACTION","LOCAL","LOCAL_SERVICE_NAME","LOCK_ESCALATION","LOCK_TIMEOUT","LOGIN","LOGSPACE","LOOP","LOW","MANUAL","MARK","MARK_IN_USE_FOR_REMOVAL","MASTER","MAX_CPU_PERCENT","MAX_DISPATCH_LATENCY","MAX_DOP","MAX_DURATION","MAX_EVENT_SIZE","MAX_FILES","MAX_IOPS_PER_VOLUME","MAX_MEMORY","MAX_MEMORY_PERCENT","MAX_QUEUE_READERS","MAX_ROLLOVER_FILES","MAX_SIZE","MAXDOP","MAXERRORS","MAXLENGTH","MAXRECURSION","MAXSIZE","MAXTRANSFERSIZE","MAXVALUE","MB","MEDIADESCRIPTION","MEDIANAME","MEDIAPASSWORD","MEDIUM","MEMBER","MEMORY_OPTIMIZED","MEMORY_OPTIMIZED_DATA","MEMORY_OPTIMIZED_ELEVATE_TO_SNAPSHOT","MEMORY_PARTITION_MODE","MERGE","MESSAGE","MESSAGE_FORWARD_SIZE","MESSAGE_FORWARDING","MICROSECOND","MILLISECOND","MIN_CPU_PERCENT","MIN_IOPS_PER_VOLUME","MIN_MEMORY_PERCENT","MINUTE","MINUTES","MINVALUE","MIRROR","MIRROR_ADDRESS","MODIFY","MONEY","MONTH","MOVE","MULTI_USER","MUST_CHANGE","NAME","NANOSECOND","NATIONAL","NATIVE_COMPILATION","NCHAR","NEGOTIATE","NESTED_TRIGGERS","NEW_ACCOUNT","NEW_BROKER","NEW_PASSWORD","NEWNAME","NEXT","NO","NO_BROWSETABLE","NO_CHECKSUM","NO_COMPRESSION","NO_EVENT_LOSS","NO_INFOMSGS","NO_TRUNCATE","NO_WAIT","NOCHECK","NOCOUNT","NOEXEC","NOEXPAND","NOFORMAT","NOINDEX","NOINIT","NOLOCK","NON","NON_TRANSACTED_ACCESS","NONCLUSTERED","NONE","NORECOMPUTE","NORECOVERY","NORESEED","NORESET","NOREWIND","NORMAL","NOSKIP","NOTIFICATION","NOTRUNCATE","NOUNLOAD","NOWAIT","NTEXT","NTLM","NUMANODE","NUMERIC","NUMERIC_ROUNDABORT","NVARCHAR","OBJECT","OF","OFF","OFFLINE","OFFSET","OFFSETS","OLD_ACCOUNT","OLD_PASSWORD","ON","ON_FAILURE","ONLINE","ONLY","OPEN","OPEN_EXISTING","OPENTRAN","OPTIMISTIC","OPTIMIZE","OPTION","ORDER","OUT","OUTPUT","OUTPUTBUFFER","OVER","OVERRIDE","OWNER","OWNERSHIP","PAD_INDEX","PAGE","PAGE_VERIFY","PAGECOUNT","PAGLOCK","PARAMETERIZATION","PARSEONLY","PARTIAL","PARTITION","PARTITIONS","PARTNER","PASSWORD","PATH","PER_CPU","PER_NODE","PERCENT","PERMISSION_SET","PERSISTED","PHYSICAL_ONLY","PLAN","POISON_MESSAGE_HANDLING","POOL","POPULATION","PORT","PRECEDING","PRECISION","PRIMARY","PRIMARY_ROLE","PRINT","PRIOR","PRIORITY","PRIORITY_LEVEL","PRIVATE","PRIVILEGES","PROC","PROCCACHE","PROCEDURE","PROCEDURE_NAME","PROCESS","PROFILE","PROPERTY","PROPERTY_DESCRIPTION","PROPERTY_INT_ID","PROPERTY_SET_GUID","PROVIDER","PROVIDER_KEY_NAME","PUBLIC","PUT","QUARTER","QUERY","QUERY_GOVERNOR_COST_LIMIT","QUEUE","QUEUE_DELAY","QUOTED_IDENTIFIER","RAISERROR","RANGE","RAW","RC2","RC4","RC4_128","READ","READ_COMMITTED_SNAPSHOT","READ_ONLY","READ_ONLY_ROUTING_LIST","READ_ONLY_ROUTING_URL","READ_WRITE","READ_WRITE_FILEGROUPS","READCOMMITTED","READCOMMITTEDLOCK","READONLY","READPAST","READTEXT","READUNCOMMITTED","READWRITE","REAL","REBUILD","RECEIVE","RECOMPILE","RECONFIGURE","RECOVERY","RECURSIVE","RECURSIVE_TRIGGERS","REFERENCES","REGENERATE","RELATED_CONVERSATION","RELATED_CONVERSATION_GROUP","RELATIVE","REMOTE","REMOTE_PROC_TRANSACTIONS","REMOTE_SERVICE_NAME","REMOVE","REORGANIZE","REPAIR_ALLOW_DATA_LOSS","REPAIR_FAST","REPAIR_REBUILD","REPEATABLE","REPEATABLEREAD","REPLICA","REPLICATION","REQUEST_MAX_CPU_TIME_SEC","REQUEST_MAX_MEMORY_GRANT_PERCENT","REQUEST_MEMORY_GRANT_TIMEOUT_SEC","REQUIRED","RESAMPLE","RESEED","RESERVE_DISK_SPACE","RESET","RESOURCE","RESTART","RESTORE","RESTRICT","RESTRICTED_USER","RESULT","RESUME","RETAINDAYS","RETENTION","RETURN","RETURNS","REVERT","REVOKE","REWIND","REWINDONLY","ROBUST","ROLE","ROLLBACK","ROLLUP","ROOT","ROUTE","ROW","ROWCOUNT","ROWGUIDCOL","ROWLOCK","ROWS","ROWS_PER_BATCH","ROWTERMINATOR","ROWVERSION","RSA_1024","RSA_2048","RSA_512","RULE","SAFE","SAFETY","SAMPLE","SAVE","SCHEDULER","SCHEMA","SCHEMA_AND_DATA","SCHEMA_ONLY","SCHEMABINDING","SCHEME","SCROLL","SCROLL_LOCKS","SEARCH","SECOND","SECONDARY","SECONDARY_ONLY","SECONDARY_ROLE","SECONDS","SECRET","SECURITY_LOG","SECURITYAUDIT","SELECT","SELECTIVE","SELF","SEND","SENT","SEQUENCE","SERIALIZABLE","SERVER","SERVICE","SERVICE_BROKER","SERVICE_NAME","SESSION","SESSION_TIMEOUT","SET","SETS","SETUSER","SHOW_STATISTICS","SHOWCONTIG","SHOWPLAN","SHOWPLAN_ALL","SHOWPLAN_TEXT","SHOWPLAN_XML","SHRINKDATABASE","SHRINKFILE","SHUTDOWN","SID","SIGNATURE","SIMPLE","SINGLE_BLOB","SINGLE_CLOB","SINGLE_NCLOB","SINGLE_USER","SINGLETON","SIZE","SKIP","SMALLDATETIME","SMALLINT","SMALLMONEY","SNAPSHOT","SORT_IN_TEMPDB","SOURCE","SPARSE","SPATIAL","SPATIAL_WINDOW_MAX_CELLS","SPECIFICATION","SPLIT","SQL","SQL_VARIANT","SQLPERF","STANDBY","START","START_DATE","STARTED","STARTUP_STATE","STAT_HEADER","STATE","STATEMENT","STATIC","STATISTICAL_SEMANTICS","STATISTICS","STATISTICS_INCREMENTAL","STATISTICS_NORECOMPUTE","STATS","STATS_STREAM","STATUS","STATUSONLY","STOP","STOP_ON_ERROR","STOPAT","STOPATMARK","STOPBEFOREMARK","STOPLIST","STOPPED","SUBJECT","SUBSCRIPTION","SUPPORTED","SUSPEND","SWITCH","SYMMETRIC","SYNCHRONOUS_COMMIT","SYNONYM","SYSNAME","SYSTEM","TABLE","TABLERESULTS","TABLESAMPLE","TABLOCK","TABLOCKX","TAKE","TAPE","TARGET","TARGET_RECOVERY_TIME","TB","TCP","TEXT","TEXTIMAGE_ON","TEXTSIZE","THEN","THESAURUS","THROW","TIES","TIME","TIMEOUT","TIMER","TIMESTAMP","TINYINT","TO","TOP","TORN_PAGE_DETECTION","TRACEOFF","TRACEON","TRACESTATUS","TRACK_CAUSALITY","TRACK_COLUMNS_UPDATED","TRAN","TRANSACTION","TRANSFER","TRANSFORM_NOISE_WORDS","TRIGGER","TRIPLE_DES","TRIPLE_DES_3KEY","TRUE","TRUNCATE","TRUNCATEONLY","TRUSTWORTHY","TRY","TSQL","TWO_DIGIT_YEAR_CUTOFF","TYPE","TYPE_WARNING","UNBOUNDED","UNCHECKED","UNCOMMITTED","UNDEFINED","UNIQUE","UNIQUEIDENTIFIER","UNKNOWN","UNLIMITED","UNLOAD","UNSAFE","UPDATE","UPDATETEXT","UPDATEUSAGE","UPDLOCK","URL","USE","USED","USER","USEROPTIONS","USING","VALID_XML","VALIDATION","VALUE","VALUES","VARBINARY","VARCHAR","VARYING","VERIFYONLY","VERSION","VIEW","VIEW_METADATA","VIEWS","VISIBILITY","WAIT_AT_LOW_PRIORITY","WAITFOR","WEEK","WEIGHT","WELL_FORMED_XML","WHEN","WHERE","WHILE","WINDOWS","WITH","WITHIN","WITHOUT","WITNESS","WORK","WORKLOAD","WRITETEXT","XACT_ABORT","XLOCK","XMAX","XMIN","XML","XMLDATA","XMLNAMESPACES","XMLSCHEMA","XQUERY","XSINIL","YEAR","YMAX","YMIN"],e}(),DataConfigQuery_Query=function(e){function t(a){var s=e.call(this,a)||this;return s.tagName="div",s.deltaParameterRx=/^{\[([a-z0-9A-Z\;\w\/ ]+?)\]/,s.inlineParameterRx=/<%[^<>%]+%>/g,s.inlinePyKxParametersRx=/def.*[\w\s$]*(\((.*[\w\s,$]*)\))\:/g,s.inlinePyKxFunctionRx=/\((.*?)\)/g,s.inlineSQLParmaterRx=/\{\{([^}]*)\}\}/g,s.params=new Backbone.Collection,s.docDataModel=a.docDataModel,s.docViewModel=a.docViewModel,s.appModel=a.appModel,s.components=a.components,s.componentDefs=a.componentDefs,s.isEmbedded=a.isEmbedded,s.dialogContainer=a.dialogContainer,s.isTableUpdateDialog=a.isTableUpdateDialog,s.$el.html(T.DataConfigQuery_Query(s.model.toJSON())),s.$paramsBox=s.$el.find(".params-box"),s.lastText=s.model.get("_queryString"),s.dashEngine=s.appModel.get("dashEngine"),s.eventBus=a.eventBus,s.isEmbedded&&s.eventBus.on("treeNodeDelete",s.clearCache,s),s.applyVisibility_cmbAssemblyTarget(),Worker&&(s.linter=new Worker(requirejs.toUrl("qlinter")+".js")),MonacoHelpers.require({language:"q"},function(e){var t,i,n,o=e.monaco;s.editor||(e=s.$el.find(".query-editor")[0],t="pykx"===s.model.get("_dataType"),(i="sql"===s.model.get("_dataSource")||"sql"===s.model.get("_dataType"))?($["Cache.SQL.Text"]=s.lastText,$["Cache.SQL.Param"]=s.model.get("_queryParams")):t?($["Cache.pykx.Text"]=s.lastText,$["Cache.pykx.Param"]=s.model.get("_queryParams")):($["Cache.Q.Text"]=s.lastText,$["Cache.Q.Param"]=s.model.get("_queryParams")),n="q",i?n="sql":t&&(n="python"),s.editor=o.editor.create(e,_.assign({},MonacoHelpers.DEFAULT_OPTIONS(),{value:s.lastText,language:n,theme:"kx-light"!==$.cookie("dashboard-theme")?"q-theme":"q-theme-light",fontFamily:'"Lucida Console", Monaco, monospace',fontSize:"12px",wordWrap:!0,tabSize:2,readOnly:!a.appModel.get("CanExecuteQueries")})),s.editor.addAction({id:"Execute",label:"Execute Data Source",keybindings:[o.KeyMod.chord(o.KeyMod.CtrlCmd|o.KeyCode.Enter)],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){var t=e.getModel().getValueInRange(e.getSelection());return s.deltaParameterRx.exec(t)?a.execute(t):t?a.execute("{[".concat(s.params.map(function(e){return e.get("name")}).join(";"),"] ").concat(t,"}")):a.execute(e.getValue()),null}}),s.editor.addAction({id:"Help-Menu",label:"Help",keybindings:[o.KeyMod.CtrlCmd|o.KeyCode.F10,o.KeyMod.chord(o.KeyMod.CtrlCmd|o.KeyCode.KeyQ)],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){var e=e.getModel().getValueInRange(e.getSelection()),t="https://code.kx.com/v2/ref/";return window.open(e?t+e:t,"_blank","noopener,noreferrer,resizable"),null}}),document.activeElement instanceof HTMLInputElement||s.editor.focus(),s.linter&&s.linter.addEventListener("message",function(e){var e=e.data,t=e.markers,e=e.version,i=s.editor.getModel();i&&i.getVersionId()===e&&"kdb"===s.model.get("_dataSource")?o.editor.setModelMarkers(i,"lint",t):i&&o.editor.setModelMarkers(i,"lint",[])}),s.registerFnAutocomplete(),s.registerTableAutocomplete()),s.paramsBoxResizeObserver=new ResizeObserver(function(e){for(var t=0,i=e;t<i.length;t++){i[t];s.onResize()}}),s.onModelParamsChange(),s.onParamsChanged(),s.onEditorTextChange(),s.initializeEvents()}),s}return __extends(t,e),t.prototype.applyVisibility_cmbAssemblyTarget=function(){var e,t,i,n;this.dashEngine.isDeltaMode()||(e="hasCustomAPIparams","query"===this.model.get("_dataType")?(t=!(n=!1),this.dashEngine.isIEMode()?n=!0:!this.dashEngine.isDirectMode()||(i=this.model.get("_connection"),n=this.dashEngine.isConnectionTargeting_insightsSDK(i))||(t=!1),t?(this.$el.hasClass(e)||this.$el.addClass(e),this.$cmbAssemblyTarget||(this.$cmbAssemblyTarget=this.$(".cmbAssemblyTarget"),this.init_cmbAssemblyTarget())):this.$el.removeClass(e),n&&(this.remove_cmbAssemblyTarget(),this.init_cmbAssemblyTarget(),this.loadAssemblyInfo())):this.$el.removeClass(e))},t.prototype.loadAssemblyInfo=function(){this.requestId_loadAssemblyInfo=_.uniqueId(),this.loadAssemblyInfo_ignoreOldCallbacks(this.requestId_loadAssemblyInfo)},t.prototype.loadAssemblyInfo_ignoreOldCallbacks=function(t){var i=this,e=this.model.get("_connection");this.appModel.get("getAssemblyInfo")(e,!0).then(function(e){i.requestId_loadAssemblyInfo===t&&i.renderTargetDropdown(e)})},t.prototype.renderTargetDropdown=function(e){this.remove_cmbAssemblyTarget();var i=this.model.get("_connection"),n="",e=(this.dashEngine.isDirectMode()&&(n=this.dashEngine.parseConnElements(i).connection+"|"),_.reduce(e,function(e,t){return e=e.concat(_.map(t.dapInstances,function(e){return{dap:"".concat(n).concat(t.name,"|").concat(e),dbName:"".concat(t.databaseName," ").concat(e," (").concat(t.name.replace(/-qe$/,""),")")}}))},[])),t=_.reduce(e,function(e,t){return e+'<option value="'+_.escape(t.dap)+'"'+(t.dap===i?" selected>":">")+t.dbName+"</option>"},""),o=this,a=this.$cmbAssemblyTarget;a.append(t),this.init_cmbAssemblyTarget(),a.on("select2:select",function(){o.model.set("_connection",a.val(),{silent:!0}),o.model.trigger("connectionChange")}),!e.find(function(e){return e.dap.includes(i)})&&this.dashEngine.isIEMode()&&(i="",o.model.set("_connection",i,{silent:!0})),a.val(i).trigger("change")},t.prototype.init_cmbAssemblyTarget=function(){this.$cmbAssemblyTarget.select2({placeholder:"Select a target",theme:"dashboards"})},t.prototype.focusEditor=function(){this.editor&&this.editor.focus()},t.prototype.forceAssemblySelectUpdate=function(){var e;this.$cmbAssemblyTarget&&(e=this.model.get("_connection"))&&this.$cmbAssemblyTarget.val(e).trigger("change")},t.prototype.clearCache=function(){this.editor&&this.editor.setValue(""),this.$(".cmbAssemblyTarget").val("Select a target").trigger("change")},t.prototype.loadText=function(e){"query"===e?$["Cache.Q.Text"]?this.setEditorText($["Cache.Q.Text"],$["Cache.Q.Param"]):($["Cache.SQL.Text"]||$["Cache.pykx.Text"])&&this.setEditorText("",[]):"sql"===e?$["Cache.SQL.Text"]?this.setEditorText($["Cache.SQL.Text"],$["Cache.SQL.Param"]):($["Cache.Q.Text"]||$["Cache.pykx.Text"])&&this.setEditorText("",[]):"pykx"===e&&($["Cache.pykx.Text"]?this.setEditorText($["Cache.pykx.Text"],$["Cache.pykx.Param"]):($["Cache.Q.Text"]||$["Cache.SQL.Text"])&&this.setEditorText("",[]))},t.prototype.initializeEvents=function(){this.listenTo(this.params,"add reset remove",this.onParamsChanged),this.listenTo(this.model,"change:_queryParams",this.onModelParamsChange),this.listenTo(this.model,"change:_queryString",this.onModelTextChange),this.listenTo(this.model,"change:_connection",this.onModelConnectionChange),this.listenTo(this.model,"change:_dataSource",this.onModelDataSourceChange),this.listenTo(this.model,"change:_dataType",this.onModelDataTypeChange),this.debounceEditorChange=_.debounce($.proxy(this.onEditorTextChange,this),100),this.editor.onDidChangeModelContent(this.debounceEditorChange),this.paramsBoxResizeObserver.observe(this.$paramsBox[0])},t.prototype.setEditorText=function(e,t){this.lastText=e,this.model.set("_queryParams",t),this.editor&&this.editor.setValue(this.lastText)},t.prototype.onModelDataTypeChange=function(){this.applyVisibility_cmbAssemblyTarget()},t.prototype.onModelDataSourceChange=function(){this.editor&&monaco.editor.setModelLanguage(this.editor.getModel(),"kdb"==this.model.get("_dataSource")?"q":"sql")},t.prototype.getTables=function(i){var e=this.model.get("_connection");QuickBase.DeltaClientLib.getQueryData(void 0,e,QuickBase.KdbQuery.getTables,void 0,function(e){var t=e.rows;i(Object.keys(t[0]).map(function(e){return t[0][e]}))},function(){i([])})},t.prototype.getText=function(){return this.lastText},t.prototype.onEditorTextChange=function(){this.linter&&this.editor&&"kdb"===this.model.get("_dataSource")&&this.linter.postMessage({code:this.editor.getValue(),version:this.editor.getModel().getVersionId()}),this.lastText=this.editor.getValue(),this.model.set({_queryString:this.lastText}),this.updateParams()},t.prototype.onModelConnectionChange=function(){this.appModel.get("isLite")&&this.registerFnAutocomplete(),this.registerTableAutocomplete(),this.applyVisibility_cmbAssemblyTarget()},t.prototype.onModelParamsChange=function(){this.params.reset(this.model.get("_queryParams")||[]),this.setParamsInCache()},t.prototype.setParamsInCache=function(){"sql"===this.model.get("_dataType")?$["Cache.SQL.Param"]=this.model.get("_queryParams"):"pykx"===this.model.get("_dataType")?$["Cache.pykx.Param"]=this.model.get("_queryParams"):$["Cache.Q.Param"]=this.model.get("_queryParams")},t.prototype.setTextInCache=function(){"sql"===this.model.get("_dataType")?$["Cache.SQL.Text"]=this.lastText:"pykx"===this.model.get("_dataType")?$["Cache.pykx.Text"]=this.lastText:$["Cache.Q.Text"]=this.lastText},t.prototype.onModelTextChange=function(e,t){(t=this.isTableUpdateDialog&&0===t.length?"{[add;upd;del]  }":t)!==this.lastText&&(this.lastText=t,this.editor.setValue(t)),this.setTextInCache()},t.prototype.onParamsChanged=function(){var n=this;_.each(n.paramViews,function(e){n.stopListening(e.model),e.remove()}),n.paramViews=[],n.params.each(function(t,e){try{"sql"===n.model.get("_dataSource")&&t.set("ShowRemoveButton",!0),t.set("index",e);var i=new DataParameter(t,n.model,n.docViewModel,function(e){new ViewStateDialog(_.extend({dialogContainer:n.dialogContainer,docDataModel:n.docDataModel,model:n.docViewModel,components:n.components,componentDefs:n.componentDefs,isEmbedded:n.isEmbedded},e))});n.listenTo(i.model,"change",n.updateModelParams),i.on("resizeEvent",function(e){_.delay(function(){},e)}),n.paramViews.push(i),n.$paramsBox.append(i.$el)}catch(e){console.error("Parameter editor error ",t)}}),n.querySection&&(n.querySection.params=n.params),0<n.paramViews.length?n.$paramsBox.show():n.$paramsBox.hide()},t.prototype.onResize=function(){0<this.params.length?this.$el.find(".query-editor").css("bottom",this.$el.find(".params-box").height()+"px"):this.$el.find(".query-editor").css("bottom",0),this.editor&&monaco.editor.setTheme("kx-light"!==$.cookie("dashboard-theme")?"q-theme":"q-theme-light"),MonacoHelpers.adjustAfterResize(this.editor)},t.prototype.registerFnAutocomplete=function(){var o=this;MonacoHelpers.require({language:"q"},function(e){var t,n=e.monaco,i=e.autocompleteItems;o.fnAutocomplete&&(o.fnAutocomplete.dispose(),delete o.fnAutocomplete),"sql"===o.model.get("_dataType")&&(o.fnAutocomplete=n.languages.registerCompletionItemProvider("sql",{provideCompletionItems:function(){var e=AutoCompleteParams.sqlKeywords,t=AutoCompleteParams.sqlOperators,i=AutoCompleteParams.sqlBuiltInFunctions;return{suggestions:e.map(function(e){return{label:e,kind:n.languages.CompletionItemKind.Keyword,insertText:e}}).concat(t.map(function(e){return{label:e,kind:n.languages.CompletionItemKind.Operator,insertText:e}})).concat(i.map(function(e){return{label:e,kind:n.languages.CompletionItemKind.Function,insertText:e}}))}}})),"pykx"===o.model.get("_dataType")?o.fnAutocomplete=n.languages.registerCompletionItemProvider("python",{provideCompletionItems:function(){var e=AutoCompleteParams.pythonKeywords,t=AutoCompleteParams.pythonOperators,i=AutoCompleteParams.pythonBuiltInFunctions;return{suggestions:e.map(function(e){return{label:e,kind:n.languages.CompletionItemKind.Keyword,insertText:e}}).concat(t.map(function(e){return{label:e,kind:n.languages.CompletionItemKind.Operator,insertText:e}})).concat(i.map(function(e){return{label:e,kind:n.languages.CompletionItemKind.Function,insertText:e}}))}}}):o.appModel.get("isLite")?(t=function(e){e=e.rows.map(function(e){return e.parameters=e.parameters.rows,e}).sort(function(e,t){return e.name.localeCompare(t.name)}),e=i.concat(e.map(function(e){return{label:e.name,detail:e.description||e.name+"["+_.filter(e.parameters,function(e){return e.name}).map(function(e){return e.name}).join(";")+"]"}})).map(function(e){return __assign(__assign({},e),{insertText:e.label})});o.fnAutocomplete=n.languages.registerCompletionItemProvider("q",new KdbFunctionCompletionProvider(e))},QuickBase.DeltaClientLib.runAnalytic(QuickBase.KdbQuery.getFunctions,o.model.get("_connection"),[],t,function(){QuickBase.DeltaClientLib.getQueryData("q",o.model.get("_connection"),QuickBase.KdbQuery.getFunctionList,[],t,function(){})})):QuickBase.DeltaClientLib.getDeltaAnalytics(function(e){e=i.concat(e.map(function(e){return{label:e.name,detail:e.description}})).map(function(e){return __assign(__assign({},e),{insertText:e.label})});o.fnAutocomplete=n.languages.registerCompletionItemProvider("q",new KdbFunctionCompletionProvider(e))})})},t.prototype.registerTableAutocomplete=function(){var i=this,n="q";"sql"===this.model.get("_dataType")?n="sql":"pykx"===this.model.get("_dataType")&&(n="python"),MonacoHelpers.require({language:n},function(e){var t=e.monaco;e.autocompleteItems;i.tableAutocomplete&&(i.tableAutocomplete.dispose(),delete i.fnAutocomplete),i.getTables(function(e){i.tableAutocomplete&&i.tableAutocomplete.dispose(),i.tableAutocomplete=t.languages.registerCompletionItemProvider(n,new KdbTableCompletionProvider(e))})})},t.prototype.clearCachedQueries=function(){_.each(["Q.Text","SQL.Text","Q.Param","Q.Text","pykx.Text","pykx.Param"],function(e){$["Cache."+e]&&($["Cache."+e]=null)})},t.prototype.remove=function(){return this.remove_cmbAssemblyTarget(),this.editor&&(this.editor=null),this.fnAutocomplete&&this.fnAutocomplete.dispose(),this.tableAutocomplete&&this.tableAutocomplete.dispose(),this.clearCachedQueries(),this.paramsBoxResizeObserver.unobserve(this.$paramsBox[0]),Backbone.View.prototype.remove.call(this)},t.prototype.remove_cmbAssemblyTarget=function(){var e=this.$cmbAssemblyTarget;e&&e.data("select2")&&(e.off("select2:select"),e.select2("destroy"),e.empty())},t.prototype.updateModelParams=function(){this.stopListening(this.model,"change:_queryParams"),this.model.set("_queryParams",this.params.toJSON()),this.setParamsInCache(),this.listenTo(this.model,"change:_queryParams",this.onModelParamsChange)},t.prototype.updateParams=function(){var i,n,e,o=this,a=!1,s=[];o.isTableUpdateDialog||("kdb"!==o.model.get("_dataSource")&&"deltaclient"!==o.model.get("_dataSource")||(e=o.deltaParameterRx.exec(o.model.get("_queryString")),i=_.map(o.model.get("_queryString").match(o.inlineParameterRx),function(e){return e.substring(2,e.length-2)}),"sql"===this.model.get("_dataType")&&(i=_.map(o.model.get("_queryString").match(o.inlineSQLParmaterRx),function(e){return e.substring(2,e.length-2)})),"pykx"===this.model.get("_dataType")&&_.each(o.model.get("_queryString").match(o.inlinePyKxParametersRx),function(e,t){0===t&&_.each(e.match(o.inlinePyKxFunctionRx),function(e){e=e.replace(/\(/g,"").replace(/\)/g,"");i=_.isEmpty(e)?[]:e.split(",")})}),0<(e=(e?e[1].split(";"):[]).concat(i)).length?(a=e.length!==o.params.length,_.each(e,function(e,t){var i=o.params.findWhere({name:e});i?(s.push(i),a=a||i.get("index")===t,i.set({index:t},{silent:!0})):(n=new Backbone.Model({name:e,index:t,type:"symbol",value:"",IsKdbParam:!0}),s.push(n),a=!0)})):o.params.reset([]),a&&o.params.reset(s)),o.updateModelParams())},t}(Backbone.View),DataConfigQuery_Update=function(i){function e(e){var t=i.call(this,e)||this;return t.deltaParameterRx=/^{\[([a-z0-9A-Z\;\w\/ ]+?)\]/,t.inlineParameterRx=/<%[^<>%]+%>/g,t.lastUpdateText=t.model.get("_updateQueryString"),t.options=e,t.params=new Backbone.Collection,t.docDataModel=e.docDataModel,t.docViewModel=e.docViewModel,t.components=e.components,t.componentDefs=e.componentDefs,t.isEmbedded=e.isEmbedded,t.dialogContainer=e.dialogContainer,t.lastUpdateText||(t.lastUpdateText=["{[dgAdd;dgUpd;dgDel]","  / this sample requires keyed table","  / always use unique key (id), 'Force Reset': checked","","  /testTable:: `id xkey ([] id:`int$();name:`symbol$();note1:`symbol$());","  /`testTable upsert(0i;`dummy;`);","  /testTable","","    availablePK: 1 + exec max id from testTable;","","    $[((count dgUpd)>0);`testTable upsert flip dgUpd;];","    $[((count dgDel)>0);delete from `testTable where id in (dgDel[`id]);];","","    /generate unique ids for new items","    addedCount: count dgAdd[`id];","    dgAdd[`id]:(availablePK + til addedCount);","    $[((count dgAdd)>0);`testTable upsert flip dgAdd;];","}"].join("\n"),t.model.set("_updateQueryString",t.lastUpdateText,{silent:!0})),t.$el.html(T.DataConfigQuery_Update({})),t.$paramsBox=t.$el.find(".update-params-box"),t.onUpdateTypeChange(),t.initializeCodeMirror(),t.initializeAnalyticPicker(),t.initializeEvents(),t.onUpdateTypeChange(),t.refreshQueryEditor(),t}return __extends(e,i),e.prototype.initializeEvents=function(){this.listenTo(this.params,"add reset remove",this.onParamsChanged),this.listenTo(this.model,"change:_updateQueryParams",this.onModelParamsChange),this.listenTo(this.model,"change:_updateQueryString",this.refreshQueryEditor),this.listenTo(this.model,"change:_updateType",this.onUpdateTypeChange)},e.prototype.onUpdateTypeChange=function(){"analytic"===this.model.get("_updateType")?(this.$el.find(".update-editor").hide(),this.$el.find(".fa-info-circle").hide(),this.$el.find(".update-analytic-picker").show(),this.$paramsBox.hide(),this.datagridAppWrapper&&this.datagridAppWrapper.onResize()):(this.$paramsBox.show(),this.$el.find(".update-editor").show(),this.$el.find(".fa-info-circle").show(),this.$el.find(".update-analytic-picker").hide())},e.prototype.onModelParamsChange=function(){this.params.reset(this.model.get("_updateQueryParams")||[])},e.prototype.initializeAnalyticPicker=function(){var o=this;require(["Datagrid"],function(e){var t,i,n="Dark";"kx-light"===$.cookie("dashboard-theme")&&(n="Light"),t=o.model.get("_updateAnalytic"),(i=new QuickBase.DocumentDataModel({_subscriptionKey:"name",_dataType:"copy",_maxRows:1e5},null,null,null)).apply(),o.selectedUpdateAnalytic=new QuickBase.DocumentViewModel({_default:t,_viewType:!0,_type:"symbol",value:t},null),o.listenTo(o.selectedUpdateAnalytic,"change:value",function(e,t){t&&o.model.set("_updateAnalytic",t)}),t=e.getSettingsModel({Basics:{Data:i,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:[e.getColumnSettingsModel({Field:"name",TextAlign:"left"})],Selection:{Mode:"Single Row",RowSelectionColumn:"name",SelectedValue:o.selectedUpdateAnalytic,FollowSelectedValue:!0},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Style:{FontSize:"11px",RowHeight:20,HeaderRowHeight:20}}),o.datagridAppWrapper=new QuickBase.AppView({el:o.$el.find(".update-analytic-picker .picker")[0],key:"Datagrid",settings:t,dashboardViewModel:new Backbone.Model({DashboardTheme:n}),dashboardAppModel:new Backbone.Model,docViewModel:o.options.docViewModel,deltaClient:QuickBase.DeltaClientLib.deltaClient,callback:function(){QuickBase.DeltaClientLib.getDeltaAnalytics(function(e){e.sort(function(e,t){return e.name.localeCompare(t.name)}).filter(function(e){return 3===e.parameters.length}),i.onExecuteSuccess({columns:["name"],meta:{name:11},rows:e},!0)})}})},function(e){QuickBase.Log.Error(t("DataConfigAnalytic.js: Datagrid initialization error")+e)})},e.prototype.onResize=function(){0<this.params.length?this.$el.find(".update-editor").css("bottom",this.$el.find(".update-params-box").height()+"px"):this.$el.find(".update-editor").css("bottom",0),this.updateEditor&&(MonacoHelpers.adjustAfterResize(this.updateEditor),monaco.editor.setTheme("kx-light"!==$.cookie("dashboard-theme")?"vs-dark":"vs"),this.datagridAppWrapper)&&this.datagridAppWrapper.onResize()},e.prototype.initializeCodeMirror=function(){var i=this,n=this;MonacoHelpers.require({language:"q"},function(e){var t,e=e.monaco;i.updateEditor||(t=i.$el.find(".update-editor")[0],i.updateEditor=e.editor.create(t,_.assign({},MonacoHelpers.DEFAULT_OPTIONS(),{language:"q"}))),i.updateEditor.setValue(n.lastUpdateText),i.debounceUpdateEditorChange=_.debounce(function(){return n.onUpdateEditorTextChange()},100),i.updateEditor.onDidChangeModelContent(i.debounceUpdateEditorChange),i.onModelParamsChange(),i.updateParams(),i.onParamsChanged(),i.onUpdateEditorTextChange()})},e.prototype.refreshQueryEditor=function(){this.updateEditor&&this.updateEditor.getValue()!==this.model.get("_updateQueryString")&&this.updateEditor.setValue(this.model.get("_updateQueryString"))},e.prototype.onParamsChanged=function(){var o=this;_.each(this.paramViews,function(e){o.stopListening(e.model),e.remove()}),this.paramViews=[],this.params.each(function(i,e){try{"sql"===o.model.get("_dataSource")&&i.set("ShowRemoveButton",!0),i.set("index",e);var n=new DataParameter(i,o.model,o.docViewModel,function(e){new ViewStateDialog(_.extend({dialogContainer:o.dialogContainer,docDataModel:o.docDataModel,model:o.docViewModel,components:o.components,componentDefs:o.componentDefs,isEmbedded:o.isEmbedded},e))});o.listenTo(n.model,"change",o.updateModelParams.bind(o)),n.on("resizeEvent",function(e){_.delay(function(){},e)}),o.paramViews.push(n),o.$paramsBox.append(n.$el)}catch(e){QuickBase.Log.Error(t("Parameter editor error ")+i.toJSON())}}),0<this.paramViews.length?this.$paramsBox.show():this.$paramsBox.hide(),this.onResize()},e.prototype.onUpdateEditorTextChange=function(){this.model.set({_updateQueryString:this.updateEditor.getValue()}),this.updateParams()},e.prototype.updateModelParams=function(){this.stopListening(this.model,"change:_updateQueryParams"),this.model.set("_updateQueryParams",this.params.toJSON()),this.listenTo(this.model,"change:_updateQueryParams",this.onModelParamsChange.bind(this))},e.prototype.updateParams=function(){var n,o=this,a=!1,s=[],e=this.deltaParameterRx.exec(this.model.get("_updateQueryString")),t=_.map(this.model.get("_updateQueryString").match(this.inlineParameterRx),function(e){return e.substring(2,e.length-2)}),e=(e?e[1].split(";"):[]).concat(t);3<e.length?(e=e.slice(3),a=e.length!==this.params.length,_.each(e,function(e,t){var i=o.params.findWhere({name:e});i?(s.push(i),a=a||i.get("index")===t,i.set({index:t},{silent:!0})):(n=new Backbone.Model({name:e,index:t,type:"symbol",value:"",IsKdbParam:!0}),s.push(n),a=!0)})):this.params.reset([]),a&&this.params.reset(s),this.updateModelParams()},e}(Backbone.View),AdvancedSettingsDialog=function(i){function e(e){var t=i.call(this,e)||this;return t.options=e,t.init(),t}return __extends(e,i),e.prototype.dialogButtons=function(){var e=this;return[{text:"OK",click:this.onSave.bind(this),icon:"fa fa-check"},{text:"Cancel",click:function(){e.isCancel=!0,e.dialogClose()},icon:"fa fa-times"}]},e.prototype.preRender=function(){this.options.dialogTitle="Advanced Settings",this.options.minHeight=150,this.options.width=400,this.options.iconClass="fa fa-gear",this.options.userClass="Data advanced-settings-dialog",this.options.draggable=!1,this.options.position={my:"left top",at:"left bottom",collision:"flip flip",of:$(this.options.target)}},e.prototype.renderTemplate=function(){return T.AdvancedSettingsDialog({})},e.prototype.postRender=function(){this.availableMemoryThresholdInput=this.el.querySelectorAll(".available-memory-threshold")[0],this.inputChangeHandler=this.onInputChange.bind(this),this.availableMemoryThresholdInput&&(this.availableMemoryThresholdInput.addEventListener("input",this.inputChangeHandler),this.availableMemoryThresholdInput.addEventListener("change",this.inputChangeHandler))},e.prototype.onResize=function(){this.$dialogRoot.position(this.options.position)},e.prototype.init=function(){this.availableMemoryThresholdModel=this.options.viewStates.get("_settings").get(e.VS_AVAILABLE_MEMORY_THRESHOLD),this.availableMemoryThresholdInput.value=this.availableMemoryThresholdModel.get("value")},e.prototype.remove=function(){return this.availableMemoryThresholdInput&&(this.availableMemoryThresholdInput.removeEventListener("input",this.inputChangeHandler),this.availableMemoryThresholdInput.removeEventListener("change",this.inputChangeHandler)),QuickBase.DialogBase.prototype.remove.apply(this)},e.prototype.onInputChange=function(e){var t=e.target;"input"===e.type&&""===t.value||(e=parseInt(t.value,10),e=_.isNaN(e)||e<parseInt(t.min,10)||e>parseInt(t.max,10)?this.availableMemoryThresholdModel.get("value"):e,t.value=e.toString())},e.prototype.onSave=function(){var e=parseInt(this.availableMemoryThresholdInput.value,10);this.availableMemoryThresholdModel.set("_default",e,{silent:!0}),this.availableMemoryThresholdModel.set("value",e),this.dialogClose()},e.VS_AVAILABLE_MEMORY_THRESHOLD="dashboardAvailableMemoryThreshold",e}(QuickBase.DialogBase),DataDialog=Backbone.View.extend({appModel:null,cookieKey:"dashboard-datadialog-settings",className:"data-dialog",dataView:null,propertiesView:null,isModelChanged:!1,areYouSureDialog:null,areYouSureMessage:"There are unsaved changes to this data source.",dashEngine:null,DOCUMENT_DEFAULTS:function(e){return _.extend({_autoExec:!0,_autoExecute:!0,_columns:[],_connection_Viewstate:"",_subscriptionKey:"",_dataSource:"kdb",_dataType:this.appModel.get("CanExecuteQueries")?"query":"analytic",_serverPaging:!1,_subscriptionType:"static",_subscriptionInterval:3,_maxRows:2e3,_layout:[{weight:2,isExpanded:!0},{weight:1,isExpanded:!1},{weight:1,isExpanded:!1},{weight:1,isExpanded:!0},{weight:2,isExpanded:!1}],_mappings:{},_pageSize:2e3,_pagingNum:0,_pagingType:"NONE",_query_connection:"",_queryParams:[],_isStreamingSubscription:!1,_selectedAnalytic:"",_analyticParams:{},_analyticParameters:{},_streamingParameters:{},_table:"",_pivotSource:"query",_pivotType:"",_pivotQuery:"",_aggregateFns:[],_aggregateCols:[],_aggregateLabels:[],_breakdownCols:[],_columnLabel:"",_aggFn:"avg",_topX:"",_from:"",_to:"",_ordering:"",_queryString:"",_hasUpdateQuery:!1,_updateQueryString:"",_updateQueryParams:[],_virtualParams:[],_virtualQueryString:"",_analyticString:"",_builderParams:[],_queryBuilderParams:[],_graphJSON:""},e)},initialize:function(e){var a=this,i=(this.debounceUpdateCookie=_.debounce(this.updateCookie,100),this.appModel=e.appModel,this.docViewModel=e.docViewModel,this.dashEngine=this.appModel.get("dashEngine"),this.dialogContainer=e.dialogContainer,this.disabledNodes=e.disabledNodes,this.initialTab=e.initialTab,this.selectCallback=e.selectCallback,this.dialogOptions=e.dialogOptions,this.components=e.components,this.isPropertiesCollapsed=!1,this.path=void 0,this.$el.html(T.DataDialog()),this.$tree=this.$el.find("> .tree"),this.$collapsible=this.$el.find("> .collapsible"),this.$header=this.$collapsible.find("> h3"),this.$icon=this.$header.find("i"),this.$collapsibleContent=this.$collapsible.find("> .properties"),this.resizeConfigDialogDebounced=_.debounce(_.bind(this.resizeConfigDialog,this),100),this.eventBus=_.extend({},Backbone.Events),this.getJSON(this.cookieKey)),n=(this.sideBarWidth=this.dashEngine.isIEMode()?64:0,this.marginSize=7,Math.max(_.isNil(i.left)?this.sideBarWidth:i.left,this.sideBarWidth)),o=Math.max(_.isNil(i.width)?1200:i.width,1200),s=(n+o+this.marginSize>window.innerWidth?(n=null,this.sideBarWidth+o+this.marginSize>window.innerWidth&&(o=window.innerWidth-this.marginSize-this.sideBarWidth)):_.isNil(i.left)&&(n=null),_.isNil(i.left)||null===n||(n=Math.max(this.sideBarWidth,n)),Math.max(_.isNil(i.top)?0:i.top,0)),l=Math.max(_.isNil(i.height)?750:i.height,200);s+l+this.marginSize>window.innerHeight?(s=null,l+this.marginSize>window.innerHeight&&(l=window.innerHeight-this.marginSize)):_.isNil(i.top)&&(s=null),l=Tools.calcDialogHeight(l,"dataDialog");this.$dialog=this.$el.dialog(_.extend({appendTo:e.dialogContainer,title:t("Data "),classes:{"ui-dialog":"quick-dash datasource-dialog"},resizable:!0,height:l,width:o,minWidth:1200,minHeight:200,position:{my:"center",at:"center",of:"#appdiv",collision:"fit"},modal:!0,autoOpen:!0,buttons:[{text:t("Advanced Settings"),disabled:!1,class:"btn-left btn-settings",click:$.proxy(a.onSettingsButtonClick,a),icon:"fa fa-gear"},{text:t("Select Item"),disabled:!0,class:"btn-right btn-select",click:$.proxy(a.onSelectButtonClick,a),icon:"fa fa-check"},{text:t("Apply"),disabled:!0,class:"btn-right btn-save",click:$.proxy(a.onSaveButtonClick,a),icon:"fa fa-check-square-o"},{text:t("Close"),class:"btn-right btn-close",click:$.proxy(a.onCancelButtonClick,a),icon:"fa fa-times"}],open:function(){$('<i class="fa fa-database" />').insertBefore(a.$el.parent().find(".ui-dialog-title")),$('<div class="buttonset-right"></div>').appendTo(a.$el.parent().find(".ui-dialog-buttonset")),a.$el.parent().find(".btn-right").appendTo(a.$el.parent().find(".buttonset-right")),_.isNil(n)||_.isNil(s)||(a.el.parentElement.style.left=n+"px",a.el.parentElement.style.top=s+"px"),a.dashEngine.isIEMode()&&adjustDialogPositionIfNeeded(document.querySelector("#appdiv"),a.el.parentElement),a.updateLayout(),a.$header.click(function(){a.isPropertiesCollapsed=!a.isPropertiesCollapsed,a.updateLayout()}),a.dataView=new TreeView({areYouSureMessage:this.areYouSureMessage,el:a.$el.find("> .tree"),model:a.model,eventBus:a.eventBus,disabledNodes:a.disabledNodes,treeViewType:"DATA_SOURCE",nodeLabel:"Data Source",nodeTypes:{node:{icon:"fa fa-fw fa-database",valid_children:[]},node_mapped:{icon:"fa fa-fw fa-database",a_attr:{class:"mapped"},valid_children:[]},virtual_node:{icon:"fa fa-calculator",valid_children:[]},virtual_node_mapped:{icon:"fa fa-calculator",a_attr:{class:"mapped"},valid_children:[]}},selected:e.path,viewOptions:e.dialogOptions,getCleanUpButtonState:a.getCleanUpButtonState.bind(a),getDocumentGraph:a.getDocumentGraph.bind(a),contextMenuFn:function(e,t){var i={};return"node"!==e&&"node_mapped"!==e||(i.create_virtual_node={label:"Add Virtual Data Source",_disabled:t,action:function(e){var t=$.jstree.reference(e.reference),e=t.get_node(e.reference),i=t.get_path(e,"/");t.create_node(e.parent,{source:i,type:"virtual_node"},"last",function(e){_.defer(function(){t.edit(e)})})}}),i},determineTypeFn:function(e){return e&&e.get?e.isMapping()?"virtual"===e.get("_dataType")?"virtual_node_mapped":"node_mapped":"virtual"===e.get("_dataType")?"virtual_node":"node":"node"},newGroupFn:function(){return new QuickBase.DocumentDataModel({},a.root,"",a.docViewModel,!0)},newNodeFn:function(e){var t=DataConfigForm.filterAttributes(a.DOCUMENT_DEFAULTS());return e&&"virtual_node"===e.type&&(t._dataType="virtual",e.source)&&(t._virtualParams=[{type:"datasource",name:"source",value:e.source}],t._virtualQueryString=a.generateSampleVirtualQuery(e.source)),a.editModel&&a.editModel.get("_connection")&&(t._connection=a.editModel.get("_connection")),new QuickBase.DocumentDataModel(t,a.model?a.model.root:null,"",a.docViewModel,!1)},setPathFn:function(t,i){var n,o=t.path;i!==o&&(t.path=i,n=new RegExp("^"+o),t.getTreeList().forEach(function(e){e.path&&e.cid!==t.cid&&(e.path=""===o?i:e.path.replace(n,i))}),a.model.getTreeList().forEach(function(e){"virtual"===e.get("type")&&e.updateParameterPath("ds",o,i)}))},saveCb:function(){a.onSaveButtonClick()},noSaveCb:function(){a.isModelChanged=!1,a.setSaveEnabled(a.isModelChanged)},cleanUpFn:function(){a.documentGraph=new QuickBase.DocumentGraph(a.docViewModel,this.model,a.components,a.appModel.get("components").models,!!a.appModel.get("embedded"),this.model.getByPath.bind(this.model)),a.documentGraphVisual={documentGraph:a.documentGraph},a.cleanUpDialog=new CleanUpDialog({documentGraphVisual:a.documentGraphVisual,dialogContainer:a.dialogContainer,onClose:this.cleanUpNodes.bind(this),dialogOptions:{dialogTitle:"Unused Data Sources",hideViewStates:!0}})}}),a.setDialogOptions(),a.initHorizontalResize(),a.dataView.on("select_property",$.proxy(a.onTreeViewSelectProperty,a)),"FSBL"in window&&a.$el.parent().css("margin-top",window.finApi.DIALOGS_TOP_MARGIN),a.$el.parent().find(".ui-dialog-buttonpane button:last-child").focus()},close:function(){a.remove()},dragStart:function(e){var t=a.$dialog.parent();a.isOutsideOfScreen=t.outerWidth()>window.innerWidth-a.sideBarWidth||t.outerHeight()>window.innerHeight,a.isOutsideOfScreen&&a.$dialog.parent().hide()},dragStop:function(e){a.isOutsideOfScreen&&(a.$dialog.dialog("option",{width:Math.min(window.innerWidth-a.sideBarWidth-a.marginSize,a.$dialog.dialog("option","width")),height:Math.min(window.innerHeight-a.marginSize,a.$dialog.dialog("option","height")),position:{my:"center",at:"center",of:"#appdiv",collision:"fit"}}),a.$el.parent().show(),a.onHorizontalResize(),a.isOutsideOfScreen=!1)},drag:function(e){a.isOutsideOfScreen||a.debounceUpdateCookie()},resize:function(){a.onHorizontalResize(),a.debounceUpdateCookie(),a.resizeConfigDialogDebounced()},resizeStop:function(){a.dataView.scrollSelectedNodeIntoView()}},this.options)).dialogExtend({maximizable:!0,maximize:function(){a.configDialog&&_.defer(function(){a.configDialog.onResize()}),a.onHorizontalResize(),_.defer(function(){a.initHorizontalResize()}),a.debounceUpdateCookie()},restore:function(){a.configDialog&&a.configDialog.onResize(),a.onHorizontalResize(),_.defer(function(){a.initHorizontalResize(),a.dataView.scrollSelectedNodeIntoView()}),a.debounceUpdateCookie()}}),this.dashEngine.isIEMode()&&this.onDialogResize(),i.isMaximized&&this.$dialog.dialogExtend("maximize"),this.resizeEvent=function(){a.maximizedResize()},window.addEventListener("resize",this.resizeEvent)},getJSON:function(e){var t;try{t=JSON.parse($.cookie(e)||"{}")}catch(e){t={}}return t},getDataTypeCookie:function(){var e=$.cookie("KXQueryType");return _.isNil(e)||["sql","query"].indexOf(e)<0?"sql":e},maximizedResize:function(){var e;"maximized"===this.$dialog.dialogExtend("state")?this.$dialog.dialogExtend("maximize"):((e=this.$dialog.parent()).outerWidth()>window.innerWidth-this.sideBarWidth||e.outerHeight()>window.innerHeight)&&(this.$dialog.dialog("option",{width:Math.min(window.innerWidth-this.sideBarWidth-this.marginSize,this.$dialog.dialog("option","width")),height:Math.min(window.innerHeight-this.marginSize,this.$dialog.dialog("option","height")),position:{my:"center",at:"center",of:"#appdiv",collision:"fit"}}),this.onHorizontalResize())},updateCookie:function(){var e,t,i,n,o;this.el.parentElement&&(o=((e="maximized"===this.$dialog.dialogExtend("state"))?(t=(o=this.getJSON(this.cookieKey)).left,i=o.top,n=o.width,o):(t=(o=this.el.parentElement.style).left,i=o.top,n=o.width,o)).height,$.cookie(this.cookieKey,JSON.stringify({left:parseInt(t),top:parseInt(i),width:parseInt(n),height:parseInt(o),isMaximized:e}),{expires:90,secure:!0,path:"/;SameSite=Strict"}))},generateSampleVirtualQuery:function(e){var t,e=this.model.getByPath(e),i=["sym","bid","ask"],n={sym:11,bid:9,ask:9},o=[{sym:"AUD/CAD",bid:1.0052,ask:1.0055},{sym:"EUR/USD",bid:1.3945,ask:1.3941},{sym:"GBP/USD",bid:1.5896,ask:1.59}];return e&&e.dataSet&&e.dataSet.columns&&!e.dataSet.columns.isEmpty()&&(t=QuickBase.DocumentDataModel.convertMetaToDeltaClientColumnSpec(e.dataSet.columns.toJSON()))&&(i=t.columns.slice(0,3),n=_.pick(t.meta,i),o=_.map(e.dataSet.collection.toJSON().slice(0,3),function(e){return _.pick(e,i)})),T.VirtualQuerySample({columns:JSON.stringify(i,null,2).replace(/\n/g,"\n\t//"),meta:JSON.stringify(n,null,2).replace(/\n/g,"\n\t//"),rows:JSON.stringify(o,null,2).replace(/\n/g,"\n\t//")})},initHorizontalResize:function(){try{this.dataView.$el.resizable("destroy")}catch(e){}this.dataView.$el.resizable({handles:"e",minWidth:300,maxWidth:400}).on("resize",$.proxy(this.onHorizontalResize,this))},onCancelButtonClick:function(){function e(){t.$el.dialog("close"),t.remove()}var t=this;this.isModelChanged?this.areYouSureDialog=new QuickBase.AreYouSureDialog({saveCb:function(){t.onSaveButtonClick(),e()},onClose:function(){t.areYouSureDialog.remove(),delete t.areYouSureDialog},noSaveCb:function(){e()},dashChanged:!0,message:this.areYouSureMessage}):e()},onDialogResize:function(){var i=this;this.$dialog.on("dialogresizestop",function(e,t){dialogResizeHelper(document.querySelector("#appdiv"),t,$(this),this.querySelector(".form")),i.onHorizontalResize(),i.debounceUpdateCookie(),i.resizeConfigDialogDebounced()})},onHorizontalResize:function(){var e=this.$el.width();this.$el.find("> .form").css({width:e-this.$el.find("> .tree").width()+22+"px",left:"auto"}),this.resizeConfigDialogDebounced()},onModelCopyChanged:function(e){!this.isModelChanged&&_.find(_.keys(e.changed),function(e){return 0===e.indexOf("_")&&"_layout"!==e})&&(this.isModelChanged=!0,this.dataView.setPending(this.dataView.selectedNode),this.setSaveEnabled(this.isModelChanged))},onSettingsButtonClick:function(e){new AdvancedSettingsDialog({container:this.dialogContainer,target:e.currentTarget,viewStates:this.model.viewState})},onSaveButtonClick:function(){var e,t=this;t.editModel&&((e=t.model.getByPath(t.path)).clear({silent:!0}),e.set(DataConfigForm.filterAttributes(t.editModel.attributes)),Log.Info("Saved",e.attributes),e.apply(),e.start(),t.deferSaveID=_.defer(function(){t.isModelChanged=!1,t.dataView.selectionChanged=null,t.dataView.setPending(),t.setSaveEnabled(t.isModelChanged)}))},onSelectButtonClick:function(){var e;this.selectCallback&&((e=this.model.getByPath(this.path))?(e.path=this.path,this.selectCallback(e)):this.selectCallback({path:this.path})),this.onCancelButtonClick()},onTreeViewSelectProperty:function(e,a){function t(e){s.path=e;var t,i,n=s.model.getByPath(e),o=n&&n.has("_dataType");s.$el.next().find(".btn-select").button({disabled:!o}),o?(Log.Info("Select model: ",n.attributes),l.dashEngine.isIEMode()&&(o=n.get("_dataType"),["query","sql","api","virtual","insightsStreaming"].includes(o)&&("query"!==o||""!==n.get("_queryString"))||(o="sql"),n.set({_dataType:o,_selectedAnalytic:n.get("_selectedAnalytic")||"getData",_connection:n.get("_connection")||""},{silent:!0})),"copy"===n.get("_dataType")&&n.set("_dataType","query",{silent:!0}),s.configDialog?(s.configDialog.clearCachedQueriesAndParameters(),s.configDialog.$el.show(),s.configDialog.stopListening(s.configDialog.model,"change:"+s.configDialog.SUBCRIPTION_PROPERTY),s.editModel.forceRender=!0,o=n.get("_dataType"),t="streaming"===n.get("_subscriptionType"),i="streaming"===s.editModel.get("_subscriptionType"),s.editModel.set($.extend(!0,r,n.attributes)),s.editModel.get("_dataType")===o&&i!=t&&(s.$el.find("input:radio[name=_dataType]").val([t?"streaming":o]),s.editModel.trigger("change:_dataType",s.editModel,n.get("_dataType"))),s.editModel.forceRender=!1,s.configDialog.clearData(),"builder"===s.editModel.get("_dataType")&&s.configDialog.dataConfigBuilder&&s.configDialog.dataConfigBuilder.settingsModel.set({"Basics.JSON":s.editModel.get("_graphJSON"),"Basics.Selected":s.editModel.get("_selectedNode")}),s.editModel.builderNeedsRender=!0,s.configDialog.listenTo(s.configDialog.model,"change:"+s.configDialog.SUBCRIPTION_PROPERTY,s.configDialog.onModelSubscriptionTypeChange)):(s.editModel=new QuickBase.DocumentDataModel($.extend(!0,{},r,n.attributes),n.root,n.path,n.viewState,!1,_.mapKeys(n.virtualSubscriptions,function(e,t){return t+"#edit"})),s.configDialog=new DataConfigForm({el:s.$el.find("> .form").get(0),dataDialogView:s,docDataModel:s.model,eventBus:s.eventBus,docViewModel:s.docViewModel,dialogContainer:s.dialogContainer,initialTab:s.initialTab,model:s.editModel,appModel:s.appModel,components:s.components}),s.listenTo(s.editModel,"change",s.onModelCopyChanged),s.listenTo(s.editModel,"connectionChange",function(){return s.setSaveEnabled(!0)}),s.listenTo(s.editModel,"isValid",function(e){(this.isModelChanged=e)&&this.dataView.setPending(this.dataView.selectedNode),this.setSaveEnabled(e),this.setSelectEnabled(e)})),s.configDialog.updateQueryRadio(!0),s.editModel.path=e,s.configDialog.onResize()):s.configDialog&&s.configDialog.$el.hide(),l.isModelChanged=!1,l.dataView.selectionChanged=null,l.dataView.setPending(),l.setSaveEnabled(l.isModelChanged),a||_.delay(function(){l.configDialog&&l.configDialog.focusEditor()},100)}var s=this,l=this,r=$.extend(!0,{},this.DOCUMENT_DEFAULTS());this.areYouSureDialog||(!_.isUndefined(e)&&this.isModelChanged&&this.dataView.pending&&this.dataView.selectionChanged?this.areYouSureDialog=new QuickBase.AreYouSureDialog({saveCb:function(){s.dataView.setPending(),l.onSaveButtonClick(),t(e)},onClose:function(){s.areYouSureDialog.isCancel&&(l.dataView.$tree.jstree("deselect_node",l.dataView.selectedNode),l.dataView.$tree.jstree("select_node",l.dataView.lastSelectedNode)),s.areYouSureDialog.remove(),delete s.areYouSureDialog},noSaveCb:function(){s.dataView.setPending(),t(e)},dashChanged:!0,message:"There are unsaved changes to this data source."}):_.isUndefined(e)||!1!==this.dataView.selectionChanged?t(e):(this.path=e,this.editModel&&(this.editModel.path=e)))},remove:function(){this.editModel&&(this.stopListening(this.editModel),this.editModel=null),this.configDialog&&(this.configDialog.remove(),this.configDialog=null),window.clearTimeout(this.deferSaveID),window.removeEventListener("resize",this.resizeEvent),QuickBase.ErrorTooltip.clearAll(),Backbone.View.prototype.remove.call(this)},resizeConfigDialog:function(){this.configDialog&&this.configDialog.onResize()},updateProperties:function(e){var t=this;t.propertiesView&&t.propertiesView.remove(),e&&(t.propertiesView=new DataModelPropertiesView({model:t.model.getByPath(e)}),t.listenTo(t.propertiesView,"configure",function(){t.onConfigureClick(e)}),t.$collapsibleContent.append(t.propertiesView.el))},updateLayout:function(){var e=this.$header.outerHeight(!0),e=this.isPropertiesCollapsed?e:this.$collapsibleContent.outerHeight(!0)+e;this.$collapsible.css("height",e+"px"),this.$tree.css("bottom",e+"px"),this.isPropertiesCollapsed?(this.$icon.removeClass("fa-caret-down"),this.$icon.addClass("fa-caret-right")):(this.$icon.removeClass("fa-caret-right"),this.$icon.addClass("fa-caret-down"))},getDocumentGraph:function(){return new QuickBase.DocumentGraph(this.docViewModel,this.model,this.components,this.appModel.get("components").models,!!this.appModel.get("embedded"),this.model.getByPath.bind(this.model))},setDialogOptions:function(){this.dialogOptions&&this.dialogOptions.hideSelectBtn&&this.$el.next().find(".btn-select").hide()},setSaveEnabled:function(e){this.configDialog&&(this.dashEngine.isIEMode()||this.configDialog.$connectionSelect[0].value)&&this.$el.next().find(".btn-save").button({disabled:!e})},setSelectEnabled:function(e){this.$el.next().find(".btn-select").button({disabled:!e})},getCleanUpButtonState:function(){var e=this.getDocumentGraph();return _.isEmpty(e.getDataSourcesNotConnectedToComponents())}}),VirtualParameter=Backbone.View.extend({BINDABLE_TYPES:["datasource","viewstate"],className:"data-parameter",errorDialog:null,initialize:function(e){var t=this;this.appModel=e.appModel,this.docDataModel=e.docDataModel,this.docViewModel=e.docViewModel,this.components=e.components,this.componentDefs=e.componentDefs,this.isEmbedded=e.isEmbedded,this.dialogContainer=e.dialogContainer,this.paramModel=e.paramModel,this.render(),_.includes(this.BINDABLE_TYPES,this.model.get("type"))?this.onBindingSelected(this.model.get("value")):this.$valueInput.val(this.model.get("value")),this.onTypeChanged(),_.defer(function(){t.initializeEvents()})},initializeEvents:function(){this.listenTo(this.model,"change:type",this.onTypeChanged),this.$valueDisplay.on("click",$.proxy(this.onShowBindingDialog,this)),this.$clearBinding.on("click",$.proxy(this.onClearBinding,this)),this.$selectBinding.on("click",$.proxy(this.onShowBindingDialog,this)),this.$valueInput.on("change",$.proxy(this.onValueInput,this)),this.$rollingCheckbox.on("change",this.onUseRollingChange.bind(this)),this.$typeRadio.find("input[type=radio]").change(_.bind(this.onTypeRadioChange,this))},applyControlState:function(){var e;_.includes(this.BINDABLE_TYPES,this.model.get("type"))?this.$form.addClass("is-bound"):this.$form.removeClass("is-bound"),"viewstate"===this.model.get("type")?(e=this.model.get("value"))&&((e=this.docViewModel.getByPath(e))&&e.has("_rolling")&&!0===e.get("_rolling")?(this.$form.addClass("use-rolling"),this.model.has("useRollingSyntax")||this.model.set("useRollingSyntax",!1),this.$rollingCheckbox.prop("checked",!!this.model.has("useRollingSyntax")&&this.model.get("useRollingSyntax"))):this.removeRolling()):this.removeRolling()},removeRolling:function(){this.$form.removeClass("use-rolling"),this.$rollingCheckbox.prop("checked",!1),this.model.unset("useRollingSyntax")},getPath:function(){var e=this.paramModel.path;return e.substring(e.lastIndexOf("/")+1)+"/"+this.model.get("name")},onClearBinding:function(){this.model.set("value",null),this.$viewStateInput.val(""),this.$viewStateDisplay.val(""),this.applyControlState()},onBindingSelected:function(e){switch(this.stopListening(this.boundModel,"change"),this.model.get("type")){case"datasource":this.boundModel=this.docDataModel.getByPath(e);break;case"viewstate":this.boundModel=this.docViewModel.getByPath(e),this.listenTo(this.boundModel,"change:value",this.onBoundModelChange)}this.model.set("value",e),this.$valueInput.val(e),this.$valueDisplay.val(e),this.applyControlState()},onBoundModelChange:function(){this.trigger("change")},onTypeRadioChange:function(){var e=this.$typeRadio.find(":radio:checked").val();this.model.set({type:e}),this.onShowBindingDialog()},onTypeChanged:function(){var e=this.model.get("type");switch(this.$bindingIcon.removeClass("fa-eye fa-database"),e){case"datasource":this.$bindingIcon.addClass("fa-database");break;case"viewstate":this.$bindingIcon.addClass("fa-eye")}this.applyControlState(),this.toogleActiveButtonSet(e)},toogleActiveButtonSet:function(t){var i=this;_.each(["datasource","viewstate","text"],function(e){i.$typeRadio.find("label[for='"+i.uniqueId+"_"+e+"']").toggleClass("ui-state-active",t===e)})},onValueInput:function(){var e=this.$valueInput.val();this.model.set({value:e,isViewState:!1})},onUseRollingChange:function(){var e=this.$rollingCheckbox.prop("checked");this.model.set({useRollingSyntax:e})},render:function(){this.uniqueId=_.uniqueId("virtualParam_"),this.$el.html(T.VirtualParameter(_.extend({uniqueId:this.uniqueId},this.model.toJSON()))),this.$bindingContainer=this.$(".binding-container"),this.$bindingIcon=this.$(".binding-icon"),this.$clearBinding=this.$(".binding-clear"),this.$form=this.$el.find(".form-control"),this.$selectBinding=this.$(".binding-apply"),this.$valueDisplay=this.$el.find(".value-display"),this.$valueInput=this.$el.find(".value-input"),this.$typeRadio=this.$el.find(".type-radio"),this.$rollingCheckbox=this.$(".checkbox-rolling"),this.$typeRadio.val(this.model.get("type")),this.$typeButtonDatasource=this.$typeRadio.find("label[for='"+this.uniqueId+"_datasource']").button({icon:"fa fa-database",text:!1,showLabel:!1,classes:{"ui-button":"ui-state-default ui-corner-left btn-type-virtual"}}),this.$typeButtonText=this.$typeRadio.find("label[for='"+this.uniqueId+"_text']").button({icon:"fa fa-font",text:!1,showLabel:!1,classes:{"ui-button":"ui-state-default ui-corner-left btn-type-virtual"}}),this.$typeButtonViewstate=this.$typeRadio.find("label[for='"+this.uniqueId+"_viewstate']").button({icon:"fa fa-eye",text:!1,showLabel:!1,classes:{"ui-button":"ui-state-default ui-corner-right btn-type-virtual"}}),this.$typeRadio.find(":radio[value="+this.model.get("type")+"]").prop("checked",!0),this.$typeRadio.button({classes:{"ui-button":"ui-buttonset"}})},remove:function(){this.$bindingContainer.off(),this.$clearBinding.off(),this.$selectBinding.off(),this.$valueInput.off(),Backbone.View.prototype.remove.apply(this)},onShowBindingDialog:function(){var e,t=this,i={dialogContainer:t.dialogContainer,path:t.model.get("value")};switch(t.model.get("type")){case"datasource":e=DataDialog,_.extend(i,{appModel:t.appModel,disabledNodes:[t.paramModel.path],docViewModel:t.docViewModel,model:t.docDataModel,components:t.components,selectCallback:function(e){e&&t.onBindingSelected(e.path)}});break;case"viewstate":e=ViewStateDialog,_.extend(i,{model:t.docViewModel,docDataModel:t.docDataModel,components:t.components,componentDefs:t.componentDefs,isEmbedded:t.isEmbedded,selectCallback:function(e){t.onBindingSelected(e)}})}e&&new e(i)}}),DataConfigQuery_Virtual=Backbone.View.extend({tagName:"div",params:null,$paramsBox:null,$queryEditor:null,lastText:null,initialize:function(e){var t=this;t.appModel=e.appModel,t.docDataModel=e.docDataModel,t.docViewModel=e.docViewModel,t.components=e.components,t.componentDefs=e.componentDefs,t.isEmbedded=e.isEmbedded,t.dialogContainer=e.dialogContainer,t.params=new Backbone.Collection,t.render(),t.initializeMonaco()},initializeMonaco:function(){var n=this;this.lastText=this.model.get("_virtualQueryString"),MonacoHelpers.require({language:"javascript"},function(e){var t=e.monaco,e=e.unload,i=n.$el.find(".query-editor")[0];n.unregisterTypes=e,n.editor=t.editor.create(i,_.assign({},MonacoHelpers.DEFAULT_OPTIONS(),{language:"javascript"})),n.onModelParamsChange(),n.onParamsChanged(),n.initializeEvents(),n.editor.setValue(n.lastText)})},initializeEvents:function(){this.listenTo(this.params,"add reset remove",this.onParamsChanged),this.listenTo(this.model,"change:_virtualParams",this.onModelParamsChange),this.listenTo(this.model,"change:_virtualQueryString",this.onModelTextChange),this.debounceEditorChange=_.debounce($.proxy(this.onEditorTextChange,this),100),this.editor.onDidChangeModelContent(this.debounceEditorChange)},focusEditor:function(){this.editor&&(this.editor.setPosition({lineNumber:2,column:1}),this.editor.focus())},onEditorTextChange:function(){this.lastText=this.editor.getValue(),this.model.set("_virtualQueryString",this.lastText),this.updateParams()},onModelParamsChange:function(){this.params.reset(this.model.get("_virtualParams")||[])},onModelTextChange:function(e,t){t!==this.lastText&&(this.lastText=t,this.editor.setValue(t))},onParamsChanged:function(){var i=this;_.each(i.paramViews,function(e){i.stopListening(e.model),e.remove()}),i.paramViews=[],i.params.each(function(e){var t=new VirtualParameter({appModel:i.appModel,dialogContainer:i.dialogContainer,docDataModel:i.docDataModel,docViewModel:i.docViewModel,model:e,paramModel:i.model,components:i.components,componentDefs:i.componentDefs,isEmbedded:i.isEmbedded});i.listenTo(e,"change",i.updateDataModelParams),i.paramViews.push(t),i.$paramsBox.append(t.$el)}),0<i.paramViews.length?i.$paramsBox.show():i.$paramsBox.hide(),i.onResize()},onResize:function(){0<this.params.length?this.$queryEditor.css("bottom",this.$paramsBox.height()+"px"):this.$queryEditor.css("bottom",0),MonacoHelpers.adjustAfterResize(this.editor)},remove:function(){this.editor&&(this.editor=null),this.unregisterTypes(),Backbone.View.prototype.remove.call(this)},render:function(){this.$el.html(T.DataConfigQuery_Virtual(this.model.toJSON())),this.$paramsBox=this.$el.find(".params-box"),this.$queryEditor=this.$el.find(".query-editor")},updateDataModelParams:function(){this.stopListening(this.model,"change:_virtualParams"),this.model.set("_virtualParams",this.params.toJSON()),this.listenTo(this.model,"change:_virtualParams",this.onModelParamsChange)},updateParams:function(){var n=this,o=[],a=!1,e=QuickBase.DocumentDataModel.VIRTUAL_QUERY_REGEX.exec(n.model.get("_virtualQueryString"));e&&6===e.length?(e=e[2].split(","),a=e.length!==n.params.length,_.each(e,function(e,t){var i;e=e.trim(),(i=n.params.findWhere({name:e}))?(i.get("index")!==t&&(a=!0,i.set({index:t},{silent:!0})),o.push(i)):(o.push(new Backbone.Model({name:e,index:t,type:"datasource",value:""})),a=!0)})):console.warn("Virtual Query: Function Declaration Invalid. Function call must have at least one source & callback."),a&&n.params.reset(o),n.updateDataModelParams()}}),DataConfigQuery_Builder=Backbone.View.extend({className:"data-config-builder",$isStreamingSub:null,$parametersPanel:null,selectedAnalyticParams:[],subscriptionSelect:null,analyticDetailsObj:{},height:0,width:0,initialize:function(e){this.options=e,this.render()},onChange_queryBuilderParams:function(){0<this.model.get("_queryBuilderParams").length&&this.$el.closest(".data-div").siblings(".toolbar").find("#datasource-execute-query").click()},onModelColumnsChange:function(){var e,t=this.queryBuilderWrapper.app.selectedNode;t&&this.model.get("_selectedNode")===t.id&&((e=JSON.parse(this.settingsModel.get("Basics.JSON"))).nodes[t.id].subscription={cols:this.model.get("_columns"),key:this.model.get("_subscriptionKey")},this.setJsonProperty(JSON.stringify(e)))},onResize:function(){this.queryBuilderWrapper&&this.$el.is(":visible")&&(this.height!==this.$el.height()||this.width!==this.$el.width())&&(this.queryBuilderWrapper.onResize(),this.height=this.$el.height(),this.width=this.$el.width())},remove:function(){this.$parametersPanel&&(this.$parametersPanel.remove(),delete this.$parametersPanel),this.queryBuilderWrapper&&this.queryBuilderWrapper.remove(),Backbone.View.prototype.remove.call(this)},render:function(){var s=this;s.queryBuilderWrapper&&s.queryBuilderWrapper.app.sideDialog;if(!1===s.model.builderNeedsRender)return!1;s.model.builderNeedsRender=!1,s.$el.html(T.DataConfigQuery_Builder()),require(["QueryBuilder"],function(e){var t=s.model.get("_selectedNode")||"result",i=s.model.get("_graphJSON")||"";s.settingsModel=e.getSettingsModel({Basics:{Data:"",Connection:s.model.get("_connection"),Direction:"Left-Right",DialogPlacement:"Left",AutoSave:!0,ReadOnly:!1,Selected:t,JSON:i,qIPC:"",UseViewStates:!0,Theme:"Dark"},Bindings:[],Style:{advanced:"",LevelSeparation:220,NodeSpacing:150}}),s.listenTo(s.settingsModel,"change:Basics.JSON",function(e,t){var i=s.queryBuilderWrapper.app,n=s.model.get("_graphJSON"),i=i.selectedNode;if(n!==t){if(i&&_.includes(["data","function","stream","filter","groupBy","join"],i.group)){var o,a,n=JSON.parse(n).nodes[i.id];if(_.includes(["data","function","stream"],i.group)&&("string"==typeof i.data&&i.data!==n.data||"object"==typeof i.data&&i.data.name!==n.data.name)||"filter"===i.group&&!_.isEqual(i.data.select,n.data.select)||"groupBy"===i.group&&!_.isEqual(i.data.groupBy,n.data.groupBy)||"join"===i.group&&!_.isEqual(i.data,n.data))return s.options.subscriptionSelect.reset(),o=JSON.parse(t),(a=function(e){delete e.subscription,"result"!==e.id&&a(o.nodes[o.edges[e.id]])})(o.nodes[i.id]),n=JSON.stringify(o),s.model.set("_graphJSON",n),void s.setJsonProperty(n)}s.model.set("_graphJSON",t)}else s.resetSubscription(s.model.get("_selectedNode"))}),s.listenTo(s.settingsModel,"change:Basics.Selected",function(e,t){s.model.get("_selectedNode")!==t&&s.resetSubscription(t),s.model.set("_selectedNode",t)}),s.listenTo(s.model,"change:_connection",function(e,t){var i,n;"builder"===s.model.get("_dataType")&&(n=(i=s.queryBuilderWrapper.app).selectedNode,i.api.setProperty("Basics.Connection",t),-1<n.id.indexOf("data"))&&i.doCommand(n.group)}),s.listenTo(s.model,"change:_subscriptionKey",function(e,t){var i,n,o;"builder"===s.model.get("_dataType")&&s.model.get("_graphJSON")&&(i=s.queryBuilderWrapper.app,o=(o=(n=JSON.parse(s.model.get("_graphJSON"))).nodes)[s.model.get("_selectedNode")||_.keys(o)[1]])&&o.subscription&&o.subscription.key!==t&&i.selectedNode&&i.selectedNode.id===s.model.get("_selectedNode")&&(o.subscription.key=t,s.setJsonProperty(JSON.stringify(n)))}),s.queryBuilderWrapper=new QuickBase.AppView({el:s.$el.find(".graph-container")[0],key:"QueryBuilder",settings:s.settingsModel,dashboardViewModel:new Backbone.Model({DashboardTheme:"Dark"}),dashboardAppModel:s.options.appModel,docDataModel:s.options.model,docViewModel:s.options.docViewModel,deltaClient:QuickBase.DeltaClientLib,callback:function(){this.app.setViewModel(s.options.docViewModel,s.options.model,function(e){e.path=e.path?e.path.toString():null,new ViewStateDialog(_.extend({dialogContainer:s.options.dialogContainer,docDataModel:s.options.docDataModel,model:s.options.docViewModel,components:s.options.components,componentDefs:s.options.componentDefs,isEmbedded:s.options.isEmbedded},e))})}})})},resetSubscription:function(e){var t=JSON.parse(this.model.get("_graphJSON")).nodes,e=t[e||_.keys(t)[1]];e&&e.subscription?(this.model.set("_subscriptionKey",e.subscription.key),this.options.subscriptionSelect.updateSubscriptionKeyMenu(e.subscription.cols)):this.options.subscriptionSelect.reset()},setJsonProperty:function(e){var t=this.queryBuilderWrapper.app;t.isSaving=!0,t.api.setProperty("Basics.JSON",e)}}),AnalyticParamsView=function(i){function e(e){var t=i.call(this,e)||this;return t.$parameterList=null,t.parameterArray=[],t.options=e,t.render(),t.listenTo(t.model,"change",t.refreshParameterList),t.refreshParameterList(),t}return __extends(e,i),e.prototype.getParams=function(){var i=[];return _.each(this.parameterArray,function(e,t){i.push(e.model.toJSON())}),i},e.prototype.onParamItemChanged=function(){this.trigger("ParamItemChanged")},e.prototype.refreshParameterList=function(){var i,n=this;n.parameterArray=[],n.$parameterList.html(""),this.model.get("Parameters").length?_.each(this.model.get("Parameters"),function(e){i=new DataParameter(new Backbone.Model(_.extend({},e)),n.options.analyticModel,n.options.docViewModel,function(e){new ViewStateDialog(_.extend({dialogContainer:n.options.dialogContainer,docDataModel:n.options.docDataModel,model:n.options.docViewModel,components:n.options.components,componentDefs:n.options.componentDefs,isEmbedded:n.options.isEmbedded},e))},n.options.possibleTypes),n.listenTo(i,"ValueChanged",n.onParamItemChanged),n.parameterArray.push(i),n.$parameterList.append(i.$el)}):n.$parameterList.append($("<div />").addClass("noParameters").text(t("No Parameters")))},e.prototype.render=function(){return this.$el.html(T.AnalyticParamsView(this.model.toJSON())),this.$parameterList=this.$el.find(".parameterList"),this},e}(Backbone.View),SubscriptionSelect=Backbone.View.extend({className:"row data-source-row",hasStreamingNode:!1,isLite:!1,DATA_TYPE_PROP:"_dataType",DATA_SOURCE_PROP:"_dataSource",COLUMNS_PROPERTY:"_columns",SUBCRIPTION_PROPERTY:"_subscriptionType",INTERVAL_PROPERTY:"_subscriptionInterval",SUBSCRIPTION_KEY_PROPERTY:"_subscriptionKey",FORCE_RESET_PROPERTY:"_forceReset",$subscriptionSelect:null,$maxRowsInput:null,$subscriptionCheckedRadio:null,$polling:null,$static:null,$streaming:null,$subscription:null,$serverPaging:null,initialize:function(i){var e,t=this,n=this;this.isLite=i.isLite,this.subscriptionKey=_.uniqueId("subscriptionSelect_"),this.$el.html(T.SubscriptionSelect()),this.$autoExecute=this.$el.find(".auto-execute"),this.$subscriptionSelect=this.$el.find("input[name='"+this.SUBCRIPTION_PROPERTY+"']"),this.$subscriptionKey=this.$el.find("select[name='"+this.SUBSCRIPTION_KEY_PROPERTY+"']"),this.$intervalSelectContainer=this.$el.find(".subscriptionIntervalContainer"),this.$forceResetCheck=this.$el.find("."+this.FORCE_RESET_PROPERTY),this.$streaming=this.$el.find(".streamingRadio"),this.$subscription=this.$el.find(".subscriptionRadio"),this.$static=this.$el.find(".staticRadio"),this.$polling=this.$el.find(".pollingRadio"),this.$serverPaging=this.$el.find(".server-paging > input"),this.debouncedUpdateSubscriptionKeyMenu=_.debounce(this.updateSubscriptionKeyMenu,100),this.onModelColumnsChange(),this.listenTo(this.model,"change:"+this.COLUMNS_PROPERTY,this.onModelColumnsChange),this.onModelDataTypeChange(),this.listenTo(this.model,"change:"+this.DATA_TYPE_PROP+" change:"+this.DATA_SOURCE_PROP,this.onModelDataTypeChange),this.onModelSubscriptionChange(),this.listenTo(this.model,"change:"+this.SUBCRIPTION_PROPERTY,this.onModelSubscriptionChange),this.$subscriptionSelect.change($.proxy(this.onInputSubscriptionChange,this)),this.onModelGraphChange(),this.listenTo(this.model,"change:_graphJSON",this.onModelGraphChange),e=new Backbone.Form.editors.NumberViewState({key:this.INTERVAL_PROPERTY,model:this.model,openViewStateDialog:function(e,t){new ViewStateDialog({dialogContainer:i.dialogContainer,docDataModel:i.docDataModel,model:i.docViewModel,components:i.components,componentDefs:i.componentDefs,isEmbedded:i.isEmbedded,path:e,selectCallback:function(e){e=i.docViewModel.getByPath(e);t(e)}})},schema:{editorAttrs:{max:3600,min:.5,step:.1}}}).render(),this.$intervalSelectContainer.append(e.el),e.on("change",function(){n.model.set(n.INTERVAL_PROPERTY,e.getValue())}),this.onModelSubscriptionKeyChange(),this.listenTo(this.model,"change:"+this.SUBSCRIPTION_KEY_PROPERTY,this.onModelSubscriptionKeyChange),this.$subscriptionKey.change($.proxy(this.onInputSubscriptionKeyChange,this)),this.onModelForceResetChange(),this.listenTo(this.model,"change:"+this.FORCE_RESET_PROPERTY,this.onModelForceResetChange),this.$forceResetCheck.change($.proxy(this.onInputForceResetChange,this)),this.$forceResetCheck.on("keyup",function(e){" "!==e.key&&"Enter"!==e.key||t.$forceResetCheck.trigger("click")}),this.onModelAutoExecuteChange(),this.listenTo(this.model,"change:"+QuickBase.DocumentDataModel.AUTO_EXECUTE,this.onModelAutoExecuteChange.bind(this)),this.$autoExecute.on("click",this.onAutoExecuteChange.bind(this)).on("keyup",function(e){" "!==e.key&&"Enter"!==e.key||t.$autoExecute.trigger("click")}),this.$serverPaging.on("keyup",function(e){" "!==e.key&&"Enter"!==e.key||t.$serverPaging.trigger("click")})},appendOption:function(e,t){this.$subscriptionKey.append($("<option>",{value:e,text:t}))},enableStreamingOnly:function(e){this.$static.toggle(!e),this.$polling.toggle(!e),this.$subscription.toggle(!this.isLite&&!e),this.$streaming.toggle(e);var t=this.model.get(this.SUBCRIPTION_PROPERTY);({static:this.$static,polling:this.$polling,subscription:this.$subscription,streaming:this.$streaming})[e?"streaming":"streaming"===t?"static":t].find("input").prop("checked",!0).trigger("change")},onAutoExecuteChange:function(e){this.model.set(QuickBase.DocumentDataModel.AUTO_EXECUTE,$(e.target).prop("checked"))},onInputForceResetChange:function(e){this.model.set(this.FORCE_RESET_PROPERTY,$(e.currentTarget).is(":checked"))},onInputSubscriptionKeyChange:function(e){this.model.set(this.SUBSCRIPTION_KEY_PROPERTY,$(e.currentTarget).val()),Log.Info("Subscription Key Change "+this.SUBSCRIPTION_KEY_PROPERTY,$(e.currentTarget).val())},onInputSubscriptionChange:function(e){e=$(e.currentTarget).val();e&&this.model.set(this.SUBCRIPTION_PROPERTY,e)},onModelAutoExecuteChange:function(){this.$autoExecute.prop("checked",this.model.get(QuickBase.DocumentDataModel.AUTO_EXECUTE))},onModelColumnsChange:function(){this.updateSubscriptionKeyMenu(this.model.get(this.COLUMNS_PROPERTY))},onModelDataTypeChange:function(){var e=this.model.get(this.DATA_TYPE_PROP),t=this.model.get(this.DATA_SOURCE_PROP),i=this.$el.closest(".subscription").siblings(".function").find("input:checked");"insightsStreaming"===e?this.enableStreamingOnly(!0):"analytic"===e?this.enableStreamingOnly(!i.hasClass("analytic")&&"streaming"===this.model.get("_subscriptionType")||i.hasClass("streaming")):"builder"===e?this.enableStreamingOnly(this.hasStreamingNode):(this.$static.show(),this.$polling.show(),this.$streaming.toggle(this.isLite?"builder"===e&&this.hasStreamingNode||"streaming"===e:"analytic"===e&&"sql"!==t),this.$subscription.toggle(!this.isLite&&"sql"!==t&&"virtual"!==e),i=this.$el.find("input:checked")[0],-1===this.$el.find("input:visible").toArray().indexOf(i)&&this.$static.find("input").prop("checked",!0).trigger("change"))},onModelGraphChange:function(){var e;"builder"===this.model.get(this.DATA_TYPE_PROP)&&(e=this.model.get("_graphJSON"),this.hasStreamingNode=!_.isEmpty(e)&&_.some(JSON.parse(e).nodes,function(e){return"stream"===e.group}),this.enableStreamingOnly(this.hasStreamingNode))},onModelSubscriptionKeyChange:function(){"polling"!==this.model.get(this.SUBSCRIPTION_KEY_PROPERTY)&&"subscription"!==this.model.get(this.SUBSCRIPTION_KEY_PROPERTY)||this.debouncedUpdateSubscriptionKeyMenu()},onModelForceResetChange:function(){this.$forceResetCheck.prop("checked",!0===this.model.get(this.FORCE_RESET_PROPERTY))},onModelSubscriptionChange:function(){var e,t=this.$el.find("."+this.model.get(this.SUBCRIPTION_PROPERTY));this.$subscriptionCheckedRadio&&t!==this.$subscriptionCheckedRadio&&this.$subscriptionCheckedRadio.removeAttr("checked"),_.defer(function(){t.prop("checked",!0)}),"static"===(this.$subscriptionCheckedRadio=t).val()?this.$intervalSelectContainer.parent().hide():(e="streaming"===t.val()?"none":"inline-block",this.$intervalSelectContainer.parent().css("display",e),this.debouncedUpdateSubscriptionKeyMenu())},remove:function(){this.model.unsubscribe(this.subscriptionKey),Backbone.View.prototype.remove.call(this)},resetOptions:function(){this.$subscriptionKey.find("option").remove(),this.appendOption("","Row Num")},reset:function(){this.model.set(this.SUBSCRIPTION_KEY_PROPERTY,""),this.resetOptions()},updateSubscriptionKeyMenu:function(e){var t=this;e&&(t.resetOptions(),0<e.length?_.each(e,function(e){t.$subscriptionKey.append($("<option>",{value:e,text:e}))}):t.model.get(t.SUBSCRIPTION_KEY_PROPERTY)&&t.$subscriptionKey.append($("<option>",{value:t.model.get(t.SUBSCRIPTION_KEY_PROPERTY),text:t.model.get(t.SUBSCRIPTION_KEY_PROPERTY)}))),t.model.get(t.SUBSCRIPTION_KEY_PROPERTY)?t.$subscriptionKey.val(t.model.get(t.SUBSCRIPTION_KEY_PROPERTY)):t.model.set(t.SUBSCRIPTION_KEY_PROPERTY,t.$subscriptionKey.val())}}),DataConfigAnalytic=function(n){function e(e){var t=n.call(this,e)||this,i=(t.ignoreParamsChanges=!1,t.selectedAnalytic="",t.selectedAnalyticParams=[],t.subscriptionSelect=null,t.analytics={},t.options=e,t.dashEngine=t.options.appModel.get("dashEngine"),t.$el.addClass("data-config-analtyic"),t.$el.attr("id",t.options.analyticGuid),t.$el.html(T.DataConfigAnalytic()),t.$tree=t.$el.find(".pnlAnalyticsTree"),t.$search=t.$el.find(".searchBox"),t.$clearSearch=t.$el.find(".clearSearch"),t.selectedAnalytic=t.model.get("_selectedAnalytic"),t.resetParametersPanel(),t.options.appModel.get("isLite")?t.updateLite():t.updateDelta(),_.debounce(t.jstreeSearch.bind(t),250));return t.debouncedScrollToSelection=_.debounce(t.scrollToSelection,100),t.$search.keyup(function(e){e=e.target.value;e?t.$clearSearch.show():t.$clearSearch.hide(),i(e)}),t.$clearSearch.click(function(e){t.$search.val("").trigger("keyup")}),t.model.set(t.getParametersProperty(),t.model.get("_analyticParams")),t.listenTo(t.model,"change:_selectedAnalytic",t.onModelAnalyticChange),t.listenTo(t.model,"change:"+t.getParametersProperty(),t.onModelAnalyticParamsChange),t.listenTo(t.model,"change:_connection",t.onModelConnectionChange),t}return __extends(e,n),e.prototype.onModelConnectionChange=function(){this.options.appModel.get("isLite")&&this.updateLite()},e.prototype.createJsTreeJSON=function(e,t,i){return{id:e,text:t,state:{selected:e===this.selectedAnalytic},children:[],type:i}},e.prototype.getParams=function(){var e,t=this.parametersPanel.getParams();return this.ignoreParamsChanges=!0,this.model.set(((e={_analyticParams:t})[this.getParametersProperty()]=t,e)),this.ignoreParamsChanges=!1,t},e.prototype.generateAnalyticParametersObject=function(e){var a=this,s=(this.selectedAnalyticParams=[],this.getParametersProperty());this.isStreaming()&&this.options.appModel.get("isLite")&&this.selectedAnalytic&&0===e.length&&e.push({name:"x",type:"Symbol"}),e.forEach(function(e){var t,i=null,n=null,o=_.find(a.model.get(s),{name:e.name});o&&(t=_.find(a.model.get(s),function(e){return e.id===o.id}))&&(n=t.value,i=t.type),a.selectedAnalyticParams.push({id:e.name,name:e.name,type:i||a.modifyParameterType(e.type),description:e.description||"",required:e.required||!1,value:n||e.value,addValue:null==o?void 0:o.addValue,isViewState:!(!o||!o.isViewState),useRollingSyntax:!(!o||!o.useRollingSyntax)})}),this.parametersPanel&&(this.parametersPanel.model.set({Parameters:this.selectedAnalyticParams}),this.getParams())},e.prototype.getParametersProperty=function(){return this.isStreaming()?"_streamingParameters":"_analyticParameters"},e.prototype.isStreaming=function(){return"streaming"===this.model.get("_subscriptionType")},e.prototype.jstreeSearch=function(e){this.$tree.jstree(!0).show_all(!1),this.$tree.jstree().search(e)},e.prototype.modifyParameterType=function(e){var t={Character:"Char",Integer:"Int"}[e];return t||e},e.prototype.onModelAnalyticChange=function(){this.selectedAnalytic=this.model.get("_selectedAnalytic"),this.updateAnalyticUI(),this.model.forceRender&&(this.$tree.jstree("deselect_node",this.$tree.jstree("get_selected")[0]),this.$tree.jstree("select_node",this.selectedAnalytic),this.debouncedScrollToSelection())},e.prototype.onModelAnalyticParamsChange=function(){this.ignoreParamsChanges||this.model.hasChanged("_selectedAnalytic")||this.updateAnalyticUI()},e.prototype.onResize=function(){},e.prototype.resetParametersPanel=function(e){e=_.isNil(e)?this.isStreaming():e;this.parametersPanel&&(this.stopListening(this.parametersPanel,"ParamItemChanged"),delete this.parametersPanel),this.parametersPanel=new AnalyticParamsView({el:this.$el.find(".paramsView"),dialogContainer:this.options.dialogContainer,docDataModel:this.options.docDataModel,docViewModel:this.options.docViewModel,components:this.options.components,componentDefs:this.options.appModel.get("components").models,isEmbedded:this.options.appModel.get("embedded"),model:new Backbone.Model({Parameters:[]}),analyticModel:this.model,possibleTypes:this.options.appModel.get("isLite")&&e?["symbol","list"]:[]}),this.listenTo(this.parametersPanel,"ParamItemChanged",this.getParams)},e.prototype.remove=function(){return this.parametersPanel&&(this.parametersPanel.remove(),delete this.parametersPanel),Backbone.View.prototype.remove.call(this)},e.prototype.renderTree=function(e){var c,d=this,i=this,n=[];i.options.appModel.get("isLite")?(c={},_.each(e,function(o,e){var a=_.filter(e.split("."),function(e){return""!==e}),s=1===a.length&&e==="."+a[0],l=1<a.length||s?".":"",r=n;_.each(a,function(e,t){var i,n=l+e,t=t<a.length-1;t?(void 0===(i=c[n])&&(i=c[n]=d.createJsTreeJSON(n,(t||s?".":"")+e,t?"namespace":o),r.push(i)),r=i.children,l=n+"."):r.push(d.createJsTreeJSON(n,e,o))})})):_.each(e,function(e,t){var i=n.push(d.createJsTreeJSON(t,t,e?"namespace":d.analytics[t].streaming?"streaming":"analytic"));e&&_.each(e,function(e){n[i-1].children.push(d.createJsTreeJSON(e,e,d.analytics[e].streaming?"streaming":"analytic"))})}),require(["jstree"],function(){d.$tree&&d.$tree.jstree("destroy"),d.$tree.jstree({core:{data:n,multiple:!1},conditionalselect:function(e,t){return 0===e.children.length},types:{table:{icon:"fa fa-table"},analytic:{icon:"fa fa-line-chart"},namespace:{icon:"fa fa-folder"},streaming:{icon:i.options.appModel.get("isLite")?"fa fa-table streaming-icon":"fa fa-line-chart streaming-icon"}},search:{show_only_matches:!0,show_only_matches_children:!0},plugins:["conditionalselect","types","search","wholerow"]}),d.$tree.on("select_node.jstree",function(e,t){t&&(i.model.get("_selectedAnalytic")!==t.node.id&&i.options.subscriptionSelect.reset(),i.model.set("_selectedAnalytic",t.node.id))}),d.$tree.on("deselect_node.jstree",function(e,t){i.model.forceRender||i.model.set("_selectedAnalytic","")}),d.$tree.on("search.jstree",function(e,t,i){0===t.nodes.length&&d.$tree.jstree(!0).hide_all(!1)}),d.$tree.one("ready.jstree",d.scrollToSelection.bind(d))})},e.prototype.scrollToSelection=function(){var e=this.selectedAnalytic;e&&(e=e.replace(/\./g,"\\."),e=this.$tree.find("#"+e)[0])&&(this.$tree[0].scrollTop=e.offsetTop-this.$tree[0].offsetTop)},e.prototype.standardSort=function(e){return e.sort(function(e,t){return e.localeCompare(t)})},e.prototype.updateDelta=function(){var o=this;QuickBase.DeltaClientLib.getDeltaAnalytics(function(e){var t=_.reduce(e,function(t,i,e){return o.isStreaming()&&!i.streaming||!o.isStreaming()&&i.streaming||(0<i.groups.length?_.each(i.groups,function(e){t[e]||(t[e]=[]),t[e].push(i.name),o.analytics[i.name]=i}):(t[i.name]=!1,o.analytics[i.name]=i)),t},{}),i={},n={},e=(_.each(o.standardSort(_.keys(t)),function(e){t[e]?i[e]=o.standardSort(t[e]):n[e]=t[e]}),_.extend(i,n));o.renderTree(e),o.updateAnalyticUI()})},e.prototype.updateLite=function(){var t=this,e=this.model.get("_connection");if(!this.dashEngine.isDirectMode_AND_isConnectionTargeting_insightsSDK(e)){function i(){QuickBase.DashClient.getQueryData("q",e,QuickBase.KdbQuery.getFunctionList,[],o,a)}var n=this.isStreaming(),o=function(e){t.analytics={},n&&_.every(e.meta,function(e){return 11==e})&&e.rows[0]?_.values(e.rows[0]).sort(function(e,t){return e.localeCompare(t)}).forEach(function(e){0!==e.indexOf("01000000")&&(t.analytics[e]={name:e,parameters:[],type:"streaming"})}):e.rows.sort(function(e,t){return e.name.localeCompare(t.name)}).forEach(function(e){n===(1==e.streaming)&&(t.analytics[e.name]={name:e.name,parameters:e.parameters?_.filter(e.parameters.rows,function(e){return!!e.name}):[],type:e.streaming?"streaming":"analytic"})}),t.renderTree(_.fromPairs(_.keys(t.analytics).map(function(e){return[e,t.analytics[e].type]}))),t.updateAnalyticUI()},a=function(e){t.analytics={},t.renderTree({}),t.updateAnalyticUI()};try{n?QuickBase.DashClient.getQueryData("q",e,".u.t",[],o,i):QuickBase.DashClient.runAnalytic(QuickBase.KdbQuery.getFunctions,e,[],o,i)}catch(e){a(e)}}},e.prototype.updateAnalyticUI=function(){var e=this.analytics[this.selectedAnalytic];"analytic"===this.model.get("_dataType")&&e&&this.generateAnalyticParametersObject(e&&e.parameters||[])},e}(Backbone.View),GetDataParamsView=function(i){function e(e){var t=i.call(this,e)||this;return t.$parameterList=null,t.parameterArray=[],t.options=e,t.render(),t.listenTo(t.model,"change",t.refreshParameterList),t.listenTo(t.model,"change:hasQueryLimit",t.render),t.refreshParameterList(),t}return __extends(e,i),e.prototype.getParams=function(){var i=[];return _.each(this.parameterArray,function(e,t){i.push(_.omit(e.model.toJSON(),["options"]))}),i},e.prototype.onParamItemChanged=function(e){this.trigger("ParamItemChanged",e)},e.prototype.refreshParameterList=function(){var s,l=this,e=this.model.get("Parameters");l.parameterArray=[],l.$parameterList.html(""),e.length?(s=new Set,_.each(e,function(e){var t,i,n,o,a;s.has(e.id)||(s.add(e.id),t=_.extend({},e),0<e.id.indexOf(QuickBase.CustomAPIHelpers.SUBPARAMETER_SEPARATOR)&&(i="options.cssClass",(n=_.get(t,i,"")).indexOf(o="data-sub-parameter")<1)&&_.set(t,i,o+" "+n),a=new DataParameter(new Backbone.Model(t),l.options.analyticModel,l.options.docViewModel,function(e){new ViewStateDialog(_.extend({dialogContainer:l.options.dialogContainer,docDataModel:l.options.docDataModel,model:l.options.docViewModel,components:l.options.components,componentDefs:l.options.componentDefs,isEmbedded:l.options.isEmbedded},e))},l.options.possibleTypes,!0),"limit"===e.id&&l.model.get("hasQueryLimit")&&(l.limitDataParameter=a,l.initQueryLimit(e.value)),l.listenTo(a,"ValueChanged",function(){l.onParamItemChanged(a)}),l.listenTo(a.model,"change:useRollingSyntax",function(e,t){void 0!==t&&l.onParamItemChanged(a)}),l.parameterArray.push(a),l.$parameterList.append(a.$el))})):l.$parameterList.append($("<div />").addClass("noParameters").text(t("No Parameters")))},e.prototype.getEventListeners=function(){return this.model.get("hasQueryLimit")?{"change .applyLimit > input":"onLimitEnabledChange","input .rowLimit > input":"onLimitChange","change .firstLast > label > input":"onFirstLastChange"}:{}},e.prototype.initQueryLimit=function(e){var t=e[0],i=e[1],e=e[2];_.isUndefined(t)||(this.limit=i,this.limitEnabled=e,t=this.limit.includes("-"),this.$limit.val(this.limit),this.$limitEnabled.prop("checked","on"===this.limitEnabled),this.$limitFirst.prop("checked",!t),this.$limitLast.prop("checked",t))},e.prototype.onLimitEnabledChange=function(e){this.limitEnabled=e.currentTarget.checked?"on":"off",this.updateLimitValue()},e.prototype.onLimitChange=function(e){this.limit=e.currentTarget.value;e=this.limit.includes("-");!e&&this.$limitLast.prop("checked")?this.$limitFirst.prop("checked",!0):e&&this.$limitFirst.prop("checked")&&this.$limitLast.prop("checked",!0),this.updateLimitValue()},e.prototype.onFirstLastChange=function(e){var e=e.currentTarget,t=this.limit.includes("-");"on"===e.value&&t&&(this.limit=this.limit.replace("-","")),"off"!==e.value||t||(this.limit="-"+this.limit),this.$limit.val(this.limit),this.updateLimitValue()},e.prototype.updateLimitValue=function(){this.limitDataParameter&&(this.limitDataParameter.model.set("value",["0","".concat(this.limit),this.limitEnabled]),this.limitDataParameter.updateValue())},e.prototype.render=function(){return this.undelegateEvents(),this.$el.html(T.GetDataParamsView(__assign(__assign({},this.model.toJSON()),{localGuid:_.uniqueId()}))),this.$parameterList=this.$el.find(".parameterList"),this.$limit=this.$el.find(".rowLimit > input"),this.$limitEnabled=this.$el.find(".applyLimit > input"),this.$limitFirst=this.$el.find(".firstRadio > input"),this.$limitLast=this.$el.find(".lastRadio > input"),this.delegateEvents(this.getEventListeners()),this},e}(Backbone.View),ParamValidator=function(){function e(){}return e.validateAggParam=function(e){e=e.value.filter(function(e){return e.includes(";")}).filter(function(e){var e=e.split(/[`;]+/).filter(Boolean),t=(e[0],e[1]);e[2];return!QuickBase.CustomAPIHelpers.ALLOWED_AGG_OPERATORS.find(function(e){return e===t})});e.length&&e.map(function(e){return'The agg parameter "'.concat(e,'" contains an unsupported operator. It will not be sent to the API call.')}).forEach(function(e){new QuickBase.WarningDialog.ShowWarning(e)})},e}(),DataConfigApiSource=function(n){function e(e){var t=n.call(this,e)||this,i=(t.ignoreParamsChanges=!1,t.selectedAnalytic="",t.selectedAnalyticParams=[],t.subscriptionSelect=null,t.analytics={},t.missingAPIwarningVisibleClass="missingAPIwarningVisible",t.options=e,t.$el.addClass("data-config-api-source"),t.$el.attr("id",t.options.analyticGuid),t.$el.html(T.DataConfigApiSource()),t.$tree=t.$el.find(".pnlApiSourceTree"),t.$search=t.$el.find(".searchBox"),t.$clearSearch=t.$el.find(".clearSearch"),t.$missingAPIwarning=t.$el.find(".missingAPIwarning"),t.selectedAnalytic=t.model.get("_selectedAnalytic"),t.resetParametersPanel(),_.debounce(t.jstreeSearch.bind(t),250));return t.debouncedScrollToSelection=_.debounce(t.scrollToSelection,100),t.$search.keyup(function(e){e=e.target.value;e?t.$clearSearch.show():t.$clearSearch.hide(),i(e)}),t.$clearSearch.click(function(e){t.$search.val("").trigger("keyup")}),t.model.set(t.getParametersProperty(),t.model.get("_analyticParams")),t.listenTo(t.model,"change:_selectedAnalytic",t.onModelAnalyticChange),t.listenTo(t.model,"change:"+t.getParametersProperty(),t.onModelAnalyticParamsChange),t.listenTo(t.model,"change:_connection",t.onModelConnectionChange),t}return __extends(e,n),e.prototype.onModelConnectionChange=function(){this.updateAssemblyApiList()},e.prototype.createJsTreeJSON=function(e,t,i){return{id:e,text:t,state:{selected:e===this.selectedAnalytic},children:[],type:i}},e.prototype.validateParams=function(e){var t,i,e=e.find(function(e){return"agg"===e.id});e&&"list"===e.type&&e.value&&(e.isViewState?(i=this.options.docViewModel.viewStates,t=e.value.toString().replace(/<%(.+)%>/,"$1"),(i=i.find(function(e){return e.path===t}))&&ParamValidator.validateAggParam(__assign(__assign({},e),{value:i.model.attributes.value}))):ParamValidator.validateAggParam(__assign({},e)))},e.prototype.getParams=function(){for(var e,i,a=this.parametersPanel.getParams(),s=(this.validateParams(a),!0),l=new Map,t=(a.forEach(function(e){l.set(e.id,e)}),0);t<a.length;t++)!function(n){var t,o=a[n],e=o.id.indexOf(QuickBase.CustomAPIHelpers.SUBPARAMETER_SEPARATOR);e<0?(t=new Set,"list"===o.type&&_.isArray(o.value)&&o.value.forEach(function(e){_.map(e.match(QuickBase.CustomAPIHelpers.SUBPARAMETER_REGEX),function(e){return e.substring(2,e.length-2)}).forEach(function(e){t.has(e)||t.add(e)})}),t.size&&t.forEach(function(e){var t,i="".concat(o.name).concat(QuickBase.CustomAPIHelpers.SUBPARAMETER_SEPARATOR).concat(e);n++,l.has(i)?(t=l.get(i))!==a[n]&&(_.remove(a,t),a.splice(n,0,t),s=!1):(l.set(i,t={description:"",id:i,isViewState:!1,name:e,required:!0,type:"symbol",value:""}),a.splice(n,0,t),s=!1)}),l.delete(o.id)):(e=o.id.substring(0,e),l.has(e)?(_.remove(a,o),a.push(o)):(a.splice(n,1),s=!1),n--),i=n}(t),t=i;return this.ignoreParamsChanges=s,this.model.set(((e={_analyticParams:a})[this.getParametersProperty()]=a,e)),this.ignoreParamsChanges=!1,a},e.prototype.generateAnalyticParametersObject=function(e){var o=this,t=(this.selectedAnalyticParams=[],this.getParametersProperty()),a="getData"===this.selectedAnalytic,s=(this.isStreaming()&&this.options.appModel.get("isLite")&&this.selectedAnalytic&&0===e.length&&e.push({id:"x",name:"x",type:"Symbol"}),this.model.get(t));e.forEach(function(e){var t,i=null,n=_.find(s,{id:e.id,type:e.type});n?i=n.value:"limit"===e.id&&a&&"list"===e.type&&(i=["0","2000",_.isEmpty(s)?"on":"off"]),o.selectedAnalyticParams.push({id:e.name,name:e.name,type:o.modifyParameterType(e.type),description:e.description||"",required:e.required||!1,value:i||e.value,options:e.options,isViewState:!(!n||!n.isViewState),addValue:e.addValue,useRollingSyntax:!(!n||!n.useRollingSyntax)}),n&&(t=n.id+QuickBase.CustomAPIHelpers.SUBPARAMETER_SEPARATOR,_.filter(s,function(e){return 0===e.id.indexOf(t)}).forEach(function(e){o.selectedAnalyticParams.push(__assign({},e))}))}),this.parametersPanel&&(this.parametersPanel.model.set({Parameters:this.selectedAnalyticParams,hasQueryLimit:a}),this.getParams())},e.prototype.getParametersProperty=function(){return this.isStreaming()?"_streamingParameters":"_analyticParameters"},e.prototype.isStreaming=function(){return"streaming"===this.model.get("_subscriptionType")},e.prototype.jstreeSearch=function(e){this.$tree.jstree(!0).show_all(!1),this.$tree.jstree().search(e)},e.prototype.modifyParameterType=function(e){var t={Character:"Char",Integer:"Int"}[e];return t||e},e.prototype.onModelAnalyticChange=function(){this.selectedAnalytic=this.model.get("_selectedAnalytic"),this.updateAnalyticUI(),this.model.forceRender&&(this.$tree.jstree("deselect_node",this.$tree.jstree("get_selected")[0]),this.$tree.jstree("select_node",this.selectedAnalytic),this.debouncedScrollToSelection())},e.prototype.onModelAnalyticParamsChange=function(){this.ignoreParamsChanges||this.model.hasChanged("_selectedAnalytic")||this.updateAnalyticUI()},e.prototype.onResize=function(){},e.prototype.resetParametersPanel=function(){this.parametersPanel&&(this.stopListening(this.parametersPanel,"ParamItemChanged"),delete this.parametersPanel),this.parametersPanel=new GetDataParamsView({el:this.$el.find(".paramsView"),dialogContainer:this.options.dialogContainer,docDataModel:this.options.docDataModel,docViewModel:this.options.docViewModel,model:new Backbone.Model({Parameters:[]}),analyticModel:this.model,possibleTypes:this.options.appModel.get("isLite")&&this.isStreaming()?["symbol","list"]:[]}),this.listenTo(this.parametersPanel,"ParamItemChanged",this.getParams)},e.prototype.remove=function(){return this.parametersPanel&&(this.parametersPanel.remove(),delete this.parametersPanel),Backbone.View.prototype.remove.call(this)},e.prototype.renderTree=function(e){var c,d=this,i=this,n=[];i.options.appModel.get("isLite")?(c={},_.each(e,function(o,e){var a=_.filter(e.split("."),function(e){return""!==e}),s=1===a.length&&e==="."+a[0],l=1<a.length||s?".":"",r=n;_.each(a,function(e,t){var i,n=l+e,t=t<a.length-1;t?(void 0===(i=c[n])&&(i=c[n]=d.createJsTreeJSON(n,(t||s?".":"")+e,t?"namespace":o),r.push(i)),r=i.children,l=n+"."):r.push(d.createJsTreeJSON(n,e,o))})})):_.each(e,function(e,t){var i=n.push(d.createJsTreeJSON(t,t,e?"namespace":d.analytics[t].streaming?"streaming":"analytic"));e&&_.each(e,function(e){n[i-1].children.push(d.createJsTreeJSON(e,e,d.analytics[e].streaming?"streaming":"analytic"))})}),require(["jstree"],function(){d.$tree&&d.$tree.jstree("destroy"),d.$tree.jstree({core:{data:n,multiple:!1},conditionalselect:function(e,t){return 0===e.children.length},types:{table:{icon:"fa fa-table"},analytic:{icon:"fa fa-line-chart"},api:{icon:"fa fa-server"},namespace:{icon:"fa fa-folder"},streaming:{icon:i.options.appModel.get("isLite")?"fa fa-table streaming-icon":"fa fa-line-chart streaming-icon"}},search:{show_only_matches:!0,show_only_matches_children:!0},plugins:["conditionalselect","types","search","wholerow"]}),d.$tree.on("select_node.jstree",function(e,t){t&&(i.model.get("_selectedAnalytic")!==t.node.id&&i.options.subscriptionSelect.reset(),i.model.set("_selectedAnalytic",t.node.id))}),d.$tree.on("deselect_node.jstree",function(e,t){i.model.forceRender||(i.$missingAPIwarning.toggleClass(i.missingAPIwarningVisibleClass,!1),i.model.set("_selectedAnalytic",""))}),d.$tree.on("search.jstree",function(e,t,i){0===t.nodes.length&&d.$tree.jstree(!0).hide_all(!1)}),d.$tree.one("ready.jstree",d.scrollToSelection.bind(d))})},e.prototype.scrollToSelection=function(){var e=this.selectedAnalytic;e&&(e=e.replace(/\./g,"\\."),e=this.$tree.find("#"+e)[0])&&(this.$tree[0].scrollTop=e.offsetTop-this.$tree[0].offsetTop)},e.prototype.standardSort=function(e){return e.sort(function(e,t){return e.localeCompare(t)})},e.prototype.updateDelta=function(){var o=this;QuickBase.DeltaClientLib.getDeltaAnalytics(function(e){var t=_.reduce(e,function(t,i,e){return o.isStreaming()&&!i.streaming||!o.isStreaming()&&i.streaming||(0<i.groups.length?_.each(i.groups,function(e){t[e]||(t[e]=[]),t[e].push(i.name),o.analytics[i.name]=i}):(t[i.name]=!1,o.analytics[i.name]=i)),t},{}),i={},n={},e=(_.each(o.standardSort(_.keys(t)),function(e){t[e]?i[e]=o.standardSort(t[e]):n[e]=t[e]}),_.extend(i,n));o.renderTree(e),o.updateAnalyticUI()})},e.prototype.updateAssemblyApiList=function(){function t(e){o.analytics={},o.renderTree({}),o.updateAnalyticUI()}var o=this;try{o.analytics={},o.options.appModel.get("getAssemblyInfo")(o.model.get("_connection"),!1).then(function(e){null!=e&&e.length&&_.each(e[0].api,function(e){var t,i,n=e.api.replace(".kxi.","");"ping"!==n&&"sql"!==n&&"sql2"!==n&&"qsql"!==n&&"sqlDefer"!==n&&((t=e.metadata.params).push({name:"labels",type:0,description:"label pairs",isReq:!1}),(i=_.find(t,function(e){return"scope"===e.name&&99===Math.abs(e.type)}))&&(i.addValue=function(e){return{name:"assembly",type:"symbol",value:""}}),o.analytics[n]={name:n,parameters:_.map(t,function(e){var t={id:e.name,name:e.name,type:o.getType(e.type),description:e.description,required:e.isReq};return _.has(e,"value")&&(t.value=e.value),_.has(e,"addValue")&&(t.addValue=e.addValue),t}),type:"api",isMissing:e.isMissing})}.bind(o)),o.recreateMissingAPIs(),o.renderTree(_.fromPairs(_.keys(o.analytics).map(function(e){return[e,o.analytics[e].type]}))),o.updateAnalyticUI()}).catch(function(e){t()})}catch(e){t()}},e.prototype.getType=function(e){return _.isArray(e)?"list":0<e&&99!==e?10===e?"string":"list":{0:"list",1:"boolean",2:"guid",4:"byte",5:"short",6:"int",7:"long",8:"real",9:"float",10:"char",11:"symbol",12:"timestamp",13:"month",14:"date",15:"datetime",16:"timespan",17:"minute",18:"second",19:"time",99:"dict"}[Math.abs(e)]||"symbol"},e.prototype.recreateMissingAPIs=function(){var i=function(t){var e;t instanceof QuickBase.DocumentDataModel&&(t.group?_.each(t.keys(),function(e){i(t.get(e))}):"api"===t.get("_dataType")&&(e=t.get("_selectedAnalytic"),this.analytics[e]||(this.analytics[e]={name:e,parameters:t.get("_analyticParams").map(function(e){return _.pick(e,["id","name","type","description","required"])}),type:"api",isMissing:!0})))}.bind(this);i(this.options.docDataModel)},e.prototype.updateAnalyticUI=function(){var e,t,i;!_.isEmpty(this.analytics)&&this.selectedAnalytic&&(t=(e=this.analytics[this.selectedAnalytic]).parameters,"getData"===e.name&&(t.find(function(e){return"limit"===e.name}).options={cssClass:"hidden"},(i=t.find(function(e){return"slice"===e.name}))&&(i.options={cssClass:"hidden"}),(i=t.find(function(e){return"fill"===e.name}))&&(i.options={format:"Select",schema:{width:"100%",showSearch:!1,options:[{label:"(none)",val:""},{label:"zero",val:"zero"},{label:"forward",val:"forward"}]}}),i=t.find(function(e){return"temporality"===e.name}))&&(i.options={format:"Select",schema:{width:"100%",showSearch:!1,options:[{label:"(none)",val:""},{label:"snapshot",val:"snapshot"},{label:"slice",val:"slice"}]}}),"api"===this.model.get("_dataType"))&&e&&(this.$missingAPIwarning.toggleClass(this.missingAPIwarningVisibleClass,e.isMissing||!1),this.generateAnalyticParametersObject(e&&t||[]))},e}(Backbone.View),DataConfigInsightsStreaming=function(i){function n(e){var t=i.call(this,e)||this,e=(t.ignoreParamsChanges=!1,t.PARAMS_PROPERTY="_streamingParameters",t.CONNECTION_PROP="_connection",t.hasPermission_insightsStreaming=!1,t.options=e,t.appModel=e.appModel,t.dashEngine=t.appModel.get("dashEngine"),t.$el.addClass("data-config-insights-streaming"),t.$el.html(T.DataConfigInsightsStreaming()),t.$paramsView=t.$(".paramsView"),t.$warningEl=t.$(".permission-required"),t.$warningText=t.$warningEl.find(">span"),t.appModel.get("hasPermission"));return e&&(t.hasPermission_insightsStreaming=e("canEditStream")),t.hasPermission_insightsStreaming?(t.parametersPanel=new GetDataParamsView({el:t.$paramsView,dialogContainer:t.options.dialogContainer,docDataModel:t.options.docDataModel,docViewModel:t.options.docViewModel,model:new Backbone.Model({Parameters:[]}),analyticModel:t.model,possibleTypes:[]}),t.listenTo(t.parametersPanel,"ParamItemChanged",t.getParams),t.listenTo(t.model,"change:"+t.PARAMS_PROPERTY,t.onParamsChange),(e=t.model.get(t.CONNECTION_PROP)||"")!==(e=t.dashEngine.parseConnElements(e).connection)&&t.model.set(t.CONNECTION_PROP,e),t.listenTo(t.model,"change:"+t.CONNECTION_PROP,t.loadPipelineSubscribers),t.loadPipelineSubscribers()):t.showWarning(n.PERMISSION_REQUIRED_TEXT),t}return __extends(n,i),n.prototype.findParameterObject=function(e){return _.find(this.model.get(this.PARAMS_PROPERTY),{name:e})},n.prototype.getDropdownItems_pipelines=function(){var e,t,i=this.pipelines||[],n=this.findParameterObject("pipeline");return(i=null!=n&&n.value&&!i.find(function(e){return e.id===n.value})&&(e=null==(e=this.findParameterObject("pipelineId"))?void 0:e.value,t=null==(t=this.findParameterObject("pipelineName"))?void 0:t.value,e)&&t?i.concat({id:e,name:t}):i).map(function(e){return{label:e.name,val:e.id}})},n.prototype.getDropdownItems_tables=function(e,t){e=(this.map_pipelineTables||{})[e]||[],e=__spreadArray([],e,!0);return null!=t&&t.value&&(t=t.value,e.indexOf(t)<0)&&e.push(t),e.sort(),e.map(function(e){return{label:e,val:e}})},n.prototype.getParams=function(e){var t,i,a=this.parametersPanel.getParams();if(!this.useDropdowns||!e||"pipeline"!==e.model.get("name")){for(var s,l=!0,r=new Map,n=(a.forEach(function(e){r.set(e.id,e)}),0);n<a.length;n++)!function(n){var t,o=a[n],e=o.id.indexOf(QuickBase.CustomAPIHelpers.SUBPARAMETER_SEPARATOR);e<0?(t=new Set,"filters"===o.id&&"symbol"===o.type&&_.isString(o.value)&&_.map(o.value.match(QuickBase.CustomAPIHelpers.SUBPARAMETER_REGEX),function(e){return e.substring(2,e.length-2)}).forEach(function(e){t.has(e)||t.add(e)}),t.size&&t.forEach(function(e){var t,i="".concat(o.name).concat(QuickBase.CustomAPIHelpers.SUBPARAMETER_SEPARATOR).concat(e);n++,r.has(i)?(t=r.get(i))!==a[n]&&(_.remove(a,t),a.splice(n,0,t),l=!1):(r.set(i,t={description:"",id:i,isViewState:!1,name:e,required:!0,type:"symbol",value:""}),a.splice(n,0,t),l=!1)}),r.delete(o.id)):(e=o.id.substring(0,e),r.has(e)?(_.remove(a,o),a.push(o)):(a.splice(n,1),l=!1),n--),s=n}(n),n=s;return this.ignoreParamsChanges=l,this.model.set(((i={})[this.PARAMS_PROPERTY]=a.map(function(e){return _.omit(e,["options"])}),i)),this.ignoreParamsChanges=!1,a}t=e.model.get("value"),(i=this.pipelines.find(function(e){return e.id===t}))&&(this.modifyDataParameter("pipelineId",t),e=i.name,this.modifyDataParameter("pipelineName",e)),i=this.getDropdownItems_tables(t),this.modifyDataParameter("table",i.length?i[0].val:"",i)},n.prototype.generateStreamingParamsObject=function(e){var a=this,s=[],l=null,r=this.model.get(this.PARAMS_PROPERTY);e.forEach(function(e){var t=null,i=e.name,n=a.findParameterObject(i),o=(n&&(t=n.value,"pipeline"===i)&&(l=t),"pipeline"===i?e.options.schema.options=a.getDropdownItems_pipelines():"table"===i&&(e.options.schema.options=a.getDropdownItems_tables(l,n)),s.push({id:e.name,name:e.name,type:e.type,options:e.options,description:e.description||"",required:e.required||!1,value:t||e.value,isViewState:!(!n||!n.isViewState),useRollingSyntax:!(!n||!n.useRollingSyntax)}),e.name+QuickBase.CustomAPIHelpers.SUBPARAMETER_SEPARATOR);_.isArray(r)&&_.filter(r,function(e){return 0===e.id.indexOf(o)}).forEach(function(e){s.push(__assign({},e))})},this),this.parametersPanel&&(this.parametersPanel.model.set({Parameters:s}),this.getParams())},n.prototype.loadPipelineSubscribers=function(){var o=this,e=this.model.get("_connection");this.useDropdowns=!0,this.$paramsView.hide(),this.$warningEl.hide(),(this.dashEngine.isIEMode()||this.dashEngine.isDirectMode_AND_isConnectionTargeting_insightsSDK(e))&&this.appModel.get("getPipelineSubscribers")(e).then(function(e){o.pipelines=[],o.map_pipelineTables=(e||[]).reduce(function(e,t){var i=t.id,n=e[i];return n||(e[i]=n=[],o.pipelines.push({id:t.id,name:t.name})),n.push(t.topic),e},{}),o.pipelines.sort(function(e,t){return e.name.localeCompare(t.name)}),o.$warningEl.hide(),o.$paramsView.show(),o.updateUI()}).catch(function(e){"string"==typeof e&&e===QuickBase.Dash.DashEngine.ERROR_MSG_PIPELINES_NOT_PRESENT?(o.useDropdowns=!1,o.$warningEl.hide(),o.$paramsView.show(),o.updateUI()):(o.pipelines=[],o.map_pipelineTables={})})},n.prototype.remove=function(){return this.parametersPanel&&(this.parametersPanel.remove(),delete this.parametersPanel),Backbone.View.prototype.remove.call(this)},n.prototype.onParamsChange=function(){this.ignoreParamsChanges||this.updateUI()},n.prototype.onResize=function(){},n.prototype.showWarning=function(e){this.$paramsView.hide(),this.$warningText.text(e),this.$warningEl.show()},n.prototype.modifyDataParameter=function(t,e,i){var n,o;this.parametersPanel&&(n=this.parametersPanel.parameterArray.find(function(e){return e.model.get("name")===t}),o=void 0,i&&(o=n.model.get("options"))&&"Select"===o.format?(o.schema.options=i,n.model.set("value",e,{silent:!0}),n.onTypeChanged()):n.model.set("value",e))},n.prototype.updateUI=function(){var e="hidden",e=[{name:"pipeline",type:"symbol",options:this.useDropdowns?{cssClass:"pipelineWatermark "+(this.useDropdowns?"":e),format:"Select",schema:{showSearch:!0,tooltipItemLimit:20,width:"100%"}}:{schema:{},tooltip:"e.g. packageName-pipelineName"},required:!0,value:""},{name:"pipelineId",type:"symbol",options:{cssClass:e},value:""},{name:"pipelineName",type:"symbol",options:{cssClass:e},value:""},{name:"table",type:"symbol",options:this.useDropdowns?{cssClass:"tableWatermark",format:"Select",schema:{showSearch:!0,tooltipItemLimit:20,width:"100%"}}:{schema:{}},required:!0,value:""},{name:"filters",options:{triggerChangeOnBlurEvent:!0,cssClass:"jsonNotation",tooltip:'Enter your filter criteria using JSON format (e.g. {"sym": "FDPL", "bsize": [2, 3]})'},type:"symbol",value:""},{name:"version",options:{cssClass:e},type:"symbol",value:"v1"}];this.generateStreamingParamsObject(e)},n.PERMISSION_REQUIRED_TEXT='You are missing required roles: "insights.pipeline.subscriber.nodes", "insights.query.stream"',n.SP_PORT_WARNING="Unable to load available pipelines with the selected connection, check if the SP Port is set and open",n}(Backbone.View),DataConfigMappingItem=function(i){function e(e){var t=i.call(this,_.extend(e,{tagName:"div"}))||this;return t.tagName="tr",t.dataMapper=e.dataMapper,t.openViewStateDialog=e.openViewStateDialog,t.setSelectClasses=e.setSelectClasses,t.render(),t.initializeEvents(),t.onModelMappingKeyChange(),t}return __extends(e,i),e.prototype.initializeEvents=function(){this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"change:key",this.onModelMappingKeyChange),this.listenTo(this.model,"change:value",this.onModelMappingValueChange),this.$removeMapping.click(this.onRemoveMapping.bind(this)),this.$keySelect.on("select2:select",function(e){this.model.set("key",e.params.data.id)}.bind(this)),this.$keySelect.on("select2:open",this.setSelectClasses)},e.prototype.onModelMappingKeyChange=function(){this.model.set("value",this.dataMapper.getValue(this.model.get("key")))},e.prototype.onModelMappingValueChange=function(){this.$value.text(this.model.get("value"))},e.prototype.onRemoveMapping=function(){this.model.destroy()},e.prototype.onResize=function(){},e.prototype.remove=function(){return Backbone.View.prototype.remove.call(this)},e.prototype.render=function(){return this.$el.html(T.DataConfigMappingItem(this.model.toJSON())),this.$keySelect=this.$el.find(".key-select"),this.$removeMapping=this.$el.find(".remove-mapping"),this.$value=this.$el.find(".value"),this.$viewState=this.$el.find(".view-state"),this.$keySelect.select2({tags:!0,theme:"dashboards",width:"100%"}),this.$removeMapping.button({icon:"fa fa-minus",text:!1,showLabel:!1}),this.viewStateEditor=new Backbone.Form.editors.ViewState({id:_.uniqueId("date_"),key:"viewstate",model:this.model,openViewStateDialog:this.openViewStateDialog}).render(),this.viewStateEditor.on("change",function(){this.model.set("viewstate",this.viewStateEditor.getValue())}.bind(this)),this.setSelectOptions(),this.$viewState.append(this.viewStateEditor.el),this},e.prototype.setSelectOptions=function(){var e=_.union([this.model.get("key")],this.dataMapper.getPossibleKeys());this.$keySelect.empty(),_.each(e,function(e){this.$keySelect.append(new Option(e,e,!0,!0))}.bind(this)),this.$keySelect.val(this.model.get("key")).trigger("change")},e}(Backbone.View),DataConfigMapping=function(i){function e(e){var t=i.call(this,e)||this;return t.tagName="div",t.dataMapper=e.dataMapper,t.docDataModel=e.docDataModel,t.docViewModel=e.docViewModel,t.dialogContainer=e.dialogContainer,t.components=e.components,t.componentDefs=e.componentDefs,t.isEmbedded=e.isEmbedded,t.model=t.dataMapper.model,t.mappings=t.dataMapper.mappings,t.viewModel=new Backbone.Model,t.render(),t.setSelectOptions(),t.initializeEvents(),t.onModelMappingKeyChange(),t.onModelMappingValueChange(),require(["Datagrid"]),t}return __extends(e,i),e.prototype.initializeEvents=function(){this.listenTo(this.dataMapper,"key-change",this.onModelMappingKeyChange),this.listenTo(this.dataMapper,"mappings-change",this.renderMappings),this.listenTo(this.dataMapper,"on-data",this.onData),this.listenTo(this.dataMapper,"value-change",this.onModelMappingValueChange),this.$keySelect.on("select2:select",function(e){this.model.set("key",e.params.data.id)}.bind(this)),this.$valueSelect.on("select2:select",function(e){this.model.set("value",e.params.data.id)}.bind(this)),this.$keySelect.on("select2:open",this.setSelectClasses),this.$valueSelect.on("select2:open",this.setSelectClasses),this.$addMapping.click(_.bind(this.dataMapper.addMapping,this.dataMapper)),this.$resetMapping.click(_.bind(this.dataMapper.resetMappings,this.dataMapper))},e.prototype.onData=function(){this.setSelectOptions(),this.renderMappings()},e.prototype.onModelMappingKeyChange=function(){this.$keySelect.val(this.model.get("key")).trigger("change"),_.each(this.mappingViews,function(e){e.setSelectOptions()}.bind(this))},e.prototype.onModelMappingValueChange=function(){this.$valueSelect.val(this.model.get("value")).trigger("change")},e.prototype.onResize=function(){this.setScrollClasses()},e.prototype.openViewStateDialog=function(e,t){new ViewStateDialog({dialogContainer:this.dialogContainer,docDataModel:this.docDataModel,model:this.docViewModel,components:this.components,componentDefs:this.componentDefs,isEmbedded:this.isEmbedded,path:e,selectCallback:function(e){e=this.docViewModel.getByPath(e);t(e)}.bind(this)}),$(".viewstate-dialog").css("z-index",102)},e.prototype.remove=function(){return this.$keySelect.data("select2")&&this.$keySelect.select2("destroy"),this.$valueSelect.data("select2")&&this.$valueSelect.select2("destroy"),this.dataMapper.setSubscription(!1),Backbone.View.prototype.remove.call(this)},e.prototype.removeMapping=function(e){this.dataMapper.removeMapping(e)},e.prototype.render=function(e){return this.$el.html(T.DataConfigMapping({theme:"kx-light"!==$.cookie("dashboard-theme")?"Dark":"Light",singleValue:e})),this.$addMapping=this.$el.find(".add-mapping"),this.$mappings=this.$el.find(".table-body"),this.$mappingTable=this.$el.find(".mapping-table"),this.$keySelect=this.$el.find(".key-select"),this.$resetMapping=this.$el.find(".reset-mapping"),this.$valueSelect=this.$el.find(".value-select"),this.$addMapping.button({icon:"fa fa-plus",text:!1,showLabel:!1}),this.$resetMapping.button({icon:"fa fa-undo",text:!1,showLabel:!1}),this.$keySelect.select2({theme:"dashboards",width:"100%"}),this.$valueSelect.select2({theme:"dashboards",width:"100%"}),this.renderMappings(),this},e.prototype.renderMappings=function(){_.each(this.mappingViews,function(e){this.stopListening(e.model),e.remove()}.bind(this)),this.mappingViews=[],this.dataMapper.mappings.each(function(e,t){t=new DataConfigMappingItem({className:"slick-row "+(t%2==0?"even":"odd"),dataMapper:this.dataMapper,model:e,openViewStateDialog:this.openViewStateDialog.bind(this),setSelectClasses:this.setSelectClasses.bind(this)});this.listenTo(e,"destroy",this.removeMapping),this.mappingViews.push(t),this.$mappings.append(t.$el)}.bind(this)),this.setScrollClasses()},e.prototype.setScrollClasses=function(){this.$mappingTable.toggleClass("has-scrollbar",this.$mappings.get(0).scrollHeight>Math.round(this.$mappings.height()))},e.prototype.setSelectClasses=function(){$("body > .select2-container--dashboards.select2-container--open").addClass("select2--environment")},e.prototype.setSelectOptions=function(){var e=_.union([this.model.get("key"),this.model.get("value")],this.dataMapper.getColumns());this.$keySelect.empty(),this.$valueSelect.empty(),_.each(e,function(e,t){this.$keySelect.append(new Option(e,e,0===t,this.model.get("key")===e)),this.$valueSelect.append(new Option(e,e,0===t,this.model.get("value")===e))}.bind(this)),this.$keySelect.trigger("change"),this.$valueSelect.trigger("change")},e}(Backbone.View),ConnectionManagement=function(o){function e(e){var i=o.call(this,_.extend(e,{className:"connectionManagementPanel"}))||this,n=(i.currentTab="Individual",i.currentConnection="",i.currentGroup="",i.currentServices="",i.isCreatingGroup=!1,i.isCreatingSingle=!1,i.isLite=!1,i.connections=e.appModel.get("connections"),i.connectionGroups=e.appModel.get("connectionGroups"),i.services=e.appModel.get("services"),i.docViewModel=e.docViewModel,i.launchObject=e.launchObject,i.isLite=e.appModel.get("isLite"),i.dashEngine=e.appModel.get("dashEngine"),{singleConnectionsId:_.uniqueId("connectionsTab_"),groupConnectionsId:_.uniqueId("connectionsTab_"),serivcesTabId:_.uniqueId("connectionsTab_"),isLite:i.isLite,isDirectMode:i.dashEngine.isDirectMode(),DATA_SOURCE_insightsSDK:QuickBase.Dash.DATA_SOURCE_insightsSDK});return i.$el.html(T.ConnectionManagement(n)),i.dashEngine.isDeltaMode()&&i.$("select.type").parent().hide(),i.setDOMObjects(),i.$dialog=i.$el.dialog({appendTo:e.container,classes:{"ui-dialog":"quick-dash new-connection-panel"},modal:!0,resizable:!1,title:"Connection Management",height:400,width:600,create:function(){i.$editButtons=$(i).parent().find(".ui-dialog-buttonset").children(),i.$editButtons=i.$editButtons.slice(0,i.$editButtons.length-1),i.initializeDialogDisplay()},close:function(){i.remove()},buttons:[{text:t("New"),click:i.onBtnNewClick.bind(i),icon:"fa fa-plus"},{text:t("Duplicate"),click:i.onBtnDuplicateClick.bind(i),icon:"fa fa-copy"},{text:t("Delete"),click:i.onBtnDeleteClick.bind(i),icon:"fa fa-trash-o"},{text:t("Test"),click:i.onBtnTestClick.bind(i),icon:"fa fa-flask"},{text:t("Save"),click:i.onBtnSaveClick.bind(i),icon:"fa fa-floppy-o"},{text:t("Close"),click:i.remove.bind(i),icon:"fa fa-times"}]}),i.positionDialog(),i.createStatusBar(),i.$el.find(".type").change(function(e){i.onTypeChange(i.$el.find(".type").val())}),i}return __extends(e,o),e.prototype.openDialog=function(){var e,t,i;this.positionDialog(),this.$dialog.dialog("open"),this.launchObject&&(i=t=e=void 0,(e=this.connections.get(this.launchObject))?(this.currentConnection=this.launchObject,i="connection",t=0):this.connectionGroups&&((e=this.connectionGroups.get(this.launchObject))?(this.currentGroup=this.launchObject,i="group",t=1):(e=this.services.get(this.launchObject))&&(this.currentServices=this.launchObject,i="services",t=2)),e)&&void 0!==t&&(this.$el.find(".connectionsTabs").tabs({active:t}),this.launchObject="",this.setSelectedRows(),this.loadConnectionDetails(i,e.id))},e.prototype.remove=function(){return this.$el.dialog("close"),this.multiselectDatagridWrapper&&this.multiselectDatagridWrapper.remove(),this.groupDatagridAppWrapper&&this.groupDatagridAppWrapper.remove(),this.datagridAppWrapper&&this.datagridAppWrapper.remove(),this.trigger("onRemove"),Backbone.View.prototype.remove.call(this)},e.prototype.setDOMObjects=function(){this.$statusBar=this.$el.find(".statusBar"),this.$connectionDetailsPanel=this.$el.find(".connectionDetailsPanel"),this.$groupDetailsPanel=this.$el.find(".groupDetailsPanel")},e.prototype.setSelectedRows=function(){this.datagridAppWrapper.app&&this.datagridAppWrapper.app.grid&&this.selectedConnection.set("value",this.currentConnection),this.connectionGroups&&this.datagridAppWrapper.app&&this.groupDatagridAppWrapper.app.grid&&this.selectedGroup.set("value",this.currentGroup),this.services&&this.serviceDatagridAppWrapper&&this.serviceDatagridAppWrapper.app&&this.serviceDatagridAppWrapper.app.grid&&this.selectedServices.set("value",this.currentServices)},e.prototype.disableNewDuplicateEditButtons=function(){$(this.$editButtons[0]).button("disable"),$(this.$editButtons[1]).button("disable"),$(this.$editButtons[2]).button("disable")},e.prototype.enableNewDuplicateEditButtons=function(){$(this.$editButtons[0]).button("enable"),$(this.$editButtons[1]).button("enable"),$(this.$editButtons[2]).button("enable")},e.prototype.getTheme=function(){return"kx-light"===$.cookie("dashboard-theme")?"Light":"Dark"},e.prototype.onBtnNewClick=function(){switch(this.disableNewDuplicateEditButtons(),this.currentTab){case"Individual":return this.setTitle("Connection Management: New Connection"),this.isCreatingSingle=!0,this.$connectionDetailsPanel.show(),this.$groupDetailsPanel.hide(),this.enableInputs("connection"),this.$el.find(".saveConnectionBtn").show(),void this.$el.find(".cancelBtn").show();case"Groups":return this.setTitle("Connection Management: New Connection Group"),this.isCreatingGroup=!0,this.$groupDetailsPanel.show(),this.$connectionDetailsPanel.hide(),this.multiSelection.set("value",[]),this.enableInputs("group"),this.$el.find(".saveGroupBtn").show(),this.$el.find(".cancelBtn").show(),void this.$el.find(".groupName").prop("disabled","")}},e.prototype.onBtnDeleteClick=function(){switch(this.currentTab){case"Individual":return void this.deleteConnectionConfirm(this.deleteConnection.bind(this),this.$connectionDetailsPanel.find(".title")[0].innerText);case"Groups":return void this.deleteConnectionConfirm(this.deleteGroup.bind(this),this.$groupDetailsPanel.find(".title")[0].innerText)}},e.prototype.onBtnSaveClick=function(){this.enableNewDuplicateEditButtons(),this.$el.find(".groupName").prop("disabled","disabled"),this.isCreatingSingle||this.isCreatingGroup?"Individual"===this.currentTab?this.createConnection():(this.createGroup(),this.isCreatingGroup=!1):"Individual"===this.currentTab?this.editConnection():this.editGroup()},e.prototype.onBtnTestClick=function(){function e(e){t.showError("Test failed: ",e),c=!1}var t=this,i="test_"+(new Date).getTime()+this.$connectionDetailsPanel.find(".name").val(),n=this.$connectionDetailsPanel.find(".password").val(),o=this.$connectionDetailsPanel.find(".confirmPassword").val(),a=this.$connectionDetailsPanel.find(".type option:selected").val(),s=QuickBase.KdbQuery.testConnectionQuery,l=this.isLite?{}:new win.ConnectionEntity,r=function(t){return new Promise(function(e){return setTimeout(e,t)})},c=!0;n!==o?this.showError("Passwords not matching",""):(l.name=i,l.host=this.$connectionDetailsPanel.find(".host").val(),l.port=this.$connectionDetailsPanel.find(".port").val(),l.user=this.$connectionDetailsPanel.find(".user").val(),l.password=n,l.type=_.isNil(a)?"q":a,l.driver=this.$connectionDetailsPanel.find(".driver").val(),l.tls=this.$el.find(".tls").is(":checked")?"on":"off",this.isLite?(l.type===QuickBase.Dash.DATA_SOURCE_insightsSDK&&(l.qipcport=this.$connectionDetailsPanel.find(".qipcport").val()),QuickBase.DashClientLib.testConnection(l,function(){QuickBase.DashClient.getQueryData2(l.type,i,s,[],function(){t.showMessageAndRefresh("Test succeed: Connection OK"),QuickBase.DashClientLib.deleteConnection(i),c=!1},function(e){e=0<e.length?e[0]:"";t.showError("Test failed: ",e),QuickBase.DashClientLib.deleteConnection(i),c=!1})},e)):QuickBase.DeltaClientLib.testConnection(l,function(){QuickBase.DeltaClientLib.getQueryData(l.type,i,s,[],function(){t.showMessageAndRefresh("Test succeed: Connection OK"),QuickBase.DeltaClientLib.deleteConnection(i),c=!1},function(e){e=0<e.length?e[0]:"";t.showError("Test failed: ",e),QuickBase.DeltaClientLib.deleteConnection(i),c=!1})},e),__awaiter(t,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,r(2500)];case 1:return e.sent(),c&&(this.showError("Test failed - ","Failed to connection"),(this.isLite?QuickBase.DashClientLib:QuickBase.DeltaClientLib).deleteConnection(i)),[2]}})}))},e.prototype.onBtnDuplicateClick=function(){switch(this.currentTab){case"Individual":return void this.createConnection(!0);case"Groups":return void this.createGroup(!0)}},e.prototype.createConnection=function(e){var i,n,o=this,a=this.$connectionDetailsPanel.find(".name").val()+(e?" (Copy)":""),e=this.$connectionDetailsPanel.find(".password").val(),s=this.$connectionDetailsPanel.find(".confirmPassword").val();this.isLite&&!/^[a-zA-Z0-9]+$/.test(a)?this.showError("Please create connections with Alphanumeric characters only.",""):e!==s?this.showError("Password and password confirmation don't match.",""):(i=(s=this.getHostPortDriver()).host,n=s.port,s=s.driver,i={name:a,host:i,port:n,user:this.$connectionDetailsPanel.find(".user").val(),password:e,type:this.$connectionDetailsPanel.find(".type option:selected").val(),driver:s,tls:this.$el.find(".tls").is(":checked")?"on":"off"},(n=this.$connectionDetailsPanel.find(".qipcport").val())&&(i.qipcport=n),this.connections.create(i,{success:function(){o.isCreatingSingle=!1,o.currentConnection=a,o.populateConnectionsList(),o.populateConnectionGroupsList(),o.showMessageAndRefresh("Connection created successfully"),o.isCreatingSingle=!1},error:function(e){return o.showError(t("Error creating connection."),e)}}))},e.prototype.getHostPortDriver=function(){var e=this.$connectionDetailsPanel.find(".type option:selected").val(),t=this.$connectionDetailsPanel.find(".database").val(),i=this.$connectionDetailsPanel.find(".host").val(),n=this.$connectionDetailsPanel.find(".port").val(),o=this.$connectionDetailsPanel.find(".driver").val();switch(e){case"jdbc:com.mysql.jdbc.Driver":i="jdbc:mysql://"+i+":"+n+"/"+t+"?socketTimeout=35000",n=0,o="";case"jdbc:oracle.jdbc.OracleDriver":i="jdbc:oracle:thin:@"+i+":"+n+":"+t,n=0,o="";case"jdbc:com.microsoft.sqlserver.jdbc.SQLServerDriver":i="jdbc:sqlserver://"+i+":"+n+";databaseName="+t+";",n=0,o="",this.$el.find(".integratedSecurity").is(":checked")&&(i+="integratedSecurity=true;");case"daemon":n=0}return{host:i,port:n,driver:o}},e.prototype.createGroup=function(e){for(var i=this,n=e?this.$el.find(".groupName").val()+" (copy)":this.$el.find(".groupName").val(),o=this.multiSelection.get("value"),a=[],e=this.$el.find(".groupType").val(),s=0;s<o.length;s+=1)a.push("primary");new QuickBase.ConnectionGroup({name:n,type:e,connections:o,connectionsType:a}).sync("create",this.connectionGroups,{success:function(e){i.currentGroup=n,i.isCreatingGroup=!1,i.populateConnectionGroupsList(),i.showMessageAndRefresh("Connection group created successfully"),Log.Info("success",e)},error:function(e){return i.showError(t("Error creating connection group."),e)}})},e.prototype.createStatusBar=function(){var e=(1e6*Math.random()).toFixed()+"-statusBar",t=document.createElement("div");t.classList.add("statusBar"),t.classList.add(e),this.$el[0].parentElement.appendChild(t),this.$statusBar=$("."+e)},e.prototype.deleteConnectionConfirm=function(e,i){QuickBase.ConfirmDialog.ShowConfirm({callback:function(){e&&e(i)},renderTemplate:function(){return t("Are you sure you want to delete connection/Group?")},container:this.$el})},e.prototype.deleteConnection=function(e){var i=this;this.connections.get(e).destroy({success:function(e){i.populateConnectionsList(),i.populateConnectionGroupsList(),i.showMessageAndRefresh("Connection deleted successfully"),Log.Info("success",e)},error:function(e){return i.showError(t("Error deleting connection."),e)}})},e.prototype.deleteGroup=function(e){var i=this;this.connectionGroups.get(e).destroy({success:function(e){i.populateConnectionGroupsList(),i.showMessageAndRefresh("Connection group deleted successfully"),Log.Info("success",e)},error:function(e){i.showError(t("error creating connection group."),e)}})},e.prototype.editConnection=function(){var e,i,n,o,a=this,s=this.getInputValue(".password");s!==this.getInputValue(".confirmPassword")?this.showError("Password and password confirmation don't match.",""):(e=this.currentConnection,i=this.getInputValue("input.name"),this.isLite&&!/^[a-zA-Z0-9]+$/.test(i)?this.showError("Can not edit the Connection. Please add Alphanumeric characters only.",""):(s=this.buildConnectionPayload(i,e,s),n=function(){a.populateConnectionsList(),a.populateConnectionGroupsList(),a.setSelectedRows(),a.showMessageAndRefresh("Connection edited successfully")},o=function(e){return a.showError(t("Error editing connection."),e)},(this.currentConnection=i)===e?this.connections.get(e).save(s,{success:n,error:o}):(this.deleteConnection(e),this.connections.create(s,{success:n,error:o}))))},e.prototype.getInputValue=function(e){return this.$connectionDetailsPanel.find(e).val()},e.prototype.buildConnectionPayload=function(e,t,i){var n=this.getHostPortDriver(),o=n.host,a=n.port,n=n.driver,e={name:e,originalName:t,host:o,port:a,user:this.getInputValue("input.user"),password:i,type:this.$el.find(".type option:selected").val(),driver:n,tls:this.$el.find(".tls").is(":checked")?"on":"off"},t=this.$connectionDetailsPanel.find(".qipcport").val();return t&&(e.qipcport=t),e},e.prototype.editGroup=function(){var i=this,e=this.multiSelection.get("value"),e={name:this.$el.find(".groupName").val(),originalName:this.currentGroup,connections:e,type:this.$el.find(".groupType").val()};this.connectionGroups.get(e.originalName).save(e,{success:function(){i.populateConnectionGroupsList(),i.showMessageAndRefresh("Connection edited successfully")},error:function(e){return i.showError(t("Error editing connection group."),e)}})},e.prototype.enableInputs=function(e){"connection"===e?(this.$connectionDetailsPanel.find(".title").text(t("New Connection")),this.$connectionDetailsPanel.find("input").removeAttr("readonly"),this.$connectionDetailsPanel.find("input").val(""),this.$connectionDetailsPanel.find("select").removeAttr("disabled"),this.$connectionDetailsPanel.find(".tls").removeAttr("disabled")):"group"===e&&(this.$groupDetailsPanel.find(".title").text(t("New Group")),this.$groupDetailsPanel.find("input").removeAttr("readonly").val(""),this.$groupDetailsPanel.find("select").removeAttr("disabled"),this.$el.find(".multipleSelect").show())},e.prototype.initializeDialogDisplay=function(){var i,n=this;this.connectionGroups?(this.populateConnectionGroupsList(),i=$(".ui-dialog-buttonpane >.ui-dialog-buttonset > button:has(.fa-flask)"),this.$el.find(".connectionsTabs").tabs({active:0,activate:function(e,t){n.currentTab=t.newTab[0].innerText,n.$editButtons.each(function(e,t){$(t).button("enable")}),"Groups"===n.currentTab?($(i[0]).css({display:"none"}),n.$groupDetailsPanel.show(),n.groupDatagridAppWrapper.app.onResize(),n.multiselectDatagridWrapper.app.onResize(),n.setTitle("Connection Management: "+n.currentGroup),n.isCreatingGroup&&(n.disableNewDuplicateEditButtons.call(n),n.setTitle("Connection Management: New Connection Group"))):0===n.currentTab.localeCompare("Services")?($(i[0]).css({display:"none"}),n.setTitle("Connection Management"),n.$editButtons.each(function(e,t){$(t).button("disable")}),n.serviceDatagridAppWrapper.app.onResize()):($(i[0]).css({display:"inline-block"}),n.$connectionDetailsPanel.show(),n.setTitle("Connection Management: "+n.currentConnection),n.datagridAppWrapper.app.onResize(),n.isCreatingSingle&&(n.disableNewDuplicateEditButtons(),n.setTitle("Connection Management: New Connection")))}})):(this.$el.find(".connectionsTabs > ul").hide(),this.$el.find(".connectionsList").css("top","-8px"),this.populateConnectionsList())},e.prototype.loadConnectionDetails=function(e,t){var i;"group"===e?(i=this.connectionGroups.get(t)||this.connectionGroups.first(),this.$el.find(".groupDetailsPanel").show(),this.currentGroup=i?i.get("name"):null):(i=this.connections.get(t)||this.connections.first(),this.$connectionDetailsPanel.show(),i&&this.onTypeChange(i.get("type")),this.currentConnection=i?i.get("name"):null),i&&this.populateDetailsPanel(e,i.attributes)},e.prototype.onTypeChange=function(e){function i(){n.$el.find(".port").siblings("label").text(t("Port:")),n.$el.find(".qipcportRow").hide(),n.$el.find(".tls").siblings("label").text(t("TLS:"))}var n=this,o=".userRow, .passwordRow, .confirmPasswordRow";_.includes(["q","daemon",QuickBase.Dash.DATA_SOURCE_insightsSDK],e)?(this.$el.find(".databaseRow").hide(),this.$el.find(".integratedSecurityRow").hide(),_.includes([QuickBase.Dash.DATA_SOURCE_insightsSDK],e)?(this.$el.find(".port").siblings("label").text(t("SG Streaming Port (http):")),this.$el.find(".qipcportRow").show(),this.$el.find(".tls").siblings("label").text(t("HTTPS:")),this.$el.find(o).hide()):(i(),this.$el.find(o).show())):(this.$el.find(".databaseRow").show(),"jdbc:com.microsoft.sqlserver.jdbc.SQLServerDriver"===e?this.$el.find(".integratedSecurityRow").show():this.$el.find(".integratedSecurityRow").hide(),i(),this.$el.find(o).show())},e.prototype.parseJdbcHost=function(e,t){var i,n,o,a,s,e=e.host,l=!1,r="database";"jdbc:com.mysql.jdbc.Driver"===this.$el.find(".type").val()?(i="jdbc:mysql://",s="mysql"):"jdbc:oracle.jdbc.OracleDriver"===this.$el.find(".type").val()?(i="jdbc:oracle:thin:@",s="oracle"):"jdbc:com.microsoft.sqlserver.jdbc.SQLServerDriver"===this.$el.find(".type").val()&&(i="jdbc:sqlserver://",s="mssql"),"mssql"!==s?(n=(e=e.substring(i.length)).split(":")[0],o=e.split(":")[1].split("/")[0],"mysql"===s?a=e.split(":")[1].split("/")[1].split("?")[0]:(a=e.split(":")[2],r="SID")):(n=(e=e.substring(i.length)).split(":")[0],o=e.split(":")[1].split(";")[0],a=e.split(":")[1].split("=")[1],2<e.split(":").length&&(l=-1<e.split(":")[2].indexOf("true"))),t.find(".integratedSecurity").prop("checked",l),t.find(".databaseRow label").text(r+":"),t.find(".host").val(n),t.find(".port").val(o),t.find(".database").val(a)},e.prototype.populateConnectionsList=function(){var n=this,o=this.$el.find(".singleConnectionsList ul");require(["Datagrid"],function(e){var i=new QuickBase.DocumentDataModel({_subscriptionKey:"name",_dataType:"copy",_maxRows:1e5},null,null,n.docViewModel),e=(i.apply(),n.selectedConnection=new QuickBase.DocumentViewModel({_default:n.currentConnection,_viewType:!0,_type:"symbol",value:n.currentConnection},{}),n.selectedConnection.path="dg_connection",n.listenTo(n.selectedConnection,"change:value",function(e,t){n.enableNewDuplicateEditButtons(),n.isCreatingSingle=!1,t&&(n.loadConnectionDetails("connection",t),n.currentConnection=t)}),e.getSettingsModel({Basics:{Data:i,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:[e.getColumnSettingsModel({Field:"name",TextAlign:"left"})],Selection:{Mode:"Single Row",RowSelectionColumn:"name",SelectedValue:n.selectedConnection,FollowSelectedValue:!0},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Style:{FontSize:"11px",RowHeight:20,HeaderRowHeight:20}}));n.datagridAppWrapper=new QuickBase.AppView({el:n.$el.find(".singleConnectionsListGrid")[0],key:"Datagrid",settings:e,dashboardViewModel:new Backbone.Model({DashboardTheme:n.getTheme()}),dashboardAppModel:new Backbone.Model,docViewModel:n.docViewModel,deltaClient:null,callback:function(){n.connections.fetch({success:function(e){var t=e.map(function(e){return e.get("name")}).map(function(e){return'<li data-type="connection" data-value="'+_.escape(e)+'"><span class="conn_title">'+e+'</span><span class="deleteItem fa fa-trash-o"></li>'}).join("\n");o.html(""),o.append(t),i.onExecuteSuccess({class:"",columns:["name"],meta:{name:11},rows:e.map(function(e){return e.attributes})},!0),n.$el.find(".ui-state-default.slick-headerrow-column.l0.r0 input")[0].setAttribute("placeholder","search connections..."),n.populateMultiSelect()},error:function(e){return alert(e)}})}})},function(e){console.log("DataConfigAnalytic.js: Datagrid initialization error",e)})},e.prototype.populateConnectionGroupsList=function(){var n=this,o=this.$el.find(".groupConnectionsList ul");this.connectionGroups&&require(["Datagrid"],function(e){var i=new QuickBase.DocumentDataModel({_subscriptionKey:"name",_dataType:"copy",_maxRows:1e5},null,null,null),e=(i.apply(),n.selectedGroup=new QuickBase.DocumentViewModel({_default:n.currentGroup,_viewType:!0,_type:"symbol",value:n.currentGroup},{}),n.selectedGroup.path="dg_group",n.listenTo(n.selectedGroup,"change:value",function(e,t){n.enableNewDuplicateEditButtons.call(n),n.$el.find(".groupName").prop("disabled","disabled"),n.isCreatingGroup=!1,t&&(n.loadConnectionDetails("group",t),n.currentGroup=t)}),e.getSettingsModel({Basics:{Data:i,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:[e.getColumnSettingsModel({Field:"name",TextAlign:"left"})],Selection:{Mode:"Single Row",RowSelectionColumn:"name",SelectedValue:n.selectedGroup,FollowSelectedValue:!0},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Style:{FontSize:"11px",RowHeight:20,HeaderRowHeight:20}}));n.groupDatagridAppWrapper=new QuickBase.AppView({el:n.$el.find(".groupConnectionListGrid")[0],key:"Datagrid",settings:e,dashboardViewModel:new Backbone.Model({DashboardTheme:n.getTheme()}),dashboardAppModel:new Backbone.Model,docViewModel:n.docViewModel,deltaClient:null,callback:function(){n.connectionGroups.fetch({success:function(e){var t=e.map(function(e){return'<li data-type="group" data-value="'+_.escape(e.get("name"))+'"><span class="conn_title">'+e.get("name")+":</span> ("+e.get("connections").join(", ")+') <span class="deleteItem fa fa-trash-o"></span></li>'}).join("\n");o.html(t),i.onExecuteSuccess({class:"",columns:["name"],meta:{name:11},rows:e.map(function(e){return e.attributes})},!0),n.populateConnectionsList()}})}})},function(e){console.log("DataConfigAnalytic.js: Datagrid initialization error",e)})},e.prototype.populateDetailsPanel=function(e,t){var i=this.$groupDetailsPanel,n=this.$connectionDetailsPanel;switch(this.setTitle("Connection Management: "+this.currentTab=="Groups"?this.currentGroup:this.currentConnection),e){case"group":i.find(".title").text(t.name),i.find(".groupName").val(t.name),i.find(".groupType").val(t.type),i.find(".multipleSelect select").val(t.connections),this.multiSelection.set("value",t.connections);break;case"connection":if(t.confirmPassword="",n.find(".title").text(t.name),_.each(_.keys(t),function(e){"type"===e&&"deltaclient"===t[e]&&(t[e]="q"),"tls"===e?n.find("."+e).prop("checked","on"===t[e]):n.find("."+e).val(t[e])}),"q"!==t.type&&"daemon"!==t.type&&t.type!==QuickBase.Dash.DATA_SOURCE_insightsSDK)try{this.parseJdbcHost(t,n)}catch(e){console.error("Failed to Parse Jdbc Host: ",e)}n.find(".saveConnectionBtn").hide()}},e.prototype.populateMultiSelect=function(){var i=this;require(["Datagrid"],function(e){var t=new QuickBase.DocumentDataModel({_subscriptionKey:"name",_dataType:"copy",_maxRows:1e5},null,null,null),e=(t.apply(),i.multiSelection=new QuickBase.DocumentViewModel({_default:[],_viewType:!0,_type:"list",value:[]},{}),i.multiSelection.path="dg_multiselect",e.getSettingsModel({Basics:{Data:t,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:[e.getColumnSettingsModel({Field:"name",TextAlign:"left"})],Selection:{Mode:"Multi Row",CheckboxAlignment:"left",RowSelectionColumn:"name",SelectedValue:i.multiSelection,FollowSelectedValue:!0},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Style:{FontSize:"11px",RowHeight:20,HeaderRowHeight:20}}));i.multiselectDatagridWrapper=new QuickBase.AppView({el:i.$groupDetailsPanel.find(".multipleSelect")[0],key:"Datagrid",settings:e,dashboardViewModel:new Backbone.Model({DashboardTheme:i.getTheme()}),dashboardAppModel:new Backbone.Model,docViewModel:i.docViewModel,deltaClient:QuickBase.DeltaClientLib.deltaClient,callback:function(){i.connections.fetch({success:function(e){t.onExecuteSuccess({class:"",columns:["name"],meta:{name:11},rows:e.map(function(e){return e.attributes})},!0),i.setSelectedRows(),i.loadConnectionDetails("connection",i.currentConnection),i.connectionGroups&&i.loadConnectionDetails("group",i.currentGroup),i.services?i.populateServicesList():i.launchObject&&i.openDialog()},error:function(e){alert(e)}})}})},function(e){console.log("DataConfigAnalytic.js: Datagrid initialization error",e)})},e.prototype.populateServicesList=function(){var i=this;require(["Datagrid"],function(e){var t=new QuickBase.DocumentDataModel({_subscriptionKey:"name",_dataType:"copy",_maxRows:1e5},null,null,null),e=(i.selectedServices=new QuickBase.DocumentViewModel({_default:i.currentServices,_viewType:!0,_type:"symbol",value:i.currentServices},null),i.selectedServices.path="dg_services",t.apply(),e.getSettingsModel({Basics:{Data:t,Filtering:"Column Filters",ShowPagingControl:!1,EnableGrouping:!1},ColumnsConfiguration:[e.getColumnSettingsModel({Field:"name",TextAlign:"left"})],Selection:{Mode:"Single Row",RowSelectionColumn:"name",SelectedValue:i.selectedServices,FollowSelectedValue:!0},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1},Style:{FontSize:"11px",RowHeight:20,HeaderRowHeight:20}}));i.serviceDatagridAppWrapper=new QuickBase.AppView({el:i.$el.find(".servicesListGrid")[0],key:"Datagrid",settings:e,dashboardViewModel:new Backbone.Model({DashboardTheme:i.getTheme()}),dashboardAppModel:new Backbone.Model,docViewModel:i.docViewModel,deltaClient:null,callback:function(){i.services.fetch({success:function(e){t.onExecuteSuccess({class:"",columns:["name"],meta:{name:11},rows:e.map(function(e){return e.attributes})},!0)}})}})})},e.prototype.positionDialog=function(){var e=QuickBase.Tools.calcDialogHeight(400,"dataDialog"),t=e<400?"top":"center";"FSBL"in window&&this.$dialog.parent().css("margin-top",window.finApi.DIALOGS_TOP_MARGIN),this.$dialog.dialog("option","height",e),this.$dialog.dialog("option","position",{my:"center",at:t,of:"#appdiv",collision:"fit"})},e.prototype.setTitle=function(e){this.$dialog.parent().find(".ui-dialog-title").text(e)},e.prototype.showError=function(e,i){var n=this;"string"==typeof i?this.$statusBar.text(e+" "+t("Error")+': "'+i+'"'):this.$statusBar.text(e),this.$statusBar.css({opacity:1,"background-color":"#ED3054"}),_.delay(function(){return n.$statusBar.css("opacity",0)},3500),_.delay(function(){n.$statusBar.css({"background-color":"#62BA62"})},4e3)},e.prototype.showMessageAndRefresh=function(e){var i=this;this.trigger("RefreshConnectionList"),this.$statusBar.text(t(e)),this.$statusBar.css({opacity:1}),_.delay(function(){return i.$statusBar.css({opacity:0})},3500)},e}(Backbone.View),DataConfigForm=Backbone.View.extend({$dataDiv:null,$rawDataView:null,$queryStatus:null,$connectionTypeSelect:null,$connectionSelect:null,dataTableDisplay:null,$newConnectionGroupBtn:null,$qeInfoText:null,appModel:null,components:null,data:{},className:"data-config-dialog",connectionManagementPanel:null,DATA_SOURCE_PROP:"_dataSource",DATA_TYPE_PROP:"_dataType",LAYOUT_PROP:"_layout",MAXROWS_PROP:"_maxRows",PAGESIZE_PROP:"_pageSize",PAGINGTYPE_PROP:"_pagingType",PIVOT_TYPE_PROP:"_pivotType",QUERY_STR_PROP:"_queryString",CONNECTION_PROP:"_connection",CONNECTION_VS_PROP:"_connection_Viewstate",SERVER_PAGING_PROP:"_serverPaging",SUBCRIPTION_PROPERTY:"_subscriptionType",HAS_UPDATE_PROP:"_hasUpdateQuery",UPDATE_TYPE_PROP:"_updateType",PREVIEW_MAX_ROWS:2e3,resultsType:"preview",subscriptionSz:34,hasPermission_insightsStreaming:!1,hasSubscribed:!1,PYTHON_NOT_AVAILABLE_MSG:"Python integration not available, requires loading of pykx on q server, See docs for more information",initialize:function(e){var t=this,i=(t.appModel=e.appModel,t.connections=t.appModel.get("connections"),t.connectionsViewstate=t.appModel.get("connectionsViewstate"),t.connectionGroups=t.appModel.get("connectionGroups"),t.services=t.appModel.get("services"),t.docDataModel=e.docDataModel,t.docViewModel=e.docViewModel,t.dataDialogView=e.dataDialogView,t.components=e.components,t.eventBus=e.eventBus,t.dataConnectionMiniMode=e.dataConnectionMiniMode,t.dialogContainer=e.dialogContainer,t.dashEngine=this.appModel.get("dashEngine"),""),n=(t.dashEngine.isIEMode()&&(i=(t.appModel.get("sendSignal")||function(){return""})({type:"config",param:"queryEnvironmentsText"}),n=t.appModel.get("hasPermission"))&&(t.hasPermission_insightsStreaming=n("canEditStream")),t.subscriptionKey=_.uniqueId("queryEditor_"),t.dataGridSubscriptionKey=_.uniqueId("queryEditor_DataGrid_"),t.columnInfo=new Backbone.Collection,t.domIds={tableId:_.uniqueId("dc_"),mappingId:_.uniqueId("dc_"),inputId:_.uniqueId("dc_"),rawId:_.uniqueId("dc_"),objectId:_.uniqueId("dc_")},t.model.set("isSourceDataDialog",!0),t.$el.addClass(this.className),t.$el.html(T.DataConfigForm(_.extend(t.domIds,{queryEnvironmentsText:i}))),t.$el.find(".connection-select").hide(),t.appModel.get("isLite")&&(t.appModel.get("query_graph")||!t.appModel.attributes.hasOwnProperty("query_graph"))||!t.appModel.get("isLite")&&"true"===QuickBase.DeltaClientLib.getDashboardProperty("query_graph"));t.appModel.set("isQueryGraphBuilderVisible",!!n),this.layoutManager=this.dashEngine.datasourceEditorLayoutManager,this.updateEditorLayout(),t.$queryRadio=t.$el.find("input.query").parent(),t.debounceUpdateForm=_.debounce(t.updateForm,100),t.$connectionSelectContainer=t.$el.find(".connection-select"),t.$connectionTypeSelect=t.$el.find(".connection-type-select select"),t.$connectionSelect=t.$el.find(".connection-select select"),t.$viewstateConnectionBtn=t.$el.find(".connection-select-viewstate"),t.$viewstateConnectionClearBtn=t.$el.find(".connection-select-viewstate-clear"),t.$viewStateConnectionText=this.$el.find(".connection-select-viewstate-text"),t.$viewstateConnectionGrp=this.$el.find(".connection-select-viewstate-grp"),t.$newConnectionGroupBtn=t.$el.find(".newConnectionGroup"),t.$connectionTypeSubscription=t.$el.find(".connection-subscription select"),t.$executeButton=t.$el.find(".run-btn"),t.$dataTypeRadio=t.$el.find("input:radio[name=_dataType]"),t.$functionFieldset=t.$el.find("fieldset.function"),t.$dataDiv=t.$el.find(".data-div"),t.$mappingDiv=this.$el.find("#"+t.domIds.mappingId),t.$rawDataOutput=this.$el.find("#"+t.domIds.rawId),t.$inputInfoOutput=this.$el.find("#"+t.domIds.inputId),t.$queryStatus=t.$el.find(".queryStatus"),t.$tabs=t.$el.find(".tabs"),t.$tabsHeaders=t.$tabs.find(">ul"),t.$pivotCheckbox=t.$el.find(".pivot-checkbox"),t.$updateCheckbox=t.$el.find(".update-checkbox"),t.$pivotTypeRadio=t.$el.find("input:radio[name=_pivotType]"),t.$subscription=t.$el.find(".subscription"),t.$updateTypeRadio=t.$el.find("input:radio[name=_updateType]"),t.$resultsTypeRadio=t.$el.find("input:radio[name=_resultsType]"),t.dashEngine.isIEMode()?(t.$tabsHeaders.addClass("embeddedMode"),t.$el.addClass("hideConnectionDetails"),t.$qeInfoText=this.$(".qe-info"),t.viewStateConnectionClear()):t.$tabsHeaders.removeClass("embeddedMode"),t.$pivotLabel=t.$el.find(".pivot-label"),t.$updateLabel=t.$el.find(".update-label"),t.throttleStop=_.throttle(function(){t.model.stop(),t.throttleStop.flush()},5e3,{leading:!1}),t.$viewstateConnectionBtn.button({icon:"fa fa-eye",text:!1,showLabel:!1}).click($.proxy(t.viewStateConnectionDialog,t)),t.$viewstateConnectionGrp.click($.proxy(t.viewStateConnectionDialog,t)),t.$viewstateConnectionClearBtn.button({icon:"fa fa-eraser",text:!1,showLabel:!1}).click($.proxy(t.viewStateConnectionClear,t)),t.setViewStateConnection(),t.$newConnectionGroupBtn.button({icon:"fa fa-cogs",text:!1,showLabel:!1}).click($.proxy(t.openConnectionManagement,t)),t.$executeButton.button({icon:"fa fa-play"}).click($.proxy(t.onExecuteButtonClick,t)),t.model.get("_dataSource")&&"deltaclient"!==t.model.get("_dataSource")||t.model.set({_dataSource:"kdb"},{silent:!0}),t.$connectionTypeSelect.select2({dropdownAutoWidth:!1,minimumResultsForSearch:5,theme:"dashboards"}),t.$connectionTypeSelect.val(t.model.get("_dataSource")).trigger("change"),t.$connectionTypeSelect.on("select2:open",function(){$("body > .select2-container--dashboards.select2-container--open").addClass("select2--environment")}),this.subscriptionSelect=new SubscriptionSelect({el:t.$subscription,model:this.model,dialogContainer:this.dialogContainer,docDataModel:this.docDataModel,docViewModel:this.docViewModel,components:this.components,componentDefs:this.appModel.get("components").models,isEmbedded:this.dashEngine.isIEMode(),isLite:this.appModel.get("isLite")}),t.$maxRowsInput=t.$el.find("input."+t.MAXROWS_PROP),t.$pageSizeInput=t.$el.find("input."+t.PAGESIZE_PROP),t.$serverPagingCheck=t.$el.find('input[name="'+t.SERVER_PAGING_PROP+'"]'),navigator.userAgent.toLowerCase().match(/trident|firefox/)&&(t.subscriptionSz=20,t.$el.find(".data-div > div").css("min-height","20px")),t.$tabs.tabs({activate:$.proxy(t.onTabActivate,t)}),t.sections=[{$el:t.$el.find(".function"),$heading:"> legend",$content:"> fieldset > div",weight:2,isExpanded:!0,resize:function(){t.dataConfigQuery&&t.dataConfigQuery.onResize(),t.dataConfigAnalytic&&t.dataConfigAnalytic.$el.is(":visible")&&t.dataConfigAnalytic.onResize(),t.dataConfigApiSource&&t.dataConfigApiSource.$el.is(":visible")&&t.dataConfigApiSource.onResize(),t.dataConfigUpdate&&t.dataConfigUpdate.$el.is(":visible")&&t.dataConfigUpdate.onResize(),t.dataConfigInsightsStreaming&&t.dataConfigInsightsStreaming.onResize(),t.dataConfigVirtual&&t.dataConfigVirtual.onResize(),t.dataConfigSQLQuery&&t.dataConfigSQLQuery.onResize(),t.dataConfigPyKxQuery&&t.dataConfigPyKxQuery.onResize()}},{$el:t.$el.find(".pivot"),$heading:"> legend",$content:"> fieldset > div",weight:1,isExpanded:!0,hidden:!0},{$el:t.$el.find(".update"),$heading:"> legend",$content:"> fieldset > div",weight:1,isExpanded:!1,hidden:!0},{$el:t.$subscription,$heading:"> legend",$content:"> fieldset > div",weight:0,fixed:80,isExpanded:!1},{$el:t.$el.find(".results"),$heading:"> legend",$content:"> fieldset > div",weight:2,isExpanded:!1,hidden:!0,resize:function(){t.resizeDatatable(),t.mappingView&&t.mappingView.onResize()}}],t.accordion=new AccordionView({el:t.$dataDiv.get(0),sections:t.sections,onUpdate:$.proxy(t.onAccordionUpdate,t)}),t.onModelDataSourceChange(),t.onModelDataTypeChange(),t.onModelHasUpdateChange(),t.onModelPivotTypeChange(),t.onModelSubscriptionTypeChange(),t.onModelMaxRowsChange(),t.onModelPageSizeChange(),t.onModelServerPagingChange(),t.onModelLayoutChange(),t.initializeEvents(),t.model.execute=$.noop,t.dataConnectionMiniMode&&t.$el.addClass("dataConnectionMiniMode"),e.initialTab&&(t.sections[4].hidden=!1,t.sections[4].isExpanded=!0,t.onAccordionUpdate(),t.$tabs.tabs("option","active",e.initialTab),t.onTabActivate()),"sql"===t.model.get("_dataSource")?(t.$pivotLabel.hide(),t.$updateLabel.hide(),t.model.set(t.DATA_TYPE_PROP,"query")):"sql"===t.model.get("_dataType")?(t.$pivotLabel.show(),t.$updateLabel.hide()):(t.$pivotLabel.show(),t.$updateLabel.show())},viewStateConnectionClear:function(e){this.model.set(this.CONNECTION_VS_PROP,""),this.setViewStateConnection(),e&&e.stopPropagation()},setViewStateConnection:function(){var e=this.model.get(this.CONNECTION_VS_PROP),t=!!e;this.$viewStateConnectionText.html(t?e.path:""),this.$viewStateConnectionText.attr("title",t?e.get("value"):""),this.$connectionSelectContainer.toggle(!t),this.$viewstateConnectionBtn.toggle(!t),this.$viewstateConnectionGrp.toggle(t)},viewStateConnectionDialog:function(){var i=this,e=this.model.get("_connection_Viewstate"),e=e?e.path:"";new ViewStateDialog({dialogContainer:this.dialogContainer,docDataModel:this.docDataModel,model:this.docViewModel,components:this.components,componentDefs:this.appModel.get("components").models,isEmbedded:this.dashEngine.isIEMode(),path:e}).on("selected",function(e,t){e=e.getByPath(t);i.model.set(i.CONNECTION_VS_PROP,e),i.setViewStateConnection()})},initializeEvents:function(){var i=this;i.listenTo(i.model,"change:"+this.CONNECTION_PROP,i.onModelConnectionChanged),i.$dataTypeRadio.change(function(){var e=i.$el.find('input:radio[name="_dataType"]:checked').val(),t=i.model.get(i.DATA_TYPE_PROP);i.model.set(i.DATA_TYPE_PROP,"streaming"===e?"analytic":e),t===i.model.get(i.DATA_TYPE_PROP)&&i.model.trigger("change:_dataType",i.model,e)}),i.$updateTypeRadio.change(function(){i.model.set(i.UPDATE_TYPE_PROP,this.value)}),i.model.get("_updateType")||i.model.set("_updateType","query",{silent:!0}),this.$updateTypeRadio.val([i.model.get("_updateType")]),i.$pivotCheckbox.change(function(){var e="query"===i.model.get(i.DATA_TYPE_PROP)?"server":"client";i.model.set(i.PIVOT_TYPE_PROP,this.checked?e:"")}),i.$pivotCheckbox.keyup(function(e){" "!==e.key&&"Enter"!==e.key||i.$pivotCheckbox.trigger("click")}),i.$updateCheckbox.change(function(){i.model.set(i.HAS_UPDATE_PROP,this.checked)}),i.$updateCheckbox.keyup(function(e){" "!==e.key&&"Enter"!==e.key||i.$updateCheckbox.trigger("click")}),i.$resultsTypeRadio.change(function(){i.resultsType=this.value,i.clearData()}),i.$connectionTypeSelect.on("select2:select",function(){i.model.set("_dataSource",i.$connectionTypeSelect.val())}),i.$pivotTypeRadio.change(function(){i.model.set(i.PIVOT_TYPE_PROP,i.$el.find('input:radio[name="_pivotType"]:checked').val())}),i.listenTo(i.model,"change:_dataSource",function(){"sql"===i.model.get("_dataSource")?(i.$pivotLabel.hide(),i.$updateLabel.hide(),i.model.set(i.DATA_TYPE_PROP,"query")):(i.$pivotLabel.show(),i.$updateLabel.show()),i.updateEditorLayout()}),i.listenTo(i.model,"change:"+i.DATA_TYPE_PROP,i.onModelDataTypeChange),i.listenTo(i.model,"change:"+i.HAS_UPDATE_PROP,i.onModelHasUpdateChange),i.listenTo(i.model,"change:"+i.UPDATE_TYPE_PROP,i.onUpdateTypeChange),i.listenTo(i.model,"change:"+i.PIVOT_TYPE_PROP,i.onModelPivotTypeChange),i.listenTo(i.model,"change:"+i.SUBCRIPTION_PROPERTY,i.onModelSubscriptionTypeChange),i.$maxRowsInput.on("input",_.debounce($.proxy(i.onInputMaxRowsChange,i),50)),i.listenTo(i.model,"change:"+i.MAXROWS_PROP,i.onModelMaxRowsChange),i.$pageSizeInput.on("input",_.debounce($.proxy(i.onInputPageSizeChange,i),50)),i.listenTo(i.model,"change:"+i.PAGESIZE_PROP,i.onModelPageSizeChange),i.$serverPagingCheck.on("change",$.proxy(i.onInputServerPagingChange,i)),i.listenTo(i.model,"change:"+i.SERVER_PAGING_PROP,i.onModelServerPagingChange),i.listenTo(i.model,"change:"+this.DATA_TYPE_PROP,i.validateUI),i.listenTo(i.model,"change:_breakdownCols",i.validateUI),i.listenTo(i.model,"change:_aggregateCols",i.validateUI),i.listenTo(i.model,"change:"+this.DATA_SOURCE_PROP,i.onModelDataSourceChange),i.listenTo(i.model,"change:"+i.LAYOUT_PROP,i.onModelLayoutChange),i.listenTo(i.model,"data",i.onModelData)},addDataTable:function(){var o=this;o.loadingDatagridModule?console.log("Datagrid module is already being loaded!"):o.dataTableDisplay?("builder"===o.model.get("_dataType")&&(o.dataTableDisplay.regenerateColumnsConfiguration=!0,o.dataTableDisplay.viewModel.set("ColumnsConfiguration",[])),o.dataTableDisplay.$el.show()):(o.loadingDatagridModule=!0,require(["Datagrid"],function(e){var n,t="Dark";o.loadingDatagridModule=!1,"kx-light"===$.cookie("dashboard-theme")&&(t="Light"),n=e.getSettingsModel({Basics:{Data:o.model,Filtering:"disabled",ShowPagingControl:!1,EnableGrouping:!1},FileExport:{ShowExportCsvButton:!1,ShowExportExcelButton:!1}}),o.dataTableDisplay=new e({dashboardViewModel:new Backbone.Model({DashboardTheme:t}),dataConfigDialogMode:!0,viewModel:new QuickBase.DocumentViewModel,dataModel:o.model,settingsModel:n,api:{showQueryStatus:$.proxy(o.showQueryStatus,o),hideQueryStatus:$.proxy(o.hideQueryStatus,o),subscribe:$.proxy(o.onDataGridSubscribe,o),unsubscribe:$.proxy(o.onDataGridUnsubscribe,o),page:$.proxy(o.onDataGridPage,o),getProperty:function(e){return n.get(e)},setProperty:function(e,t){var i={};n.set(e,t),i[e]=t,o.dataTableDisplay&&o.dataTableDisplay.onSettingsChange(i)},doActions:$.noop,loadSetting:$.noop,saveSetting:$.noop}}),o.dataTableDisplay.on("data-loaded",function(){o.dataTableDisplay&&(o.dataTableDisplay.previousOnDataWasError=!1,o.dataTableDisplay.columnsToRemoveOnNextRun=null)}),o.$el.find(".dataTableTab").append(o.dataTableDisplay.el),o.dataTableDisplay.onSettingsChange(n.toFlat())},function(e){console.log("ComponentView:loadApp require error",e)}),_.delay(function(){o.loadingDatagridModule=!1},2e3))},clearData:function(){this.dataTableDisplay&&this.dataTableDisplay.$el.hide(),this.mappingView&&this.$mappingDiv.hide(),this.$rawDataOutput.text(""),this.$inputInfoOutput.text("")},execute:function(e){var t,i,n,o=this.model.get(this.MAXROWS_PROP);"preview"===this.resultsType&&this.model.set("_maxRows",isNaN(parseInt(o,10))||2e3<Number(o)?2e3:o,{silent:!0}),this.clearData(),!this.isBlank()&&this.validateUI()&&(this.showUIMask(),n=i=void 0,(t=e&&0<=["query","sql","pykx"].indexOf(this.model.get(this.DATA_TYPE_PROP)))&&(i=this.model.get(this.QUERY_STR_PROP),n=this.model.get(this.PIVOT_TYPE_PROP),this.model.set(this.QUERY_STR_PROP,e,{silent:!0}),this.model.set(this.PIVOT_TYPE_PROP,"",{silent:!0})),this.throttleStop.flush(),this.hasSubscribed?(this.model.apply(),this.model.execute()):(this.model.subscribe(this.subscriptionKey,this),this.hasSubscribed=!0),this.model.dataMapper&&this.model.dataMapper.setSubscription(!0),t)&&(this.model.set(this.QUERY_STR_PROP,i,{silent:!0}),this.model.set(this.PIVOT_TYPE_PROP,n,{silent:!0})),"preview"===this.resultsType&&this.model.set(this.MAXROWS_PROP,o,{silent:!0})},setQueryTypeCookie:function(e){var t=new Date;t.setTime(t.getTime()+31536e6),$.cookie("KXQueryType",e,{expires:t,secure:!0,path:"/;SameSite=Strict"})},verifyPermission:function(){return!!this.$connectionSelect[0].value||(console.warn("No Selected Connection. Do you have permission for the connection you're trying to run?"),!1)},focusEditor:function(){var e=this.model.get(this.DATA_TYPE_PROP);"query"===e&&this.dataConfigQuery?this.dataConfigQuery.focusEditor():"virtual"===e&&this.dataConfigVirtual?this.dataConfigVirtual.focusEditor():"sql"===e&&this.dataConfigSQLQuery?this.dataConfigSQLQuery.focusEditor():"pykx"===e&&this.dataConfigPyKxQuery&&this.dataConfigPyKxQuery.focusEditor()},clearCachedQueriesAndParameters:function(){var e=_.isNil(this.dataConfigQuery)?_.isNil(this.dataConfigSQLQuery)?_.isNil(this.dataConfigPyKxQuery)?null:this.dataConfigPyKxQuery:this.dataConfigSQLQuery:this.dataConfigQuery;e&&e.clearCachedQueries(),this.dataConfigStreaming&&this.dataConfigStreaming.resetParametersPanel(!0),this.dataConfigAnalytic&&this.dataConfigAnalytic.resetParametersPanel(!1)},hasStreamingNode:function(){var e=this.model.get("_graphJSON");return!_.isEmpty(e)&&_.some(JSON.parse(e).nodes,function(e){return"stream"===e.group})},hideQueryStatus:function(e){this.$queryStatus.hide()},hideUIMask:function(){this.uiMaskCallback&&this.uiMaskCallback()},isBlank:function(){switch(this.model.get(this.DATA_TYPE_PROP)){case"query":case"pykx":case"sql":case"pivot":return!this.model.get(this.QUERY_STR_PROP);default:return!1}},onAccordionUpdate:function(e){e=_.map(e,function(e){return _.pick(e,"isExpanded","weight")});_.isEqual(this.model.get("_layout"),e)||this.model.set("_layout",e)},onCancelButtonClick:function(){this.$el.dialog("close"),this.remove()},onData:function(e,t,i,n){var o=this.$tabs.tabs("option","active");switch(this.sections[4].hidden=!1,this.sections[4].isExpanded=!0,this.onAccordionUpdate(),this.hideUIMask(),this.data=t,this.meta=e,this.updateColumnsProperty(e.columns),i?this.$el.find(".stacked-bar-graph").empty():n&&(this.renderPerformanceGrid(n),Log.logPerformanceMetrics(this.model.path,n)),this.addDataTable(t),this.throttleStop(),this.model.execute=_.noop,o){case 1:this.updateMappingView();break;case 2:this.updateInputInfoOutputView();break;case 3:this.updateRawView({meta:e,data:t})}},onExecuteButtonClick:function(){(this.dashEngine.isIEMode()||this.verifyPermission())&&this.execute()},onInputMaxRowsChange:function(){this.model.set(this.MAXROWS_PROP,this.$maxRowsInput.val())},onInputPageSizeChange:function(){this.model.set(this.PAGESIZE_PROP,this.$pageSizeInput.val())},onInputServerPagingChange:function(){this.model.set(this.SERVER_PAGING_PROP,this.$serverPagingCheck.prop("checked"))},onModelConnectionChanged:function(){var e;this.$connectionSelect.isLoaded&&(e=this.model.get(this.CONNECTION_PROP),e=this.dashEngine.parseConnElements(e).connection,this.$connectionSelect.val(e).trigger("change"),this.setSQLEditorVisiblity(),this.dashEngine.isIEMode()||this.setPyKxEditorVisiblity(),this.updateEditorLayout(),this.dashEngine.isDirectMode())&&setTimeout(this.switchToAvailableDataType.bind(this),50)},onModelLayoutChange:function(){var i=this,e=i.model.get(i.LAYOUT_PROP);_.each(e,function(e,t){_.extend(i.sections[t],e)}),i.sections[3].isExpanded=!0,this.accordion.updateLayout(!1)},onModelDataSourceChange:function(){"deltaclient"===this.model.get("_dataSource")&&this.model.set({_dataSource:"kdb"},{silent:!0}),this.sections[4].hidden=!0,this.$connectionTypeSelect.val(this.model.get("_dataSource")).trigger("change"),"sql"===this.model.get("_dataSource")?(this.$el.find(".configFieldsetLabels").hide(),this.$el.find(".configFieldsetLabels .query").click()):this.$el.find(".configFieldsetLabels").show(),this.dataConfigQuery,this.updateEditorLayout(),this.dashEngine.isIEMode()?this.setSQLEditorVisiblity():this.populateConnectionsGroupList()},setSQLEditorVisiblity:function(){var t=this;QuickBase.DeltaClientLib.getQueryData("kdb",this.$connectionSelect.val(),QuickBase.KdbQuery.isSqlSupported,[],function(e){e=0<e.rows.length&&_.first(Object.values(e.rows[0]));t.appModel.set("isSqlEditorVisible",!!e),t.updateEditorLayout()},function(){t.appModel.set("isSqlEditorVisible",!1),t.updateEditorLayout()},100,!1)},setPyKxEditorVisiblity:function(){var t,e=this,i=this.el.getElementsByClassName("pykx-editor_label")[0],n=this.el.getElementsByClassName("pykx")[0];_.isNil(i)||(t=function(){i.setAttribute("title",e.PYTHON_NOT_AVAILABLE_MSG),n.setAttribute("disabled",!0)},QuickBase.DeltaClientLib.getQueryData("kdb",this.$connectionSelect.val(),QuickBase.KdbQuery.isPyKxSupported,[],function(e){0<e.rows.length&&_.first(Object.values(e.rows[0]))?(i.removeAttribute("title"),n.removeAttribute("disabled")):t()},function(){t()},100,!1))},switchToAvailableDataType:function(){this&&this.model&&this.$dataTypeRadio&&this.$dataTypeRadio.filter(":checked:hidden").length&&(this.model.get("_dataType"),this.$dataTypeRadio.filter(":enabled:visible").first().prop("checked",!0),this.$dataTypeRadio.trigger("change"))},updateQueryRadio:function(e){e&&(this.originalDataType=this.model.get(this.DATA_TYPE_PROP),this.setSelectedConnection(),this.setViewStateConnection()),this.appModel.get("CanExecuteQueries")||"query"===this.model.get(this.DATA_TYPE_PROP)||"query"===this.originalDataType||this.$queryRadio.hasClass(e="kdbQueryLabelHidden")||this.$queryRadio.addClass(e)},onModelDataTypeChange:function(){var e,t={};"pivot"===this.model.get(this.DATA_TYPE_PROP)?(t[this.DATA_TYPE_PROP]="query",t[this.PIVOT_TYPE_PROP]="server",this.model.set(t)):(t=this.model.get(this.DATA_TYPE_PROP),"server"===this.model.get(this.PIVOT_TYPE_PROP)&&"query"!==t&&"builder"!==t&&this.model.set(this.PIVOT_TYPE_PROP,"client"),e={api:".api-source-form",analytic:".analytic-form",builder:".builder-query-form",query:".query-form",insightsStreaming:".insights-streaming-form",pykx:".pykx-form",sql:".sql-query-form",streaming:".streaming-form",virtual:".virtual-query-form"},this.$(_.values(e).join(",")).hide(),this.$(e[t]).show(),this.updateQueryButtons(),this.updatePivotButton(),this.updateResultsButtons(),this.debounceUpdateForm())},onModelHasUpdateChange:function(){this.debounceUpdateForm()},onModelPivotTypeChange:function(){"server"===this.model.get(this.PIVOT_TYPE_PROP)&&"pykx"===this.model.get(this.DATA_TYPE_PROP)&&"query"!==this.model.get(this.DATA_TYPE_PROP)&&"builder"!==this.model.get(this.DATA_TYPE_PROP)&&this.model.set(this.PIVOT_TYPE_PROP,"client"),this.debounceUpdateForm()},onModelSubscriptionTypeChange:function(){this.validateUI()&&this.model.stop&&this.model.stop(),this.debounceUpdateForm()},onModelMaxRowsChange:function(){this.$maxRowsInput.val(this.model.get(this.MAXROWS_PROP))},onModelPageSizeChange:function(){this.$pageSizeInput.val(this.model.get(this.PAGESIZE_PROP))},onModelServerPagingChange:function(){var e=this.model.get(this.SERVER_PAGING_PROP),e=void 0===e||e||!1;"virtual"!==this.model.get(this.DATA_TYPE_PROP)&&(this.$serverPagingCheck.prop("checked",e),this.$maxRowsInput.parent().toggle(!e),this.$pageSizeInput.parent().toggle(e),this.$resultsTypeRadio.parent().toggle(!e))},onResize:function(e,t){this.accordion.resize(),this.resizeDatatable()},onDataGridPage:function(e,t){if(!e||!e.subscribe||!e.unsubscribe)return!1;t=_.pick(t,"_pagingType","_pagingNum","_pageSize","_pageSort"),e.set(t)},onDataGridSubscribe:function(e,t){return!!(e&&e.subscribe&&e.unsubscribe)&&(this.dataGridSubscription?(this.dataGridSubscription.callback=t,!1):(this.dataGridSubscription={source:e,onData:t},this.dataGridSubscription.key="queryEditor_DataGrid",void e.subscribe(this.dataGridSubscription.key,this.dataGridSubscription)))},onDataGridUnsubscribe:function(e){if(!(e instanceof QuickBase.DocumentDataModel))return!1;this.dataGridSubscription&&(e.unsubscribe(this.dataGridSubscription.key),delete this.dataGridSubscription)},onTabActivate:function(){switch(this.$tabs.tabs("option","active")){case 0:this.resizeDatatable();break;case 1:this.updateMappingView();break;case 2:this.updateInputInfoOutputView();break;case 3:this.updateRawView(this.data)}},openConnectionManagement:function(){this.connectionManagementPanel=new ConnectionManagement({container:this.dialogContainer,launchObject:this.$connectionSelect.val(),docViewModel:this.docViewModel,appModel:this.appModel}),this.listenTo(this.connectionManagementPanel,"RefreshConnectionList",$.proxy(this.refreshConnectionsSelect,this)),this.listenToOnce(this.connectionManagementPanel,"onRemove",$.proxy(function(){this.stopListening(this.connectionManagementPanel),this.connectionManagementPanel=null},this))},populateConnectionsList:function(n){var o,a,s=this,l=this,r="q",c=null,d=null,e=new Promise(function(t){l.model.get("_dataSource");"kdb"===l.model.get("_dataSource")?r="q":"sql"===l.model.get("_dataSource")&&(r="jdbc:com.mysql.jdbc.Driver",c="jdbc:oracle.jdbc.OracleDriver",d="jdbc:com.microsoft.sqlserver.jdbc.SQLServerDriver"),l.connections.fetch({success:function(e){t(e.map(function(e){return e.attributes}))}})});Promise.all([e]).then(function(e){var e=e[0],t=((l.dashEngine.isIEMode()||_.isUndefined(l.model.get(l.CONNECTION_PROP)))&&e[0]&&l.model.set(l.CONNECTION_PROP,e[0].name,{silent:!0}),a=_.filter(e,function(e){return"DC"!==e.name&&(e.type===r||"api"===e.type||e.type===QuickBase.Dash.DATA_SOURCE_insightsSDK)}),c&&(a=$.merge(a,_.filter(e,{type:c}))),d&&(a=$.merge(a,_.filter(e,{type:d}))),s.model.get(s.CONNECTION_PROP)),i=s.dashEngine.parseConnElements(t).connection,e=(o=_.reduce(a,function(e,t){return e+'<option value="'+_.escape(t.name)+'"'+(t.name===i?" selected>":">")+t.name+"</option>"},""),l.$connectionSelect.append('<optgroup label="-Single Connections-">'),l.$connectionSelect.append(o),l.$connectionSelect.append("</optgroup>"),_.find(e.concat(n||[]),{name:i}));l.dataConnectionMiniMode?l.$connectionSelect.val(t).trigger("change"):e?l.$connectionSelect.val(i).trigger("change"):0<a.length?l.$connectionSelect.val(a[0].name).trigger("change"):l.$executeButton.button("option","disabled",!0),l.$connectionSelect.isLoaded=!0,l.populateServicesList()})},populateConnectionsGroupList:function(){var i=this,e=0;this.connectionGroups?(i.$connectionSelect.empty(),"kdb"===i.model.get("_dataSource")?i.connectionGroups.fetch({success:function(e){var t;e=e.map(function(e){return e.attributes}),_.isUndefined(i.model.get(i.CONNECTION_PROP))&&e[0]&&i.model.set(i.CONNECTION_PROP,e[0].name,{silent:!0}),t=_.reduce(e,function(e,t){return e+'<option value="'+_.escape(t.name)+'"'+(t.name===i.model.get(i.CONNECTION_PROP)?" selected>":">")+t.name+"</option>"},""),i.$connectionSelect.html('<optgroup label="-Connection Groups-">'+t+"</optgroup>"),i.populateConnectionsList(e),i.updateEditorLayout()},error:function(){_.delay(function(){e<3&&(e+=1,i.populateConnectionsGroupList(),i.updateEditorLayout())},1e3)}}):i.populateConnectionsList()):this.populateConnectionsList([])},populateServicesList:function(){var i=this;this.appModel.get("isLite")?i.setSelectedConnection():i.appModel.get("services").fetch({success:function(e){optionsHeader='<optgroup label="-Services-">',optionsfooter="</optgroup>",optionsHtml=e.reduce(function(e,t){return e+'<option value="'+_.escape(t.get("name"))+'"'+(t.get("name")===i.model.get(i.CONNECTION_PROP)?" selected>":">")+t.get("name")+"</option>"},""),i.$connectionSelect.append(optionsHeader),i.$connectionSelect.append(optionsHtml),i.$connectionSelect.append(optionsfooter),i.$executeButton.button("option","disabled")&&0<e.length&&(i.$executeButton.button("option","disabled",!1),i.$connectionSelect.val(e.models[0].get("name")).trigger("change")),i.setSelectedConnection()},error:function(e,t){QuickBase.Log.Error("Failed to fetch Services",t[0]),i.setSelectedConnection()}})},refreshConnectionsSelect:function(){this.$connectionSelect.html(""),this.$connectionSelect.empty(),this.populateConnectionsGroupList()},remove:function(){this.removeDataTable(),this.model.unsubscribe(this.subscriptionKey),this.hasSubscribed=!1,this.stopListening(this.model),this.model.destroy(),this.dataConfigQuery&&(this.dataConfigQuery.remove(),delete this.dataConfigQuery),this.dataConfigSQLQuery&&(this.dataConfigSQLQuery.remove(),delete this.dataConfigSQLQuery),this.dataConfigPyKxQuery&&(this.dataConfigPyKxQuery.remove(),delete this.dataConfigPyKxQuery),this.dataConfigAnalytic&&(this.dataConfigAnalytic.remove(),delete this.dataConfigAnalytic),this.dataConfigApiSource&&(this.dataConfigApiSource.remove(),delete this.dataConfigApiSource),this.dataConfigStreaming&&(this.dataConfigStreaming.remove(),delete this.dataConfigStreaming),this.dataConfigInsightsStreaming&&(this.dataConfigInsightsStreaming.remove(),delete this.dataConfigInsightsStreaming),this.dataConfigPivot&&(this.dataConfigPivot.remove(),delete this.dataConfigPivot),this.dataConfigUpdate&&(this.dataConfigUpdate.remove(),delete this.dataConfigUpdate),this.dataConfigBuilder&&(this.dataConfigBuilder.remove(),delete this.dataConfigBuilder),this.remove_cmb(this.$connectionSelect),this.remove_cmb(this.$connectionTypeSelect),Backbone.View.prototype.remove.call(this)},remove_cmb:function(e){e&&e.data("select2")&&(e.off("select2:open"),e.off("select2:select"),e.select2("destroy"))},removeDataTable:function(){this.dataTableDisplay&&(this.dataTableDisplay.remove(),this.dataTableDisplay=null)},renderPerformanceGrid:function(e){var e=e.performance,t=e.onAgentNotify-e.apply,i=e.serverStart?e.serverStart-e.apply:0,n=e.serverStart&&e.serverEnd?e.serverEnd-e.serverStart:t,e=e.serverEnd?e.onAgentNotify-e.serverEnd:0,o=i/t,a=n/t,s=e/t;this.$el.find(".stacked-bar-graph").html(T.DataConfigForm_Perf({totalTime:t.toFixed(0),subscriptionPercent:100*o,executionPercent:100*a,dataModelPercent:100*s,subscriptionTime:i.toFixed(0),executionTime:n.toFixed(0),dataModelTime:e.toFixed(0)}))},resizeDatatable:function(){this.dataTableDisplay&&this.dataTableDisplay.onResize(),this.dataConfigBuilder&&this.dataConfigBuilder.onResize()},setSelectedConnection:function(){var t=this;t.$connectionSelect.select2({theme:"dashboards"}),t.$connectionSelect.on("select2:select",function(){var e=t.$connectionSelect.val();t.model.set(t.CONNECTION_PROP,e)}),t.$connectionSelect.on("select2:open",function(){$("body > .select2-container--dashboards.select2-container--open").addClass("select2--environment")}),t.onModelConnectionChanged()},showUIMask:function(){var e=this;e.$uiMask||(e.$uiMask=$('<div class="ui-widget-overlay" style="z-index: 1111; display: none; opacity: 0.7; position: absolute;"></div>').appendTo(".data-dialog"),e.$uiMask.append(new LoadingScreen({loadingText:"Please wait, executing query"}).$el),e.uiMaskCallback=function(){e.$uiMask.stop(!0,!0).fadeOut(200),clearTimeout(e.uiMaskTimeout)}),e.$uiMask.fadeIn(1e3),clearTimeout(e.uiMaskTimeout),e.uiMaskTimeout=setTimeout(function(){e.showQueryStatus({message:"Request timed out, no response within 10 seconds",type:"Error"}),e.sections[4].isExpanded=!0,e.sections[4].hidden=!1,e.onAccordionUpdate(),e.model.stop&&e.model.stop(),e.uiMaskCallback()},1e4)},showQueryStatus:function(e){var t=this,i=e.message||e.error||"",e=e.type||"Error",n="NoResults"===e?"No Results":e;0===i.indexOf("0.0")&&(i=i.substring(4)),t.$queryStatus.removeClass("Error Warning Info Loading NoResults").addClass(e),t.$queryStatus.find(".statusTitle span").text(n+(i?": ":"")),t.$queryStatus.find(".statusText").html(i),t.$queryStatus.show(),t.fadeTimer&&clearTimeout(t.fadeTimer),"Info"===e&&(t.fadeTimer=_.delay(function(){t.$queryStatus.fadeOut("slow")},3e3))},updateForm:function(){var e,t,i,n=this.model.get(this.DATA_TYPE_PROP),o=this.model.get(this.PIVOT_TYPE_PROP),a=!!o,s="streaming"===this.model.get("_subscriptionType"),l=this.model.get(this.HAS_UPDATE_PROP);this.dashEngine.isIEMode()&&(this.$dataTypeRadio.prop("disabled",!0).filter(".api, .sql, .query, .virtual"+(this.hasPermission_insightsStreaming?", .insights-streaming":"")).prop("disabled",!1),this.$dataTypeRadio.filter(".insights-streaming").parent().prop("title",this.hasPermission_insightsStreaming?"":DataConfigInsightsStreaming.PERMISSION_REQUIRED_TEXT).find("span").toggleClass("ui-state-disabled",!this.hasPermission_insightsStreaming)),this.dashEngine.isIEMode()&&this.$qeInfoText&&("sql"===n||"query"===n?this.$qeInfoText.show():this.$qeInfoText.hide()),this.$dataTypeRadio.val(["analytic"===n&&s?"streaming":n]),this.$pivotTypeRadio.val([o]),this.$pivotCheckbox.prop("checked",a),this.$el.find('input:radio[name="_pivotType"].server').prop("disabled","query"!==this.model.get(this.DATA_TYPE_PROP)&&"pykx"!==this.model.get(this.DATA_TYPE_PROP)&&"builder"!==this.model.get(this.DATA_TYPE_PROP)),this.$pivotCheckbox.prop("disabled",!_.includes(["sql","query","analytic","streaming","api","virtual","pykx","builder"],n)||l),this.sections[1].isExpanded=a,this.sections[1].hidden=!a,this.$updateCheckbox.prop("checked",!!l),this.$updateCheckbox.prop("disabled",!_.includes(["query","analytic","streaming"],n)||a),this.sections[2].isExpanded=l,this.sections[2].hidden=!l,this.sections[3].isExpanded="static"!==this.model.get(this.SUBCRIPTION_PROPERTY)||l||"virtual"===this.model.get(this.DATA_TYPE_PROP),this.sections[3].isExpanded?(this.sections[3].fixed=80,this.sections[3].$el.find("fieldset").toggleClass("hide-border-color",!1)):(this.sections[3].fixed=this.subscriptionSz,this.sections[3].$el.find("fieldset").toggleClass("hide-border-color",!0)),"static"!==this.model.get(this.SUBCRIPTION_PROPERTY)||l||"virtual"===this.model.get(this.DATA_TYPE_PROP)||this.model.set("_subscriptionKey",""),this.onAccordionUpdate(),_.each([this.dataConfigAnalytic,this.dataConfigApiSource,this.dataConfigStreaming,this.dataConfigInsightsStreaming,this.dataConfigQuery,this.dataConfigPivot,this.dataConfigUpdate,this.dataConfigVirtual,this.dataConfigSQLQuery,this.dataConfigPyKxQuery,this.dataConfigBuilder],function(e){e&&e.$el.hide()}),this.dataConnectionMiniMode||("api"===n?(this.dataConfigApiSource=this.updateFormComponent(this.dataConfigApiSource,DataConfigApiSource,this.$el.find(".api-source-form").get(0)),e=this.dataConfigApiSource.$tree.jstree("get_selected"),o=this.model.get("_selectedAnalytic"),e instanceof Array&&0<e.length&&(o=e[0]),this.model.set("_selectedAnalytic",o=o||"getData"),this.model.set("_analyticParams",this.model.get("_analyticParameters")),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),i=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!1),this.$resultsTypeRadio.parent().toggle(!1),this.$pageSizeInput.parent().toggle(!1),this.$serverPagingCheck.parent().toggle(!1),this.dataConfigApiSource.onResize(),this.dataConfigApiSource.resetParametersPanel(),this.dataConfigApiSource.updateAssemblyApiList()):"analytic"!==n||s?"analytic"===n&&s?(this.dataConfigStreaming=this.updateFormComponent(this.dataConfigStreaming,DataConfigAnalytic,this.$el.find(".streaming-form").get(0)),(e=this.dataConfigStreaming.$tree.jstree("get_selected"))instanceof Array&&0<e.length&&this.model.set("_selectedAnalytic",e[0]),this.model.set("_analyticParams",this.model.get("_streamingParameters")),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),i=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!i),this.$resultsTypeRadio.parent().toggle(!t||!i),this.$pageSizeInput.parent().toggle(t&&i),this.$serverPagingCheck.parent().toggle(t),this.dataConfigStreaming.onResize()):"insightsStreaming"===n?(this.dataConfigInsightsStreaming=this.updateFormComponent(this.dataConfigInsightsStreaming,DataConfigInsightsStreaming,this.$el.find(".insights-streaming-form").get(0)),this.$maxRowsInput.parent().toggle(!0),this.$resultsTypeRadio.parent().toggle(!1),this.$pageSizeInput.parent().toggle(!1),this.$serverPagingCheck.parent().toggle(!1),this.dataConfigInsightsStreaming.onResize()):"query"===n?(this.dataConfigQuery=this.updateFormComponent(this.dataConfigQuery,DataConfigQuery_Query,this.$el.find(".query-form").get(0)),o=_.get(QuickBase.DeltaClientLib,"properties.legacy_managed"),s=this.model.get(this.SUBCRIPTION_PROPERTY),t=-1!==["static","polling"].indexOf(s)&&!a&&!this.appModel.get("isLite"),t="subscription"===s&&"false"===o||t,i=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!i),this.$resultsTypeRadio.parent().toggle(!t||!i),this.$pageSizeInput.parent().toggle(t&&i),this.$serverPagingCheck.parent().toggle(t),this.stopListening(this.dataConfigQuery,"execute",this.execute),this.listenTo(this.dataConfigQuery,"execute",this.execute),this.dataConfigQuery.loadText("query")):"sql"===n?(this.dataConfigSQLQuery=this.updateFormComponent(this.dataConfigSQLQuery,DataConfigQuery_Query,this.$el.find(".sql-query-form").get(0)),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),i=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!i),this.$resultsTypeRadio.parent().toggle(!t||!i),this.$pageSizeInput.parent().toggle(t&&i),this.$serverPagingCheck.parent().toggle(t),this.stopListening(this.dataConfigSQLQuery,"execute",this.execute),this.listenTo(this.dataConfigSQLQuery,"execute",this.execute),this.dataConfigSQLQuery.loadText("sql"),this.dataConfigSQLQuery.onResize()):"pykx"===n?(this.dataConfigPyKxQuery=this.updateFormComponent(this.dataConfigPyKxQuery,DataConfigQuery_Query,this.$el.find(".pykx-form").get(0)),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),i=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!i),this.$pageSizeInput.parent().toggle(t&&i),this.$serverPagingCheck.parent().toggle(t),this.stopListening(this.dataConfigPyKxQuery,"execute",this.execute),this.listenTo(this.dataConfigPyKxQuery,"execute",this.execute),this.dataConfigPyKxQuery.loadText("pykx"),this.dataConfigPyKxQuery.onResize()):"virtual"===n?(""===this.model.get("_virtualQueryString")&&this.model.set("_virtualQueryString",this.dataDialogView.generateSampleVirtualQuery(this.model.path)),this.dataConfigVirtual=this.updateFormComponent(this.dataConfigVirtual,DataConfigQuery_Virtual,this.$el.find(".virtual-query-form").get(0)),this.stopListening(this.dataConfigVirtual,"execute",this.execute),this.listenTo(this.dataConfigVirtual,"execute",this.execute),this.dataConfigVirtual.onResize()):"builder"===n&&(this.dataConfigBuilder=this.updateFormComponent(this.dataConfigBuilder,DataConfigQuery_Builder,this.$el.find(".builder-query-form").get(0)),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),i=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!i),this.$resultsTypeRadio.parent().toggle(!t||!i),this.$pageSizeInput.parent().toggle(t&&i),this.$serverPagingCheck.parent().toggle(t),this.stopListening(this.dataConfigVirtual,"execute",this.execute),this.listenTo(this.dataConfigVirtual,"execute",this.execute),this.stopListening(this.dataConfigSQLQuery,"execute",this.execute),this.listenTo(this.dataConfigSQLQuery,"execute",this.execute),this.dataConfigBuilder.onResize()):(this.dataConfigAnalytic=this.updateFormComponent(this.dataConfigAnalytic,DataConfigAnalytic,this.$el.find(".analytic-form").get(0)),(e=this.dataConfigAnalytic.$tree.jstree("get_selected"))instanceof Array&&0<e.length&&this.model.set("_selectedAnalytic",e[0]),this.model.set("_analyticParams",this.model.get("_analyticParameters")),t=-1!=["static","polling"].indexOf(this.model.get(this.SUBCRIPTION_PROPERTY))&&!a&&!this.appModel.get("isLite"),i=this.model.get(this.SERVER_PAGING_PROP),this.$maxRowsInput.parent().toggle(!t||!i),this.$resultsTypeRadio.parent().toggle(!t||!i),this.$pageSizeInput.parent().toggle(t&&i),this.$serverPagingCheck.parent().toggle(t),this.dataConfigAnalytic.onResize()),a?this.dataConfigPivot=this.updateFormComponent(this.dataConfigPivot,DataConfigQuery_Pivot,this.$el.find(".pivot-form").get(0)):l&&(this.dataConfigUpdate=this.updateFormComponent(this.dataConfigUpdate,DataConfigQuery_Update,this.$el.find(".update-form").get(0)))),this.updateQueryRadio()},updateFormComponent:function(e,t,i){return(e?("builder"===this.model.get("_dataType")&&e.render(),e):(["builder","analytic"].includes(this.model.get("_dataType"))?(this.$el.find(".query-form").toggle(!1),this.$el.find(".sql-query-form").toggle(!1)):("sql"===this.model.get("_dataType")?this.$el.find(".sql-query-form"):"pykx"===this.model.get("_dataType")?this.$el.find(".pykx-form"):this.$el.find(".query-form")).toggle($(i).hasClass("sql-query-form")||$(i).hasClass("query-form")||$(i).hasClass("update-form")||$(i).hasClass("pykx-form")||$(i).hasClass("pivot-form")),e=new t({model:this.model,docDataModel:this.docDataModel,docViewModel:this.docViewModel,eventBus:this.eventBus,el:i,dialogContainer:this.dialogContainer,appModel:this.appModel,execute:this.execute.bind(this),subscriptionSelect:this.subscriptionSelect,components:this.components,componentDefs:this.appModel.get("components").models,isEmbedded:this.dashEngine.isIEMode()}))).$el.show(),e},updateQueryStatus:function(e,t){t?(this.showQueryStatus(t),"Error"===t.type&&(this.hideUIMask(),this.model.stop(),this.$rawDataOutput.text(""),this.$inputInfoOutput.text(""))):this.hideQueryStatus()},updateColumnsProperty:function(t){t.reset?this.columnInfo.reset(t.reset):(this.columnInfo.remove(_.map(t.remove,function(e){return e.id})),this.columnInfo.add(t.add),this.columnInfo.add(t.change,{merge:!0})),_.some(["add","remove","reset","change"],function(e){return void 0!==t[e]})&&(this.model.set("_columns",this.columnInfo.map(function(e){return e.id}),{silent:!0}),this.subscriptionSelect.onModelColumnsChange(),"builder"===this.model.get("_dataType"))&&this.dataConfigBuilder.onModelColumnsChange()},updateResultsButtons:function(){var e=this.model.get(this.SERVER_PAGING_PROP),t="virtual"===this.model.get(this.DATA_TYPE_PROP);this.$maxRowsInput.parent().toggle(!t&&!e),this.$pageSizeInput.parent().toggle(!t&&e),this.$serverPagingCheck.parent().toggle(!t),this.$resultsTypeRadio.parent().toggle(!t&&!e)},reduceData:function(){var i,n=this.data.rows?this.data.rows.length:0;return 20<n?(i={},_.each(this.data,function(e,t){i[t]=e}),i.rows=[],_.each(this.data.rows,function(e,t){t<10||n-10<t?i.rows.push(e):10===i.rows.length&&i.rows.push(".. .. .. ..")}),i):this.data},updateEditorLayout:function(){var e=this.model.get("_connection"),e=this.dashEngine.parseConnElements(e).connection,e=this.connections.get(e);this.layoutManager.changeLayout(this.$el,this.appModel,e,this.model)},updateInputInfoOutputView:function(){var e="";this.model&&this.model.lastRunInfo&&(e=JSON.stringify(this.model.lastRunInfo)),this.$inputInfoOutput.text(e)},updateMappingView:function(){var e,t;this.mappingView&&(e=this.$mappingDiv.parent(),t=this.$mappingDiv.prop("class"),this.mappingView.remove(),this.$mappingDiv=$("<div />"),this.$mappingDiv.prop("id",this.domIds.mappingId),this.$mappingDiv.prop("class",t),e.append(this.$mappingDiv)),this.model.dataMapper||this.model.apply(),this.mappingView=new DataConfigMapping({el:this.$mappingDiv,dataMapper:this.model.dataMapper,dialogContainer:this.dialogContainer,docDataModel:this.docDataModel,docViewModel:this.docViewModel,components:this.components,componentDefs:this.appModel.get("components").models,isEmbedded:this.dashEngine.isIEMode()})},updatePivotButton:function(){_.includes(["streaming"],this.model.get(this.DATA_TYPE_PROP))?(this.$pivotLabel.hide(),this.model.set(this.PIVOT_TYPE_PROP,"")):this.$pivotLabel.show()},updateRawView:function(){var e=_.isString(this.data)?this.data:JSON.stringify(this.meta)+JSON.stringify(this.reduceData(),function(e,t){return"bigint"==typeof t?t.toString():t});this.$rawDataOutput.text(e)},updateQueryButtons:function(){_.includes(["virtual","streaming"],this.model.get(this.DATA_TYPE_PROP))?this.$updateLabel.hide():this.$updateLabel.show()},validateUI:function(){var e=!0,t="";return"pivot"===this.model.get("_dataType")&&(this.model.get("_breakdownCols").length<1||0===this.model.get("_aggregateCols").length)&&(e=!1,t="Please ensure breakdown columns and aggregate columns are populated."),e?this.hideQueryStatus():this.showQueryStatus({type:"Error",message:t}),this.model.trigger("isValid",e),e}},{filterAttributes:function(e){var t={query:["_queryString","_queryParams","_subscriptionKey","_hasUpdateQuery","_updateQueryParams","_updateQueryString","_updateType","_updateAnalytic"],sql:["_queryString","_queryParams","_subscriptionKey","_hasUpdateQuery","_updateQueryParams","_updateQueryString","_updateType","_updateAnalytic"],pykx:["_queryString","_queryParams","_subscriptionKey","_hasUpdateQuery","_updateQueryParams","_updateQueryString","_updateType","_updateAnalytic"],api:["_selectedAnalytic","_analyticParams","_analyticParameters","_subscriptionKey"],insightsStreaming:["_streamingParameters","_subscriptionKey","_isStreamingSubscription"],analytic:["_selectedAnalytic","_analyticParams","_analyticParameters","_streamingParameters","_subscriptionKey","_isStreamingSubscription","_hasUpdateQuery","_updateQueryString","_updateType","_updateAnalytic"],pivot:["_aggregateCols","_aggregateFns","_aggregateLabels","_breakdownCols","_columnLabel","_pivotSource","_pivotType","_table","_queryString","_queryParams","_aggFn","_topX","_ordering","_from","_to"],virtual:["_subscriptionKey","_virtualParams","_virtualQueryString"],builder:["_selectedAnalytic","_analyticParams","_builderParams","_subscriptionKey","_isStreamingSubscription","_graphJSON","_subscriptionKey","_selectedNode"]},i=["_autoExec","_autoExecute","_columns","_dataType","_dataSource","_connection","_connection_Viewstate","_mappings","_maxRows","_forceReset","_subscriptionType","_subscriptionInterval","_layout"],i=_.union(i,t[e._dataType]);return"query"!=e._dataType&&"sql"!=e._dataType&&"analytic"!=e._dataType&&"builder"!=e._dataType||-1==["static","polling","subscription"].indexOf(e._subscriptionType)||e._pivotType||(i=i.concat(["_pageSize","_serverPaging"])),e._pivotType&&(i=_.union(i,t.pivot)),_.pick(e,i)}}),DataConnectionDialog=Backbone.View.extend({className:"dataConnection-dialog",isModelChanged:!1,initialize:function(e){var i=this;i.options=e,i.appModel=i.options.appModel,i.path=i.options.path,this.$dialog=i.$el.dialog(_.extend({appendTo:e.container,title:t("Data Connection "),classes:{"ui-dialog":"quick-dash dlgDataConnection"},resizable:!0,height:125,width:250,modal:!0,autoOpen:!0,buttons:[{text:t("Apply"),disabled:!0,click:$.proxy(i.onSelectButtonClick,i),icon:"fa fa-check"},{text:t("Close"),click:$.proxy(i.onCancelButtonClick,i),icon:"fa fa-times"}],open:function(){i.changeApplyButtonStatus(),$('<i class="fa fa-server" />').insertBefore(i.$el.parent().find(".ui-dialog-title")),i.model=new(Backbone.Model.extend({apply:$.noop,getChildren:$.noop,subscribe:$.noop}))({_connection:i.path,_dataType:"query"}),i.model.on("change:_connection",function(){var e=i.model.get("_connection");e&&(0<=e.indexOf("--Connection Groups--")||0<=e.indexOf("--Single Connections--"))&&(e=""),i.path=e,i.changeApplyButtonStatus()}),i.configDialog=new DataConfigForm({dataConnectionMiniMode:!0,docViewModel:i.options.docViewModel,dialogContainer:i.options.dialogContainer,model:i.model,appModel:i.appModel}),i.$el.append(i.configDialog.$el),_.delay(function(){i.configDialog.$el.find(".toolbar").css("position","relative"),_.delay(function(){i.configDialog.$el.find(".toolbar").css("position","absolute"),_.delay(function(){i.configDialog.$el.find(".toolbar").css("position","relative")},10)},500)},200)},close:function(){i.remove()}},e))},changeApplyButtonStatus:function(){this.$el.next().find("button:nth-of-type(1)").button({disabled:!this.path})},onCancelButtonClick:function(){this.$el.dialog("close")},onSelectButtonClick:function(){var e=this.options.selectCallback;e&&e(this.path),this.onCancelButtonClick()},remove:function(){this.model&&this.model.off(),this.$dialog.dialog("destroy"),Backbone.View.prototype.remove.apply(this,arguments)}}),MenuLayoutCheckbox=Backbone.View.extend({className:"menuLayoutCheckbox",initialize:function(e){this.add_keyword="ADD",this.delimiter_keyword="->",this.remove_keyword="REMOVE",this.codeEditor=e.codeEditor,this.componentModel=e.componentModel,this.id=e.id,this.menuLayout=this.setLayout(e.menuLayout),this.parseHTML=e.parseHTML,this.setDefaults=e.setDefaults,this.widgetId=e.widgetId,this.setDefaultsOptions(),this.render()},applyLayout:function(){var t=this,i=this,e=this.menuLayout.classes.filter(function(e){return"checked"===e.checked});0<e.length&&_.each(e,function(e){i.applyOption(t.add_keyword+t.delimiter_keyword+e.class)})},applyOption:function(e){var t,i,n=e.split(this.delimiter_keyword),e="",o=this.menuLayout.classes.filter(function(e){return e.class===n[1]}),a=this.parseExtractCSS(),s=this.parseHTML();n[0]===this.add_keyword?$(s[1]).addClass(n[1]):n[0]===this.remove_keyword&&$(s[1]).removeClass(n[1]),t=(t=(t="\x3c!--".concat($(s[0])[0].data).concat("--\x3e")).concat($(s[1])[0].outerHTML)).concat("\x3c!--").concat($(s[2])[0].data).concat("--\x3e"),this.processHTML(t),i=n[0]===this.add_keyword?(e=decodeURI(o[0].css),(i=(i=(i=a[1].concat("\n")).concat(a[2])).concat(e)).concat(a[3])):(e=decodeURI(o[0].css),s=this.componentModel.get("Style.advanced"),(i=this.replaceDataWidgetId(s,'data-widgetid=""')).replace(e,"")),this.processCSS(i)},initialiseCheckboxEvents:function(){var t=this,e=this.$el.find('input[type="checkbox"]');_.each(e,function(e){$(e).off("change"),$(e).on("change",function(){var e=(e=$(this).attr("class")).replace("GENERATED->","");this.checked?t.applyOption(t.add_keyword+t.delimiter_keyword+e):t.applyOption(t.remove_keyword+t.delimiter_keyword+e)})})},inspectHTML:function(){var t,e=this.parseHTML();e&&(e=$(e[1]).attr("class"))&&(t=e.split(" "),this.menuLayout.classes.map(function(e){t.includes(e.class)?e.checked="checked":e.checked=""}),this.applyLayout())},parseExtractCSS:function(){return/(.*\[START\].*)[\s\S](.*[\s\S]*\})(.*[\s\S]\/\*.*\*\/)/.exec(this.componentModel.get("Style.advanced"))},processCSS:function(e){var e=this.replaceDataWidgetId(e,'data-widgetid="'+this.widgetId+'"'),t=this.componentModel.get("Style.advanced"),t=/(.*[\s\S]*(\/\*.*START\])).*[\s\S]*(\/\*.*END\] \*\/)(.*[\s\S]*)/.exec(t);t&&(e=t[1].replace(t[2],"")+e,e+=t[4]),this.componentModel.set("Style.advanced",e)},processHTML:function(e){var t=this.codeEditor.getValue(),t=/(.*[\s\S]*(\<\!.*START\])).*[\s\S]*(\<\!.*END\]--\>)(.*[\s\S]*)/.exec(t),t=t?(t[1]=t[1].replace(t[2],""),t[1]+e+t[4]):e;this.codeEditor.setValue(t)},replaceDataWidgetId:function(e,t){return e.replace(/data-widgetid=".*"/g,t)},render:function(){this.inspectHTML(),this.$el.html(T.MenuLayoutCheckbox({checkboxes:this.menuLayout.classes})),this.initialiseCheckboxEvents()},setDefaultsOptions:function(){var t=this;this.menuLayout.classes.map(function(e){!0===e.default&&t.setDefaults?e.checked="checked":e.checked=""}),this.applyLayout()},setLayout:function(e){var t=this;return e.filter(function(e){return e.id===t.id})[0]}}),MenuLayoutItem=Backbone.View.extend({className:"menuLayoutItem ui-widget-content",initialize:function(e){this.codeEditor=e.codeEditor,this.componentModel=e.componentModel,this.menuLayout=e.menuLayout,this.onPresetSelected=e.onPresetSelected,this.parseHTML=e.parseHTML,this.widgetId=e.widgetId,this.render()},applyId:function(e,t){return $(t[1]).attr("id",e),result=(result=(result="\x3c!--".concat($(t[0])[0].data).concat("--\x3e")).concat($(t[1])[0].outerHTML)).concat("\x3c!--").concat($(t[2])[0].data).concat("--\x3e")},applyLayout:function(e){this.previouslySelected(e)||(this.processCSS(),this.processHTML(e))},encodeId:function(e){return btoa(e)},previouslySelected:function(e){var t=this.codeEditor.getValue(),t=this.parseHTML(t);return t?$(t[1]).attr("id")===e:null},processCSS:function(){var e=decodeURI(this.menuLayout.css),t=this.componentModel.get("Style.advanced"),t=/(.*[\s\S]*(\/\*.*START\])).*[\s\S]*(\/\*.*END\] \*\/)(.*[\s\S]*)/.exec(t),e=e.replace(/data-widgetid=""/g,'data-widgetid="'+this.widgetId+'"');t&&(e=t[1].replace(t[2],"")+e,e+=t[4]),this.componentModel.set("Style.advanced",e)},processHTML:function(e){var t=this.codeEditor.getValue(),i=decodeURI(this.menuLayout.html),t=/(.*[\s\S]*(\<\!.*START\])).*[\s\S]*(\<\!.*END\]--\>)(.*[\s\S]*)/.exec(t),i=this.parseHTML(i);i=this.applyId(e,i),e=t?(t[1]=t[1].replace(t[2],""),t[1]+i+t[4]):i,this.codeEditor.setValue(e)},render:function(){var t=this;this.$el.html(T.MenuLayoutItem({description:this.menuLayout.description,id:this.menuLayout.id,image:this.menuLayout.image,label:this.menuLayout.label})),this.$el.on("click",function(){var e=t.encodeId(t.menuLayout.id);t.applyLayout(e),t.onPresetSelected(e)}),this.$el.on({mouseenter:function(){t.$el.addClass("ui-state-hover")},mouseleave:function(){t.$el.removeClass("ui-state-hover")}})}}),MenuLayoutList=Backbone.View.extend({className:"menuLayoutList ui-widget-content",initialize:function(e){this.codeEditor=e.codeEditor,this.menuCheckbox,this.options=e,this.render()},addMenuLayoutCheckbox:function(e,t){e=this.decodeId(e);this.menuCheckbox&&this.menuCheckbox.remove(),this.menuCheckbox=new MenuLayoutCheckbox({codeEditor:this.options.codeEditor,componentModel:this.options.componentModel,id:e,menuLayout:this.options.menuLayout,parseHTML:this.parseHTML.bind(this),setDefaults:t,widgetId:this.options.widgetId}),this.menuCheckbox.$el.appendTo(this.$el.find(".checkboxes"))},addMenuLayoutItem:function(){var t=this;_.each(this.options.menuLayout,function(e){new MenuLayoutItem({codeEditor:t.options.codeEditor,componentModel:t.options.componentModel,menuLayout:e,onPresetSelected:t.onPresetSelected.bind(t),parseHTML:t.parseHTML.bind(t),widgetId:t.options.widgetId}).$el.appendTo(t.$el.find(".presets"))})},decodeId:function(e){return atob(e)},findId:function(){var e=this.parseHTML();return!!e&&$(e[1]).attr("id")},onPresetSelected:function(e){this.addMenuLayoutCheckbox(e,!0)},parseHTML:function(e){e=e||this.codeEditor.getValue(),e=/.*[\s\S]*(\<\!.*START\].*-->.*[\s\S]*)/.exec(e);return e?this.stripHTML($.parseHTML(e[1])):null},render:function(){this.$el.html(T.MenuLayoutList({text:"Sample Layout Presets"})),this.addMenuLayoutItem();var e=this.findId();e&&this.addMenuLayoutCheckbox(e,!1)},stripHTML:function(e){for(var t=[],i=0;i<e.length;i++)"\n"!=e[i].data&&"\r\n"!=e[i].data&&t.push(e[i]);return t}}),bkExtend=function(){var e,t=arguments;for(e in(t=1==t.length?[this,t[0]]:t)[1])t[0][e]=t[1][e];return t[0]};function bkClass(){}bkClass.prototype.construct=function(){},bkClass.extend=function(e){function t(){if(arguments[0]!==bkClass)return this.construct.apply(this,arguments)}var i=new this(bkClass);return bkExtend(i,e),t.prototype=i,t.extend=this.extend,t};var bkElement=bkClass.extend({construct:function(e,t){return e=$BK(e="string"==typeof e?(t||document).createElement(e):e)},appendTo:function(e){return e.appendChild(this),this},appendBefore:function(e){return e.parentNode.insertBefore(this,e),this},addEvent:function(e,t){return bkLib.addEvent(this,e,t),this},setContent:function(e){return this.innerHTML=e,this},pos:function(){var e=curtop=0;obj=this;if(obj.offsetParent)for(;e+=obj.offsetLeft,curtop+=obj.offsetTop,obj=obj.offsetParent;);var t=!window.opera&&parseInt(this.getStyle("border-width")||this.style.border)||0;return[e+t,curtop+t+this.offsetHeight]},noSelect:function(){return bkLib.noSelect(this),this},parentTag:function(e){var t=this;do{if(t&&t.nodeName&&t.nodeName.toUpperCase()==e)return t}while(t=t.parentNode);return!1},hasClass:function(e){return this.className.match(new RegExp("(\\s|^)nicEdit-"+e+"(\\s|$)"))},addClass:function(e){return this.hasClass(e)||(this.className+=" nicEdit-"+e),this},removeClass:function(e){return this.hasClass(e)&&(this.className=this.className.replace(new RegExp("(\\s|^)nicEdit-"+e+"(\\s|$)")," ")),this},setStyle:function(e){var t,i=this.style;for(t in e)switch(t){case"float":i.cssFloat=i.styleFloat=e[t];break;case"opacity":i.opacity=e[t],i.filter="alpha(opacity="+Math.round(100*e[t])+")";break;case"className":this.className=e[t];break;default:i[t]=e[t]}return this},getStyle:function(e,t){t=t||document.defaultView;if(1==this.nodeType)return t&&t.getComputedStyle?t.getComputedStyle(this,null).getPropertyValue(e):this.currentStyle[bkLib.camelize(e)]},remove:function(){return this.parentNode.removeChild(this),this},setAttributes:function(e){for(var t in e)this[t]=e[t];return this}}),bkLib={isMSIE:-1!=navigator.appVersion.indexOf("MSIE"),addEvent:function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)},toArray:function(e){for(var t=e.length,i=new Array(t);t--;)i[t]=e[t];return i},noSelect:function(e){e.setAttribute&&"input"!=e.nodeName.toLowerCase()&&"textarea"!=e.nodeName.toLowerCase()&&e.setAttribute("unselectable","on");for(var t=0;t<e.childNodes.length;t++)bkLib.noSelect(e.childNodes[t])},camelize:function(e){return e.replace(/\-(.)/g,function(e,t){return t.toUpperCase()})},inArray:function(e,t){return null!=bkLib.search(e,t)},search:function(e,t){for(var i=0;i<e.length;i++)if(e[i]==t)return i;return null},cancelEvent:function(e){return(e=e||window.event).preventDefault&&e.stopPropagation&&(e.preventDefault(),e.stopPropagation()),!1},domLoad:[],domLoaded:function(){if(!arguments.callee.done)for(arguments.callee.done=!0,i=0;i<bkLib.domLoad.length;i++)bkLib.domLoad[i]()},onDomLoaded:function(e){this.domLoad.push(e),document.addEventListener?document.addEventListener("DOMContentLoaded",bkLib.domLoaded,null):bkLib.isMSIE&&(document.write("<style>.nicEdit-main p { margin: 0; }</style><script id=__ie_onload defer "+("https:"==location.protocol?"src='javascript:void(0)'":"src=//0")+"><\/script>"),$BK("__ie_onload").onreadystatechange=function(){"complete"==this.readyState&&bkLib.domLoaded()}),window.onload=bkLib.domLoaded}};function $BK(e){return(e="string"==typeof e?document.getElementById(e):e)&&!e.appendTo?bkExtend(e,bkElement.prototype):e}var bkEvent={addEvent:function(e,t){return t&&(this.eventList=this.eventList||{},this.eventList[e]=this.eventList[e]||[],this.eventList[e].push(t)),this},fireEvent:function(){var e=bkLib.toArray(arguments),t=e.shift();if(this.eventList&&this.eventList[t])for(var i=0;i<this.eventList[t].length;i++)this.eventList[t][i].apply(this,e)}};function __(e){return e}Function.prototype.closure=function(){var e=this,t=bkLib.toArray(arguments),i=t.shift();return function(){if(void 0!==bkLib)return e.apply(i,t.concat(bkLib.toArray(arguments)))}},Function.prototype.closureListener=function(){var i=this,n=bkLib.toArray(arguments),o=n.shift();return function(e){var t;return t=(e=e||window.event).target||e.srcElement,i.apply(o,[e,t].concat(n))}};var nicEditorConfig=bkClass.extend({buttons:{bold:{name:__("Click to Bold"),command:"Bold",tags:["B","STRONG"],css:{"font-weight":"bold"},key:"b",content:'<i class="fa fa-fw fa-bold" />'},italic:{name:__("Click to Italic"),command:"Italic",tags:["EM","I"],css:{"font-style":"italic"},key:"i",content:'<i class="fa fa-fw fa-italic" />'},underline:{name:__("Click to Underline"),command:"Underline",tags:["U"],css:{"text-decoration":"underline"},key:"u",content:'<i class="fa fa-fw fa-underline" />'},left:{name:__("Left Align"),command:"justifyleft",noActive:!0,content:'<i class="fa fa-fw fa-align-left" />'},center:{name:__("Center Align"),command:"justifycenter",noActive:!0,content:'<i class="fa fa-fw fa-align-center" />'},right:{name:__("Right Align"),command:"justifyright",noActive:!0,content:'<i class="fa fa-fw fa-align-right" />'},justify:{name:__("Justify Align"),command:"justifyfull",noActive:!0,content:'<i class="fa fa-fw fa-align-justify" />'},ol:{name:__("Insert Ordered List"),command:"insertorderedlist",tags:["OL"],content:'<i class="fa fa-fw fa-list-ol" />'},ul:{name:__("Insert Unordered List"),command:"insertunorderedlist",tags:["UL"],content:'<i class="fa fa-fw fa-list-ul" />'},subscript:{name:__("Click to Subscript"),command:"subscript",tags:["SUB"],content:'<i class="fa fa-fw fa-subscript" />'},superscript:{name:__("Click to Superscript"),command:"superscript",tags:["SUP"],content:'<i class="fa fa-fw fa-superscript" />'},strikethrough:{name:__("Click to Strike Through"),command:"strikeThrough",css:{"text-decoration":"line-through"},content:'<i class="fa fa-fw fa-align-justify" />'},removeformat:{name:__("Remove Formatting"),command:"removeformat",noActive:!0},indent:{name:__("Indent Text"),command:"indent",noActive:!0,content:'<i class="fa fa-fw fa-indent" />'},outdent:{name:__("Remove Indent"),command:"outdent",noActive:!0,content:'<i class="fa fa-fw fa-flip-horizontal fa-indent" />'},hr:{name:__("Horizontal Rule"),command:"insertHorizontalRule",noActive:!0}},buttonList:["save","bold","italic","underline","left","center","right","justify","ol","ul","fontSize","fontFamily","fontFormat","indent","outdent","image","upload","link","unlink","forecolor","html","beautify"],iconList:{bgcolor:1,forecolor:2,bold:3,center:4,hr:5,indent:6,italic:7,justify:8,left:9,ol:10,outdent:11,removeformat:12,right:13,save:24,strikethrough:15,subscript:16,superscript:17,ul:18,underline:19,image:20,link:21,unlink:22,close:23,arrow:25,html:26,beautify:27}}),nicEditors={nicPlugins:[],editors:[],registerPlugin:function(e,t){this.nicPlugins.push({p:e,o:t})},allTextAreas:function(e){for(var t=document.getElementsByTagName("textarea"),i=0;i<t.length;i++)nicEditors.editors.push(new nicEditor(e).panelInstance(t[i]));return nicEditors.editors},findEditor:function(e){for(var t=nicEditors.editors,i=0;i<t.length;i++)if(t[i].instanceById(e))return t[i].instanceById(e)}},nicEditor=bkClass.extend({construct:function(e){this.options=new nicEditorConfig,bkExtend(this.options,e),this.nicInstances=new Array,this.loadedPlugins=new Array;for(var t=nicEditors.nicPlugins,i=0;i<t.length;i++)this.loadedPlugins.push(new t[i].p(this,t[i].o));nicEditors.editors.push(this),bkLib.addEvent(document.body,"mousedown",this.selectCheck.closureListener(this))},panelInstance:function(e,t){e=this.checkReplace($BK(e));var i=new bkElement("DIV").appendBefore(e);return this.setPanel(i),this.addInstance(e,t)},checkReplace:function(e){var t=nicEditors.findEditor(e);return t&&(t.removeInstance(e),t.removePanel()),e},addInstance:function(e,t){return e=new((e=this.checkReplace($BK(e))).contentEditable||window.opera?nicEditorInstance:nicEditorIFrameInstance)(e,t,this),this.nicInstances.push(e),this},removeInstance:function(e){e=$BK(e);for(var t=this.nicInstances,i=0;i<t.length;i++)t[i].e==e&&(t[i].remove(),this.nicInstances.splice(i,1))},removePanel:function(e){this.nicPanel&&(this.nicPanel.remove(),this.nicPanel=null)},instanceById:function(e){e=$BK(e);for(var t=this.nicInstances,i=0;i<t.length;i++)if(t[i].e==e)return t[i]},setPanel:function(e){return this.nicPanel=new nicEditorPanel($BK(e),this.options,this),this.fireEvent("panel",this.nicPanel),this},nicCommand:function(e,t){this.selectedInstance&&this.selectedInstance.nicCommand(e,t)},getIcon:function(e,t){this.options.iconList[e],t.iconFiles&&t.iconFiles[e];return{}},selectCheck:function(e,t){do{if(t.className&&"function"==typeof t.className.indexOf&&-1!=t.className.indexOf("nicEdit"))return!1}while(t=t.parentNode);return this.fireEvent("blur",this.selectedInstance,t),this.lastSelectedInstance=this.selectedInstance,this.selectedInstance=null,!1}}),nicEditor=nicEditor.extend(bkEvent),nicEditorInstance=bkClass.extend({isSelected:!1,construct:function(e,t,i){this.ne=i,this.elm=this.e=e,this.options=t||{},newX=parseInt(e.getStyle("width"))||e.clientWidth,newY=parseInt(e.getStyle("height"))||e.clientHeight,this.initialHeight=newY-8;var n,i="textarea"==e.nodeName.toLowerCase();(i||this.options.hasPanel)&&((t={border:"1px solid #ccc",borderTop:0,overflowY:"auto",overflowX:"hidden"})[(n=bkLib.isMSIE&&!(void 0!==document.body.style.maxHeight&&"CSS1Compat"==document.compatMode))?"height":"maxHeight"]=this.ne.options.maxHeight?this.ne.options.maxHeight+"px":null,this.editorContain=new bkElement("DIV").setStyle(t).appendBefore(e),t=new bkElement("DIV").setStyle({margin:"4px",minHeight:newY+"px"}).addClass("main").appendTo(this.editorContain),e.setStyle({display:"none"}),t.innerHTML=e.innerHTML,i&&(t.setContent(e.value),i=(this.copyElm=e).parentTag("FORM"))&&bkLib.addEvent(i,"submit",this.saveContent.closure(this)),t.setStyle(n?{height:newY+"px"}:{overflow:"hidden"}),this.elm=t),this.ne.addEvent("blur",this.blur.closure(this)),this.init(),this.blur()},init:function(){this.elm.setAttribute("contentEditable","true"),""==this.getContent()&&this.setContent("<br />"),this.instanceDoc=document.defaultView,this.elm.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keypress",this.keyDown.closureListener(this)).addEvent("focus",this.selected.closure(this)).addEvent("blur",this.blur.closure(this)).addEvent("keyup",this.selected.closure(this)),this.ne.fireEvent("add",this)},remove:function(){this.saveContent(),(this.copyElm||this.options.hasPanel)&&(this.editorContain.remove(),this.e.setStyle({display:"block"}),this.ne.removePanel()),this.disable(),this.ne.fireEvent("remove",this)},disable:function(){this.elm.setAttribute("contentEditable","false")},getSel:function(){return window.getSelection?window.getSelection():document.selection},getRng:function(){var e=this.getSel();if(e&&0!==e.rangeCount)return 0<e.rangeCount?e.getRangeAt(0):e.createRange()},selRng:function(e,t){window.getSelection?(t.removeAllRanges(),t.addRange(e)):e.select()},selElm:function(){var e=this.getRng();if(e){if(e.startContainer){var t=e.startContainer;if(1==e.cloneContents().childNodes.length)for(var i=0;i<t.childNodes.length;i++){var n=t.childNodes[i].ownerDocument.createRange();if(n.selectNode(t.childNodes[i]),1!=e.compareBoundaryPoints(Range.START_TO_START,n)&&-1!=e.compareBoundaryPoints(Range.END_TO_END,n))return $BK(t.childNodes[i])}return $BK(t)}return $BK("Control"==this.getSel().type?e.item(0):e.parentElement())}},saveRng:function(){this.savedRange=this.getRng(),this.savedSel=this.getSel()},restoreRng:function(){this.savedRange&&this.selRng(this.savedRange,this.savedSel)},keyDown:function(e,t){e.ctrlKey&&this.ne.fireEvent("key",this,e)},selected:function(e,t){return t=(t=t||this.selElm)||this.selElm(),e.ctrlKey||((e=this.ne.selectedInstance)!=this&&(e&&this.ne.fireEvent("blur",e,t),(this.ne.selectedInstance=this).ne.fireEvent("focus",e,t)),this.ne.fireEvent("selected",e,t),this.isFocused=!0,this.elm.addClass("selected")),!1},blur:function(){this.isFocused=!1,this.elm.removeClass("selected")},saveContent:function(){(this.copyElm||this.options.hasPanel)&&(this.ne.fireEvent("save",this),this.copyElm?this.copyElm.value=this.getContent():this.e.innerHTML=this.getContent())},getElm:function(){return this.elm},getContent:function(){return this.content=this.getElm().innerHTML,this.ne.fireEvent("get",this),this.content},setContent:function(e){this.content=e,this.ne.fireEvent("set",this),this.elm.innerHTML=this.content},nicCommand:function(e,t){document.execCommand(e,!1,t)}}),nicEditorIFrameInstance=nicEditorInstance.extend({savedStyles:[],init:function(){var e=this.elm.innerHTML.replace(/^\s+|\s+$/g,"");this.elm.innerHTML="",this.initialContent=e=e||"<br />",this.elmFrame=new bkElement("iframe").setAttributes({src:"javascript:;",frameBorder:0,allowTransparency:"true",scrolling:"no"}).setStyle({height:"100px",width:"100%"}).addClass("frame").appendTo(this.elm),this.copyElm&&this.elmFrame.setStyle({width:this.elm.offsetWidth-4+"px"});for(itm in["font-size","font-family","font-weight","color"])this.savedStyles[bkLib.camelize(itm)]=this.elm.getStyle(itm);setTimeout(this.initFrame.closure(this),50)},disable:function(){this.elm.innerHTML=this.getContent()},initFrame:function(){var e=$BK(this.elmFrame.contentWindow.document),t=(e.designMode="on",e.open(),this.ne.options.externalCSS);e.write("<html><head>"+(t?'<link href="'+t+'" rel="stylesheet" type="text/css" />':"")+'</head><body id="nicEditContent" style="margin: 0 !important; background-color: transparent !important;">'+this.initialContent+"</body></html>"),e.close(),this.frameDoc=e,this.frameWin=$BK(this.elmFrame.contentWindow),this.frameContent=$BK(this.frameWin.document.body).setStyle(this.savedStyles),this.instanceDoc=this.frameWin.document.defaultView,this.heightUpdate(),this.frameDoc.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keyup",this.heightUpdate.closureListener(this)).addEvent("keydown",this.keyDown.closureListener(this)).addEvent("keyup",this.selected.closure(this)),this.ne.fireEvent("add",this)},getElm:function(){return this.frameContent},setContent:function(e){this.content=e,this.ne.fireEvent("set",this),this.frameContent.innerHTML=this.content,this.heightUpdate()},getSel:function(){return this.frameWin?this.frameWin.getSelection():this.frameDoc.selection},heightUpdate:function(){this.elmFrame.style.height=Math.max(this.frameContent.offsetHeight,this.initialHeight)+"px"},nicCommand:function(e,t){this.frameDoc.execCommand(e,!1,t),setTimeout(this.heightUpdate.closure(this),100)}}),nicEditorPanel=bkClass.extend({construct:function(e,t,i){this.elm=e,this.options=t,this.ne=i,this.panelButtons=new Array,this.buttonList=bkExtend([],this.ne.options.buttonList),this.panelContain=new bkElement("DIV").addClass("panelContain"),this.panelElm=new bkElement("DIV").addClass("panel").appendTo(this.panelContain),this.panelContain.appendTo(e);var n=this.ne.options;for(button in n.buttons)this.addButton(button,n,!0);this.reorder(),e.noSelect()},addButton:function(buttonName,options,noOrder){var button=options.buttons[buttonName],type=button.type?eval("(typeof("+button.type+') == "undefined") ? null : '+button.type+";"):nicEditorButton,hasButton=bkLib.inArray(this.buttonList,buttonName);type&&(hasButton||this.ne.options.fullPanel)&&(this.panelButtons.push(new type(this.panelElm,buttonName,options,this.ne)),hasButton||this.buttonList.push(buttonName))},findButton:function(e){for(var t=0;t<this.panelButtons.length;t++)if(this.panelButtons[t].name==e)return this.panelButtons[t]},reorder:function(){for(var e=this.buttonList,t=0;t<e.length;t++){var i=this.findButton(e[t]);i&&this.panelElm.appendChild(i.margin)}},remove:function(){this.elm.remove()}}),nicEditorButton=bkClass.extend({construct:function(e,t,i,n){this.options=i.buttons[t],this.name=t,this.ne=n,this.elm=e,this.margin=new bkElement("DIV").setStyle({float:"left",margin:"1px"}).appendTo(e),this.contain=new bkElement("DIV").setStyle({width:"24px",height:"24px"}).addClass("buttonContain").appendTo(this.margin),this.border=new bkElement("DIV").setStyle({}).appendTo(this.contain),this.options.content?(this.button=new bkElement("DIV").appendTo(this.border).setStyle({width:"22px",height:"22px",overflow:"hidden",zoom:1,cursor:"pointer"}).addClass("button"),this.button.innerHTML=this.options.content):this.button=new bkElement("DIV").setStyle({width:"22px",height:"22px",overflow:"hidden",zoom:1,cursor:"pointer"}).addClass("button").setStyle(this.ne.getIcon(t,i)).appendTo(this.border),this.button.addEvent("mouseover",this.hoverOn.closure(this)).addEvent("mouseout",this.hoverOff.closure(this)).addEvent("mousedown",this.mouseClick.closure(this)).noSelect(),window.opera||(this.button.onmousedown=this.button.onclick=bkLib.cancelEvent),n.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)).addEvent("key",this.key.closure(this)),this.disable(),this.init()},init:function(){},hide:function(){this.contain.setStyle({display:"none"})},updateState:function(){this.isDisabled?this.setBg():this.isHover?this.setBg("hover"):this.isActive?this.setBg("active"):this.setBg()},setBg:function(e){this.border.removeClass("button-active").removeClass("button-hover").addClass("button-"+e)},checkNodes:function(e){var t=e;do{if(this.options.tags&&bkLib.inArray(this.options.tags,t.nodeName))return this.activate(),!0}while(t=t.parentNode&&"nicEdit"!=t.className);for(t=$BK(e);3==t.nodeType;)t=$BK(t.parentNode);if(this.options.css)for(itm in this.options.css)if(t.getStyle(itm,this.ne.selectedInstance.instanceDoc)==this.options.css[itm])return this.activate(),!0;return this.deactivate(),!1},activate:function(){this.isDisabled||(this.isActive=!0,this.updateState(),this.ne.fireEvent("buttonActivate",this))},deactivate:function(){this.isActive=!1,this.updateState(),this.isDisabled||this.ne.fireEvent("buttonDeactivate",this)},enable:function(e,t){this.isDisabled=!1,this.contain.setStyle({opacity:1}).addClass("buttonEnabled"),this.updateState(),this.checkNodes(t)},disable:function(e,t){this.isDisabled=!0,this.contain.setStyle({opacity:.6}).removeClass("buttonEnabled"),this.updateState()},toggleActive:function(){this.isActive?this.deactivate():this.activate()},hoverOn:function(){this.isDisabled||(this.isHover=!0,this.updateState(),this.ne.fireEvent("buttonOver",this))},hoverOff:function(){this.isHover=!1,this.updateState(),this.ne.fireEvent("buttonOut",this)},mouseClick:function(){this.options.command&&(this.ne.nicCommand(this.options.command,this.options.commandArgs),this.options.noActive||this.toggleActive()),this.ne.fireEvent("buttonClick",this)},key:function(e,t){this.options.key&&t.ctrlKey&&String.fromCharCode(t.keyCode||t.charCode).toLowerCase()==this.options.key&&(this.mouseClick(),t.preventDefault)&&t.preventDefault()}}),nicPlugin=bkClass.extend({construct:function(e,t){this.options=t,this.ne=e,this.ne.addEvent("panel",this.loadPanel.closure(this)),this.init()},loadPanel:function(e){for(var t in this.options.buttons)e.addButton(t,this.options);e.reorder()},init:function(){}}),nicPaneOptions={},nicEditorPane=bkClass.extend({construct:function(e,t,i,n){this.ne=t,this.elm=e,this.pos=e.pos(),this.contain=new bkElement("div").setStyle({zIndex:"99999",overflow:"hidden",position:"absolute",left:this.pos[0]+"px",top:this.pos[1]+"px"}),this.pane=new bkElement("div").setStyle({fontSize:"12px",border:"1px solid #ccc",overflow:"hidden",padding:"4px",textAlign:"left",backgroundColor:"#ffffc9"}).addClass("pane").setStyle(i).appendTo(this.contain),n&&!n.options.noClose&&(this.close=new bkElement("div").setStyle({float:"right",height:"16px",width:"16px",cursor:"pointer"}).setStyle(this.ne.getIcon("close",nicPaneOptions)).addEvent("mousedown",n.removePane.closure(this)).appendTo(this.pane)),this.contain.noSelect().appendTo(document.body),this.position(),this.init()},init:function(){},position:function(){var e;this.ne.nicPanel&&(e=(e=this.ne.nicPanel.elm).pos()[0]+parseInt(e.getStyle("width"))-(parseInt(this.pane.getStyle("width"))+8))<this.pos[0]&&this.contain.setStyle({left:e+"px"})},toggle:function(){this.isVisible=!this.isVisible,this.contain.setStyle({display:this.isVisible?"block":"none"})},remove:function(){this.contain&&(this.contain.remove(),this.contain=null)},append:function(e){e.appendTo(this.pane)},setContent:function(e){this.pane.setContent(e)}}),nicEditorAdvancedButton=nicEditorButton.extend({init:function(){this.ne.addEvent("selected",this.removePane.closure(this)).addEvent("blur",this.removePane.closure(this))},mouseClick:function(){this.isDisabled||(this.pane&&this.pane.pane?this.removePane():(this.pane=new nicEditorPane(this.contain,this.ne,{width:this.width||"270px",backgroundColor:"#303030",color:"#fff"},this),this.addPane(),this.ne.selectedInstance.saveRng()))},addForm:function(e,t){var i=this;for(itm in this.form=new bkElement("form").addEvent("submit",this.submit.closureListener(this)),$(this.pane.pane).addClass("quick-dash rich-text-editor-dialog"),this.pane.append(this.form),this.inputs={},e){var n=e[itm],o="",a=(o=(o=t?t.getAttribute(itm):o)||n.value||"",e[itm].type);if("title"==a)new bkElement("div").setContent(n.txt).setStyle({fontSize:"14px",fontWeight:"bold",padding:"0px",margin:"2px 0"}).appendTo(this.form);else{var s=new bkElement("div").setStyle({overflow:"hidden",clear:"both"}).appendTo(this.form);switch(n.txt&&new bkElement("label").setAttributes({for:itm}).setContent(n.txt).setStyle({margin:"2px 4px",fontSize:"13px",width:"50px",lineHeight:"20px",textAlign:"right",float:"left"}).appendTo(s),a){case"text":this.inputs[itm]=new bkElement("input").setAttributes({id:itm,value:o,type:"text"}).setStyle({margin:"2px 0",fontSize:"13px",float:"left",height:"20px",border:"none",overflow:"hidden"}).setStyle(n.style).appendTo(s);break;case"select":for(opt in this.inputs[itm]=new bkElement("select").setAttributes({id:itm}).setStyle({border:"none",float:"left",margin:"2px 0"}).appendTo(s),n.options)new bkElement("option").setAttributes({value:opt,selected:opt==o?"selected":""}).setContent(n.options[opt]).appendTo(this.inputs[itm]);break;case"content":this.inputs[itm]=new bkElement("textarea").setAttributes({id:itm}).setStyle({border:"1px solid #ccc",float:"left"}).setStyle(n.style).appendTo(s),this.inputs[itm].value=o;break;case"imageupload":var l=$('<div><input class="file-input" type="file"  accept="image/*" style="display: none;"/><div class="upload-btn" style="height: 25px;">Upload Image</div><span class="file-name"></span></div>');this.inputs[itm]=new bkElement(l).appendTo(s),l.find(".upload-btn").button({icon:"fa fa-upload",text:!0}).click(function(){l.find(".file-input").click()}),l.find(".file-input").on("change",function(e){var t;0<e.target.files.length&&((t=new FileReader).onload=function(e){i.imgSrc=e.target.result,l.find(".file-name").text(l.find(".file-input").val().replace(/C:\\fakepath\\/i,""))},t.readAsDataURL(e.target.files[0]))})}}}new bkElement("input").setAttributes({type:"submit"}).appendTo(this.form),this.form.onsubmit=bkLib.cancelEvent},submit:function(){},findElm:function(e,t,i){for(var n=this.ne.selectedInstance.getElm().getElementsByTagName(e),o=0;o<n.length;o++)if(n[o].getAttribute(t)==i)return $BK(n[o])},removePane:function(){this.pane&&(this.pane.remove(),this.pane=null,this.ne.selectedInstance.restoreRng())}}),nicButtonTips=bkClass.extend({construct:function(e){(this.ne=e).addEvent("buttonOver",this.show.closure(this)).addEvent("buttonOut",this.hide.closure(this))},show:function(e){this.timer=setTimeout(this.create.closure(this,e),400)},create:function(e){this.timer=null,this.pane||(this.pane=new nicEditorPane(e.button,this.ne,{fontSize:"12px",marginTop:"5px"}),this.pane.setContent(e.options.name))},hide:function(e){this.timer&&clearTimeout(this.timer),this.pane&&(this.pane=this.pane.remove())}}),nicSelectOptions=(nicEditors.registerPlugin(nicButtonTips),{buttons:{fontSize:{name:__("Select Font Size"),type:"nicEditorFontSizeSelect",command:"fontsize"},fontFamily:{name:__("Select Font Family"),type:"nicEditorFontFamilySelect",command:"fontname"},fontFormat:{name:__("Select Font Format"),type:"nicEditorFontFormatSelect",command:"formatBlock"}}}),nicEditorSelect=bkClass.extend({construct:function(e,t,i,n){this.options=i.buttons[t],this.elm=e,this.ne=n,this.name=t,this.selOptions=new Array,this.margin=new bkElement("div").setStyle({float:"left",margin:"1px 1px 0 1px"}).appendTo(this.elm),this.contain=new bkElement("div").setStyle({width:"90px",padding:"4px",height:"16px",cursor:"pointer",overflow:"hidden"}).addClass("selectContain").addEvent("click",this.toggle.closure(this)).appendTo(this.margin),this.items=new bkElement("div").setStyle({overflow:"hidden",zoom:1,border:"transparent",paddingLeft:"3px"}).appendTo(this.contain),this.control=new bkElement("i").setStyle({overflow:"hidden",marginTop:"3px",float:"right",height:"18px",width:"16px"}).addClass("selectControl fa fa-fw fa-caret-down").appendTo(this.items),this.txt=new bkElement("div").setStyle({overflow:"hidden",float:"left",width:"66px",height:"14px",marginTop:"1px",fontFamily:"sans-serif",textAlign:"center",fontSize:"12px"}).addClass("selectTxt").appendTo(this.items),window.opera||(this.contain.onmousedown=this.control.onmousedown=this.txt.onmousedown=bkLib.cancelEvent),this.margin.noSelect(),this.ne.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)),this.disable(),this.init()},disable:function(){this.isDisabled=!0,this.close(),this.contain.setStyle({opacity:.6})},enable:function(e){this.isDisabled=!1,this.close(),this.contain.setStyle({opacity:1})},setDisplay:function(e){this.txt.setContent(e)},toggle:function(){this.isDisabled||(this.pane?this.close():this.open())},open:function(){this.pane=new nicEditorPane(this.items,this.ne,{width:"88px",padding:"0px",borderTop:0,borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderBottom:"0px",backgroundColor:"#fff"});for(var e=0;e<this.selOptions.length;e++){var t=this.selOptions[e],i=new bkElement("div").setStyle({overflow:"hidden",borderBottom:"1px solid #ccc",width:"88px",textAlign:"left",cursor:"pointer"}),n=new bkElement("div").setStyle({padding:"0px 4px"}).setContent(t[1]).appendTo(i).noSelect();n.addEvent("click",this.update.closure(this,t[0])).addEvent("mouseover",this.over.closure(this,n)).addEvent("mouseout",this.out.closure(this,n)).setAttributes("id",t[0]),this.pane.append(i),window.opera||(n.onmousedown=bkLib.cancelEvent)}},close:function(){this.pane&&(this.pane=this.pane.remove())},over:function(e){e.setStyle({backgroundColor:"#ccc"})},out:function(e){e.setStyle({backgroundColor:"#fff"})},add:function(e,t){this.selOptions.push(new Array(e,t))},update:function(e){this.ne.nicCommand(this.options.command,e),this.close()}}),nicEditorFontSizeSelect=nicEditorSelect.extend({sel:{1:"1&nbsp;(8pt)",2:"2&nbsp;(10pt)",3:"3&nbsp;(12pt)",4:"4&nbsp;(14pt)",5:"5&nbsp;(18pt)",6:"6&nbsp;(24pt)"},init:function(){for(itm in this.setDisplay("Font&nbsp;Size..."),this.sel)this.add(itm,'<font size="'+itm+'">'+this.sel[itm]+"</font>")}}),nicEditorFontFamilySelect=nicEditorSelect.extend({sel:{arial:"Arial","comic sans ms":"Comic Sans","courier new":"Courier New",georgia:"Georgia",helvetica:"Helvetica",impact:"Impact","times new roman":"Times","trebuchet ms":"Trebuchet",verdana:"Verdana"},init:function(){for(itm in this.setDisplay("Font&nbsp;Family..."),this.sel)this.add(itm,'<font face="'+itm+'">'+this.sel[itm]+"</font>")}}),nicEditorFontFormatSelect=nicEditorSelect.extend({sel:{p:"Paragraph",pre:"Pre",h6:"Heading&nbsp;6",h5:"Heading&nbsp;5",h4:"Heading&nbsp;4",h3:"Heading&nbsp;3",h2:"Heading&nbsp;2",h1:"Heading&nbsp;1"},init:function(){for(itm in this.setDisplay("Font&nbsp;Format..."),this.sel){var e=itm.toUpperCase();this.add("<"+e+">","<"+itm+' style="padding: 0px; margin: 0px;">'+this.sel[itm]+"</"+e+">")}}}),nicLinkOptions=(nicEditors.registerPlugin(nicPlugin,nicSelectOptions),{buttons:{link:{name:"Add Link",type:"nicLinkButton",tags:["A"],content:'<i class="fa fa-fw fa-link"/>'},unlink:{name:"Remove Link",command:"unlink",noActive:!0,content:'<i class="fa fa-fw fa-unlink"/>'}}}),nicLinkButton=nicEditorAdvancedButton.extend({addPane:function(){this.ln=this.ne.selectedInstance.selElm().parentTag("A"),this.addForm({"":{type:"title",txt:"Add/Edit Link"},href:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},title:{type:"text",txt:"Title"},target:{type:"select",txt:"Open In",options:{"":"Current Window",_blank:"New Window"},style:{width:"100px"}}},this.ln)},submit:function(e){var t=this.inputs.href.value;if("http://"==t||""==t)return alert("You must enter a URL to Create a Link"),!1;this.removePane(),this.ln||(this.ne.nicCommand("createlink",t="javascript:nicTemp();"),this.ln=this.findElm("A","href",t)),this.ln&&this.ln.setAttributes({href:this.inputs.href.value,title:this.inputs.title.value,target:this.inputs.target.options[this.inputs.target.selectedIndex].value})}}),nicColorOptions=(nicEditors.registerPlugin(nicPlugin,nicLinkOptions),{buttons:{forecolor:{name:__("Change Text Color"),type:"nicEditorColorButton",noClose:!0,content:'<i class="fa fa-fw fa-font" />'},bgcolor:{name:__("Change Background Color"),type:"nicEditorBgColorButton",noClose:!0,content:'<i class="fa fa-fa fa-eyedropper"></i>'}}}),nicEditorColorButton=nicEditorAdvancedButton.extend({addPane:function(){var e,t={0:"00",1:"33",2:"66",3:"99",4:"CC",5:"FF"},i=new bkElement("DIV").setStyle({width:"270px"});for(e in t)for(var n in t)for(var o in t){var o="#"+t[e]+t[o]+t[n],a=new bkElement("DIV").setStyle({cursor:"pointer",height:"15px",float:"left"}).appendTo(i),s=new bkElement("DIV").setStyle({border:"2px solid "+o}).appendTo(a),o=new bkElement("DIV").setStyle({backgroundColor:o,overflow:"hidden",width:"11px",height:"11px"}).addEvent("click",this.colorSelect.closure(this,o)).addEvent("mouseover",this.on.closure(this,s)).addEvent("mouseout",this.off.closure(this,s,o)).appendTo(s);window.opera||(a.onmousedown=o.onmousedown=bkLib.cancelEvent)}this.pane.append(i.noSelect())},colorSelect:function(e){this.ne.nicCommand("foreColor",e),this.removePane()},on:function(e){e.setStyle({border:"2px solid #000"})},off:function(e,t){e.setStyle({border:"2px solid "+t})}}),nicEditorBgColorButton=nicEditorColorButton.extend({colorSelect:function(e){this.ne.nicCommand("hiliteColor",e),this.removePane()}}),nicImageOptions=(nicEditors.registerPlugin(nicPlugin,nicColorOptions),{buttons:{image:{name:"Add Image",type:"nicImageButton",tags:["IMG"],content:'<i class="fa fa-fw fa-picture-o" />'}}}),nicImageButton=nicEditorAdvancedButton.extend({addPane:function(){this.im=this.ne.selectedInstance.selElm().parentTag("IMG"),this.addForm({"":{type:"title",txt:"Add/Edit Image"},width:{type:"text",txt:"Width",value:"",style:{width:"100px"}},height:{type:"text",txt:"Height",value:"",style:{width:"100px"}},alt:{type:"text",txt:"Alt Text",style:{width:"100px"}},align:{type:"select",txt:"Align",options:{none:"Default",left:"Left",right:"Right"}},imageupload:{type:"imageupload",txt:"Source",style:{width:"100px",height:"25px;"}}},this.im)},submit:function(e){var t;if(this.removePane(),this.im||(this.ne.nicCommand("insertImage",t="javascript:nicImTemp();"),this.im=this.findElm("IMG","src",t)),this.im){if(this.imgSrc)this.im.setAttributes({src:this.imgSrc,alt:this.inputs.alt.value,align:this.inputs.align.value});else if("javascript:nicImTemp();"!==this.im.src.length)this.im.setAttributes({alt:this.inputs.alt.value,align:this.inputs.align.value});else if(!this.imgSrc||0==this.imgSrc.length)return alert("You must upload an image to insert"),!1;0<this.inputs.width.value&&this.im.setAttributes({width:this.inputs.width.value}),0<this.inputs.height.value&&this.im.setAttributes({height:this.inputs.height.value}),this.imgSrc=null}}}),nicSaveOptions=(nicEditors.registerPlugin(nicPlugin,nicImageOptions),{buttons:{save:{name:__("Save this content"),type:"nicEditorSaveButton"}}}),nicEditorSaveButton=nicEditorButton.extend({init:function(){this.ne.options.onSave||this.margin.setStyle({display:"none"})},mouseClick:function(){var e=this.ne.options.onSave,t=this.ne.selectedInstance;e(t.getContent(),t.elm.id,t)}}),nicHTMLOptions=(nicEditors.registerPlugin(nicPlugin,nicSaveOptions),{buttons:{html:{name:__("Edit raw HTML"),type:"nicEditorHTMLButton",content:'<i class="fa fa-fw fa-code" />'}}}),nicEditorHTMLButton=nicEditorButton.extend({init:function(){var e;this.ne.options.onCode||this.margin.setStyle({display:"none"}),this.ne.options.htmlButtonDesc&&(this.button.innerHTML=this.options.content=this.ne.options.htmlButtonDesc,e={fontFamily:"sans-serif",textAlign:"center",fontSize:"12px",width:"Basic mode"===this.options.content?"80px":"120px"},this.button.setStyle(_.extend({},e,{marginTop:"3px"})),this.contain.setStyle(e))},disable:function(){this.isDisabled||this.contain.setStyle({opacity:1})},mouseClick:function(){(0,this.ne.options.onCode)(this)}}),nicBeautifyOptions=(nicEditors.registerPlugin(nicPlugin,nicHTMLOptions),{buttons:{beautify:{name:__("Beautify HTML"),type:"beautifyButton",content:'<i class="fa fa-bath"></i>'}}}),beautifyButton=nicEditorButton.extend({init:function(){this.ne.options.onBeautify||this.margin.setStyle({display:"none"})},disable:function(){this.contain.setStyle({opacity:1})},mouseClick:function(){(0,this.ne.options.onBeautify)(this)}}),TemplateDialog=(nicEditors.registerPlugin(nicPlugin,nicBeautifyOptions),function(n){function b(e){var s=n.call(this,_.extend({},e,{className:"template-dialog"}))||this,i=(s.INSTANCE_ID="ffsEdit",s.options=e,s.keys=e.keys,s.valueData=e.valueData,s.docViewModel=e.docViewModel,s.disableTree=e.disableTree,s.$el.html(T.TemplateDialog({uid:s.INSTANCE_ID,background:e.background})),s.$textEditor=s.$el.find(".template-editor"),s.$editor=s.$el.find(".editor"),s.$code=s.$el.find(".code"),s.$error=s.$el.find(".handlebar-errors"),s.$tree=s.$el.find(".tree"),s.$search=s.$el.find(".topnav"),s.$clearSearch=s.$el.find(".clearSearch"),s.$sidebar=s.$el.find(".sidebar"),s.$basicMode=s.$el.find(".basic-mode"),s.$addHelper=s.$el.find(".add-helper"),s.$beautify=s.$el.find(".beautify"),s.$basicToolbar=s.$el.find("#htmlxEdit"),s.$advancedToolbar=s.$el.find("#advanced-toolbar"),s.disableTree&&(s.$textEditor.addClass("full-width"),s.$sidebar.hide()),s.debouncedUpdateSidebar=_.debounce(s.updateSidebar.bind(s),200),s.debouncedCheckForAdvancedHelpers=_.debounce(s.checkForAdvancedHelpers.bind(s),200),s.debouncedCheckForErrors=_.debounce(s.checkForErrors.bind(s),200),_.debounce(s.jstreeSearch.bind(s),250));return s.$search.keyup(function(e){e=e.target.value;e?s.$clearSearch.show():s.$clearSearch.hide(),i(e)}),s.$clearSearch.click(function(){s.$search.find("input").val("").trigger("keyup")}),s.$basicMode.button({icon:"fa fa-arrow-left"}).click(function(){s.htmlButton.ne.options.onCode()}),s.$beautify.button({icon:"fa fa-bath"}).click(function(){s.codeEditor.getAction("editor.action.formatDocument").run()}),$.ui.dialog.prototype._focusTabbable=$.noop.bind(s),s.$dialog=s.$el.dialog({appendTo:e.container,classes:{"ui-dialog":"template-editor-dialog"},title:"Template Editor",resizable:!0,height:b.DIALOG_HEIGHT,width:850,minWidth:710,modal:!0,autoOpen:!0,buttons:[{text:t("OK"),click:function(){s.onButtonClick(),s.$el.dialog("close")},icon:"fa fa-check"},{text:t("Apply"),click:s.onButtonClick.bind(s),icon:"fa fa-check-square-o"},{text:t("Cancel"),click:function(){s.$el.dialog("close")},icon:"fa fa-times"}],close:function(){s.remove()},open:function(){$('<i class="fa fa-code" />').insertBefore(s.$el.parent().find(".ui-dialog-title"));function e(e){s.$basicToolbar.toggle(),s.$advancedToolbar.toggle(),s.$editor.toggle(),s.$code.toggle(),s.isInCodeMode=!s.isInCodeMode,s.isInCodeMode?s.initCodeEditor(e):(s.options.allowUnsafeContent||(e=s.options.sanitizeTemplate?s.options.sanitizeTemplate(e):DOMPurify.sanitize(e,{ADD_ATTR:["target"]})),s.editor.instanceById(s.INSTANCE_ID).setContent(s.scriptify(e)),$(s.editor.instanceById(s.INSTANCE_ID).elm).focus())}var c,t,i,n,o,a;s.editor=new nicEditor({buttonList:["bold","italic","underline","left","center","right","justify","ol","ul","indent","outdent","forecolor","fontSize","html"],htmlButtonDesc:'<i class="fa fa-fw fa-code"></i> Advanced mode',onCode:function(){e(s.codeEditor&&s.isInCodeMode?s.codeEditor.getValue():null)}}),s.editor.setPanel("htmlxEdit"),s.editor.addInstance(s.INSTANCE_ID),b.NONEACH_HELPER_RX.test(s.options.text)?e(s.options.text):(t=s.scriptify(s.options.text),s.editor.instanceById(s.INSTANCE_ID).setContent(t),s.debouncedCheckForErrors(t),$(s.editor.instanceById(s.INSTANCE_ID).elm).focus()),s.htmlButton=_.find(s.editor.nicPanel.panelButtons,function(e){return"html"===e.name}),s.disableTree||(c=function(e,l,r){return void 0===l&&(l=!1),void 0===r&&(r=""),_.map(e,function(e,t){var i,n,o=_.some(e.attributes,function(e){return e instanceof QuickBase.DocumentViewModel}),a=!o&&e instanceof QuickBase.DocumentViewModel,s=o||!a&&e instanceof Object;return s?(i=t,n=r+(l?t+".":""),n=c(o?_.omit(e.attributes,".settings"):e,!0,n)):i=a?"$"+r+t+"$":r+e,{id:i,text:t,state:{selected:!1},children:s?n:[],type:s?"folder":a?"viewstate":"key"}})},t=s.keys.length?c({columns:_.keyBy(s.keys)}):[],i=c({viewstates:s.docViewModel}),n=_.reduce(s.valueData,function(e,t,i){return e[i="array"===t.type?"@"+i:i]=t.items,e},{}),n=_.isEmpty(s.valueData)?[]:c(n),o=_.union(t,n,i),a=function(e){return _.map(e.sort(function(e,t){return Math.min(1,t.children.length)-Math.min(1,e.children.length)||s.trimVSChars(e.id).localeCompare(s.trimVSChars(t.id))}),function(e){return _.reduce(e,function(e,t,i){return"children"===i&&t.length?e[i]=a(t):e[i]=t,e},{})})},o.length&&(require(["jstree"],function(){s.$tree.jstree({core:{data:a(o),multiple:!1},conditionalselect:function(e){return 0===e.children.length},contextmenu:{items:function(t){return"folder"===t.type?{}:{add:{label:"Add to editor",action:function(e){s.pendingContent||(s.$tree.jstree().deselect_node(t),s.$tree.jstree().select_node(t)),s.insertItem(t)}}}}},types:{activeKey:{icon:"fa fa-check-circle"},key:{icon:"fa fa-circle"},viewstate:{icon:"fa fa-eye"},folder:{icon:"fa fa-folder"}},search:{show_only_matches:!0,show_only_matches_children:!0},dnd:{is_draggable:function(e,t){return t.preventDefault(),!1}},plugins:["conditionalselect","contextmenu","search","types","dnd"]}),s.$tree.on("show_contextmenu.jstree",s.updateTheme.bind(s)),s.$tree.on("search.jstree",function(e,t){0===t.nodes.length&&s.$tree.jstree("hide_all")}),s.$tree.on("dblclick.jstree",function(e){var t=s.$tree.jstree().get_selected()[0],t=s.$tree.jstree().get_node(t);!t||t.a_attr.id!==e.target.id&&t.a_attr.id!==e.target.parentNode.id||s.insertItem(t)}),s.$tree.on("select_node.jstree",function(e,t){var i,n,o,a;s.isInCodeMode||(t=t.selected[0],i=nicEditors.findEditor(s.INSTANCE_ID),n="",$(i.elm).focus(),o=i.getRng(),a=i.selElm()||i.elm,i.saveRng(),t&&(n=s.wrapInHandlebars(t),a.nodeValue?s.pendingContent=a.nodeValue.substring(0,o.startOffset)+n+a.nodeValue.substring(o.endOffset,a.nodeValue.length):s.pendingContent=n,s.editorField=a,s.editorRng=o))}),s.$tree.on("ready.jstree",function(){s.updateSidebar(s.options.text);var e=s.$tree.jstree("get_json");0<e.length&&s.$tree.jstree("open_node",e[0])})}),s.initHorizontalResize())),s.editor.instanceById(s.INSTANCE_ID).elm.addEventListener("input",function(e){s.disableTree||s.debouncedUpdateSidebar(e.target.innerText),s.debouncedCheckForErrors(e.target.innerHTML)}),s.initHandlebarHelperPicker()}}),s}return __extends(b,n),b.prototype.onResize=function(){MonacoHelpers.adjustAfterResize(this.editor)},b.prototype.remove=function(){return this.unregisterHandlebarIntellisense&&this.unregisterHandlebarIntellisense.dispose(),this.editor&&(this.editor=null),this.editor=this.$beautify=this.$dialog=this.$selectable=this.options=null,Backbone.View.prototype.remove.call(this)},b.prototype.checkForAdvancedHelpers=function(e){b.NONEACH_HELPER_RX.test(e)?this.$basicMode.hide():this.$basicMode.show()},b.prototype.checkForErrors=function(e){try{Handlebars.compile(e)({}),this.$error.hide()}catch(e){this.$error.show(),this.$error.find("div")[0].innerText=e.message}},b.prototype.descriptify=function(e){return e=e&&(e=e.replace(/<script class="handlebars-helpers" type="handlebars-helpers">/gi,"")).replace(/<\/script>/gi,"")},b.prototype.initHorizontalResize=function(){try{this.$sidebar.resizable("destroy")}catch(e){}this.$sidebar.resizable({handles:"e",minWidth:220,maxWidth:300}).on("resize",this.onHorizontalResize.bind(this))},b.prototype.insertItem=function(e){function o(e,t){return e.replace(b.VS_HBAR_RX,"{{"+_.repeat("../",t)+"$1}}")}var a=this,s=e.parents[e.parents.length-2],l=[],r=new RegExp("{{\\s*#each\\s*"+s.substring(1)+"\\s*}}");if(this.isInCodeMode){var e=this.descriptify(this.wrapInHandlebars(e.id)),t=this.codeEditor.getModel().findMatches(b.EACH_HELPERS_RX.source,!0,!0,!1,null,!0),n=this.codeEditor.getPosition();_.each(t,function(e,t){var i=e.range.getEndPosition();n.lineNumber<i.lineNumber||n.lineNumber===i.lineNumber&&n.column<i.column||(b.EACH_END_RX.test(e.matches[0])?l.pop():l.push(r.test(e.matches[0])))}),_.every(l,function(e){return!e})&&_.includes(s,"@")?e="{{#each "+s.substring(1)+"}}<div>"+e+"</div>{{/each}}":l.length&&!_.includes(s,"@")&&(e=o(e,l.length)),this.codeEditor.trigger("keyboard","type",{text:e})}else{var c=this.editorField;if(c&&this.pendingContent){for(var d,u=nicEditors.findEditor(this.INSTANCE_ID),t=u.savedRange.endOffset+this.pendingContent.length-(c.data?c.data.length:0),i=(c.nodeValue?c.nodeValue=this.pendingContent:0===(e=this.editorRng.endOffset)?c.prepend(this.pendingContent):(e=c.childNodes[e-1])?e.before(this.pendingContent):c.append(this.pendingContent),this.debouncedUpdateSidebar(u.elm.innerText),_.each(Array.from(u.elm.childNodes),function(e){if(e instanceof HTMLElement&&"SCRIPT"===e.tagName)b.EACH_END_RX.test(e.innerText)?l.pop():r.test(e.innerText)?l.push(!0):b.EACH_START_RX.test(e.innerText)&&l.push(!1);else if(e===c||_.includes(Array.from(e.childNodes),c)||_.includes(Array.from(c.childNodes),e)){if(l.length&&!_.includes(s,"@"))return void(3===c.nodeType?c.nodeValue=o(c.nodeValue,l.length):c.innerText=o(c.innerText,l.length));var t,i,n;if(_.includes(s,"@")&&_.every(l,function(e){return!e}))return i=t=void 0,n="",e instanceof HTMLElement?i=(t=e).outerHTML:(t=d,i="<div>"+_.trim(e.textContent)+"</div>",n="\n"),i=a.scriptify(n+"{{#each "+s.substring(1)+"}}"+o(i,1+l.length)+"{{/each}}"),t?(t.insertAdjacentHTML("afterend",i),c=t.nextSibling.nextSibling,n&&(c=c.nextSibling)):(u.elm.insertAdjacentHTML("afterbegin",i),c=u.elm.childNodes[2]),3===c.childNodes[0].nodeType&&(c=c.childNodes[0]),void u.elm.removeChild(e)}e instanceof HTMLElement&&(d=e)}),c),p=c,h=[];i!==u.elm;)i=p.parentNode,h.push(Array.prototype.indexOf.call(i.childNodes,p)),p=i;var e=_.some(i.childNodes,function(e){return"handlebars-helpers"===e.type}),m=document.createRange();if(h.length){for(var g=e?i.childNodes:_.filter(i.childNodes,function(e){return"handlebars-helpers"!==e.type}),i=g=e||g.length===i.childNodes.length?g:g[0].childNodes,f=h.length-1;0<=f;f--)i=(c=i[h[f]]).childNodes;t=1<c.childNodes.length?c.childNodes.length:t}else{e=_.find(c.childNodes,function(e){return"handlebars-helpers"!==e.type});e&&(c=e.childNodes.length?e.childNodes[0]:e)}c.data&&c.data!==this.pendingContent&&(t+=c.data.length-this.pendingContent.length),m.setStart(c,t),m.setEnd(c,t),u.selRng(m,u.getSel()),this.pendingContent="",this.editorField=null,this.editorRng=null}}},b.prototype.onHorizontalResize=function(){var e=this.$sidebar.width();this.$textEditor.css({width:"calc(100% - "+e+"px)",left:e+"px"})},b.prototype.jstreeSearch=function(e){this.$tree.jstree("show_all"),this.$tree.jstree().search(e)},b.prototype.initCodeEditor=function(n){var o=this;MonacoHelpers.require({language:"handlebars"},function(e){var t=e.monaco,i=e.docs,e=e.disposable,i=(o.docs=i,o.unregisterHandlebarIntellisense=e,o.$el.find(".code")[0]),e=(o.codeEditor||(o.codeEditor=t.editor.create(i,{language:"handlebars",automaticLayout:!0,theme:"kx-light"!==$.cookie("dashboard-theme")?"vs-dark":"vs",contextmenu:!1,fixedOverflowWidgets:!0,fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",dragAndDrop:!1})),o.codeEditor.getAction("editor.action.formatDocument").run(),n||o.editor.instanceById(o.INSTANCE_ID).getContent());o.checkForAdvancedHelpers(e),o.codeEditor.setValue(o.descriptify(e)),o.codeEditor.getModel().onDidChangeContent(function(){var e=o.codeEditor.getModel().getValue();o.disableTree||o.debouncedUpdateSidebar(e),o.debouncedCheckForErrors(e),o.debouncedCheckForAdvancedHelpers(e)})})},b.prototype.initHandlebarHelperPicker=function(){var t=this,e=["each","eq","gt","lt","if","toFixed","addCommas","toPrecision"],e=e.concat(Object.keys(_.omit(Handlebars.helpers,["blockHelperMissing","t","helperMissing","valueProps","lookup","log","type-cast","unless"].concat(e))).sort());_.each(e,function(e){t.$el.find(".gok-handlebarselect").append("<option value="+e+">"+e+"</option>")}),this.$helperSelect=this.$el.find(".gok-handlebarselect").select2({minimumResultsForSearch:5,theme:"dashboards",width:"100px"}),this.$el.find(".add-helper").button({icon:"fa fa-plus"}).click(function(){var e=t.$helperSelect.val(),e=t.getHandlebarHelperShell(e);t.codeEditor.setValue(t.codeEditor.getValue()+"\n"+e)})},b.prototype.getHandlebarHelperShell=function(e){var t,i=this.docs[e];return i&&i.comment?(t=i.comment.match(/```handlebars\n((.|\n)+)(```)/))&&t[0]?t[0].replace(/ \* /g,"").replace("```handlebars","").replace("```","").trim():(i.comment.match(/\@block/)?"{{#".concat(e,"}} {{/"):"{{").concat(e,"}}"):"{{".concat(e,"}}")},b.prototype.onButtonClick=function(){var e=this.isInCodeMode?this.codeEditor.getValue():this.editor.instanceById(this.INSTANCE_ID).getContent();e=this.descriptify(e),this.options.allowUnsafeContent||(e=this.options.sanitizeTemplate?this.options.sanitizeTemplate(e):DOMPurify.sanitize(e,{ADD_ATTR:["target"]})),this.options.applyCallback&&this.options.applyCallback(e)},b.prototype.renderPreview=function(e){this.$preview.empty(),this.$preview.append("<div>"+e+"</div>")},b.prototype.requiresBrackets=function(e){return b.VSRx.test(e)||/\s/.test(e)},b.prototype.scriptify=function(e){return e=e.replace(b.EACH_HELPERS_RX,function(e){return'<script class="handlebars-helpers" type="handlebars-helpers">'+e+"<\/script>"})},b.prototype.trimVSChars=function(e){return b.VSRx.test(e)?e.substring(1,e.length-1):e},b.prototype.updateSidebar=function(i){var n=this,o=[],e=(_.each([/{{2,3}(#?\w+\s+)?\s*([\w\.]+)[^{}]*}{2,3}/gm,/{{2,3}[^{}]*\[(\$[\w\s\.]+\$)\][^{}]*}{2,3}/gm],function(e){for(;null!==(t=e.exec(i));){var t=n.$tree.jstree().get_node(t[2]||t[1]);t&&("activeKey"!==t.type&&(t.oldType=t.type,n.$tree.jstree().set_type(t,"activeKey")),o.push(t))}}),_.remove(this.activeKeys,function(e){return!_.includes(o,e)}));_.each(e,function(e){return n.$tree.jstree().set_type(e,e.oldType)}),this.activeKeys=o},b.prototype.updateTheme=function(){var e=$("#appdiv .toolbar").hasClass("kx-light")?"kx-light":"kx-darkroom",t=$(document).find(".vakata-context.jstree-contextmenu");t&&(t.removeClass("kx-light kx-darkroom"),t.addClass(e))},b.prototype.wrapInHandlebars=function(e){return this.requiresBrackets(e)?"{{["+e+"]}}":"{{"+e+"}}"},b.DIALOG_HEIGHT=540,b.VSRx=/\$[^$]*\$/i,b.BLOCK_HELPERS_RX=/{{(\s*#|\s*\/)[^}]*}}/gi,b.EACH_HELPERS_RX=/{{(\s*#|\s*\/)each[^}]*}}/gi,b.EACH_START_RX=/{{\s*#each\s*(\w*)\s*}}/,b.EACH_END_RX=/{{\/\s*each\s*}}/,b.NONEACH_HELPER_RX=/{{(\s*#|\s*\/)(?!each)[^{}]*}}/i,b.VS_HBAR_RX=/{{(?:..\/)*(\[\$([\w\.])+\$\])}}/g,b}(Backbone.View)),fontAwesome={"Web Application Icons":["adjust","anchor","archive","area-chart","arrows","arrows-h","arrows-v","asterisk","at","automobile","balance-scale","ban","bank","bar-chart","bar-chart-o","barcode","bars","battery-0","battery-1","battery-2","battery-3","battery-4","battery-empty","battery-full","battery-half","battery-quarter","battery-three-quarters","bed","beer","bell","bell-o","bell-slash","bell-slash-o","bicycle","binoculars","birthday-cake","bluetooth","bluetooth-b","bolt","bomb","book","bookmark","bookmark-o","briefcase","bug","building","building-o","bullhorn","bullseye","bus","cab","calculator","calendar","calendar-check-o","calendar-minus-o","calendar-o","calendar-plus-o","calendar-times-o","camera","camera-retro","car","caret-square-o-down","caret-square-o-left","caret-square-o-right","caret-square-o-up","cart-arrow-down","cart-plus","cc","certificate","check","check-circle","check-circle-o","check-square","check-square-o","child","circle","circle-o","circle-o-notch","circle-thin","clock-o","clone","close","cloud","cloud-download","cloud-upload","code","code-fork","coffee","cog","cogs","comment","comment-o","commenting","commenting-o","comments","comments-o","compass","copyright","creative-commons","credit-card","credit-card-alt","crop","crosshairs","cube","cubes","cutlery","dashboard","database","desktop","diamond","dot-circle-o","download","edit","ellipsis-h","ellipsis-v","envelope","envelope-o","envelope-square","eraser","exchange","exclamation","exclamation-circle","exclamation-triangle","external-link","external-link-square","eye","eye-slash","eyedropper","fax","feed","female","fighter-jet","file-archive-o","file-audio-o","file-code-o","file-excel-o","file-image-o","file-movie-o","file-pdf-o","file-photo-o","file-picture-o","file-powerpoint-o","file-sound-o","file-video-o","file-word-o","file-zip-o","film","filter","fire","fire-extinguisher","flag","flag-checkered","flag-o","flash","flask","folder","folder-o","folder-open","folder-open-o","frown-o","futbol-o","gamepad","gavel","gear","gears","gift","glass","globe","graduation-cap","group","hand-grab-o","hand-lizard-o","hand-paper-o","hand-peace-o","hand-pointer-o","hand-rock-o","hand-scissors-o","hand-spock-o","hand-stop-o","hashtag","hdd-o","headphones","heart","heart-o","heartbeat","history","home","hotel","hourglass","hourglass-1","hourglass-2","hourglass-3","hourglass-end","hourglass-half","hourglass-o","hourglass-start","i-cursor","image","inbox","industry","info","info-circle","institution","key","keyboard-o","language","laptop","leaf","legal","lemon-o","level-down","level-up","life-bouy","life-buoy","life-ring","life-saver","lightbulb-o","line-chart","location-arrow","lock","magic","magnet","mail-forward","mail-reply","mail-reply-all","male","map","map-marker","map-o","map-pin","map-signs","meh-o","microphone","microphone-slash","minus","minus-circle","minus-square","minus-square-o","mobile","mobile-phone","money","moon-o","mortar-board","motorcycle","mouse-pointer","music","navicon","newspaper-o","object-group","object-ungroup","paint-brush","paper-plane","paper-plane-o","paw","pencil","pencil-square","pencil-square-o","percent","phone","phone-square","photo","picture-o","pie-chart","plane","plug","plus","plus-circle","plus-square","plus-square-o","power-off","print","puzzle-piece","qrcode","question","question-circle","quote-left","quote-right","random","recycle","refresh","registered","remove","reorder","reply","reply-all","retweet","road","rocket","rss","rss-square","search","search-minus","search-plus","send","send-o","server","share","share-alt","share-alt-square","share-square","share-square-o","shield","ship","shopping-bag","shopping-basket","shopping-cart","sign-in","sign-out","signal","sitemap","sliders","smile-o","soccer-ball-o","sort","sort-alpha-asc","sort-alpha-desc","sort-amount-asc","sort-amount-desc","sort-asc","sort-desc","sort-down","sort-numeric-asc","sort-numeric-desc","sort-up","space-shuttle","spinner","spoon","square","square-o","star","star-half","star-half-empty","star-half-full","star-half-o","star-o","sticky-note","sticky-note-o","street-view","suitcase","sun-o","support","tablet","tachometer","tag","tags","tasks","taxi","television","terminal","thumb-tack","thumbs-down","thumbs-o-down","thumbs-o-up","thumbs-up","ticket","times","times-circle","times-circle-o","tint","toggle-down","toggle-left","toggle-off","toggle-on","toggle-right","toggle-up","trademark","trash","trash-o","tree","trophy","truck","tty","tv","umbrella","university","unlock","unlock-alt","unsorted","upload","user","user-plus","user-secret","user-times","users","video-camera","volume-down","volume-off","volume-up","warning","wheelchair","wifi","wrench"],"Hand Icons":["hand-grab-o","hand-lizard-o","hand-o-down","hand-o-left","hand-o-right","hand-o-up","hand-paper-o","hand-peace-o","hand-pointer-o","hand-rock-o","hand-scissors-o","hand-spock-o","hand-stop-o","thumbs-down","thumbs-o-down","thumbs-o-up","thumbs-up"],"Transportation Icons":["ambulance","automobile","bicycle","bus","cab","car","fighter-jet","motorcycle","plane","rocket","ship","space-shuttle","subway","taxi","train","truck","wheelchair"],"Gender Icons":["genderless","intersex","mars","mars-double","mars-stroke","mars-stroke-h","mars-stroke-v","mercury","neuter","transgender","transgender-alt","venus","venus-double","venus-mars"],"File Type Icons":["file","file-archive-o","file-audio-o","file-code-o","file-excel-o","file-image-o","file-movie-o","file-o","file-pdf-o","file-photo-o","file-picture-o","file-powerpoint-o","file-sound-o","file-text","file-text-o","file-video-o","file-word-o","file-zip-o"],"Spinner Icons":["info-circle","circle-o-notch","cog","gear","refresh","spinner"],"Form Control Icons":["check-square","check-square-o","circle","circle-o","dot-circle-o","minus-square","minus-square-o","plus-square","plus-square-o","square","square-o"],"Payment Icons":["cc-amex","cc-diners-club","cc-discover","cc-jcb","cc-mastercard","cc-paypal","cc-stripe","cc-visa","credit-card","credit-card-alt","google-wallet","paypal"],"Chart Icons":["area-chart","bar-chart","bar-chart-o","line-chart","pie-chart"],"Currency Icons":["bitcoin","btc","cny","dollar","eur","euro","gbp","gg","gg-circle","ils","inr","jpy","krw","money","rmb","rouble","rub","ruble","rupee","shekel","sheqel","try","turkish-lira","usd","won","yen"],"Text Editor Icons":["align-center","align-justify","align-left","align-right","bold","chain","chain-broken","clipboard","columns","copy","cut","dedent","eraser","file","file-o","file-text","file-text-o","files-o","floppy-o","font","header","indent","italic","link","list","list-alt","list-ol","list-ul","outdent","paperclip","paragraph","paste","repeat","rotate-left","rotate-right","save","scissors","strikethrough","subscript","superscript","table","text-height","text-width","th","th-large","th-list","underline","undo","unlink"],"Directional Icons":["angle-double-down","angle-double-left","angle-double-right","angle-double-up","angle-down","angle-left","angle-right","angle-up","arrow-circle-down","arrow-circle-left","arrow-circle-o-down","arrow-circle-o-left","arrow-circle-o-right","arrow-circle-o-up","arrow-circle-right","arrow-circle-up","arrow-down","arrow-left","arrow-right","arrow-up","arrows","arrows-alt","arrows-h","arrows-v","caret-down","caret-left","caret-right","caret-square-o-down","caret-square-o-left","caret-square-o-right","caret-square-o-up","caret-up","chevron-circle-down","chevron-circle-left","chevron-circle-right","chevron-circle-up","chevron-down","chevron-left","chevron-right","chevron-up","exchange","hand-o-down","hand-o-left","hand-o-right","hand-o-up","long-arrow-down","long-arrow-left","long-arrow-right","long-arrow-up","toggle-down","toggle-left","toggle-right","toggle-up"],"Video Player Icons":["arrows-alt","backward","compress","eject","expand","fast-backward","fast-forward","forward","pause","pause-circle","pause-circle-o","play","play-circle","play-circle-o","random","step-backward","step-forward","stop","stop-circle","stop-circle-o","youtube-play"],"Brand Icons":["warning","500px","adn","amazon","android","angellist","apple","behance","behance-square","bitbucket","bitbucket-square","bitcoin","black-tie","bluetooth","bluetooth-b","btc","buysellads","cc-amex","cc-diners-club","cc-discover","cc-jcb","cc-mastercard","cc-paypal","cc-stripe","cc-visa","chrome","codepen","codiepie","connectdevelop","contao","css3","dashcube","delicious","deviantart","digg","dribbble","dropbox","drupal","edge","empire","expeditedssl","facebook","facebook-f","facebook-official","facebook-square","firefox","flickr","fonticons","fort-awesome","forumbee","foursquare","ge","get-pocket","gg","gg-circle","git","git-square","github","github-alt","github-square","gittip","google","google-plus","google-plus-square","google-wallet","gratipay","hacker-news","houzz","html5","instagram","internet-explorer","ioxhost","joomla","jsfiddle","lastfm","lastfm-square","leanpub","linkedin","linkedin-square","linux","maxcdn","meanpath","medium","mixcloud","modx","odnoklassniki","odnoklassniki-square","opencart","openid","opera","optin-monster","pagelines","paypal","pied-piper","pied-piper-alt","pinterest","pinterest-p","pinterest-square","product-hunt","qq","ra","rebel","reddit","reddit-alien","reddit-square","renren","safari","scribd","sellsy","share-alt","share-alt-square","shirtsinbulk","simplybuilt","skyatlas","skype","slack","slideshare","soundcloud","spotify","stack-exchange","stack-overflow","steam","steam-square","stumbleupon","stumbleupon-circle","tencent-weibo","trello","tripadvisor","tumblr","tumblr-square","twitch","twitter","twitter-square","usb","viacoin","vimeo","vimeo-square","vine","vk","wechat","weibo","weixin","whatsapp","wikipedia-w","windows","wordpress","xing","xing-square","y-combinator","y-combinator-square","yahoo","yc","yc-square","yelp","youtube","youtube-play","youtube-square"],"Medical Icons":["ambulance","h-square","heart","heart-o","heartbeat","hospital-o","medkit","plus-square","stethoscope","user-md","wheelchair"]},googleFont={Action:["3d-rotation","accessibility","account-balance","account-balance-wallet","account-box","account-circle","add-shopping-cart","alarm","alarm-add","alarm-off","alarm-on","all-out","android","announcement","aspect-ratio","assessment","assignment","assignment-ind","assignment-late","assignment-return","assignment-returned","assignment-turned-in","autorenew","backup","book","bookmark","bookmark-border","bug-report","build","cached","camera-enhance","card-giftcard","card-membership","card-travel","change-history","check-circle","chrome-reader-mode","class","code","compare-arrows","copyright","credit-card","dashboard","date-range","delete","delete-forever","description","dns","done","done-all","donut-large","donut-small","eject","euro-symbol","event","event-seat","exit-to-app","explore","extension","face","favorite","favorite-border","feedback","find-in-page","find-replace","fingerprint","flight-land","flight-takeoff","flip-to-back","flip-to-front","g-translate","gavel","get-app","gif","grade","group-work","help","help-outline","highlight-off","history","home","hourglass-empty","hourglass-full","http","https","important-devices","info","info-outline","input","invert-colors","label","label-outline","language","launch","lightbulb-outline","line-style","line-weight","list","lock","lock-open","lock-outline","loyalty","markunread-mailbox","motorcycle","note-add","offline-pin","opacity","open-in-browser","open-in-new","open-with","pan-tool","pageview","payment","perm-camera-mic","perm-contact-calendar","perm-data-setting","perm-device-information","perm-identity","perm-media","perm-phone-msg","perm-scan-wifi","pets","picture-in-picture","play-for-work","polymer","power-settings-new","print","query-builder","question-answer","receipt","record-voice-over","redeem","reorder","report-problem","restore","restore-page","room","rounded-corner","rowing","schedule","search","settings","settings-applications","settings-backup-restore","settings-bluetooth","settings-brightness","settings-cell","settings-ethernet","settings-input-antenna","settings-input-component","settings-input-composite","settings-input-hdmi","settings-input-svideo","settings-overscan","settings-phone","settings-power","settings-remote","settings-voice","shop","shop-two","shopping-basket","shopping-cart","speaker-notes","spellcheck","stars","store","subject","supervisor-account","swap-horiz","swap-vert","swap-vertical-circle","system-update-alt","tab","tab-unselected","theaters","thumb-down","thumb-up","thumbs-up-down","toc","today","toll","touch-app","track-changes","translate","trending-down","trending-flat","trending-up","turned-in","turned-in-not","verified-user","view-agenda","view-array","view-carousel","view-column","view-day","view-headline","view-list","view-module","view-quilt","view-stream","view-week","visibility","visibility-off","work","youtube-searched-for","zoom-in","zoom-out"],Alert:["add-alert","error","error-outline","warning"],AV:["add-to-queue","airplay","album","art-track","av-timer","branding-watermark","call-to-action","closed-caption","equalizer","explicit","fast-forward","fast-rewind","featured-play-list","featured-video","fiber-dvr","fiber-manual-record","fiber-new","fiber-pin","fiber-smart-record","forward-10","forward-30","forward-5","games","hd","hearing","high-quality","library-add","library-books","library-music","loop","mic","mic-none","mic-off","movie","new-releases","not-interested","note","pause","pause-circle-filled","pause-circle-outline","play-arrow","play-circle-filled","play-circle-outline","playlist-add","queue","queue-music","radio","recent-actors","remove-from-queue","repeat","repeat-one","replay","replay-10","replay-30","replay-5","shuffle","skip-next","skip-previous","slow-motion-video","snooze","sort-by-alpha","stop","subscriptions","subtitles","surround-sound","video-call","video-label","video-library","videocam","videocam-off","volume-down","volume-mute","volume-off","volume-up","web"],Communication:["business","call","call-end","call-made","call-merge","call-missed","call-received","call-split","chat","chat-bubble","chat-bubble-outline","clear-all","comment","contact-mail","contact-phone","contacts","dialer-sip","dialpad","email","forum","import-export","invert-colors-off","live-help","location-off","location-on","message","no-sim","phone","phonelink-erase","phonelink-lock","phonelink-ring","phonelink-setup","portable-wifi-off","present-to-all","ring-volume","rss-feed","screen-share","speaker-phone","stay-current-landscape","stay-current-portrait","stay-primary-landscape","stay-primary-portrait","stop-screen-share","swap-calls","textsms","voicemail","vpn-key"],Content:["add","add-box","add-circle","add-circle-outline","archive","backspace","block","clear","content-copy","content-cut","content-paste","create","delete-sweep","drafts","filter-list","flag","font-download","forward","gesture","inbox","link","low-priority","mail","markunread","redo","remove","remove-circle","remove-circle-outline","reply","reply-all","report","save","select-all","send","sort","text-format","unarchive","undo","weekend"],Device:["access-alarm","access-alarms","access-time","add-alarm","airplanemode-active","airplanemode-inactive","battery-alert","battery-charging-full","battery-full","battery-std","battery-unknown","bluetooth","bluetooth-connected","bluetooth-disabled","bluetooth-searching","brightness-auto","brightness-high","brightness-low","brightness-medium","data-usage","developer-mode","devices","dvr","gps-fixed","gps-not-fixed","gps-off","graphic-eq","location-disabled","location-searching","network-cell","network-wifi","nfc","screen-lock-landscape","screen-lock-portrait","screen-lock-rotation","screen-rotation","sd-storage","settings-system-daydream","signal-cellular-4-bar","signal-cellular-connected-no-internet-4-bar","signal-cellular-no-sim","signal-cellular-null","signal-cellular-off","signal-wifi-4-bar","signal-wifi-4-bar-lock","signal-wifi-off","storage","usb","wallpaper","widgets","wifi-lock","wifi-tethering"],Editor:["attach-file","attach-money","border-all","border-bottom","border-clear","border-color","border-horizontal","border-inner","border-left","border-outer","border-right","border-style","border-top","border-vertical","bubble-chart","format-align-center","format-align-justify","format-align-left","format-align-right","format-bold","format-clear","format-color-fill","format-color-reset","format-color-text","format-indent-decrease","format-indent-increase","format-italic","format-line-spacing","format-list-bulleted","format-list-numbered","format-paint","format-quote","format-size","format-strikethrough","format-textdirection-l-to-r","format-textdirection-r-to-l","format-underlined","functions","insert-chart","insert-comment","insert-drive-file","insert-emoticon","insert-invitation","insert-link","insert-photo","linear_scale","merge-type","mode-comment","mode-edit","monetization-on","money-off","multiline-chart","pie-chart","pie-chart-outlined","publish","show-chart","space-bar","strikethrough-s","text-fields","title","vertical-align-bottom","vertical-align-center","vertical-align-top","wrap-text"],File:["attachment","cloud","cloud-circle","cloud-done","cloud-download","cloud-off","cloud-queue","cloud-upload","file-download","file-upload","folder","folder-open","folder-shared"],Hardware:["cast","cast-connected","computer","desktop-mac","desktop-windows","developer-board","device-hub","devices-other","dock","gamepad","headset","headset-mic","keyboard","keyboard-arrow-down","keyboard-arrow-left","keyboard-arrow-right","keyboard-arrow-up","keyboard-backspace","keyboard-capslock","keyboard-hide","keyboard-return","keyboard-tab","keyboard-voice","laptop","laptop-chromebook","laptop-mac","laptop-windows","memory","mouse","phone-android","phone-iphone","phonelink","phonelink-off","power-input","router","scanner","security","sim-card","smartphone","speaker","speaker-group","tablet","tablet-android","tablet-mac","toys","tv","videogame-asset","watch"],Image:["add-to-photos","adjust","assistant","assistant-photo","audiotrack","blur-circular","blur-linear","blur-off","blur-on","brightness-1","brightness-2","brightness-3","brightness-4","brightness-5","brightness-6","brightness-7","broken-image","brush","burst-mode","camera","camera-alt","camera-front","camera-rear","camera-roll","center-focus-strong","center-focus-weak","collections","collections-bookmark","color-lens","colorize","compare","control-point","control-point-duplicate","crop","crop-16-9","crop-3-2","crop-5-4","crop-7-5","crop-din","crop-free","crop-landscape","crop-original","crop-portrait","crop-square","dehaze","details","edit","exposure","exposure-neg-1","exposure-neg-2","exposure-plus-1","exposure-plus-2","exposure-zero","filter","filter-1","filter-2","filter-3","filter-4","filter-5","filter-6","filter-7","filter-8","filter-9","filter-9-plus","filter-b-and-w","filter-center-focus","filter-drama","filter-frames","filter-hdr","filter-none","filter-tilt-shift","filter-vintage","flare","flash-auto","flash-off","flash-on","flip","gradient","grain","grid-off","grid-on","hdr-off","hdr-on","hdr-strong","hdr-weak","healing","image","image-aspect-ratio","iso","landscape","leak-add","leak-remove","lens","linked-camera","looks","looks-3","looks-4","looks-5","looks-6","looks-one","looks-two","loupe","monochrome-photos","movie-creation","music-note","nature","nature-people","navigate-before","navigate-next","palette","panorama","panorama-fish-eye","panorama-horizontal","panorama-vertical","panorama-wide-angle","photo","photo-album","photo-camera","photo-library","photo-size-select-actual","photo-size-select-large","photo-size-select-small","picture-as-pdf","portrait","remove-red-eye","rotate-90-degrees-ccw","rotate-left","rotate-right","slideshow","straighten","style","switch-camera","switch-video","tag-faces","texture","timelapse","timer","timer-10","timer-3","timer-off","tonality","transform","tune","view-comfy","view-compact","vignette","wb-auto","wb-cloudy","wb-incandescent","wb-iridescent","wb-sunny"],Maps:["beenhere","directions","directions-bike","directions-boat","directions-bus","directions-car","directions-railway","directions-run","directions-subway","directions-transit","directions-walk","edit-location","ev-station","flight","hotel","layers","layers-clear","local-activity","local-airport","local-atm","local-bar","local-cafe","local-car-wash","local-convenience-store","local-dining","local-drink","local-florist","local-gas-station","local-grocery-store","local-hospital","local-hotel","local-laundry-service","local-library","local-mall","local-movies","local-offer","local-parking","local-pharmacy","local-phone","local-pizza","local-play","local-post-office","local-printshop","local-see","local-shipping","local-taxi","map","my-location","navigation","person-pin","pin-drop","place","rate-review","restaurant","restaurant-menu","satellite","store-mall-directory","streetview","subway","terrain","traffic","train","tram","transfer-within-a-station","zoom-out-map"],Navigation:["apps","arrow-back","arrow-drop-down","arrow-drop-down-circle","arrow-drop-up","arrow-forward","cancel","check","chevron-left","chevron-right","close","expand-less","expand-more","first-page","fullscreen","fullscreen-exit","last-page","menu","more-horiz","more-vert","refresh"],Notification:["adb","airline-seat-flat","airline-seat-flat-angled","airline-seat-individual-suite","airline-seat-legroom-extra","airline-seat-legroom-normal","airline-seat-legroom-reduced","airline-seat-recline-extra","airline-seat-recline-normal","bluetooth-audio","confirmation-number","disc-full","do-not-disturb","do-not-disturb-alt","do-not-disturb-off","do-not-disturb-on","drive-eta","event-available","event-busy","event-note","folder-special","live-tv","mms","more","network-locked","ondemand-video","personal-video","phone-bluetooth-speaker","phone-forwarded","phone-in-talk","phone-locked","phone-missed","phone-paused","power","priority-high","sd-card","sim-card-alert","sms","sms-failed","sync","sync-disabled","sync-problem","system-update","tap-and-play","time-to-leave","vibration","voice-chat","vpn-lock","wc","wifi"],Social:["cake","domain","group","group-add","location-city","mood","mood-bad","notifications","notifications-active","notifications-none","notifications-off","notifications-paused","pages","party-mode","people","people-outline","person","person-add","person-outline","plus-one","poll","public","school","sentiment-dissatisfied","sentiment-neutral","sentiment-satisfied","sentiment-very-dissatisfied","share","whatshot"],Toggle:["check-box","check-box-outline-blank","indeterminate-check-box","radio-button-checked","radio-button-unchecked","star","star-border","star-half"]},IconDropDownDialog=Backbone.View.extend({className:"icon-dialog",initialize:function(e){var s=this;s.options=e,s.path=void 0,s.search="",s.animationTimeElapsed=0,s.columns=6,s.minimumWidgetSize={w:170,h:40},s.isFAOnly=e.isFAOnly,s.panelInfos=[],s.debouncedLayout=_.debounce(s.updateLayout,100),s.debouncedAnimLayout=_.debounce(function(){s.updateLayout(!0)},170),s.throttleLayout=_.throttle(s.updateLayout,100),s.ANIMATION_TIME=300,s.renderFrameCounter=0,s.$el.dialog(_.extend({appendTo:e.container,classes:{"ui-dialog":"quick-dash dd-Panel"},title:t("Please select an image ..."),resizable:!0,height:600,width:950,minWidth:400,modal:!0,autoOpen:!0,close:function(){_.isFunction(s.options.closing)&&s.options.closing(),s.remove()},open:function(){$('<i class="fa fa-image" />').insertBefore(s.$el.parent().find(".ui-dialog-title")),s.$el.html(T.IconDialog()),s.$grid=s.$el.find(".grid"),s.$searchInput=s.$el.find(".search input");var o={row:0,column:0,position:null,size:null,targetPosition:null,targetSize:null,visible:!0},e="Web Application Icons",t=_.clone(fontAwesome),e=(t[e]=_.clone(t[e]),t[e].splice(0,0,"blank"),[t]),a=[{type:"fa",subtype:"fa-fw"}];s.isFAOnly||(e.push(googleFont),a.push({type:"mi",subtype:""})),_.each(e,function(e,n){_.each(e,function(e,t){var i=_.extend({heading:!0,$el:$("<h3>"+t+"</h3>")},o);s.panelInfos.push(i),s.$grid.append(i.$el),_.each(e,function(e){i=_.extend({icon:e,$el:$(T.IconDialogItem(_.extend({icon:e},a[n])))},o),s.panelInfos.push(i),s.$grid.append(i.$el)})})}),s.$el.find(".grid > a").on("click",function(e){var t=s.options.selectCallback;t&&t("fa-blank"==(t=$(e.target||e.toElement).find("i").attr("class").split(" ").pop())?"":t),s.$el.dialog("close")}),s.$searchInput.on("input",function(){s.search=$(this).val(),s.debouncedAnimLayout()}),s.updateLayout(!1),_.defer(function(){s.$searchInput.focus()})},resize:function(){s.debouncedLayout(!1)}},e))},onCancelButtonClick:function(){this.$el.dialog("close")},onSelectButtonClick:function(){this.options.model.tooltips=this.result,this.options.editor.setValue(this.options.model),this.onCancelButtonClick()},remove:function(){_.each(this.panelInfos,function(e){e.$el.off(),e.$el.remove(),e.$el=null}),this.panelInfos=[],Backbone.View.prototype.remove.call(this)},renderFrame:function(){var n,e=new Date,t=e-this.lastFrame,i=this;this.lastFrame=e,this.animationTimeElapsed+=t,this.renderFrameCounter+=1,this.animationTimeElapsed>=this.ANIMATION_TIME?(1<this.renderFrameCounter&&console.log("FPS: "+this.renderFrameCounter/this.ANIMATION_TIME*1e3),this.renderFrameCounter=0,_.each(i.panelInfos,function(e){e!==this.draggingPanelInfo&&(e.$el.css({top:e.targetY+"px",left:e.targetX.toFixed(3)+"%"}),e.X=e.targetX,e.Y=e.targetY)})):(n=this.animationTimeElapsed/this.ANIMATION_TIME,_.each(i.panelInfos,function(e){var t,i;e!==this.draggingPanelInfo&&(t=e.X+(e.targetX-e.X)*n,i=e.Y+(e.targetY-e.Y)*n,e.$el.css({top:i+"px",left:t.toFixed(3)+"%"}))}),window.requestAnimationFrame(function(){i.renderFrame()}))},setRowsAndColumns:function(){var e,t,i,n=0;if(0!==this.panelInfos.length)for(this.columns=Math.max(1,Math.floor(this.$grid.width()/this.minimumWidgetSize.w)),this.rows=Math.ceil(this.panelInfos.length/this.columns),i=0;;i+=1){1;{for(e=0;e<this.columns&&n!==this.panelInfos.length;e+=1)if((t=this.panelInfos[n]).visible=""===this.search||t.icon&&0<=t.icon.indexOf(this.search),t.visible){if(t.heading&&0!==e&&(e=0,i+=1),t.column=e,t.row=i,n+=1,t.heading)break}else--e,n+=1;if(n===this.panelInfos.length)break}}},updateLayout:function(e){var t=this,i=e?{"transition-property":"top, left","transition-duration":"0.3s"}:{"transition-property":"none"};t.setRowsAndColumns(),_.each(t.panelInfos,function(e){e.$el.css(_.extend({top:e.row*t.minimumWidgetSize.h+"px",left:(e.column*(100/t.columns)).toFixed(3)+"%",width:e.heading?"99%":(100/t.columns).toFixed(3)+"%",display:e.visible?"block":"none"},i))})}}),JsonDialog=function(i){function e(e){var t=i.call(this,_.extend({},e,{className:"json-dialog"}))||this;return t.DIALOG_HEIGHT=540,t.options=e,t.$el.html(T.JsonDialog({})),t.$dialog=t.$el.dialog({appendTo:t.options.container,closeOnEscape:!0,title:"Json Editor",resizable:!0,height:t.DIALOG_HEIGHT,width:800,minWidth:710,modal:!0,autoOpen:!0,buttons:[{text:"Apply",click:t.onApplyButtonClick.bind(t),icon:"fa fa-check"},{text:"Close",click:function(){t.$el.dialog("close")},icon:"fa fa-times"}],close:function(){t.remove()},open:function(){t.$el.parent().find(".ui-dialog-title").before('<i class="fa fa-code" />').append($("<span>",{style:"font-weight:normal; padding-left:2em",text:"hit CTRL + SPACE to activate IntelliSense"})),t.initEditor()}}),t}return __extends(e,i),e.prototype.disposeEditor=function(){this.editor&&(this.editor.dispose(),this.editor=null),this.editorModel&&(this.editorModel.dispose(),this.editorModel=null),this.jsonDefaults&&this.defaultDiagnostics&&(this.jsonDefaults.setDiagnosticsOptions(this.defaultDiagnostics),this.jsonDefaults=null,this.defaultDiagnostics=null)},e.prototype.initEditor=function(){var o=this;MonacoHelpers.require({language:"json"},function(e){var t=e.monaco,e=(e.docs,e.disposable,"internal://server/"+_.uniqueId("jsonModelURI")),i=t.Uri.parse(e),n=o.options.value,n=(o.editorModel=t.editor.createModel(n,"json",i),_.result(o.options.editorOptions,"jsonSchema"));n&&(o.jsonDefaults=t.languages.json.jsonDefaults,o.defaultDiagnostics=o.jsonDefaults.diagnosticsOptions,t.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:[{fileMatch:[e],schema:n}]})),o.editor=t.editor.create(o.$el.find(".json-editor")[0],_.assign({},MonacoHelpers.DEFAULT_OPTIONS(),{model:o.editorModel}))})},e.prototype.onApplyButtonClick=function(){var e=this.editor.getValue();this.options.applyCallback&&this.options.applyCallback(e)},e.prototype.remove=function(){return this.disposeEditor(),Backbone.View.prototype.remove.call(this)},e}(Backbone.View),RichTextEditorDialog=Backbone.View.extend({DIALOG_HEIGHT:540,INSTANCE_ID:"ffsEdit",appModel:null,className:"rich-text-editor-dialog",dataView:null,propertiesView:null,isInCodeMode:!1,initialize:function(e){var i=this;i.options=e,i.$el.html(T.RichTextEditorDialog({uid:i.INSTANCE_ID,background:e.background})),i.$editor=i.$el.find(".editor"),i.$code=i.$el.find(".code"),$.ui.dialog.prototype._focusTabbable=$.noop,i.$dialog=i.$el.dialog({appendTo:e.container,classes:{"ui-dialog":"rich-text-dialog"},title:t("Text Editor"),resizable:!0,height:i.DIALOG_HEIGHT,width:800,minWidth:710,modal:!0,autoOpen:!0,buttons:[{text:t("Apply"),click:$.proxy(i.onApplyButtonClick,i),icon:"fa fa-check"},{text:t("Close"),click:function(){i.$el.dialog("close")},icon:"fa fa-times"}],close:function(){i.remove()},open:function(){$('<i class="fa fa-font" />').insertBefore(i.$el.parent().find(".ui-dialog-title")),i.editor=new nicEditor({onBeautify:function(){i.isInCodeMode&&i.codeEditor.getAction("editor.action.formatDocument").run()},onCode:function(){var e;i.$editor.toggle(),i.$code.toggle(),i.isInCodeMode=!i.isInCodeMode,i.isInCodeMode?i.initCodeEditor():(e=i.codeEditor.getValue(),i.options.allowUnsafeContent||(e=DOMPurify.sanitize(e,{ADD_ATTR:["target"]})),i.editor.instanceById(i.INSTANCE_ID).setContent(e))}}),i.editor.setPanel("htmlxEdit"),i.editor.addInstance(i.INSTANCE_ID),i.editor.instanceById(i.INSTANCE_ID).setContent(i.options.text),$(i.editor.instanceById(i.INSTANCE_ID).elm).focus()}})},initCodeEditor:function(){var i=this;MonacoHelpers.require({language:"html"},function(e){var e=e.monaco,t=i.$el.find(".code")[0];i.codeEditor||(i.codeEditor=e.editor.create(t,{language:"html",automaticLayout:!0,theme:"kx-light"!==$.cookie("dashboard-theme")?"vs-dark":"vs",contextmenu:!1,fixedOverflowWidgets:!0,fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",dragAndDrop:!1})),i.codeEditor.getAction("editor.action.formatDocument").run(),i.codeEditor.setValue(i.editor.instanceById(i.INSTANCE_ID).getContent())})},onApplyButtonClick:function(){var e=this.isInCodeMode?this.codeEditor.getValue():this.editor.instanceById(this.INSTANCE_ID).getContent();this.options.allowUnsafeContent||(e=DOMPurify.sanitize(e,{ADD_ATTR:["target"]})),this.options.applyCallback&&this.options.applyCallback(e),this.$dialog.dialog("close")},remove:function(){this.editor&&(this.editor.removeInstance(this.INSTANCE_ID),this.editor=null),this.codeEditor&&(this.codeEditor=null),Backbone.View.prototype.remove.call(this)}}),PropertiesPanelApi=function(i){function e(e){var t=i.call(this)||this;return t.appModel=e.appModel,t.dialogContainer=e.dialogContainer,t.docDataModel=e.docDataModel,t.docViewModel=e.docViewModel,t.viewModel=e.viewModel,t}return __extends(e,i),e.prototype.getParameter=function(e){return"model"===e?this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")):this[e]},e.prototype.getWidget=function(){return this.widgetModel},e.prototype.setWidget=function(e){this.widgetModel=e,this.componentModel=e.get("component").get("options")},e.prototype.setDocument=function(e){e&&(this.docViewModel=e.get("viewState"),this.docDataModel=e.get("data"))},e.prototype.showBulkColumnEditor=function(e){this.dlgBulkColumnEditor=this.dlgBulkColumnEditor||new BulkColumnEditorDialog({container:this.dialogContainer}),this.dlgBulkColumnEditor.setEditor(e),this.dlgBulkColumnEditor.open()},e.prototype.showCleanUpDialog=function(e){new CleanUpDialog({documentGraphVisual:e,dialogContainer:this.dialogContainer})},e.prototype.showColorPickerDialog=function(t,i){new ColorPickerDialog({container:this.dialogContainer,values:t.getAttribute("gradient"),noColor:t.getAttribute("noColor"),target:t,editor:i,path:$(t).val(),selected:t.value,selectCallback:function(e){$(t).val()!==e&&(i.value=e,i.onInput(e.slice()),$(t).val(e))}})},e.prototype.showColSelectorDialog=function(e,t,i,n,o,a,s){new ColSelectorDialog({container:this.dialogContainer,dropdownType:o,dropdownMessage:a,values:e||[],target:i,isUserDefined:!!n,selected:t,selectCallback:s})},e.prototype.showCssDialog=function(e,t){this.cssDialog&&(this.cssDialog.remove(),this.cssDialog=null),this.cssDialog=new CssDialog({applyCallback:t,container:this.dialogContainer,viewModel:this.viewModel,styles:e}),this.listenTo(this.cssDialog,"startInspecting",function(){this.trigger("startInspecting")}),this.listenTo(this.cssDialog,"stopInspecting",function(){this.trigger("stopInspecting")})},e.prototype.showDataConnectionDialog=function(e,t){new DataConnectionDialog({appModel:this.appModel,docViewModel:this.docViewModel,container:this.dialogContainer,path:e,selectCallback:t})},e.prototype.showDataDialog=function(e,t,i,n){this.docDataModel=this.docDataModel||this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")).get("data"),this.docDataModel.cid!==this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")).get("data").cid&&(this.docDataModel=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")).get("data"));var o=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")).getComponents();new DataDialog({appModel:this.appModel,dialogContainer:this.dialogContainer,docViewModel:this.docViewModel,model:this.docDataModel,initialTab:i,path:e,isTableEditProperties:!1,selectCallback:t,components:o.concat(this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")).get("popups").models),dialogOptions:n})},e.prototype.showTemplateDialog=function(e,t,i,n){var o,a=this,s=(this.htmlDialog&&(this.htmlDialog.remove(),this.htmlDialog=null),[]),l="possibleColumns",l=(this.componentModel&&!e.disableTree?(o=this.componentModel.parent.get("key"),"string"==typeof e.columnsFieldName?l=e.columnsFieldName:e.columnsFieldName instanceof Array&&_.each(e.columnsFieldName,function(e){s=_.union(s,a.componentModel.get(e))}),this.componentModel.get(l)?s=this.componentModel.get(l):"ChartJS"===o&&_.each(this.componentModel.get("Layers"),function(e){s=_.union(s,e.Basics.Data.dataSet.columns.models.map(function(e){return e.get("id")}))}),"ChartGL"===o&&_.each(this.componentModel.get("Layers"),function(e){s=_.without(_.union(s,e.possibleColorColumns),"None")}),s=_.filter(s,function(e){return!_.isEmpty(e)}),e.templateItems&&(-1!==["ChartGL","ChartJS","PieJS","Chart3D","Gauge"].indexOf(o)&&"legendTemplate"!==e.type?_.each(e.templateItems,function(e){var t="ChartGL"!==o&&"Gauge"!==o?"cols":"data";e.items[t]=_.keyBy(s)}):"Datagrid"!==o&&"Datatable"!==o||_.each(e.templateItems,function(e){_.extend(e.items,_.keyBy(s))}),s=[])):e.disableTree&&(s=[],delete e.templateItems),this.componentModel?this.componentModel.get("format").tileTransparentBackground?"transparent":this.componentModel.get("format").tileBackgroundColor:"#ffffff"),r=this.componentModel&&!0===this.componentModel.get("Basics.AllowUnsafeContent");this.htmlDialog=new TemplateDialog({docViewModel:this.docViewModel,container:this.dialogContainer,keys:s,valueData:e.templateItems,disableTree:e.disableTree,text:t,background:l,allowUnsafeContent:r,sanitizeTemplate:this.sanitizeTemplate.bind(this),applyCallback:n})},e.prototype.showHtmlDialog=function(e){this.htmlDialog&&(this.htmlDialog.remove(),this.htmlDialog=null),this.htmlDialog=new RichTextEditorDialog({container:this.dialogContainer,text:this.componentModel.get("Basics").HtmlText,background:this.componentModel.get("format").tileTransparentBackground?"transparent":this.componentModel.get("format").tileBackgroundColor,allowUnsafeContent:!0===this.componentModel.get("Basics.AllowUnsafeContent"),applyCallback:e})},e.prototype.showIconDropDownDialog=function(e,t){var i=this;this.iconDialogLoading||(this.iconDialogLoading=!0,new IconDropDownDialog({container:this.dialogContainer,isFAOnly:e,selectCallback:t,closing:function(){return i.iconDialogLoading=!1}}))},e.prototype.showJsonDialog=function(e,t,i){new JsonDialog({editorOptions:e.schema.options,container:this.dialogContainer,value:t,applyCallback:i})},e.prototype.showPopupEditor=function(e){this.trigger("showPopupEditor",e)},e.prototype.showViewStateDialog=function(t,i,e){var n=this,o=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId")),a=(a=o.getComponents()).concat(o.get("popups").models),o=o.get("dashboardTheme");new ViewStateDialog({dialogContainer:this.dialogContainer,docDataModel:this.docDataModel,model:this.docViewModel,path:t,components:a,componentDefs:this.appModel.get("components").models,dashboardTheme:o,isEmbedded:!!this.appModel.get("embedded"),dialogOptions:e,selectCallback:function(e){e!==t&&(e=n.docViewModel.getByPath(e))&&_.isFunction(i)&&i(e)}})},e.prototype.sanitizeTemplate=function(e){var t,i,n,o,a,s,l,r,c,d=["target"],u="dashreplace-",p=["style","table","thead","tbody","tfoot","tr","th","td","comment"];return this.componentModel&&!0===this.componentModel.get("Basics.AllowUnsafeContent")?e:(n=e,(e=/(\<.*\[START\].*--\>.*[\s\S]*).*(\<.*\[END\]--\>)/g.exec(n))&&(t=e[1],i=e[2],n=(n=n.replace(e[1],"<comment>")).replace(e[2],"</comment>")),n=n.replace(/<!--([\s\S]*?)-->/g,function(e,t){return"<comment>"+t+"</comment>"}),_.each(p,function(e){e=new RegExp("(</?)("+e+")(/>)?","g");n=n.replace(e,"$1"+u+"$2$3")}),o=/".*?"/g,a=/{{.+?}}/g,s=/(dashreplace[0-9]+=)?{{.+?}}/g,l="dashreplace",r=0,n=n.replace(/<.+?>/g,function(e){return e.replace(o,function(e){return e.replace(a,function(e){return l+r+++"="+e})}).replace(s,function(e,t){return t?e:l+r+++'="'+e+'"'})}),d=d.concat(_.times(r,function(e){return l+e})),c=(e=function(e){return DOMPurify.sanitize(e,{ADD_TAGS:_.map(p,function(e){return u+e}),ADD_ATTR:d})})(e(n)),_.each(p,function(e){e=new RegExp("(</?)"+u+"("+e+")(/>)?","g");c=c.replace(e,"$1$2$3")}),c=(c=(c=t&&i?(c=c.replace("<comment>",t)).replace("</comment>",i):c).replace(/<comment>([\s\S]*?)<\/comment>/g,function(e,t){return"\x3c!--"+t+"--\x3e"})).replace(/(dashreplace[0-9]+=)"({{.+?}})"/g,function(e,t,i){return i}).replace(/(dashreplace[0-9]+=)({{.+?}})/g,function(e,t,i){return i}))},e}(CustomEvents),CopyPasteHelpers=function(){function e(e){}return e.getComponentViewStates=function(e,i){void 0===i&&(i=!0);function n(t){t&&(t instanceof QuickBase.Component?(i&&(t.get("components").each(function(e){n(e)}),t.get("widgets").each(function(e){n(e.get("component"))})),n(t.get("options"))):t instanceof QuickBase.Popup?n(_.omit(t.attributes,"widgets")):_.isArray(t)?_.each(t,function(e){n(e)}):t.attributes?t.path?t.get("_dataSource")||_.includes(o,t.path)||(o.push(t.path),"dict"===t.get("_type")&&_.each(t.get("_default"),function(e){e instanceof QuickBase.DocumentViewModel&&o.push(e.path)})):n(t.attributes):!_.isObject(t)||t instanceof Backbone.View||("viewstate"===t._dashboardsType?_.includes(o,t.value)||o.push(t.value):_.each(_.keys(t),function(e){n(t[e])})))}var o=[];return n(e),o},e.mergeViewStates=function(e,a){var s;e&&a&&(_.each(e,function(e,t){if(!a.get("viewState").getByPath(t)){var i=t.split("/"),n=null,t=void 0;if(i.length<=1)s=i[0],n=new QuickBase.DocumentViewModel(e,null);else{for(var n=a.get("viewState"),o=0;o<i.length-1;o+=1)n.set(i[o],n.get(i[o])||new QuickBase.DocumentViewModel(null,null)),n=n.get(i[o]),s=0===o?i[o]:i.slice(0,o).join("/"),n.path=s;s=i.join("/"),t=new QuickBase.DocumentViewModel(e,null),n.set(i[i.length-1],t),t.path=s}a.get("viewState").getByPath(s)||(n.path=s,a.get("viewState").set(s,n))}}),a.get("viewState").postInitialize())},e.getMappingDataSources=function(i,e){var n=[];return e.get("data").getTreeList().forEach(function(t){t.get("_mappings")&&_.each(t.get("_mappings").mappings,function(e){_.includes(i,e.value)&&(n[t.path]=t.toJSON())})}),n},e.mergeDataSources=function(e,l){var r;e&&(r=l.get("data"),_.each(e,function(e,t){for(var i,n=_.filter(t.split("/"),function(e){return e&&0<e.length}),o=r,a="",s=0;s<n.length;s+=1)a=(a+=0===s?"":"/")+n[s],i=new QuickBase.DocumentDataModel(s!==n.length-1?{}:e,r,a,l.get("viewState"),s!==n.length-1),o=l.get("data").getByPath(a)?l.get("data").getByPath(a):(o.set(n[s],i),i.viewState=l.attributes.viewState,i)}))},e.getComponentDataSources=function(e,i,n,o){void 0===o&&(o=!0);var a,s={},l={},r=function(e){return e._cpKey||(_.isObject(e)||_.isArray(e))&&(Object.defineProperty(e,"_cpKey",{enumerable:!1,writable:!0}),e._cpKey=_.uniqueId("_cpKey_")),e._cpKey||null},c=function(t){!t||(a=r(t))&&l[a]||(a&&(l[a]=!0),!o&&(t instanceof QuickBase.WidgetCollection||t instanceof QuickBase.ComponentCollection))||(_.isArray(t)?_.each(t,function(e){c(e)}):t.attributes?(t.attributes._dataType&&_.includes(QuickBase.DocumentDataModel.SUPPORTED_DATA_SOURCES,t.attributes._dataType)&&(_.each(t.getViewStateDict(),function(e){_.includes(i,e.path)||(i.push(e.path),"dict"===e.get("_type")&&_.each(e.get("_default"),function(e){e instanceof QuickBase.DocumentViewModel&&i.push(e.path)}))}),"virtual"===t.attributes._dataType&&_.each(t.get("_virtualParams"),function(e){var t;"datasource"===e.type&&(t=n.getByPath(e.value))&&(_.each(t.getViewStateDict(),function(e){_.includes(i,e.path)||i.push(e.path)}),s[e.value]=t.toJSON())}),s[t.path]=t.toJSON()),c(t.attributes)):!_.isObject(t)||t instanceof Backbone.View||("data"===t._dashboardsType?s[t.value]||c(n.getByPath(t.value)):_.each(_.keys(t),function(e){c(t[e])})))};return c(e),s},e}(),ScreenItem=(!function(v){"use strict";var s=0,e='<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>',t='<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>',i='<div class="ui-colorpicker ui-colorpicker-inline"></div>',l=function(e){var t=Math.round(e).toString(16);if(t.length===1)t="0"+t;return t.toLowerCase()},a=function(e){var t,i;i=/^#?([a-fA-F0-9]{1,6})$/.exec(e);if(i){t=parseInt(i[1],16);return new v.colorpicker.Color((t>>16&255)/255,(t>>8&255)/255,(t&255)/255)}return new v.colorpicker.Color},r=function(e,t){var i,n,o,a,s,l,r,c,d,u,p,h,m,g;e.sort(function(e,t){if(e.pos[1]===t.pos[1])return e.pos[0]-t.pos[0];return e.pos[1]-t.pos[1]});a=0;s=0;v.each(e,function(e,t){a=Math.max(a,t.pos[0]+t.pos[2]);s=Math.max(s,t.pos[1]+t.pos[3])});i=[];for(n=0;n<a;++n)i.push([]);r=[];l=[];v.each(e,function(e,t){for(n=0;n<t.pos[2];n+=1)l[t.pos[0]+n]=true;for(o=0;o<t.pos[3];o+=1)r[t.pos[1]+o]=true});u="";d=e[c=0];for(o=0;o<s;++o){u+="<tr>";n=0;while(n<a)if(typeof d!=="undefined"&&n===d.pos[0]&&o===d.pos[1]){u+=t(d,n,o);for(h=0;h<d.pos[3];h+=1)for(p=0;p<d.pos[2];p+=1)i[n+p][o+h]=true;n+=d.pos[2];d=e[++c]}else{m=0;g=false;while(n<a&&i[n][o]===undefined&&(d===undefined||o<d.pos[1]||o===d.pos[1]&&n<d.pos[0])){if(l[n]===true)m+=1;g=true;n+=1}if(m>0)u+='<td colspan="'+m+'"></td>';else if(!g)n+=1}u+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+u+"</tbody></table>"};v.colorpicker=new function(){this.regional={"":{ok:"OK",cancel:"Cancel",none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"}};this.swatchesNames={html:"HTML"};this.swatches={html:[{name:"black",r:0,g:0,b:0},{name:"dimgray",r:.4117647058823529,g:.4117647058823529,b:.4117647058823529},{name:"gray",r:.5019607843137255,g:.5019607843137255,b:.5019607843137255},{name:"darkgray",r:.6627450980392157,g:.6627450980392157,b:.6627450980392157},{name:"silver",r:.7529411764705882,g:.7529411764705882,b:.7529411764705882},{name:"lightgrey",r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},{name:"gainsboro",r:.8627450980392157,g:.8627450980392157,b:.8627450980392157},{name:"whitesmoke",r:.9607843137254902,g:.9607843137254902,b:.9607843137254902},{name:"white",r:1,g:1,b:1},{name:"rosybrown",r:.7372549019607844,g:.5607843137254902,b:.5607843137254902},{name:"indianred",r:.803921568627451,g:.3607843137254902,b:.3607843137254902},{name:"brown",r:.6470588235294118,g:.16470588235294117,b:.16470588235294117},{name:"firebrick",r:.6980392156862745,g:.13333333333333333,b:.13333333333333333},{name:"lightcoral",r:.9411764705882353,g:.5019607843137255,b:.5019607843137255},{name:"maroon",r:.5019607843137255,g:0,b:0},{name:"darkred",r:.5450980392156862,g:0,b:0},{name:"red",r:1,g:0,b:0},{name:"snow",r:1,g:.9803921568627451,b:.9803921568627451},{name:"salmon",r:.9803921568627451,g:.5019607843137255,b:.4470588235294118},{name:"mistyrose",r:1,g:.8941176470588236,b:.8823529411764706},{name:"tomato",r:1,g:.38823529411764707,b:.2784313725490196},{name:"darksalmon",r:.9137254901960784,g:.5882352941176471,b:.47843137254901963},{name:"orangered",r:1,g:.27058823529411763,b:0},{name:"coral",r:1,g:.4980392156862745,b:.3137254901960784},{name:"lightsalmon",r:1,g:.6274509803921569,b:.47843137254901963},{name:"sienna",r:.6274509803921569,g:.3215686274509804,b:.17647058823529413},{name:"seashell",r:1,g:.9607843137254902,b:.9333333333333333},{name:"chocolate",r:.8235294117647058,g:.4117647058823529,b:.11764705882352941},{name:"saddlebrown",r:.5450980392156862,g:.27058823529411763,b:.07450980392156863},{name:"sandybrown",r:.9568627450980393,g:.6431372549019608,b:.3764705882352941},{name:"peachpuff",r:1,g:.8549019607843137,b:.7254901960784313},{name:"peru",r:.803921568627451,g:.5215686274509804,b:.24705882352941178},{name:"linen",r:.9803921568627451,g:.9411764705882353,b:.9019607843137255},{name:"darkorange",r:1,g:.5490196078431373,b:0},{name:"bisque",r:1,g:.8941176470588236,b:.7686274509803922},{name:"burlywood",r:.8705882352941177,g:.7215686274509804,b:.5294117647058824},{name:"tan",r:.8235294117647058,g:.7058823529411765,b:.5490196078431373},{name:"antiquewhite",r:.9803921568627451,g:.9215686274509803,b:.8431372549019608},{name:"navajowhite",r:1,g:.8705882352941177,b:.6784313725490196},{name:"blanchedalmond",r:1,g:.9215686274509803,b:.803921568627451},{name:"papayawhip",r:1,g:.9372549019607843,b:.8352941176470589},{name:"orange",r:1,g:.6470588235294118,b:0},{name:"moccasin",r:1,g:.8941176470588236,b:.7098039215686275},{name:"wheat",r:.9607843137254902,g:.8705882352941177,b:.7019607843137254},{name:"oldlace",r:.9921568627450981,g:.9607843137254902,b:.9019607843137255},{name:"floralwhite",r:1,g:.9803921568627451,b:.9411764705882353},{name:"goldenrod",r:.8549019607843137,g:.6470588235294118,b:.12549019607843137},{name:"darkgoldenrod",r:.7215686274509804,g:.5254901960784314,b:.043137254901960784},{name:"cornsilk",r:1,g:.9725490196078431,b:.8627450980392157},{name:"gold",r:1,g:.8431372549019608,b:0},{name:"palegoldenrod",r:.9333333333333333,g:.9098039215686274,b:.6666666666666666},{name:"khaki",r:.9411764705882353,g:.9019607843137255,b:.5490196078431373},{name:"lemonchiffon",r:1,g:.9803921568627451,b:.803921568627451},{name:"darkkhaki",r:.7411764705882353,g:.7176470588235294,b:.4196078431372549},{name:"beige",r:.9607843137254902,g:.9607843137254902,b:.8627450980392157},{name:"lightgoldenrodyellow",r:.9803921568627451,g:.9803921568627451,b:.8235294117647058},{name:"olive",r:.5019607843137255,g:.5019607843137255,b:0},{name:"yellow",r:1,g:1,b:0},{name:"lightyellow",r:1,g:1,b:.8784313725490196},{name:"ivory",r:1,g:1,b:.9411764705882353},{name:"olivedrab",r:.4196078431372549,g:.5568627450980392,b:.13725490196078433},{name:"yellowgreen",r:.6039215686274509,g:.803921568627451,b:.19607843137254902},{name:"darkolivegreen",r:.3333333333333333,g:.4196078431372549,b:.1843137254901961},{name:"greenyellow",r:.6784313725490196,g:1,b:.1843137254901961},{name:"lawngreen",r:.48627450980392156,g:.9882352941176471,b:0},{name:"chartreuse",r:.4980392156862745,g:1,b:0},{name:"darkseagreen",r:.5607843137254902,g:.7372549019607844,b:.5607843137254902},{name:"forestgreen",r:.13333333333333333,g:.5450980392156862,b:.13333333333333333},{name:"limegreen",r:.19607843137254902,g:.803921568627451,b:.19607843137254902},{name:"lightgreen",r:.5647058823529412,g:.9333333333333333,b:.5647058823529412},{name:"palegreen",r:.596078431372549,g:.984313725490196,b:.596078431372549},{name:"darkgreen",r:0,g:.39215686274509803,b:0},{name:"green",r:0,g:.5019607843137255,b:0},{name:"lime",r:0,g:1,b:0},{name:"honeydew",r:.9411764705882353,g:1,b:.9411764705882353},{name:"mediumseagreen",r:.23529411764705882,g:.7019607843137254,b:.44313725490196076},{name:"seagreen",r:.1803921568627451,g:.5450980392156862,b:.3411764705882353},{name:"springgreen",r:0,g:1,b:.4980392156862745},{name:"mintcream",r:.9607843137254902,g:1,b:.9803921568627451},{name:"mediumspringgreen",r:0,g:.9803921568627451,b:.6039215686274509},{name:"mediumaquamarine",r:.4,g:.803921568627451,b:.6666666666666666},{name:"aquamarine",r:.4980392156862745,g:1,b:.8313725490196079},{name:"turquoise",r:.25098039215686274,g:.8784313725490196,b:.8156862745098039},{name:"lightseagreen",r:.12549019607843137,g:.6980392156862745,b:.6666666666666666},{name:"mediumturquoise",r:.2823529411764706,g:.8196078431372549,b:.8},{name:"darkslategray",r:.1843137254901961,g:.30980392156862746,b:.30980392156862746},{name:"paleturquoise",r:.6862745098039216,g:.9333333333333333,b:.9333333333333333},{name:"teal",r:0,g:.5019607843137255,b:.5019607843137255},{name:"darkcyan",r:0,g:.5450980392156862,b:.5450980392156862},{name:"darkturquoise",r:0,g:.807843137254902,b:.8196078431372549},{name:"aqua",r:0,g:1,b:1},{name:"cyan",r:0,g:1,b:1},{name:"lightcyan",r:.8784313725490196,g:1,b:1},{name:"azure",r:.9411764705882353,g:1,b:1},{name:"cadetblue",r:.37254901960784315,g:.6196078431372549,b:.6274509803921569},{name:"powderblue",r:.6901960784313725,g:.8784313725490196,b:.9019607843137255},{name:"lightblue",r:.6784313725490196,g:.8470588235294118,b:.9019607843137255},{name:"deepskyblue",r:0,g:.7490196078431373,b:1},{name:"skyblue",r:.5294117647058824,g:.807843137254902,b:.9215686274509803},{name:"lightskyblue",r:.5294117647058824,g:.807843137254902,b:.9803921568627451},{name:"steelblue",r:.27450980392156865,g:.5098039215686274,b:.7058823529411765},{name:"aliceblue",r:.9411764705882353,g:.9725490196078431,b:1},{name:"dodgerblue",r:.11764705882352941,g:.5647058823529412,b:1},{name:"slategray",r:.4392156862745098,g:.5019607843137255,b:.5647058823529412},{name:"lightslategray",r:.4666666666666667,g:.5333333333333333,b:.6},{name:"lightsteelblue",r:.6901960784313725,g:.7686274509803922,b:.8705882352941177},{name:"cornflowerblue",r:.39215686274509803,g:.5843137254901961,b:.9294117647058824},{name:"royalblue",r:.2549019607843137,g:.4117647058823529,b:.8823529411764706},{name:"midnightblue",r:.09803921568627451,g:.09803921568627451,b:.4392156862745098},{name:"lavender",r:.9019607843137255,g:.9019607843137255,b:.9803921568627451},{name:"navy",r:0,g:0,b:.5019607843137255},{name:"darkblue",r:0,g:0,b:.5450980392156862},{name:"mediumblue",r:0,g:0,b:.803921568627451},{name:"blue",r:0,g:0,b:1},{name:"ghostwhite",r:.9725490196078431,g:.9725490196078431,b:1},{name:"darkslateblue",r:.2823529411764706,g:.23921568627450981,b:.5450980392156862},{name:"slateblue",r:.41568627450980394,g:.35294117647058826,b:.803921568627451},{name:"mediumslateblue",r:.4823529411764706,g:.40784313725490196,b:.9333333333333333},{name:"mediumpurple",r:.5764705882352941,g:.4392156862745098,b:.8588235294117647},{name:"blueviolet",r:.5411764705882353,g:.16862745098039217,b:.8862745098039215},{name:"indigo",r:.29411764705882354,g:0,b:.5098039215686274},{name:"darkorchid",r:.6,g:.19607843137254902,b:.8},{name:"darkviolet",r:.5803921568627451,g:0,b:.8274509803921568},{name:"mediumorchid",r:.7294117647058823,g:.3333333333333333,b:.8274509803921568},{name:"thistle",r:.8470588235294118,g:.7490196078431373,b:.8470588235294118},{name:"plum",r:.8666666666666667,g:.6274509803921569,b:.8666666666666667},{name:"violet",r:.9333333333333333,g:.5098039215686274,b:.9333333333333333},{name:"purple",r:.5019607843137255,g:0,b:.5019607843137255},{name:"darkmagenta",r:.5450980392156862,g:0,b:.5450980392156862},{name:"magenta",r:1,g:0,b:1},{name:"fuchsia",r:1,g:0,b:1},{name:"orchid",r:.8549019607843137,g:.4392156862745098,b:.8392156862745098},{name:"mediumvioletred",r:.7803921568627451,g:.08235294117647059,b:.5215686274509804},{name:"deeppink",r:1,g:.0784313725490196,b:.5764705882352941},{name:"hotpink",r:1,g:.4117647058823529,b:.7058823529411765},{name:"palevioletred",r:.8588235294117647,g:.4392156862745098,b:.5764705882352941},{name:"lavenderblush",r:1,g:.9411764705882353,b:.9607843137254902},{name:"crimson",r:.8627450980392157,g:.0784313725490196,b:.23529411764705882},{name:"pink",r:1,g:.7529411764705882,b:.796078431372549},{name:"lightpink",r:1,g:.7137254901960784,b:.7568627450980392}]};this.writers={"#HEX":function(e,t){return t._formatColor("#rxgxbx",e)},"#HEX3":function(e,t){var i=v.colorpicker.writers.HEX3(e);return i===false?false:"#"+i},HEX:function(e,t){return t._formatColor("rxgxbx",e)},HEX3:function(e,t){var i=e.getRGB(),n=Math.round(i.r*255),o=Math.round(i.g*255),a=Math.round(i.b*255);if(n>>>4===(n&=15)&&o>>>4===(o&=15)&&a>>>4===(a&=15))return n.toString(16)+o.toString(16)+a.toString(16);return false},"#HEXA":function(e,t){return t._formatColor("#rxgxbxax",e)},"#HEXA4":function(e,t){var i=v.colorpicker.writers.HEXA4(e,t);return i===false?false:"#"+i},HEXA:function(e,t){return t._formatColor("rxgxbxax",e)},HEXA4:function(e,t){var i=Math.round(e.getAlpha()*255);if(i>>>4===(i&=15))return v.colorpicker.writers.HEX3(e,t)+i.toString(16);return false},RGB:function(e,t){return e.getAlpha()>=1?t._formatColor("rgb(rd,gd,bd)",e):false},RGBA:function(e,t){return t._formatColor("rgba(rd,gd,bd,af)",e)},"RGB%":function(e,t){return e.getAlpha()>=1?t._formatColor("rgb(rp%,gp%,bp%)",e):false},"RGBA%":function(e,t){return t._formatColor("rgba(rp%,gp%,bp%,af)",e)},HSL:function(e,t){return e.getAlpha()>=1?t._formatColor("hsl(hd,sd,vd)",e):false},HSLA:function(e,t){return t._formatColor("hsla(hd,sd,vd,af)",e)},"HSL%":function(e,t){return e.getAlpha()>=1?t._formatColor("hsl(hp%,sp%,vp%)",e):false},"HSLA%":function(e,t){return t._formatColor("hsla(hp%,sp%,vp%,af)",e)},NAME:function(e,t){return t._closestName(e)},EXACT:function(e,t){return t._exactName(e)}};this.parsers={"":function(e){if(e==="")return new v.colorpicker.Color},NAME:function(e,t){var i=t._getSwatch(v.trim(e));if(i)return new v.colorpicker.Color(i.r,i.g,i.b)},RGBA:function(e){var t=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e);if(t)return new v.colorpicker.Color(t[1]/255,t[2]/255,t[3]/255,parseFloat(t[4]))},"RGBA%":function(e){var t=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e);if(t)return new v.colorpicker.Color(t[1]/100,t[2]/100,t[3]/100,t[4]/100)},HSLA:function(e){var t=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e);if(t)return(new v.colorpicker.Color).setHSL(t[1]/255,t[2]/255,t[3]/255).setAlpha(parseFloat(t[4]))},"HSLA%":function(e){var t=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(e);if(t)return(new v.colorpicker.Color).setHSL(t[1]/100,t[2]/100,t[3]/100).setAlpha(t[4]/100)},"#HEX":function(e){var t=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e);if(t)return new v.colorpicker.Color(parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255)},"#HEX3":function(e){var t=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e);if(t)return new v.colorpicker.Color(parseInt(String(t[1])+t[1],16)/255,parseInt(String(t[2])+t[2],16)/255,parseInt(String(t[3])+t[3],16)/255)},HEX:function(e){var t=/^([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e);if(t)return new v.colorpicker.Color(parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255)},HEX3:function(e){var t=/^([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e);if(t)return new v.colorpicker.Color(parseInt(String(t[1])+t[1],16)/255,parseInt(String(t[2])+t[2],16)/255,parseInt(String(t[3])+t[3],16)/255)},"#HEXA":function(e){var t=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e);if(t)return new v.colorpicker.Color(parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255,parseInt(t[4],16)/255)},"#HEXA4":function(e){var t=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e);if(t)return new v.colorpicker.Color(parseInt(String(t[1])+t[1],16)/255,parseInt(String(t[2])+t[2],16)/255,parseInt(String(t[3])+t[3],16)/255,parseInt(String(t[4])+t[4],16)/255)},HEXA:function(e){var t=/^([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(e);if(t)return new v.colorpicker.Color(parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255,parseInt(t[4],16)/255)},HEXA4:function(e){var t=/^([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(e);if(t)return new v.colorpicker.Color(parseInt(String(t[1])+t[1],16)/255,parseInt(String(t[2])+t[2],16)/255,parseInt(String(t[3])+t[3],16)/255,parseInt(String(t[4])+t[4],16)/255)}};this.partslists={full:["header","map","bar","hex","hsv","rgb","alpha","lab","cmyk","preview","swatches","footer"],popup:["map","bar","hex","hsv","rgb","alpha","preview","footer"],draggable:["header","map","bar","hex","hsv","rgb","alpha","preview","footer"],inline:["map","bar","hex","hsv","rgb","alpha","preview"]};this.limits={websafe:function(e){e.limit(6)},nibble:function(e){e.limit(16)},binary:function(e){e.limit(2)},name:function(e,t){var i=t._getSwatch(t._closestName(e));e.setRGB(i.r,i.g,i.b)}};this.parts={header:function(i){var e=this,n=null,o=function(){var e=i.options.title||i._getRegional("title"),t='<span class="ui-dialog-title">'+e+"</span>";if(!i.inline&&i.options.showCloseButton)t+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button">'+'<span class="ui-icon ui-icon-closethick">close</span></a>';return'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+t+"</div>"};this.init=function(){n=v(o()).prependTo(i.dialog);var e=v(".ui-dialog-titlebar-close",n);i._hoverable(e);i._focusable(e);e.click(function(e){e.preventDefault();i.close(i.options.revert)});if(!i.inline&&i.options.draggable){var t={handle:n};if(i.options.containment)t.containment=i.options.containment;i.dialog.draggable(t)}}},map:function(o){var a=this,s=null,l,r,c,d={},u,p,h,e;u=function(e){if(!o.opened)return;var t=d.p.offset(),i=e.pageX-t.left,n=e.pageY-t.top;if(i>=0&&i<r&&n>=0&&n<c){e.stopImmediatePropagation();e.preventDefault();s.unbind("mousedown",u);v(document).bind("mouseup",p);v(document).bind("mousemove",h);h(e)}};p=function(e){e.stopImmediatePropagation();e.preventDefault();v(document).unbind("mouseup",p);v(document).unbind("mousemove",h);s.bind("mousedown",u);o._callback("stop")};h=function(e){e.stopImmediatePropagation();e.preventDefault();if(e.pageX===a.x&&e.pageY===a.y)return;a.x=e.pageX;a.y=e.pageY;var t=d.p.offset(),i=e.pageX-t.left,n=e.pageY-t.top;i=Math.max(0,Math.min(i/r,1));n=Math.max(0,Math.min(n/c,1));switch(o.mode){case"h":o.color.setHSV(null,i,1-n);break;case"s":case"a":o.color.setHSV(i,null,1-n);break;case"v":o.color.setHSV(i,1-n,null);break;case"r":o.color.setRGB(null,1-n,i);break;case"g":o.color.setRGB(1-n,null,i);break;case"b":o.color.setRGB(i,1-n,null);break}o._change(false)};e=function(){var e='<div class="ui-colorpicker-map ui-colorpicker-map-'+(o.options.part.map.size||256)+' ui-colorpicker-border">'+'<span class="ui-colorpicker-map-layer-1">&nbsp;</span>'+'<span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(o.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>';return e};this.init=function(){s=v(e()).appendTo(v(".ui-colorpicker-map-container",o.dialog));s.bind("mousedown",u);d[1]=v(".ui-colorpicker-map-layer-1",s);d[2]=v(".ui-colorpicker-map-layer-2",s);d.a=v(".ui-colorpicker-map-layer-alpha",s);d.p=v(".ui-colorpicker-map-layer-pointer",s);r=d.p.width();c=d.p.height();l=v(".ui-colorpicker-map-pointer",s)};this.update=function(){var e=(o.options.part.map.size||256)*65/64;switch(o.mode){case"h":d[1].css({"background-position":"0 0",opacity:""}).show();d[2].hide();break;case"s":case"a":d[1].css({"background-position":"0 "+-e+"px",opacity:""}).show();d[2].css({"background-position":"0 "+-e*2+"px",opacity:""}).show();break;case"v":s.css("background-color","black");d[1].css({"background-position":"0 "+-e*3+"px",opacity:""}).show();d[2].hide();break;case"r":d[1].css({"background-position":"0 "+-e*4+"px",opacity:""}).show();d[2].css({"background-position":"0 "+-e*5+"px",opacity:""}).show();break;case"g":d[1].css({"background-position":"0 "+-e*6+"px",opacity:""}).show();d[2].css({"background-position":"0 "+-e*7+"px",opacity:""}).show();break;case"b":d[1].css({"background-position":"0 "+-e*8+"px",opacity:""}).show();d[2].css({"background-position":"0 "+-e*9+"px",opacity:""}).show();break}a.repaint()};this.repaint=function(){var e=0,t=0;switch(o.mode){case"h":var i=o.color.getHSV();e=i.s*r;t=(1-i.v)*r;s.css("background-color",o.color.copy().setHSV(null,1,1).toCSS());break;case"s":case"a":var i=o.color.getHSV();e=i.h*r;t=(1-i.v)*r;d[2].css("opacity",1-i.s);break;case"v":var i=o.color.getHSV();e=i.h*r;t=(1-i.s)*r;d[1].css("opacity",i.v);break;case"r":var n=o.color.getRGB();e=n.b*r;t=(1-n.g)*r;d[2].css("opacity",n.r);break;case"g":var n=o.color.getRGB();e=n.b*r;t=(1-n.r)*r;d[2].css("opacity",n.g);break;case"b":var n=o.color.getRGB();e=n.r*r;t=(1-n.g)*r;d[2].css("opacity",n.b);break}if(o.options.alpha)d.a.css("opacity",1-o.color.getAlpha());l.css({left:e-7,top:t-7})}},bar:function(o){var n=this,a=null,s,l,r,c={},d,u,p,e;d=function(e){if(!o.opened)return;var t=c.p.offset(),i=e.pageX-t.left,n=e.pageY-t.top;if(i>=0&&i<l&&n>=0&&n<r){e.stopImmediatePropagation();e.preventDefault();a.unbind("mousedown",d);v(document).bind("mouseup",u);v(document).bind("mousemove",p);p(e)}};u=function(e){e.stopImmediatePropagation();e.preventDefault();v(document).unbind("mouseup",u);v(document).unbind("mousemove",p);a.bind("mousedown",d);o._callback("stop")};p=function(e){e.stopImmediatePropagation();e.preventDefault();if(e.pageY===n.y)return;n.y=e.pageY;var t=c.p.offset(),i=e.pageY-t.top;i=Math.max(0,Math.min(i/r,1));switch(o.mode){case"h":o.color.setHSV(1-i,null,null);break;case"s":o.color.setHSV(null,1-i,null);break;case"v":o.color.setHSV(null,null,1-i);break;case"r":o.color.setRGB(1-i,null,null);break;case"g":o.color.setRGB(null,1-i,null);break;case"b":o.color.setRGB(null,null,1-i);break;case"a":o.color.setAlpha(1-i);break}o._change(false)};e=function(){var e='<div class="ui-colorpicker-bar ui-colorpicker-bar-'+(o.options.part.bar.size||256)+'  ui-colorpicker-border">'+'<span class="ui-colorpicker-bar-layer-1">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-2">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-3">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';if(o.options.alpha)e+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span>'+'<span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>';e+='<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>';return e};this.init=function(){a=v(e()).appendTo(v(".ui-colorpicker-bar-container",o.dialog));a.bind("mousedown",d);c[1]=v(".ui-colorpicker-bar-layer-1",a);c[2]=v(".ui-colorpicker-bar-layer-2",a);c[3]=v(".ui-colorpicker-bar-layer-3",a);c[4]=v(".ui-colorpicker-bar-layer-4",a);c.a=v(".ui-colorpicker-bar-layer-alpha",a);c.ab=v(".ui-colorpicker-bar-layer-alphabar",a);c.p=v(".ui-colorpicker-bar-layer-pointer",a);l=c.p.width();r=c.p.height();s=v(".ui-colorpicker-bar-pointer",a)};this.update=function(){var e=(o.options.part.bar.size||256)*65/64;switch(o.mode){case"h":case"s":case"v":case"r":case"g":case"b":c.a.show();c.ab.hide();break;case"a":c.a.hide();c.ab.show();break}switch(o.mode){case"h":c[1].css({"background-position":"0 0",opacity:""}).show();c[2].hide();c[3].hide();c[4].hide();break;case"s":c[1].css({"background-position":"0 "+-e+"px",opacity:""}).show();c[2].css({"background-position":"0 "+-e*2+"px",opacity:""}).show();c[3].hide();c[4].hide();break;case"v":c[1].css({"background-position":"0 "+-e*2+"px",opacity:""}).show();c[2].hide();c[3].hide();c[4].hide();break;case"r":c[1].css({"background-position":"0 "+-e*6+"px",opacity:""}).show();c[2].css({"background-position":"0 "+-e*5+"px",opacity:""}).show();c[3].css({"background-position":"0 "+-e*3+"px",opacity:""}).show();c[4].css({"background-position":"0 "+-e*4+"px",opacity:""}).show();break;case"g":c[1].css({"background-position":"0 "+-e*10+"px",opacity:""}).show();c[2].css({"background-position":"0 "+-e*9+"px",opacity:""}).show();c[3].css({"background-position":"0 "+-e*7+"px",opacity:""}).show();c[4].css({"background-position":"0 "+-e*8+"px",opacity:""}).show();break;case"b":c[1].css({"background-position":"0 "+-e*14+"px",opacity:""}).show();c[2].css({"background-position":"0 "+-e*13+"px",opacity:""}).show();c[3].css({"background-position":"0 "+-e*11+"px",opacity:""}).show();c[4].css({"background-position":"0 "+-e*12+"px",opacity:""}).show();break;case"a":c[1].hide();c[2].hide();c[3].hide();c[4].hide();break}n.repaint()};this.repaint=function(){var e=0;switch(o.mode){case"h":e=(1-o.color.getHSV().h)*r;break;case"s":var t=o.color.getHSV();e=(1-t.s)*r;c[2].css("opacity",1-t.v);a.css("background-color",o.color.copy().setHSV(null,1,null).toCSS());break;case"v":e=(1-o.color.getHSV().v)*r;a.css("background-color",o.color.copy().setHSV(null,null,1).toCSS());break;case"r":var i=o.color.getRGB();e=(1-i.r)*r;c[2].css("opacity",Math.max(0,i.b-i.g));c[3].css("opacity",Math.max(0,i.g-i.b));c[4].css("opacity",Math.min(i.b,i.g));break;case"g":var i=o.color.getRGB();e=(1-i.g)*r;c[2].css("opacity",Math.max(0,i.b-i.r));c[3].css("opacity",Math.max(0,i.r-i.b));c[4].css("opacity",Math.min(i.r,i.b));break;case"b":var i=o.color.getRGB();e=(1-i.b)*r;c[2].css("opacity",Math.max(0,i.r-i.g));c[3].css("opacity",Math.max(0,i.g-i.r));c[4].css("opacity",Math.min(i.r,i.g));break;case"a":e=(1-o.color.getAlpha())*r;a.css("background-color",o.color.copy().toCSS());break}if(o.mode!=="a")c.a.css("opacity",1-o.color.getAlpha());s.css("top",e-3)}},preview:function(e){var t=this,i=null,n,o,a,s,l,r;r=function(){return'<div class="ui-colorpicker-preview ui-colorpicker-border">'+'<div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div>'+'<div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div>'+"</div>"};this.init=function(){i=v(r()).appendTo(v(".ui-colorpicker-preview-container",e.dialog));v(".ui-colorpicker-preview-initial",i).click(function(){e.color=e.currentColor.copy();e._change()});o=v(".ui-colorpicker-preview-initial",i);a=v(".ui-colorpicker-preview-initial-alpha",i);s=v(".ui-colorpicker-preview-current",i);l=v(".ui-colorpicker-preview-current-alpha",i);n=v(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",i)};this.update=function(){n[e.options.alpha?"show":"hide"]();this.repaint()};this.repaint=function(){o.css("background-color",e.currentColor.set?e.currentColor.toCSS():"").attr("title",e.currentColor.set?e.currentColor.toCSS():"");a.css("opacity",1-e.currentColor.getAlpha());s.css("background-color",e.color.set?e.color.toCSS():"").attr("title",e.color.set?e.color.toCSS():"");l.css("opacity",1-e.color.getAlpha())}},hsv:function(t){var e=this,i=null,n={},o;o=function(){var e="";if(t.options.hsv)e+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+t._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div>'+'<div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+t._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+t._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>';return'<div class="ui-colorpicker-hsv">'+e+"</div>"};this.init=function(){i=v(o()).appendTo(v(".ui-colorpicker-hsv-container",t.dialog));v(".ui-colorpicker-mode",i).click(function(){t.mode=v(this).val();t._updateAllParts()});n.h=v(".ui-colorpicker-hsv-h .ui-colorpicker-number",i);n.s=v(".ui-colorpicker-hsv-s .ui-colorpicker-number",i);n.v=v(".ui-colorpicker-hsv-v .ui-colorpicker-number",i);v(".ui-colorpicker-number",i).bind("change keyup",function(){t.color.setHSV(n.h.val()/360,n.s.val()/100,n.v.val()/100);t._change()})};this.repaint=function(){var e=t.color.getHSV();n.h.val(Math.round(e.h*360));n.s.val(Math.round(e.s*100));n.v.val(Math.round(e.v*100))};this.update=function(){v(".ui-colorpicker-mode",i).each(function(){var e=v(this);e.attr("checked",e.val()===t.mode)});this.repaint()}},rgb:function(t){var e=this,i=null,n={},o;o=function(){var e="";if(t.options.rgb)e+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+t._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'+'<div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+t._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'+'<div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+t._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>';return'<div class="ui-colorpicker-rgb">'+e+"</div>"};this.init=function(){i=v(o()).appendTo(v(".ui-colorpicker-rgb-container",t.dialog));v(".ui-colorpicker-mode",i).click(function(){t.mode=v(this).val();t._updateAllParts()});n.r=v(".ui-colorpicker-rgb-r .ui-colorpicker-number",i);n.g=v(".ui-colorpicker-rgb-g .ui-colorpicker-number",i);n.b=v(".ui-colorpicker-rgb-b .ui-colorpicker-number",i);v(".ui-colorpicker-number",i).bind("change keyup",function(){var e=v(".ui-colorpicker-rgb-r .ui-colorpicker-number",i).val();t.color.setRGB(n.r.val()/255,n.g.val()/255,n.b.val()/255);t._change()})};this.repaint=function(){var e=t.color.getRGB();n.r.val(Math.round(e.r*255));n.g.val(Math.round(e.g*255));n.b.val(Math.round(e.b*255))};this.update=function(){v(".ui-colorpicker-mode",i).each(function(){var e=v(this);e.attr("checked",e.val()===t.mode)});this.repaint()}},lab:function(t){var e=this,i=null,n={},o=function(){var e="";if(t.options.hsv)e+='<div class="ui-colorpicker-lab-l"><label>'+t._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div>'+'<div class="ui-colorpicker-lab-a"><label>'+t._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'+'<div class="ui-colorpicker-lab-b"><label>'+t._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>';return'<div class="ui-colorpicker-lab">'+e+"</div>"};this.init=function(){var e=0;i=v(o()).appendTo(v(".ui-colorpicker-lab-container",t.dialog));n.l=v(".ui-colorpicker-lab-l .ui-colorpicker-number",i);n.a=v(".ui-colorpicker-lab-a .ui-colorpicker-number",i);n.b=v(".ui-colorpicker-lab-b .ui-colorpicker-number",i);v(".ui-colorpicker-number",i).bind("change keyup",function(e){t.color.setLAB(parseInt(n.l.val(),10)/100,(parseInt(n.a.val(),10)+128)/255,(parseInt(n.b.val(),10)+128)/255);t._change()})};this.repaint=function(){var e=t.color.getLAB();n.l.val(Math.round(e.l*100));n.a.val(Math.round(e.a*255)-128);n.b.val(Math.round(e.b*255)-128)};this.update=this.repaint},cmyk:function(t){var e=this,i=null,n={},o=function(){var e="";if(t.options.hsv)e+='<div class="ui-colorpicker-cmyk-c"><label>'+t._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-m"><label>'+t._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-y"><label>'+t._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'+'<div class="ui-colorpicker-cmyk-k"><label>'+t._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>';return'<div class="ui-colorpicker-cmyk">'+e+"</div>"};this.init=function(){i=v(o()).appendTo(v(".ui-colorpicker-cmyk-container",t.dialog));n.c=v(".ui-colorpicker-cmyk-c .ui-colorpicker-number",i);n.m=v(".ui-colorpicker-cmyk-m .ui-colorpicker-number",i);n.y=v(".ui-colorpicker-cmyk-y .ui-colorpicker-number",i);n.k=v(".ui-colorpicker-cmyk-k .ui-colorpicker-number",i);v(".ui-colorpicker-number",i).bind("change keyup",function(e){t.color.setCMYK(parseInt(n.c.val(),10)/100,parseInt(n.m.val(),10)/100,parseInt(n.y.val(),10)/100,parseInt(n.k.val(),10)/100);t._change()})};this.repaint=function(){var e=t.color.getCMYK();n.c.val(Math.round(e.c*100));n.m.val(Math.round(e.m*100));n.y.val(Math.round(e.y*100));n.k.val(Math.round(e.k*100))};this.update=this.repaint},alpha:function(t){var e=this,i=null,n,o=function(){var e="";if(t.options.alpha)e+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+t._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>';return'<div class="ui-colorpicker-alpha">'+e+"</div>"};this.init=function(){i=v(o()).appendTo(v(".ui-colorpicker-alpha-container",t.dialog));v(".ui-colorpicker-mode",i).click(function(){t.mode=v(this).val();t._updateAllParts()});n=v(".ui-colorpicker-a .ui-colorpicker-number",i);v(".ui-colorpicker-number",i).bind("change keyup",function(){t.color.setAlpha(n.val()/100);t._change()})};this.update=function(){v(".ui-colorpicker-mode",i).each(function(){v(this).attr("checked",v(this).val()===t.mode)});this.repaint()};this.repaint=function(){n.val(Math.round(t.color.getAlpha()*100))}},hex:function(t){var e=this,i=null,n={},o;o=function(){var e="";if(t.options.alpha)e+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>';e+='<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>';return'<div class="ui-colorpicker-hex"><label>#</label>'+e+"</div>"};this.init=function(){i=v(o()).appendTo(v(".ui-colorpicker-hex-container",t.dialog));n.color=v(".ui-colorpicker-hex-input",i);n.alpha=v(".ui-colorpicker-hex-alpha",i);n.color.bind("change keydown keyup",function(e,t,i){if(/[^a-fA-F0-9]/.test(n.color.val()))n.color.val(n.color.val().replace(/[^a-fA-F0-9]/,""))});n.color.bind("change keyup",function(){t.color=a(n.color.val()).setAlpha(t.color.getAlpha());t._change()});n.alpha.bind("change keydown keyup",function(){if(/[^a-fA-F0-9]/.test(n.alpha))n.alpha.val(n.alpha.val().replace(/[^a-fA-F0-9]/,""))});n.alpha.bind("change keyup",function(){t.color.setAlpha(parseInt(n.alpha.val(),16)/255);t._change()})};this.repaint=function(){if(!n.color.is(":focus"))n.color.val(t.color.toHex(true));if(!n.alpha.is(":focus"))n.alpha.val(l(t.color.getAlpha()*255))};this.update=this.repaint},swatches:function(t){var e=this,i=function(){var o="";t._eachSwatch(function(e,t){var i=new v.colorpicker.Color(t.r,t.g,t.b),n=i.toCSS();o+='<div class="ui-colorpicker-swatch" style="background-color:'+n+'" title="'+e+'"></div>'});return'<div class="ui-colorpicker-swatches ui-colorpicker-border" style="width:'+t.options.swatchesWidth+'px">'+o+"</div>"};this.init=function(){var e=v(i());v(".ui-colorpicker-swatches-container",t.dialog).html(e);v(".ui-colorpicker-swatch",e).click(function(){t.color=t._parseColor(v(this).css("background-color"))||new v.colorpicker.Color;t._change()})}},footer:function(t){var e=this,i=null,n="ui-colorpicker-special-transparent-"+s,o="ui-colorpicker-special-none-"+s,a=function(){var e="";if(t.options.alpha||!t.inline&&t.options.showNoneButton){e+='<div class="ui-colorpicker-buttonset">';if(t.options.alpha)e+='<input type="radio" name="ui-colorpicker-special" id="'+n+'" class="ui-colorpicker-special-transparent"/><label for="'+n+'">'+t._getRegional("transparent")+"</label>";if(!t.inline&&t.options.showNoneButton)e+='<input type="radio" name="ui-colorpicker-special" id="'+o+'" class="ui-colorpicker-special-none"><label for="'+o+'">'+t._getRegional("none")+"</label>";e+="</div>"}if(!t.inline){e+='<div class="ui-dialog-buttonset">';if(t.options.showCancelButton)e+='<button class="ui-colorpicker-cancel">'+t._getRegional("cancel")+"</button>";e+='<button class="ui-colorpicker-ok">'+t._getRegional("ok")+"</button>";e+="</div>"}return'<div class="ui-dialog-buttonpane ui-widget-content">'+e+"</div>"};this.init=function(){i=v(a()).appendTo(t.dialog);v(".ui-colorpicker-ok",i).button().click(function(){t.close()});v(".ui-colorpicker-cancel",i).button().click(function(){t.close(true)});v(".ui-colorpicker-buttonset",i).buttonset();v(".ui-colorpicker-special-color",i).click(function(){t._change()});v("#"+o,i).click(function(){t.color.set=false;t._change()});v("#"+n,i).click(function(){t.color.setAlpha(0);t._change()})};this.repaint=function(){if(!t.color.set)v(".ui-colorpicker-special-none",i).attr("checked",true).button("refresh");else if(t.color.getAlpha()===0)v(".ui-colorpicker-special-transparent",i).attr("checked",true).button("refresh");else v("input",i).attr("checked",false).button("refresh");v(".ui-colorpicker-cancel",i).button(t.changed?"enable":"disable")};this.update=function(){}}};this.Color=function(){var o={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},t=1,a=[.9504285,1,1.0889],e=arguments,s=function(e){if(isNaN(e)||e===null)return 0;if(typeof e=="string")e=parseInt(e,10);return Math.max(0,Math.min(e,1))},i=function(e){var e=Math.round(e),t="0123456789abcdef",i=e%16,n=(e-i)/16,o=t.charAt(n)+t.charAt(i);return o},n=function(e){var t=e.r>.04045?Math.pow((e.r+.055)/1.055,2.4):e.r/12.92,i=e.g>.04045?Math.pow((e.g+.055)/1.055,2.4):e.g/12.92,n=e.b>.04045?Math.pow((e.b+.055)/1.055,2.4):e.b/12.92;return{x:t*.4124+i*.3576+n*.1805,y:t*.2126+i*.7152+n*.0722,z:t*.0193+i*.1192+n*.9505}},l=function(e){var t={r:e.x*3.2406+e.y*-1.5372+e.z*-.4986,g:e.x*-.9689+e.y*1.8758+e.z*.0415,b:e.x*.0557+e.y*-.204+e.z*1.057};t.r=t.r>.0031308?1.055*Math.pow(t.r,1/2.4)-.055:12.92*t.r;t.g=t.g>.0031308?1.055*Math.pow(t.g,1/2.4)-.055:12.92*t.g;t.b=t.b>.0031308?1.055*Math.pow(t.b,1/2.4)-.055:12.92*t.b;return t},r=function(e){var t=Math.min(e.r,e.g,e.b),i=Math.max(e.r,e.g,e.b),n=i-t,o,a,s,l={h:0,s:0,v:i};if(n===0){l.h=0;l.s=0}else{l.s=n/i;o=((i-e.r)/6+n/2)/n;a=((i-e.g)/6+n/2)/n;s=((i-e.b)/6+n/2)/n;if(e.r===i)l.h=s-a;else if(e.g===i)l.h=1/3+o-s;else if(e.b===i)l.h=2/3+a-o;if(l.h<0)l.h+=1;else if(l.h>1)l.h-=1}return l},c=function(e){var t={r:0,g:0,b:0},i,n,o,a,s;if(e.s===0)t.r=t.g=t.b=e.v;else{i=e.h===1?0:e.h*6;n=Math.floor(i);o=e.v*(1-e.s);a=e.v*(1-e.s*(i-n));s=e.v*(1-e.s*(1-(i-n)));if(n===0){t.r=e.v;t.g=s;t.b=o}else if(n===1){t.r=a;t.g=e.v;t.b=o}else if(n===2){t.r=o;t.g=e.v;t.b=s}else if(n===3){t.r=o;t.g=a;t.b=e.v}else if(n===4){t.r=s;t.g=o;t.b=e.v}else{t.r=e.v;t.g=o;t.b=a}}return t},d=function(e){var t=Math.min(e.r,e.g,e.b),i=Math.max(e.r,e.g,e.b),n=i-t,o,a,s,l={h:0,s:0,l:(i+t)/2};if(n===0){l.h=0;l.s=0}else{l.s=l.l<.5?n/(i+t):n/(2-i-t);o=((i-e.r)/6+n/2)/n;a=((i-e.g)/6+n/2)/n;s=((i-e.b)/6+n/2)/n;if(e.r===i)l.h=s-a;else if(e.g===i)l.h=1/3+o-s;else if(e.b===i)l.h=2/3+a-o;if(l.h<0)l.h+=1;else if(l.h>1)l.h-=1}return l},u=function(e){var t,i,n=function(e,t,i){if(i<0)i+=1;if(i>1)i-=1;if(6*i<1)return e+(t-e)*6*i;if(2*i<1)return t;if(3*i<2)return e+(t-e)*(2/3-i)*6;return e};if(e.s===0)return{r:e.l,g:e.l,b:e.l};i=e.l<.5?e.l*(1+e.s):e.l+e.s-e.s*e.l;t=2*e.l-i;return{r:n(t,i,e.h+1/3),g:n(t,i,e.h),b:n(t,i,e.h-1/3)}},p=function(e){var t=e.x/a[0],i=e.y/a[1],n=e.z/a[2];t=t>.008856?Math.pow(t,1/3):7.787*t+16/116;i=i>.008856?Math.pow(i,1/3):7.787*i+16/116;n=n>.008856?Math.pow(n,1/3):7.787*n+16/116;return{l:(116*i-16)/100,a:(500*(t-i)+128)/255,b:(200*(i-n)+128)/255}},h=function(e){var t={l:e.l*100,a:e.a*255-128,b:e.b*255-128},i={x:0,y:(t.l+16)/116,z:0};i.x=t.a/500+i.y;i.z=i.y-t.b/200;i.x=Math.pow(i.x,3)>.008856?Math.pow(i.x,3):(i.x-16/116)/7.787;i.y=Math.pow(i.y,3)>.008856?Math.pow(i.y,3):(i.y-16/116)/7.787;i.z=Math.pow(i.z,3)>.008856?Math.pow(i.z,3):(i.z-16/116)/7.787;i.x*=a[0];i.y*=a[1];i.z*=a[2];return i},m=function(e){return{c:1-e.r,m:1-e.g,y:1-e.b}},g=function(e){return{r:1-e.c,g:1-e.m,b:1-e.y}},f=function(e){var t=1;if(e.c<t)t=e.c;if(e.m<t)t=e.m;if(e.y<t)t=e.y;if(t===1)return{c:0,m:0,y:0,k:1};return{c:(e.c-t)/(1-t),m:(e.m-t)/(1-t),y:(e.y-t)/(1-t),k:t}},b=function(e){return{c:e.c*(1-e.k)+e.k,m:e.m*(1-e.k)+e.k,y:e.y*(1-e.k)+e.k}};this.set=false;this.setAlpha=function(e){if(e!==null)t=s(e);this.set=true;return this};this.getAlpha=function(){return t};this.setRGB=function(e,t,i){o={rgb:this.getRGB()};if(e!==null)o.rgb.r=s(e);if(t!==null)o.rgb.g=s(t);if(i!==null)o.rgb.b=s(i);this.set=true;return this};this.setHSV=function(e,t,i){o={hsv:this.getHSV()};if(e!==null)o.hsv.h=s(e);if(t!==null)o.hsv.s=s(t);if(i!==null)o.hsv.v=s(i);this.set=true;return this};this.setHSL=function(e,t,i){o={hsl:this.getHSL()};if(e!==null)o.hsl.h=s(e);if(t!==null)o.hsl.s=s(t);if(i!==null)o.hsl.l=s(i);this.set=true;return this};this.setLAB=function(e,t,i){o={lab:this.getLAB()};if(e!==null)o.lab.l=s(e);if(t!==null)o.lab.a=s(t);if(i!==null)o.lab.b=s(i);this.set=true;return this};this.setCMYK=function(e,t,i,n){o={cmyk:this.getCMYK()};if(e!==null)o.cmyk.c=s(e);if(t!==null)o.cmyk.m=s(t);if(i!==null)o.cmyk.y=s(i);if(n!==null)o.cmyk.k=s(n);this.set=true;return this};this.getRGB=function(){if(!o.rgb){o.rgb=o.lab?l(h(o.lab)):o.hsv?c(o.hsv):o.hsl?u(o.hsl):o.cmyk?g(b(o.cmyk)):{r:0,g:0,b:0};o.rgb.r=s(o.rgb.r);o.rgb.g=s(o.rgb.g);o.rgb.b=s(o.rgb.b)}return v.extend({},o.rgb)};this.getHSV=function(){if(!o.hsv){o.hsv=o.lab?r(this.getRGB()):o.rgb?r(o.rgb):o.hsl?r(this.getRGB()):o.cmyk?r(this.getRGB()):{h:0,s:0,v:0};o.hsv.h=s(o.hsv.h);o.hsv.s=s(o.hsv.s);o.hsv.v=s(o.hsv.v)}return v.extend({},o.hsv)};this.getHSL=function(){if(!o.hsl){o.hsl=o.rgb?d(o.rgb):o.hsv?d(this.getRGB()):o.cmyk?d(this.getRGB()):o.hsv?d(this.getRGB()):{h:0,s:0,l:0};o.hsl.h=s(o.hsl.h);o.hsl.s=s(o.hsl.s);o.hsl.l=s(o.hsl.l)}return v.extend({},o.hsl)};this.getCMYK=function(){if(!o.cmyk){o.cmyk=o.rgb?f(m(o.rgb)):o.hsv?f(m(this.getRGB())):o.hsl?f(m(this.getRGB())):o.lab?f(m(this.getRGB())):{c:0,m:0,y:0,k:1};o.cmyk.c=s(o.cmyk.c);o.cmyk.m=s(o.cmyk.m);o.cmyk.y=s(o.cmyk.y);o.cmyk.k=s(o.cmyk.k)}return v.extend({},o.cmyk)};this.getLAB=function(){if(!o.lab){o.lab=o.rgb?p(n(o.rgb)):o.hsv?p(n(this.getRGB())):o.hsl?p(n(this.getRGB())):o.cmyk?p(n(this.getRGB())):{l:0,a:0,b:0};o.lab.l=s(o.lab.l);o.lab.a=s(o.lab.a);o.lab.b=s(o.lab.b)}return v.extend({},o.lab)};this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b}};this.getSpaces=function(){return v.extend(true,{},o)};this.distance=function(e){var t="lab",i="get"+t.toUpperCase(),n=this[i](),o=e[i](),a=0,s;for(s in n)a+=Math.pow(n[s]-o[s],2);return a};this.equals=function(e){if(e){var t=this.getRGB(),i=e.getRGB();return this.set===e.set&&this.getAlpha()===e.getAlpha()&&t.r===i.r&&t.g===i.g&&t.b===i.b}return false};this.limit=function(e){e-=1;var t=this.getRGB();this.setRGB(Math.round(t.r*e)/e,Math.round(t.g*e)/e,Math.round(t.b*e)/e)};this.toHex=function(){var e=this.getRGB();return i(e.r*255)+i(e.g*255)+i(e.b*255)};this.toCSS=function(){return"#"+this.toHex()};this.copy=function(){var e=new v.colorpicker.Color(this.getSpaces(),this.getAlpha());e.set=this.set;return e};if(e.length===2){o=e[0];this.setAlpha(e[1]===0?0:e[1]||1);this.set=true}if(e.length>2){this.setRGB(e[0],e[1],e[2]);this.setAlpha(e[3]===0?0:e[3]||1);this.set=true}}},v.widget("vanderlee.colorpicker",{options:{alpha:false,altAlpha:true,altField:"",altOnChange:true,altProperties:"background-color",autoOpen:false,buttonClass:null,buttonColorize:false,buttonImage:"images/ui-colorpicker.png",buttonImageOnly:false,buttonText:null,closeOnEscape:true,closeOnOutside:true,color:"#00FF00",colorFormat:"HEX",draggable:true,containment:null,duration:"fast",hideOn:"button",hsv:true,inline:true,inlineFrame:true,layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:false,mode:"h",okOnEnter:false,parts:"",part:{map:{size:256},bar:{size:256}},position:null,regional:"",revert:false,rgb:true,showAnim:"fadeIn",showCancelButton:true,showNoneButton:false,showCloseButton:true,showOn:"focus click alt",showOptions:{},swatches:null,swatchesWidth:84,title:null,cancel:null,close:null,init:null,ok:null,open:null,select:null,stop:null},_create:function(){var t=this,e;++s;t.widgetEventPrefix="colorpicker";t.opened=false;t.generated=false;t.inline=false;t.changed=false;t.dialog=null;t.button=null;t.image=null;t.overlay=null;t.events={window_resize:null,document_keydown:null,document_click_html:null};t.mode=t.options.mode;if(t.element.is("input")||t.options.inline===false){t._setColor(t.element.is("input")?t.element.val():t.options.color);t._callback("init");if(/\bfocus|all|both\b/.test(t.options.showOn))t.element.bind("focus",function(){t.open()});if(/\bfocus|all|both\b/.test(t.options.hideOn))t.element.bind("focusout",function(e){t.close()});if(/\bclick|all|both\b/.test(t.options.showOn))t.element.bind("click",function(e){if(t.opened&&/\bclick|all|both\b/.test(t.options.hideOn))t.close();else t.open()});if(/\bbutton|all|both\b/.test(t.options.showOn)){if(t.options.buttonImage!==""){e=t.options.buttonText||t._getRegional("button");t.image=v("<img/>").attr({src:t.options.buttonImage,alt:e,title:e});if(t.options.buttonClass)t.image.attr("class",t.options.buttonClass);t._setImageBackground()}if(t.options.buttonImageOnly&&t.image)t.button=t.image;else{t.button=v('<button type="button"></button>').html(t.image||t.options.buttonText).button();t.image=t.image?v("img",t.button).first():null}t.button.insertAfter(t.element).click(function(){if(t.opened&&/\bbutton|all|both\b/.test(t.options.hideOn))t.close();else t.open()})}if(/\balt|all|both\b/.test(t.options.showOn))v(t.options.altField).bind("click",function(){if(t.opened&&/\balt|all|both\b/.test(t.options.hideOn))t.close();else t.open()});if(t.options.autoOpen)t.open()}else{t.inline=true;t._generate();t.opened=true}return this},_setOption:function(e,t){switch(e){case"disabled":if(t)this.dialog.addClass("ui-colorpicker-disabled");else this.dialog.removeClass("ui-colorpicker-disabled");break;case"swatches":this.options.swatches=t;this.parts.swatches.init();break}v.Widget.prototype._setOption.apply(this,arguments)},_setImageBackground:function(){if(this.image&&this.options.buttonColorize)this.image.css("background-color",this.color.set?this._formatColor("RGBA",this.color):"")},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var e,t,i=this.options.altProperties.split(",");for(e=0;e<=i.length;++e){t=v.trim(i[e]);switch(t){case"color":case"fill":case"stroke":case"background-color":case"backgroundColor":case"outline-color":case"border-color":v(this.options.altField).css(t,this.color.set?this.color.toCSS():"");break}}if(this.options.altAlpha)v(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}},_setColor:function(e){this.color=this._parseColor(e)||new v.colorpicker.Color;this.currentColor=this.color.copy();this._setImageBackground();this._setAltField()},setColor:function(e){this._setColor(e);this._change()},getColor:function(e){return this._formatColor(e||this.options.colorFormat,this.color)},_generateInline:function(){var e=this;v(e.element).html(e.options.inlineFrame?t:i);e.dialog=v(".ui-colorpicker",e.element)},_generatePopup:function(){var n=this;n.dialog=v(e).appendTo("body");if(n.events.document_click_html===null)v(document).delegate("html","touchstart click",n.events.document_click_html=function(e){if(!n.opened||e.target===n.element[0]||n.overlay)return;if(n.dialog.is(e.target)||n.dialog.has(e.target).length>0){n.element.blur();return}var t,i=v(e.target).parents();i.push(e.target);for(t=0;t<=i.length;++t){if(n.button!==null&&i[t]===n.button[0])return;if(/\balt|all|both\b/.test(n.options.showOn)&&v(n.options.altField).is(i[t]))return}if(!n.options.closeOnOutside)return;n.close(n.options.revert)});if(n.events.document_keydown===null)v(document).bind("keydown",n.events.document_keydown=function(e){if(n.opened&&e.keyCode===27&&n.options.closeOnEscape)n.close(n.options.revert);if(n.opened&&e.keyCode===13&&n.options.okOnEnter)n.close()});n.element.keydown(function(e){if(e.keyCode===9)n.close()}).keyup(function(e){var t=n._parseColor(n.element.val());if(t&&!n.color.equals(t)){n.color=t;n._change()}})},_generate:function(){var i=this,e,t,n,o,a,s;i._setColor(i.inline||!i.element.is("input")?i.options.color:i.element.val());i[i.inline?"_generateInline":"_generatePopup"]();if(typeof i.options.parts==="string")if(v.colorpicker.partslists[i.options.parts])n=v.colorpicker.partslists[i.options.parts];else n=v.colorpicker.partslists[i.inline?"inline":"popup"];else n=i.options.parts;i.parts={};v.each(n,function(e,t){if(v.colorpicker.parts[t])i.parts[t]=new v.colorpicker.parts[t](i)});if(!i.generated){o=[];v.each(i.options.layout,function(e,t){if(i.parts[e])o.push({part:e,pos:t})});a=v(r(o,function(e,t,i){s=["ui-colorpicker-"+e.part+"-container"];if(t>0)s.push("ui-colorpicker-padding-left");if(i>0)s.push("ui-colorpicker-padding-top");return'<td  class="'+s.join(" ")+'"'+(e.pos[2]>1?' colspan="'+e.pos[2]+'"':"")+(e.pos[3]>1?' rowspan="'+e.pos[3]+'"':"")+' valign="top"></td>'})).appendTo(i.dialog);if(i.options.inlineFrame)a.addClass("ui-dialog-content ui-widget-content");i._initAllParts();i._updateAllParts();i.generated=true}},_effectGeneric:function(e,t,i,n,o){var a=this;if(v.effects&&v.effects[a.options.showAnim])e[t](a.options.showAnim,a.options.showOptions,a.options.duration,o);else{e[a.options.showAnim==="slideDown"?i:a.options.showAnim==="fadeIn"?n:t](a.options.showAnim?a.options.duration:null,o);if(!a.options.showAnim||!a.options.duration)o()}},_effectShow:function(e,t){this._effectGeneric(e,"show","slideDown","fadeIn",t)},_effectHide:function(e,t){this._effectGeneric(e,"hide","slideUp","fadeOut",t)},open:function(){var e=this,t,i,n,o,a,s,l,r,c,d;if(!e.opened){e._generate();if(e.element.is(":hidden"))c=v("<div/>").insertBefore(e.element);else c=e.element;if(e.element.is(":hidden"))c.remove();r=0;v(e.element[0]).parents().each(function(){var e=v(this).css("z-index");if((typeof e==="number"||typeof e==="string")&&e!==""&&!isNaN(e)){if(e>r){r=parseInt(e,10);return false}}else v(this).siblings().each(function(){var e=v(this).css("z-index");if((typeof e==="number"||typeof e==="string")&&e!==""&&!isNaN(e))if(e>r)r=parseInt(e,10)})});r+=2;e.dialog.css("z-index",r);if(e.options.modal){e.overlay=v('<div class="ui-widget-overlay"></div>').appendTo("body").css("z-index",r-1);if(e.events.window_resize!==null)v(window).unbind("resize",e.events.window_resize);e.events.window_resize=function(){if(e.overlay){e.overlay.width(v(document).width());e.overlay.height(v(document).height())}},v(window).bind("resize",e.events.window_resize);e.events.window_resize()}e._effectShow(this.dialog);if(e.options.position){d=v.extend({},e.options.position);if(d.of==="element")d.of=c}else d={my:"left top",at:"left bottom",of:c,collision:"flip"};e.dialog.position(d);e.opened=true;e._callback("open",true);v(function(){e._repaintAllParts()})}},close:function(e){var t=this;if(!t.opened)return;if(e){t.color=t.currentColor.copy();t._change();t._callback("cancel",true)}else{t.currentColor=t.color.copy();t._callback("ok",true)}t.changed=false;if(t.overlay){v(window).unbind("resize",t.events.window_resize);t.overlay.remove()}t._effectHide(t.dialog,function(){t.dialog.remove();t.dialog=null;t.generated=false;t.opened=false;t._callback("close",true)})},destroy:function(){if(that.events.document_click_html!==null)v(document).undelegate("html","touchstart click",that.events.document_click_html);if(that.events.document_keydown!==null)v(document).unbind("keydown",that.events.document_keydown);if(that.events.resizeOverlay!==null)v(window).unbind("resize",that.events.resizeOverlay);this.element.unbind();if(this.overlay)this.overlay.remove();if(this.dialog!==null)this.dialog.remove();if(this.image!==null)this.image.remove();if(this.button!==null)this.button.remove()},_callback:function(e,t){var i=this,n,o;if(i.color.set){n={formatted:i._formatColor(i.options.colorFormat,i.color),colorPicker:i};o=i.color.getLAB();o.a=o.a*2-1;o.b=o.b*2-1;if(t===true){n.a=i.color.getAlpha();n.rgb=i.color.getRGB();n.hsv=i.color.getHSV();n.cmyk=i.color.getCMYK();n.hsl=i.color.getHSL();n.lab=o}return i._trigger(e,null,n)}else return i._trigger(e,null,{formatted:"",colorPicker:i})},_initAllParts:function(){v.each(this.parts,function(e,t){if(t.init)t.init()})},_updateAllParts:function(){v.each(this.parts,function(e,t){if(t.update)t.update()})},_repaintAllParts:function(){v.each(this.parts,function(e,t){if(t.repaint)t.repaint()})},_change:function(e){this.changed=true;e=typeof e!=="undefined"?!!e:true;if(this.color.set&&this.options.limit&&v.colorpicker.limits[this.options.limit])v.colorpicker.limits[this.options.limit](this.color,this);if(!this.inline){if(!this.color.set){if(this.element.val()!=="")this.element.val("").change()}else if(!this.color.equals(this._parseColor(this.element.val())))this.element.val(this._formatColor(this.options.colorFormat,this.color)).change();this._setImageBackground();this._setAltField()}this.options.color=this.color.set?this.color.toCSS():"";if(this.opened)this._repaintAllParts();this._callback("select");if(e)this._callback("stop")},_hoverable:function(e){e.hover(function(){e.addClass("ui-state-hover")},function(){e.removeClass("ui-state-hover")})},_focusable:function(e){e.focus(function(){e.addClass("ui-state-focus")}).blur(function(){e.removeClass("ui-state-focus")})},_getRegional:function(e){return v.colorpicker.regional[this.options.regional][e]!==undefined?v.colorpicker.regional[this.options.regional][e]:v.colorpicker.regional[""][e]},_getSwatches:function(){if(typeof this.options.swatches==="string")return v.colorpicker.swatches[this.options.swatches];if(v.isPlainObject(this.options.swatches))return this.options.swatches;return v.colorpicker.swatches.html},_eachSwatch:function(i){var n=this._getSwatches(),o;v.each(n,function(e,t){o=v.isArray(n)?t.name:e;return i(o,t)})},_getSwatch:function(i){var n=false;this._eachSwatch(function(e,t){if(e.toLowerCase()==i.toLowerCase()){n=t;return false}});return n},_parseFormat:function(e,t){var i=this,n={x:function(){return"([0-9a-fA-F]{2})"},d:function(){return"([12]?[0-9]{1,2})"},f:function(){return"([0-9]*\\.?[0-9]*)"},p:function(){return"([0-9]*\\.?[0-9]*)"}},o={x:function(e){return parseInt(e,16)},d:function(e){return e/255},f:function(e){return e},p:function(e){return e*.01}},a={r:"setRGB",g:"setRGB",b:"setRGB",h:"setHSV",s:"setHSV",v:"setHSV",c:"setCMYK",m:"setCMYK",y:"setCMYK",k:"setCMYK",L:"setLAB",A:"setLAB",B:"setLAB"},s={setRGB:["r","g","b"],setHSV:["h","s","v"],setCMYK:["c","m","y","k"],setLAB:["L","A","B"]},l=[],r=[],c=null,d,u;u=e.replace(/[()\\^$.|?*+[\]]/g,function(e){return"\\"+e});u=u.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(e){if(e.match(/^\\/))return e.slice(1);var t=e.charAt(0),i=e.charAt(1);l.push(t);r.push(o[i]);if(a[t])c=a[t];return n[i]()});if(c){var p=t.match(new RegExp(u));if(p){var h=[],m;p.shift();v.each(s[c],function(e,t){m=v.inArray(t,l);h[e]=r[m](p[m])});d=new v.colorpicker.Color;d[c].apply(d,h)}}return d},_parseColor:function(i){var n=this,o;var e=v.isArray(n.options.colorFormat)?n.options.colorFormat:[n.options.colorFormat];v.each(e,function(e,t){if(v.colorpicker.parsers[t])o=v.colorpicker.parsers[t](i,n);else o=n._parseFormat(t,i);if(o)return false});if(!o)v.each(v.colorpicker.parsers,function(e,t){o=t(i,n);if(o)return false});if(o)return o;return false},_exactName:function(i){var n=false;this._eachSwatch(function(e,t){if(i.equals(new v.colorpicker.Color(t.r,t.g,t.b))){n=e;return false}});return n},_closestName:function(i){var e=i.getRGB(),n=null,o=false,a;this._eachSwatch(function(e,t){a=i.distance(new v.colorpicker.Color(t.r,t.g,t.b));if(a<n||n===null){o=e;if(a<=1e-20)return false;n=a}});return o},_formatColor:function(e,i){var n=this,o=null,a={x:function(e){return l(e*255)},d:function(e){return Math.round(e*255)},f:function(e){return e},p:function(e){return e*100}},s=i.getChannels();if(!v.isArray(e))e=[e];v.each(e,function(e,t){if(v.colorpicker.writers[t]){o=v.colorpicker.writers[t](i,n);return o===false}else{o=t.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(e){if(e.match(/^\\/))return e.slice(1);return a[e.charAt(1)](s[e.charAt(0)])});return false}});return o}}),v.vanderlee.colorpicker}(jQuery),Backbone.View.extend({$camera:null,$defaultThumb:null,$input:null,$thumbImage:null,$removeScreenButton:null,$makeDefaultScreenButton:null,$screenName:null,$screenThumbWrapper:null,appModel:null,className:"screen-item",keyIndex:0,screensCollection:null,tagName:"li",viewModel:null,initialize:function(e){this.appModel=e.appModel,this.viewModel=e.viewModel,this.screensCollection=e.screensCollection,this.render(),this.initializeEvents(),this.onThumbChanged(),this.onScreensCollectionChanged(),this.onIsDefaultChanged()},initializeEvents:function(){var t=this;this.listenTo(this.model,"change:thumb",this.onThumbChanged),this.listenTo(this.model,"change:name",this.onNameChanged),this.listenTo(this.model,"change:isDefault",this.onIsDefaultChanged),this.$camera.on("click",$.proxy(this.onCameraClick,this)),this.$el.click($.proxy(this.onItemSelected,this)),this.$el.on("keydown",$.proxy(this.onKeyDown,this)),this.$el.on("focusout",function(e){t.$el.find(".selected-icon").removeClass("selected-icon")}),this.$screenThumbWrapper.on("focus mouseenter",function(e){"focus"===e.type&&t.$screenThumbWrapper.addClass("selected-icon"),t.showScreenIcons()}).on("focusout mouseleave",function(e){"mouseleave"!==e.type&&t.el.contains(e.relatedTarget)||t.hideScreenIcons()}),this.$duplicateScreenButton.on("click",$.proxy(this.onDuplicateScreenButtonClicked,this)),this.$makeDefaultScreenButton.on("click",$.proxy(this.onMakeDefaultScreenButtonClicked,this)),this.$removeScreenButton.on("click",$.proxy(this.onRemoveScreenButtonClicked,this)),this.$screenName.on("click",$.proxy(this.showInput,this)),this.listenTo(this.screensCollection,"reset add remove",this.onScreensCollectionChanged)},hideInput:function(){this.$input&&(this.$input.off(),this.$input.remove(),this.$input=null)},showScreenIcons:function(){this.$duplicateScreenButton.show(),1<this.screensCollection.length&&this.$removeScreenButton.show(),this.$makeDefaultScreenButton.show()},hideScreenIcons:function(){this.$duplicateScreenButton.hide(),this.$removeScreenButton.hide(),this.model.get("isDefault")||this.$makeDefaultScreenButton.hide()},navigateToScreen:function(e){var t=this.viewModel.get("selectedDocumentId");this.appModel.get("router").navigate(t+"/"+e,{trigger:!0})},onCameraClick:function(){this.trigger("cameraClick",this)},onDuplicateScreenButtonClicked:function(e){var t,i=this.model.clone(),n=1,o=!0;for(e.preventDefault(),e.stopPropagation(),(e=(t=i.get("name")).match(/^(.+ copy)( \(\d+\))?$/))?t=e[1]:t+=" copy";o;)this.screensCollection.some(function(e){return e.get("name")===(1<n?t+" ("+n+")":t)})?n+=1:(o=!1,1<n&&(t+=" ("+n+")"));i.set({name:t,isDefault:!1}),this.screensCollection.commandAdd(i),this.navigateToScreen(i.id)},onIsDefaultChanged:function(){this.model.get("isDefault")?(this.$makeDefaultScreenButton.addClass("is-default"),this.$makeDefaultScreenButton.attr("title",t("Default Screen")),this.$makeDefaultScreenButton.attr("aria-label",t("Default Screen"))):(this.$makeDefaultScreenButton.removeClass("is-default"),this.$makeDefaultScreenButton.attr("title",t("Set as Default Screen")),this.$makeDefaultScreenButton.attr("aria-label",t("Set as Default Screen")))},onItemSelected:function(){this.navigateToScreen(this.model.id)},onKeyDown:function(e){var t;"ArrowUp"===e.key||"ArrowDown"===e.key?(e.preventDefault(),t=[this.$screenThumbWrapper,this.$duplicateScreenButton,this.$makeDefaultScreenButton,this.$screenName],"none"!==this.$camera.css("display")&&t.splice(1,0,this.$camera),1<this.screensCollection.length&&t.splice(4,0,this.$removeScreenButton),this.$el.find(".selected-icon").removeClass("selected-icon"),"ArrowUp"===e.key?this.keyIndex=(this.keyIndex-1+t.length)%t.length:"ArrowDown"===e.key&&(this.keyIndex=(this.keyIndex+1)%t.length),t[this.keyIndex].addClass("selected-icon"),t[this.keyIndex].focus()):(" "!==e.key||e.target.classList.contains("name-input"))&&"Enter"!==e.key||(e.stopPropagation(),e.preventDefault(),((t=this.$el.find(".selected-icon")[0])===this.$camera[0]?this.$camera:t===this.$duplicateScreenButton[0]?this.$duplicateScreenButton:t===this.$makeDefaultScreenButton[0]?this.$makeDefaultScreenButton:t===this.$removeScreenButton[0]?this.$removeScreenButton:t===this.$screenName[0]?this.$screenName:this.$el).click(),null==t)||t.classList.add("selected-icon")},onNameChanged:function(){this.$screenName.text(this.model.get("name"))},onMakeDefaultScreenButtonClicked:function(e){var t,i=[];this.model.get("isDefault")||(i.push({id:this.model.id,isDefault:!0}),(t=this.screensCollection.find(function(e){return e.get("isDefault")&&e.id!==this.model.id}.bind(this)))&&i.push({id:t.id,isDefault:!1}),this.screensCollection.commandSet(i))},onRemoveScreenButtonClicked:function(e){e.preventDefault(),e.stopPropagation(),1<this.screensCollection.length&&this.screensCollection.commandRemove(this.model)},onScreensCollectionChanged:function(){this.screensCollection.length<=1?this.$removeScreenButton.addClass("last-one"):this.$removeScreenButton.removeClass("last-one")},onThumbChanged:function(){(this.model.get("thumb")?(this.$thumbImage.attr("src",this.model.get("thumb")),this.$defaultThumb.hide(),this.$thumbImage):(this.$thumbImage.hide(),this.$defaultThumb)).show()},render:function(){this.$el.html(T.ScreenItem(this.model.toJSON())),this.$camera=this.$el.find(".camera"),this.$defaultThumb=this.$el.find(".default-thumb"),this.$duplicateScreenButton=this.$el.find(".duplicate-screen-btn"),this.$makeDefaultScreenButton=this.$el.find(".make-default-screen-btn"),this.$removeScreenButton=this.$el.find(".remove-screen-btn"),this.$screenName=this.$el.find(".screen-name"),this.$screenThumbWrapper=this.$el.find(".screen-thumb-wrapper"),this.$thumbImage=this.$el.find(".screen-thumb")},showInput:function(e){var t,i,n=this;e&&(e.preventDefault(),e.stopPropagation()),e=this.$screenName.position(),t=this.$screenName.width(),i=this.$screenName.height(),this.$input=$(document.createElement("input")),this.$input.addClass("name-input"),this.$input.css({left:e.left+parseInt(this.$screenName.css("padding-left"),10),top:e.top+parseInt(this.$screenName.css("padding-top"),10),width:t,height:i}),this.$input.attr("tabindex","0"),this.$input.val(this.model.get("name")),this.$input.appendTo(this.$screenName.parent()),this.$input.focus(),this.$input.select(),this.$input.on("keydown",function(e){13===e.keyCode?(n.model.commandSet({name:n.$input.val()}),n.hideInput(),e.preventDefault(),e.stopPropagation()):27!==e.keyCode&&9!==e.keyCode||(n.hideInput(),e.preventDefault(),e.stopPropagation())}),this.$input.on("focusout",function(e){n.hideInput()})},remove:function(){this.$el.find("fa-camera").off(),this.$el.off(),this.$duplicateScreenButton.off(),this.$makeDefaultScreenButton.off(),this.$removeScreenButton.off(),this.$screenName.off(),Backbone.View.prototype.remove.call(this)}})),ScreenList=Backbone.View.extend({$addScreenButton:null,$list:null,$listScrollWrap:null,$screenList:null,$screenListHeader:null,addScreenButton:null,appModel:null,viewModel:null,selectedScreen:null,screens:null,addScreenItem:function(e,t){e=new ScreenItem({model:e,screensCollection:this.model.get("screens"),appModel:this.appModel,viewModel:this.viewModel});return!_.isUndefined(t)&&t<this.screens.length?0===t?e.$el.prependTo(this.$list):e.$el.insertBefore(this.$list.find("li").eq(t)):e.$el.appendTo(this.$list),this.listenTo(e,"cameraClick",this.onScreenCameraClick),this.screens.push(e),e},initialize:function(e){this.appModel=e.appModel,this.viewModel=e.viewModel,this.screens=[],this.render(),this.initializeEvents()},initializeEvents:function(){this.listenTo(this.model.get("screens"),"add",this.onScreenAdded),this.listenTo(this.model.get("screens"),"remove",this.onScreenRemoved),this.listenTo(this.viewModel,"change:selectedScreenId",$.proxy(this.onScreenSelected,this))},onAddScreenButtonClick:function(e){for(var t,i=this.model,n=this.model.get("screens"),o=0,a=!1;!a;)t="Screen "+(o+=1),n.some(function(e){return e.get("name")===t})||(a=!0);i=new QuickBase.Screen({name:t,colCount:i.get("colCount"),floatable:i.get("floatable"),relativeHeight:i.get("relativeHeight"),rowCount:i.get("rowCount"),rowHeight:i.get("rowHeight")},{},n),n.commandAdd(i),e.preventDefault()},onResize:function(){},onScreenAdded:function(e,t,i){this.addScreenItem(e,i.at),Log.Info("screen added",e)},onScreenCameraClick:function(e){this.viewModel.trigger("screenshot")},onScreenRemoved:function(e){this.removeScreenItem(e),Log.Info("screen removed",e),this.viewModel.get("selectedScreenId")===e.id&&(e=this.model.get("screens").first(),this.viewModel.set("selectedScreenId",e.id))},onScreenSelected:function(){var e,t=this.viewModel.get("selectedScreenId");this.selectedScreen&&this.selectedScreen.$el.removeClass("selected"),(e=_.find(this.screens,function(e){return e.model.id===t}))&&(this.selectedScreen=e,this.selectedScreen.$el.addClass("selected"))},removeScreenItem:function(t){var e=_.find(this.screens,function(e){return e.model===t});e?(this.screens=_.without(this.screens,e),e.remove()):Log.Info("screen not found")},render:function(){var t=this,i=this;return this.$el.html(T.ScreenList()),this.$list=this.$el.find("ul"),this.$listScrollWrap=this.$el.find(".list-scroll-wrap"),this.$screenList=this.$el.find(".screen-list"),this.$screenListHeader=this.$el.find(".screen-list-header"),this.$addScreenButton=this.$el.find(".add-screen-button"),this.$addScreenButton.button({icon:"fa fa-plus"}).click($.proxy(this.onAddScreenButtonClick,this)).keyup(function(e){" "!==e.key&&"Enter"!==e.key||t.$addScreenButton.click()}),this.viewModel.get("selectedScreenId"),this.model.get("screens").each(function(e){i.addScreenItem(e)}),0<this.model.get("screens").length&&this.onScreenSelected(),this},remove:function(){}}),DashboardPermission=Backbone.View.extend({className:"permision-row",tagName:"tr",initialize:function(e){var t=this;t.$el.html(T.DashboardPermission(e.details)),e.details.read?t.$el.find(".permissionRead input").prop("checked","checked"):t.$el.find(".permissionRead input").removeProp("checked"),e.details.write?t.$el.find(".permissionWrite input").prop("checked","checked"):t.$el.find(".permissionWrite input").removeProp("checked"),t.$el.find(".permissionWrite input").on("change",function(){!0===t.$el.find(".permissionWrite input").prop("checked")&&t.$el.find(".permissionRead input").prop("checked",!0),t.trigger("ApplyChanges")}),t.$el.find(".permissionRead input").on("change",function(){!1===t.$el.find(".permissionRead input").prop("checked")&&t.$el.find(".permissionWrite input").removeProp("checked",!0),t.trigger("ApplyChanges")}),t.$el.css({height:"25px;"})}}),DashboardPermissions=Backbone.View.extend({$permissionsList:null,$permissionsTable:null,initialize:function(e){var i=this;i.$el.html(T.DashboardPermissions()),i.$permissionsList=i.$el.find(".permissions-list"),i.$permissionsTable=i.$el.find("table tbody"),i.model.get("permissionEntity")&&i.model.get("permissionEntity").permissions&&_.each(i.model.get("permissionEntity").permissions,function(e,t){t={name:t,read:e[0],write:e[1]},e=new DashboardPermission({details:t});e.on("ApplyChanges",$.proxy(i.applyChanges,i)),i.$permissionsTable.append(e.$el)})},applyChanges:function(){var n={};_.each(this.$el.find("tr"),function(e){var t=$(e).find("td.permissionName").text(),i=$(e).find("td.permissionRead input").prop("checked"),e=$(e).find("td.permissionWrite input").prop("checked");0<t.length&&(n[t]=[i,e])}),this.model.get("permissionEntity").permissions=n},openDialog:function(){var i=this;i.$dialog.dialog("open"),i.$permissionsTable.find("tr").remove(),i.model.get("permissionEntity")&&i.model.get("permissionEntity").permissions&&_.each(i.model.get("permissionEntity").permissions,function(e,t){t={name:t,read:e[0],write:e[1]},e=new DashboardPermission({details:t});i.$permissionsTable.append(e.$el)})},updatePermissions:function(e){var i=this;_.each(e,function(e,t){i.model.get("permissionEntity").permissions[t]=e})}}),DashbordDefinition=function(){var e,i,t,n=[{type:"#0061FF"},{type:"#F23A66"},{type:"#009BAB"},{type:"#7647CC"},{type:"#FFC300"},{type:"#9FA3A6"},{type:"#003A99"},{type:"#A90B31"},{type:"#005D67"},{type:"#452481"}],n=[{title:"Column Color",options:{linked_oneof_property:{property:"RuleType",value:"Column"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleTarget:{default:"",title:"Rule Target (Column Name)",type:"string"},UsePalette:{title:"Use Color Palette",type:"boolean",default:!1},RuleColor:{default:"#F8F8F8",options:{gradient:!1,noColor:!1},title:"Rule Color",type:"gradient"},RuleColumnsPaletteTheme:{default:" ",title:"Palette Theme",type:"string",enumSource:"possible_palettes",watch:{possible_palettes:"root.possiblePalettes"}},RuleColumnsPalette:{type:"array",format:"table",title:"Color Palette",options:{collapsed:!0},uniqueItems:!1,items:{type:"object",title:"Palette Color",properties:{type:{type:"gradient",options:{gradient:!1},title:"color",default:"#ffa500"}}},default:_.cloneDeep(n)}}},{title:"Layer Color Palette",options:{linked_oneof_property:{property:"RuleType",value:"Layer"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleTarget:{default:"",title:"Rule Target (Layer Name)",type:"string"},RulePaletteTheme:{default:" ",title:"Palette Theme",type:"string",enumSource:"possible_palettes",watch:{possible_palettes:"root.possiblePalettes"}},RuleColorPalette:{type:"array",format:"table",title:"Color Palette",options:{collapsed:!0},uniqueItems:!1,items:{type:"object",title:"Palette Color",properties:{type:{type:"gradient",options:{gradient:!1},title:"color",default:"#ffa500"}}},default:_.cloneDeep(n)}}},{title:"Axis Formatting",options:{linked_oneof_property:{property:"RuleType",value:"Axis"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleTargetAxis:{default:"",title:"Rule Target (Axis)",type:"string"},RuleProperty:{default:"Prefix",options:{gradient:!1,noColor:!1},title:"Axis Property",type:"string",enum:["Prefix","Suffix","Decimal Places"]},RuleCondition:{default:"",title:"Rule Condition",type:"string"},RuleAction:{default:"",title:"Rule Action",type:"string"}}}];return i={type:"object",title:"Properties",_transform:function(e,t,i,n){_.set(t,"properties.Basics.properties.RowCount.options.hidden",!_.get(e,"Basics.FillHeight")),_.set(t,"properties.Basics.properties.RowHeight.options.hidden",!!_.get(e,"Basics.FillHeight")),n(void 0,t)},properties:{possiblePalettes:{type:"array",format:"table",default:[""],options:{collapsed:!0,hidden:!0}},Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{Hash:{title:"Hash",type:"string",propertyOrder:1,default:""},Name:{title:"Name",type:"string",propertyOrder:10,readOnly:!0,default:""},Link:{title:"Link",type:"string",options:{readonly:!0},propertyOrder:15,default:""},HostnameAccess:{title:"Hostname(s) access",type:"string",propertyOrder:16,default:""},EnableShareDashboard:{title:'Enable "Share Dashboard"',type:"boolean",propertyOrder:20,format:"checkbox",default:!1},SaveViewerState:{title:"Save Viewer State",type:"string",propertyOrder:22,enum:["disabled","enabled","enabled_auto"],default:"enabled",options:{enum_titles:["Disabled","Enabled","Enabled (Autosave)"]}},UnsavedViewerPrompt:{title:"Unsaved Viewer Prompt",type:"boolean",propertyOrder:25,format:"checkbox",default:!1},FillHeight:{title:"Fill Height",type:"boolean",propertyOrder:30,format:"checkbox",default:!0},Floatable:{title:"Floatable",type:"boolean",propertyOrder:35,format:"checkbox",default:!1},ColCount:{title:"Column Count",type:"number",propertyOrder:40,minimum:1,default:12},RowHeight:{title:"Row Height",type:"number",propertyOrder:45,default:25,options:{hidden:!0}},RowCount:{title:"Row Count",type:"number",propertyOrder:50,minimum:1,default:24},HidePdfGlobalVS:{title:"Hide Pdf Global Viewstates",type:"boolean",propertyOrder:55,format:"checkbox",default:!1}}},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{MainMenuButton:{title:"Main Menu Button",type:"string",enum:["Show","Hide","Hide (End User only)"],default:"Show"},DashboardTheme:{title:"Dashboard Theme",type:"string",enum:["Dark","Light"],default:"Dark"},ThemeSwitchable:{title:"Theme Switchable",type:"boolean",format:"checkbox",default:!0},WidgetsSpacing:{title:"Widgets Spacing",type:"number",minimum:0,default:0},WidgetShadow:{title:"Widget Shadow",type:"boolean",format:"checkbox",default:!1},BackgroundColor:{title:"Background Color",options:{noColor:!1},type:"gradient",default:"#000000"},TransparentBackground:{title:"Transparent Background",type:"boolean",format:"checkbox",default:!0},BorderSize:{title:"Border Size",type:"number",minimum:0,default:0},BorderColor:{title:"Border Color",options:{noColor:!1},type:"gradient",default:"#000000"},BorderRounding:{title:"Border Rounding",type:"number",minimum:0,default:0},BorderSpacing:{title:"Border Spacing",type:"number",minimum:0,default:0},WorksheetPadding:{title:"Worksheet Padding",type:"number",minimum:0,default:10},ShowDataLoadingIndicators:{title:"Show Data Loading Indicators",type:"boolean",format:"checkbox",default:!0},AdvancedCss:{type:"css",title:"Advanced CSS",default:""},cssClasses:{type:"string",title:"CSS Classes",default:""}}},HierarchicalRules:{title:"Hierarchical Rules",type:"object",options:{collapsed:!0},properties:{ChartHierarchicalRules:{title:"Chart Hierarchical Rules",type:"array",options:{collapsed:!0},items:{title:"Chart Hierarchical Rule",type:"object",oneOf:n}},GridHierarchicalRules:{title:"Grid Hierarchical Rules",type:"array",options:{collapsed:!0},items:{title:"Grid Hierarchical Rule",type:"object",oneOf:[{title:"Column Rule Boolean",options:{linked_oneof_property:{property:"RuleType",value:"ColumnRuleBoolean"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleSource:{default:"UserDefined",title:"Rule Source",enum:["UserDefined","Sortable","HideTrailingZeroes","HighlightChanges","IsReadonly","IsSelectable","ShowArrowsOnChange","IsRangeHighlightColorInverted","Hidden","Filter"],type:"string"},RuleTarget:{default:"",title:"Rule Target (Column Name)",type:"string"},RuleValue:{default:!1,title:"Rule Value",type:"boolean"}}},{title:"Column Rule String",options:{linked_oneof_property:{property:"RuleType",value:"ColumnRuleString"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleSource:{default:"DisplayName",title:"Rule Source",enum:["DisplayName","Tooltip","TextAlign","Format","Currency","DateFormat","TimeFormat","Template","SparklineOptions","Footer","FooterWeights","Header"],type:"string"},RuleTarget:{default:"",title:"Rule Target (Column Name)",type:"string"},RuleValue:{default:"",title:"Rule Value",type:"string"}}},{title:"Column Rule Number",options:{linked_oneof_property:{property:"RuleType",value:"ColumnRuleNumber"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleSource:{default:"WidthWeight",title:"Rule Source",enum:["WidthWeight","MinWidthAbsolute","Precision"],type:"string"},RuleTarget:{default:"",title:"Rule Target (Column Name)",type:"string"},RuleValue:{default:0,title:"Rule Value",type:"number"}}},{title:"Column Rule Color",options:{linked_oneof_property:{property:"RuleType",value:"ColumnRuleColor"}},properties:{RuleType:{options:{hidden:!0},title:"Rule Type",type:"string"},RuleName:{default:"",title:"Rule Name",type:"string"},RuleSource:{default:"HighlightNegativeColor",title:"Rule Source",enum:["HighlightNegativeColor","HighlightMinValueColor","HighlightMaxValueColor","RangeHighlightColor","PercentageColorOverride"],type:"string"},RuleTarget:{default:"",title:"Rule Target (Column Name)",type:"string"},RuleValue:{default:"#F8F8F8",options:{gradient:!1,noColor:!1},title:"Rule Color",type:"gradient"}}}]}}}},Popups:{type:"popups",title:"Popups",options:{collapsed:!0,editPopupButton:!0},items:{type:"object",id:"id",options:{collapsed:!0},title:"Popup",headerTemplate:"{{#if self.dialogName}}{{valueProp self.dialogName }}{{else if self.dialogTitle}}{{valueProp self.dialogTitle }}{{else}}Popup {{ i1 }}{{/if}}",properties:{dialogName:{type:"stringViewState",title:"Name",default:""},visible:{type:"booleanViewState",title:"Visible",format:"checkbox",default:!1},dialogTitle:{type:"stringViewState",title:"Dialog Title",default:""},dialogHeight:{type:"numberViewState",format:"number",title:"Dialog Height",default:0},dialogWidth:{type:"numberViewState",format:"number",title:"Dialog Width",default:0},modal:{type:"booleanViewState",title:"Modal",format:"checkbox",default:!1},dialogTop:{type:"stringViewState",title:"Dialog Top",default:""},dialogLeft:{type:"stringViewState",title:"Dialog Left",default:""},resizable:{type:"booleanViewState",title:"Resizable",format:"checkbox",default:!1},Actions:{type:"actions",title:"Actions on Close",excludedFields:["url","nav","query"],fields:{map:{Current:{propertyOrder:10,default:"",type:"stringViewState",options:{custom_class_name:"mapping-current"}},Target:{default:"",propertyOrder:11,type:"stringViewState",options:{custom_class_name:"mapping-target"}}}}},id:{type:"stringViewState",title:"id",options:{hidden:!0},default:""}}}},Shortcuts:{type:"array",title:"Shortcuts",options:{collapsed:!0},items:{type:"object",id:"id",options:{collapsed:!0},title:"Shortcut",headerTemplate:"{{#if self.dialogTitle}}{{valueProp self.dialogTitle }}{{else}}Shortcut {{ i1 }}{{/if}}",properties:{Data:{type:"data",title:"Data Source",default:"",format:"data"},Key:{type:"string",title:"Key",default:""}}}}}},e=_.reduce(["Basics","Style"],function(e,t){return e[t]=_.mapValues(i.properties[t].properties,"default"),e},{}),t={name:"Basics.Name",hash:"Basics.Hash",saveViewerState:"Basics.SaveViewerState",hostnameAccess:"Basics.HostnameAccess",enableShareDashboard:"Basics.EnableShareDashboard",unsavedViewerPrompt:"Basics.UnsavedViewerPrompt",relativeHeight:"Basics.FillHeight",floatable:"Basics.Floatable",colCount:"Basics.ColCount",rowHeight:"Basics.RowHeight",rowCount:"Basics.RowCount",hidePdfGlobalVS:"Basics.HidePdfGlobalVS",hierarchicalRules:"HierarchicalRules",mainMenuButton:"Style.MainMenuButton",dashboardTheme:"Style.DashboardTheme",themeSwitchable:"Style.ThemeSwitchable",widgetsSpacing:"Style.WidgetsSpacing",borderShadow:"Style.WidgetShadow",borderBackground:"Style.BackgroundColor",transparentBackground:"Style.TransparentBackground",borderWidth:"Style.BorderSize",borderColor:"Style.BorderColor",borderRounding:"Style.BorderRounding",borderSpacing:"Style.BorderSpacing",worksheetPadding:"Style.WorksheetPadding",showLoadingIndicators:"Style.ShowDataLoadingIndicators",advancedCss:"Style.AdvancedCss",cssClasses:"Style.cssClasses"},{createConfigFromDashboardModel:function(n){var o=$.extend(!0,{},e);return n&&_.each(t,function(e,t){var i=n.get(t);_.includes(["borderBackground","borderColor"],t)&&_.isString(i)&&i.indexOf("#")<0&&(i="#"+i),_.set(o,e,i)}),o},createModelConfig:function(i){return _.mapValues(t,function(e,t){e=_.get(i,e);return e=_.includes(["borderBackground","borderColor"],t)&&_.isString(e)?e.replace("#",""):e})},SCHEMA:i}}(),TestingPage=function(){function e(e,t){this.dashboardTheme=e,this.$contentPanel=$("body > div > .content-panel")}return e.prototype.getTheme=function(){for(var e="dashboard-theme=",t=decodeURIComponent(document.cookie).split(";"),i=0;i<t.length;i++){for(var n=t[i];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(e))return n.substring(e.length,n.length)}return""},e.prototype.openTestingPage=function(){var t=this,e=(this.$testingPage=$('<div class="testing-page" />'),this.getTheme());this.$testingPage.addClass(e),this.$testingPage.html(T.TestingPage()),this.$contentPanel.append(this.$testingPage),this.$contentPanel.removeClass(this.getDocumentTheme()),this.$close=this.$testingPage.find(".close"),this.$close.on("click",this.remove.bind(this)).on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||t.$close.click()})},e.prototype.remove=function(){this.$close&&this.$close.off(),this.$testingPage&&this.$testingPage.remove(),this.$contentPanel&&this.$contentPanel.addClass(this.getDocumentTheme())},e.prototype.getDocumentTheme=function(){return"kx-"+("Light"===this.dashboardTheme?"light":"darkroom")},e}(),PropertiesPanelDocument=Backbone.View.extend({$documentProperties:null,$propertyEditor:null,$connectionsBtn:null,$documentGraphBtn:null,PROP_HIERARCHICAL_RULES:"HierarchicalRules",PROP_CHART_HIERARCHICAL_RULES:"ChartHierarchicalRules",PROP_GRID_HIERARCHICAL_RULES:"GridHierarchicalRules",PROP_COLOR:"RuleColor",PROP_PALETTE:"RuleColorPalette",PROP_PALETTETHEME:"RulePaletteTheme",PROP_USE_PALETTE:"UsePalette",PROP_COLUMN_PALETTE:"RuleColumnsPalette",PROP_COLUMN_PALETTE_THEME:"RuleColumnsPaletteTheme",PROP_RULE_TARGET:"RuleTarget",className:"document-properties",initialize:function(e){this.api=e.api,this.appModel=e.appModel,this.dialogContainer=e.dialogContainer,this.viewModel=e.viewModel,(e=this.viewModel.get("selectedDocumentId"))&&(this.appModel.get("documents").get(e)?this.onDocumentChanged():this.listenToOnce(this.appModel.get("documents"),"reset",this.onDocumentChanged)),this.initEvents()},initializeDocumentChangeEvent:function(){this.listenTo(this.viewModel,"change:selectedDocumentId",this.onDocumentChanged)},initEvents:function(){var i=this;this.$el.on("click",'[name="root[Basics][Link]"]',function(){this.select()}),this.$el.on("dblclick",'[name="root[Basics][Link]"]',function(){e=location.href,t=e.indexOf("edit");var e,t=(e=e.substr(0,t)+"#"+i.model.id).match(/^((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)$/)?e:"";window.open(t,"_blank","noopener,noreferrer,resizable")})},initializeEvents:function(){var e=this;this.listenTo(this.model,"change",function(){this.editor&&this.editor.setValue(_.extend(this.editor.getValue(),DashbordDefinition.createConfigFromDashboardModel(e.model)))}),this.listenTo(this.model,"detail-downloaded",this.onDocumentChanged),this.listenTo(this.model.get("popups"),"add remove change",this.onPopupsChange),this.listenTo(this.model.get("popups"),"remove",this.onPopupRemoved),this.listenTo(this.model.get("Shortcuts"),"add remove change",this.onShortcutsChange),this.listenTo(this.appModel,"change:globalPalettes",this.setGlobalPalettes),this.setGlobalPalettes()},setGlobalPalettes:function(){var e;this.globalPalette=this.appModel.get("globalPalettes"),this.editor&&this.globalPalette&&(this.editor.getValue(),e=_.map(_.uniqBy(this.globalPalette,"rule"),"rule"),this.editor.setValueByPath(e,"root.possiblePalettes"))},applyDashboardTheme:function(e){this.model.set("dashboardTheme",e),this.viewModel.set("DashboardTheme",e)},onDocumentChanged:function(){var e;this.remove(),(e=this.viewModel.get("selectedDocumentId"))&&(this.model=this.appModel.get("documents").get(e),this.model)&&(this.render(),this.initializeEvents())},onPopupsChange:function(){this.editor&&this.editor.setValueByPath(this.model.get("popups").toJSON(),"root.Popups")},onPopupRemoved:function(){this.popupView&&!_.includes(this.model.get("popups").pluck("id"),this.popupView.model.get("id"))&&(this.popupView.remove(),this.popupView=null)},onShortcutsChange:function(){this.editor&&this.editor.setValueByPath(this.model.get("Shortcuts").toJSON(),"root.Shortcuts")},remove:function(){this.model&&this.stopListening(this.model),this.documentGraph&&this.documentGraph.remove(),this.editor&&this.editor.remove()},render:function(){var t=this;t.$el.html(T.PropertiesPanelDocument()),t.$documentProperties=t.$el.find(".document-properties"),t.$propertyEditor=t.$el.find(".property-editor"),t.$connectionsBtn=t.$el.find(".connectionMgmtBtn"),t.$documentGraphBtn=t.$el.find(".documentGraphBtn"),t.model.get("dashboardTheme")&&t.applyDashboardTheme(t.model.get("dashboardTheme")),t.$el.find(".connectionMgmtBtn").button({icon:"fa fa-cogs"}).click($.proxy(t.openConnectionsDialog,t)).keydown(function(e){" "!==e.key&&"Enter"!==e.key||t.$el.find(".connectionMgmtBtn").click()}),t.$el.find(".documentGraphBtn").button({icon:"fa fa-sitemap"}).click($.proxy(t.openDocumentGraph,t)).keydown(function(e){" "!==e.key&&"Enter"!==e.key||t.$el.find(".documentGraphBtn").click()}),t.renderPropertyEditor()},updatePalette:function(e){var t,i,n;this.editor&&(t=this.model.get("dashboardTheme"),(i=this.editor.getValue())[this.PROP_HIERARCHICAL_RULES][this.PROP_CHART_HIERARCHICAL_RULES][e])&&(n=i[this.PROP_HIERARCHICAL_RULES][this.PROP_CHART_HIERARCHICAL_RULES][e].RulePaletteTheme,(n=QuickBase.Tools.getPaletteFromTheme(this.globalPalette,n,".palette_theme",t)).updated)&&(_.set(i,this.PROP_HIERARCHICAL_RULES+"."+this.PROP_CHART_HIERARCHICAL_RULES+"."+e+".RuleColorPalette",n.palette),this.editor.setValue(i))},updateHierarchicalRulesColumnProps:function(e){var t,i,n,o,a,s;if(this.editor)return t=!1,(i=this.editor.getValue())[this.PROP_HIERARCHICAL_RULES][this.PROP_CHART_HIERARCHICAL_RULES][e]&&(a=i[this.PROP_HIERARCHICAL_RULES][this.PROP_CHART_HIERARCHICAL_RULES][e][this.PROP_USE_PALETTE],n=i[this.PROP_HIERARCHICAL_RULES][this.PROP_CHART_HIERARCHICAL_RULES][e][this.PROP_COLUMN_PALETTE],s=i[this.PROP_HIERARCHICAL_RULES][this.PROP_CHART_HIERARCHICAL_RULES][e][this.PROP_COLOR],o=[this.PROP_HIERARCHICAL_RULES]+"."+this.PROP_CHART_HIERARCHICAL_RULES+"."+e+".",a?void 0!==s?(_.set(i,o+this.PROP_COLUMN_PALETTE,[{type:"#0061FF"},{type:"#F23A66"},{type:"#009BAB"},{type:"#7647CC"},{type:"#FFC300"},{type:"#9FA3A6"},{type:"#003A99"},{type:"#A90B31"},{type:"#005D67"},{type:"#452481"}]),_.set(i,o+this.PROP_COLOR,void 0),_.set(i,o+this.PROP_COLUMN_PALETTE_THEME,""),this.editor.setValue(i),t=!0):(a=this.model.get("dashboardTheme"),e=(s=this.editor.getValue())[this.PROP_HIERARCHICAL_RULES][this.PROP_CHART_HIERARCHICAL_RULES][e][this.PROP_COLUMN_PALETTE_THEME],(e=QuickBase.Tools.getPaletteFromTheme(this.globalPalette,e,".palette_theme",a)).updated&&(_.set(s,o+this.PROP_COLUMN_PALETTE,e.palette),this.editor.setValue(s),t=!0)):void 0!==n&&(_.set(i,o+this.PROP_COLUMN_PALETTE,void 0),_.set(i,o+this.PROP_COLOR,"#F8F8F8"),_.set(i,o+this.PROP_COLUMN_PALETTE_THEME,void 0),this.editor.setValue(i),t=!0)),t},renderPropertyEditor:function(){var e,c=this,t=c.model.get("popups").toJSON(),i=c.model.get("shortcuts")||[],n=c.model.get("hierarchicalRules")||{ChartHierarchicalRules:[],GridHierarchicalRules:[]},o=this.model.get("screens"),d=QuickBase.NotificationManager;d.setDocumentDataModel(c.appModel.get("documents").get(c.viewModel.get("selectedDocumentId")).get("data")),d.setViewStateModel(c.appModel.get("documents").get(c.viewModel.get("selectedDocumentId")).get("viewState")),c.stopListening(c.model,"basePanelLayoutChanged",c.onBasePanelLayoutChanged),c.editor&&c.editor.remove(),o&&o.length&&(o=d.CONFIG.upgradeConfig(c.model.get("notifications")),e=$.extend(!0,{},DashbordDefinition.SCHEMA,d.CONFIG.SCHEMA,{properties:_.omit({Permissions:{type:"backbone",options:{collapsed:!0,parameters:["model"],view:DashboardPermissions}},Screens:{type:"backbone",options:{collapsed:!0,parameters:["appModel","model","viewModel"],view:ScreenList}}},c.appModel.get("isLite")?["Permissions"]:[])}),o=$.extend(!0,{},o,DashbordDefinition.createConfigFromDashboardModel(c.model)),_.set(o,"Popups",_.map(t,function(e){return e.Actions=e.Actions||[],e.dialogTop=e.dialogTop||"",e.dialogLeft=e.dialogLeft||"",_.omit(e,"widgets")})),_.set(o,"Shortcuts",i),_.set(o,"Permissions",{}),_.set(o,"Screens",[]),n&&Array.isArray(n)&&c.model.set("hierarchicalRules",n={ChartHierarchicalRules:n,GridHierarchicalRules:[]}),_.set(o,c.PROP_HIERARCHICAL_RULES,n),n&&c.viewModel.set(c.PROP_HIERARCHICAL_RULES,n),_.set(o,"Basics.Link","../"+(c.appModel.get("saml")?"?auth=saml#":"#")+c.model.id),c.appModel.get("embedded")&&(e.properties.Basics.properties.SaveViewerState.options.hidden=!0),c.editor=new PropertyEditor(e,o,null,c.$propertyEditor[0],c.api),c.editor.subscribe(function(e){var i,t,n,o,a,s,l,r;e===PropertyEditor.ChangeType.Value&&(e=c.editor.getValue(),n=t=l=void 0,e=$.extend(!0,{},e),l=_.pick(e,"Notifications"),d.setOptions(l),o=null==(o=c.model.get("notifications"))?void 0:o.Notifications,a=(null==l?void 0:l.Notifications)||l,_.isNil(o)||_.isNil(a)||!(typeof o!=typeof a||"object"==typeof o&&!_.isEqual(o,a)||"object"!=typeof o&&o!==a)||c.model.commandSet({notifications:l}),i=_.pick(e,"Popups"),c.model.get("popups").length===i.Popups.length&&!c.model.get("popups").some(function(e,t){return e.changedAttributes(i.Popups[t])})||c.model.get("popups").commandSet(i.Popups),c.model.set("shortcuts",e.Shortcuts),r=_.pick(e,c.PROP_HIERARCHICAL_RULES),a=(o=c.model.get("hierarchicalRules")).ChartHierarchicalRules,l=o.GridHierarchicalRules,o=(null==a?void 0:a.length)!==r.HierarchicalRules.ChartHierarchicalRules.length||(null==a?void 0:a.some(function(e,t){return!_.isEqual(e,r.HierarchicalRules.ChartHierarchicalRules[t])})),a=(null==l?void 0:l.length)!==r.HierarchicalRules.GridHierarchicalRules.length||(null==l?void 0:l.some(function(e,t){return!_.isEqual(e,r.HierarchicalRules.GridHierarchicalRules[t])})),(o||a)&&(s=!1,r.HierarchicalRules.ChartHierarchicalRules.forEach(function(e,t){var i="Column"===e.RuleType||!e.RuleType;"Layer"===e.RuleType&&e.RulePaletteTheme!==c.model.get("hierarchicalRules").ChartHierarchicalRules[t].RulePaletteTheme?(c.updatePalette(t),s=!0):i&&(s=c.updateHierarchicalRulesColumnProps(t))}),s&&(l=c.editor.getValue(),r=_.pick(l,c.PROP_HIERARCHICAL_RULES),e=$.extend(!0,{},l)),c.viewModel.set(c.PROP_HIERARCHICAL_RULES,r.HierarchicalRules)),c.model.set("hierarchicalRules",r.HierarchicalRules),n=_.omit(e,"Popups","Shortcuts"),t=DashbordDefinition.createModelConfig(n),c.model.get("dashboardTheme")!==t.dashboardTheme&&c.applyDashboardTheme(t.dashboardTheme),c.model.changedAttributes(t)&&c.model.commandSet(t),c.editor.reloadHeaderTemplates())}),c.listenTo(c.model,"basePanelLayoutChanged",c.onBasePanelLayoutChanged))},openConnectionsDialog:function(){new ConnectionManagement({container:this.dialogContainer,docViewModel:this.model.get("viewState"),appModel:this.appModel})},openTestingPage:function(){var e=this.viewModel.get("selectedDocumentId"),e=this.appModel.get("documents").get(e);try{this.testingPage||(this.testingPage=new TestingPage(e.get("dashboardTheme"))),this.testingPage.openTestingPage()}catch(e){}},openDocumentGraph:function(){var e=this.viewModel.get("selectedDocumentId"),e=this.appModel.get("documents").get(e);try{this.documentGraph||(this.documentGraph=new DocumentGraphVisual(e.get("viewState"),e.get("data"),e.getComponents(),this.appModel.get("components").models,!!this.appModel.get("embedded"),e.get("dashboardTheme"),this.api.showViewStateDialog.bind(this.api),this.api.showDataDialog.bind(this.api),e.get("data").getByPath.bind(e.get("data")),this.api.showCleanUpDialog.bind(this.api),function(){this.documentGraph=null}.bind(this)),this.documentGraph.displayGraph("#appdiv  .content-panel"))}catch(e){}},showPopupEditor:function(e){e=this.model.get("popups").get(e);this.popupView&&this.popupView.remove(),this.popupView=new QuickBase.PopupView({viewModel:this.viewModel,appModel:this.appModel,model:e,isEditing:!0}),this.popupView.toggleDialog(!0)},onBasePanelLayoutChanged:function(){var e;this.editor&&(e=this.editor.getValue(),_.set(e,"Basics.ColCount",this.model.get("colCount")),_.set(e,"Basics.RowCount",this.model.get("rowCount")),_.set(e,"Basics.RowHeight",this.model.get("rowHeight")),_.set(e,"Basics.FillHeight",this.model.get("relativeHeight")),_.set(e,"Basics.Floatable",this.model.get("floatable")),this.editor.setValue(e))}}),PropertiesPanel=Backbone.View.extend({KEYCODE_C:67,KEYCODE_V:86,$pinButton:null,$documentPanel:null,$propertiesPanel:null,$expandBtn:null,documentProperties:null,prevComponentModel:null,copiedJson:{},clipboardCopied:{},initialize:function(e){this.options=e,this.appModel=e.appModel,this.dialogContainer=e.dialogContainer,this.viewModel=e.viewModel,this.$el.html(T.PropertiesPanel()),this.$panelHeader=this.$el.find(".panel-header"),this.$properties=this.$el.find(".panel-content"),this.$properties.hide(),this.$propertiesPanel=this.$el,this.$documentPanel=this.$el.find(".panel-document"),this.$pinButton=this.$(".pin-button"),this.$expandBtn=this.$(".expand-button"),this.$lblWidgetName=this.$(".lblWidgetName"),this.$dashboardHelp=this.$(".dashboardHelp"),this.$searchInput=this.$(".searchInput"),this.$searchIcon=this.$(".searchIcon"),this.$dataSrcBtn=this.$(".btn-datasource"),this.$viewStateBtn=this.$(".btn-viewstate"),this.$documentGraphBtn=this.$(".btn-document-graph"),this.api=new PropertiesPanelApi({appModel:this.appModel,dialogContainer:this.dialogContainer,viewModel:this.viewModel}),this.api.setDocument(this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId"))),this.documentProperties=new PropertiesPanelDocument({el:this.$documentPanel,api:this.api,appModel:this.appModel,dialogContainer:this.dialogContainer,viewModel:this.viewModel}),this.copiedJson=null,this.render(),this.debouncedSubComponentSelected=_.debounce(this.onSubComponentSelected,100),this.initializeEvents(),this.onPropertiesPinnedChanged()},initializeDocumentChangeEvent:function(){this.documentProperties.initializeDocumentChangeEvent()},initializeEvents:function(){var t=this,i=this;this.listenTo(this.viewModel,"change:selectedDocumentId",this.onViewModelSelectedDocumentChanged),this.listenTo(this.viewModel,"change:selectedWidget",this.onViewModelSelectedWidgetChanged),this.listenTo(this.viewModel,"change:selectedWidgetId",this.onViewModelSelectedWidgetIdChanged),this.listenTo(this.viewModel,"change:selectedSubComponent",this.debouncedSubComponentSelected),this.listenTo(this.appModel,"change:propertiesPinned",this.onPropertiesPinnedChanged),this.listenTo(this.api,"showPopupEditor",function(e){this.documentProperties.showPopupEditor(e)}),this.listenTo(i.api,"startInspecting",function(){this.trigger("startInspecting")}),this.listenTo(i.api,"stopInspecting",function(){this.trigger("stopInspecting")}),this.$dataSrcBtn.on("click",this.showDataDialog.bind(this)),this.$dataSrcBtn.on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),t.showDataDialog())}),this.$viewStateBtn.on("click",this.showViewStateDialog.bind(this)),this.$viewStateBtn.on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),t.showViewStateDialog())}),this.$documentGraphBtn.on("click",this.showDocumentGraph.bind(this)),this.$documentGraphBtn.on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||t.showDocumentGraph()}),this.$pinButton.on("click",function(){i.appModel.set("propertiesPinned",!i.appModel.get("propertiesPinned"))}),this.$pinButton.on("keydown",function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),i.appModel.set("propertiesPinned",!i.appModel.get("propertiesPinned")))}),this.$expandBtn.on("click",function(){i.appModel.set("propertiesPinned",!i.appModel.get("propertiesPinned"))}),this.$searchInput.on("keyup",function(e){27===e.keyCode&&(e.preventDefault(),i.$searchInput.val(""),i.editor)&&i.editor.filter(null)}),this.$searchInput.on("input",function(){i.editor&&i.editor.filter(this.value)}),this.$searchInput.on("blur",function(){this.value||i.togglePropertySearch()}),this.$dashboardHelp.click($.proxy(this.onDashboardHelp,this)),this.$dashboardHelp.keydown(function(e){" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),i.onDashboardHelp())}),this.$el.on("paste",$.proxy(this.onPaste,this)),$(window).on("keydown",$.proxy(this.onKeyDown,this))},showDataDialog:function(){this.api.showDataDialog(null,null,null,{hideSelectBtn:!0})},showViewStateDialog:function(){this.api.showViewStateDialog(null,null,{dialogTitle:"View States",hideSelectBtn:!0,cancelBtnText:"Close"})},showDocumentGraph:function(){this.documentProperties.openDocumentGraph()},showConnectionsDialog:function(){this.documentProperties.openConnectionsDialog()},getArgs:function(e,t,i){var t=_.clone(t.attributes),n="",i=i?e.get("appArgs").json:t;return t.Basics&&t.Basics.Data&&(n=t.Basics.Data),e.get("appArgs")[n+"Args"]&&(i=e.get("appArgs")[n+"Args"]),_.omit(i,"version")},getSchema:function(e,t){return e.get("appArgs").schema},processPage:function(e){var t=this.viewModel.get("page");!this.appModel.get("embedded")&&("test"===t?this.documentProperties.openTestingPage():"graph"===t&&this.documentProperties.openDocumentGraph())},handleLinkButton:function(t,n){var o,i=[],e=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId"));this.appModel.get("documents").each(function(e){i.push({title:e.get("name"),value:e.id})}),_.isEqual([],i)?t.possible_dashboards=[{title:"none",value:"none"}]:(i.unshift({title:"none",value:"none"}),t.possible_dashboards=i),t.possible_viewstates=[],_.each(e.get("viewState").getViewStateList(),function(e){t.possible_viewstates.push(e.path)}),t.possible_viewstates.sort(),o=n.get("ViewState"),this.listenTo(n,"change:ViewState",function(e,t,i){o.target_screen!==t.target_screen&&"none"!==t.target_screen&&(n.get("ViewState").target_dashboard="none"),o=t})},onPropertiesPinnedChanged:function(){this.appModel.get("propertiesPinned")?(this.$pinButton.find("i").removeClass("fa-caret-left").addClass("fa-caret-right"),this.$propertiesPanel.removeClass("unpinned")):(this.$pinButton.find("i").removeClass("fa-caret-right").addClass("fa-caret-left"),this.$propertiesPanel.addClass("unpinned"))},onViewModelSelectedDocumentChanged:function(){var e=this,t=e.appModel.get("documents").get(e.viewModel.get("selectedDocumentId"));t&&this.listenToOnce(t,"view-state-init",function(){e.api.setDocument(t),e.processPage(t)})},onViewModelSelectedWidgetChanged:function(e,t,i){var n=this.viewModel.get("selectedWidget");n?(this.viewModel.set("selectedWidgetId",n.id,{silent:!0}),this.showWidgetProperties(n,i.reset),this.$el.removeClass("doc")):(this.viewModel.set("selectedWidgetId",null,{silent:!0}),this.showWidgetProperties(null,i.reset),this.$el.addClass("doc"))},reloadHeaderTemplates:function(){this.editor.reloadHeaderTemplates()},showWidgetProperties:function(e,i){var n,o,a,s=this;if(this.prevComponentModel&&(this.stopListening(this.prevComponentModel),this.prevComponentModel=null),this.dontRemoveSubComponent)this.dontRemoveSubComponent=!1;else if(this.viewModel.get("selectedSubComponent"))return void this.viewModel.set({selectedSubComponent:null});s.editor&&(s.$el.find(".btnBulkEditor").off(),s.$el.find(".btnReset").off(),s.editor.remove(),s.editor=null,s.$panelHeader.removeClass("search-open")),e&&(o=e.get("component")),(o=(a=this.viewModel.get("selectedSubComponent"))||o)?(this.$documentPanel.hide(),this.$properties.show(),o&&(s.componentModel=a=o.get("options"),s.api.setWidget(e),s.componentItem=o,e=(e=s.appModel.get("components").get(o.get("definitionId")))||s.appModel.get("components").find({appKey:o.get("key")}),s.componentOptions=o.get("options"),window.ops=s.componentOptions,this.$dashboardHelp.off("click"),this.$dashboardHelp.click($.proxy(this.onDashboardHelp,this)),this.$searchIcon.off("click"),this.$searchIcon.click($.proxy(this.togglePropertySearch,this)),_.isNil(e)||(this.$lblWidgetName.text(e.get("componentName")),e.get("appArgs")&&(i=s.getArgs(e,s.componentOptions,i),n=s.getSchema(e,i.Basics?i.Basics.Data:null),!a.get("Basics")||"GeoMap"!==a.get("Basics").ComponentName&&"ContextMenu"!==a.get("Basics").ComponentName||s.handleLinkButton(i,a),s.stopListening(a,"change",s.onComponentModelChanged),s.listenTo(a,"change",s.onComponentModelChanged),s.stopListening(a,"quickStart",s.onComponentQuickStart),s.listenTo(a,"quickStart",s.onComponentQuickStart),s.stopListening(a,"transform",s.quickStartTransform),s.listenTo(a,"transform",s.quickStartTransform),s.prevComponentDefinition=e,s.prevComponentModel=a,s.editor=new PropertyEditor(n,i,s.componentOptions.expanded,s.$properties[0],s.api,o.get("hasOnSettingsChange")),s.editor.subscribe(this.onEditorChange.bind(this)))))):(this.$searchIcon.off("click"),this.$lblWidgetName.text(t("dashboard")),this.$documentPanel.show(),this.$properties.hide(),this.componentItem=null)},onComponentQuickStart:function(e){this.editor.focusItemByPath("root."+e)},quickStartTransform:function(e,t){this.editor.setValueByPath(e,"root."+t)},onComponentModelChanged:function(e,t){e=_.clone(e.attributes);this.editor&&this.editor.setValue(_.omit(e,"version"))},onDashboardHelp:function(){var e,t;this.componentItem?(e=/\s/g,t={radarchartbeta:"radar",layoutpanel:"layout",bipartitechart:"bipartite",reportmanagement:"reportmanager"}[e="How_to/components/"+this.appModel.get("components").get(this.componentItem.get("definitionId")).get("componentName").toLowerCase().replace(e,"")+".htm"]):e="home.htm",new QuickBase.HelpDialog({appModel:this.appModel,container:this.dialogContainer,viewMode:this.viewModel,tag:t||e})},togglePropertySearch:function(){this.$panelHeader.toggleClass("search-open"),this.$panelHeader.hasClass("search-open")?(this.editor&&this.editor.filter(this.$searchInput[0].value),_.defer(function(){this.$searchInput.focus()}.bind(this))):this.editor&&this.editor.filter("")},onEditorChange:function(e){e===PropertyEditor.ChangeType.Expanded?this.componentOptions.expanded=this.editor.getExpanded():(e=this.editor.getValue(),e=_.extend({},e),this.componentOptions.commandSet(this.componentOptions.changedAttributes(e)),this.reloadHeaderTemplates(),this.args=this.getArgs(this.prevComponentDefinition,this.componentOptions,!1))},createClipboardEvent:function(){try{var t=new ClipboardEvent("paste");navigator.clipboard.readText().then(function(e){this.clipboardCopied=e.toString(),this.$el[0].dispatchEvent(t)}.bind(this)).catch(function(e){QuickBase.Log.Info("Please enable Clipboard Access to copy and paste via Property Panel Icons")})}catch(e){this.showModal()}},showModal:function(){new QuickBase.ErrorDialog.ShowError("Pasting is unavailable via this action currently, but you can still use: CTRL-V for paste")},onKeyDown:function(e){if(112===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.onDashboardHelp()),this.editor&&this.editor.getFocusedPath()){var t,i=e.keyCode;if(e.ctrlKey||e.metaKey)switch(i){case this.KEYCODE_V:this.pastePath=this.editor.getFocusedPath(),this.clipboardCopied=null,e.originalEvent?(this.$el.attr("contenteditable",!0),this.$el.focus()):window.Promise?this.createClipboardEvent():this.showModal();break;case this.KEYCODE_C:this.copiedJson=this.editor.copy(),this.copiedJson&&(t=QuickBase.ComponentOptions.setDataProperties(this.getCopyJSON(this.copiedJson)),this.copy(JSON.stringify(t),!1))}}},getCopyJSON:function(e){var t,i,n={},o=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId"));return n._property=this.copiedJson,i=CopyPasteHelpers.getComponentViewStates(this.copiedJson),n._dataSources=_.extend(CopyPasteHelpers.getComponentDataSources(e,i,o.get("data")),CopyPasteHelpers.getMappingDataSources(i,o)),n._viewState={},_.each(i,function(e){(t=o.get("viewState").getByPath(e))&&(n._viewState[e]=t.toJSON(),"dict"===t.get("_type"))&&(n._viewState[e]._default=_.mapValues(t.get("_default"),function(e){var t;return e instanceof Backbone.Model?(_.includes(i,e.path)||n._viewState[e.path]||(t=o.get("viewState").getByPath(e.path))&&(n._viewState[e.path]=t.toJSON()),"<%"+e.path+"%>"):e}))}),n},copy:function(e,t){var i,n;if(navigator.clipboard)navigator.clipboard.writeText(e).then(function(){$("window").focus()},function(e){$("window").focus()});else{(i=$(document.createElement("textarea"))).css({position:"absolute",width:0,height:0,top:0,left:0}),i[0].value=e,i.appendTo(this.$el),i[0].focus(),i[0].select();try{document.execCommand("SelectAll")&&(n=document.execCommand("copy",!1,null))}catch(e){console.log(e)}i.remove(),$("window").focus(),t&&t(n)}},onPaste:function(e){if(this.pastePath){var t,i,n,o,a=void 0,s=void 0;if(this.editor.canPaste(this.pastePath)){if(e.stopPropagation(),e.preventDefault(),this.$el.removeAttr("contenteditable"),a=e.originalEvent.clipboardData||window.clipboardData,!this.clipboardCopied&&!a)return void QuickBase.Log.Info("Please copy a property section prior to pasting");if(this.clipboardCopied)s=this.clipboardCopied;else if(!(s=a.getData("Text")))return;if(!s)return;e=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId"));try{(o=JSON.parse(s))._property&&(CopyPasteHelpers.mergeViewStates(o._viewState,e),i={},n={},_.each(o._dataSources,function(e,t){"virtual"===e._dataType?n[t]=e:i[t]=e}),CopyPasteHelpers.mergeDataSources(i,e),CopyPasteHelpers.mergeDataSources(n,e),t=this.convertToModel(JSON.parse(s)))&&this.editor.pasteProperties(t._property,this.pastePath)}catch(e){console.log("cannot get pasted data",e)}}this.pastedEditor=null}},convertToModel:function(i){var n=this,o=n.appModel.get("documents").get(n.viewModel.get("selectedDocumentId"));return i instanceof Object&&_.each(i,function(e,t){e instanceof Object&&e._dashboardsType?"viewstate"===e._dashboardsType?i[t]=o.get("viewState").getByPath(e.value):"data"===e._dashboardsType&&(i[t]=o.get("data").getByPath(e.value)):n.convertToModel(e)}),i},onSubComponentSelected:function(){this.viewModel.get("selectedSubComponent")&&(this.dontRemoveSubComponent=!0),this.onViewModelSelectedWidgetChanged(null,null,{reset:!1})},remove:function(){this.$pinButton.off(),this.$expandBtn.off(),this.$searchInput.off(),this.$searchInput.off(),this.$el.off(),Backbone.View.prototype.remove.apply(this,arguments)}}),data={},ComponentListView=Backbone.View.extend({tagName:"div",initialize:function(e){var i=this;i.options=e,i.$el.html(T.ComponentListView(i.model.toJSON())),i.el.setAttribute("title",t(i.model.get("componentName"))+" - "+t(i.model.get("componentDescription"))),i.el.classList.contains("component-header")||i.el.setAttribute("tabindex",0),e.dblclick&&i.$el.dblclick(function(){e.dblclick(i.model)}),i.proxiedOnDragEnd=$.proxy(this.onDragEnd,this),i.proxiedOnDragStart=$.proxy(this.onDragStart,this),i.initializeEvents()},initializeEvents:function(){var t=this;this.el.addEventListener("dragend",this.proxiedOnDragEnd,!1),this.el.addEventListener("dragstart",this.proxiedOnDragStart,!1),this.el.addEventListener("keypress",function(e){13===(e.which||e.keyCode||e.charCode)&&t.onEnterKey(e)})},createEvent:function(e,t){e=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:null});return e.dataTransfer={data:t,setData:function(e,t){data[e]=t},getData:function(e){return data[e]}},e},dispatchEvent:function(e,t,i){e.dispatchEvent?e.dispatchEvent(i):e.fireEvent&&e.fireEvent("on"+t,i)},onDragEnd:function(e){this.options.onDragEnd&&this.options.onDragEnd()},onDragStart:function(e){var e=e.dataTransfer,t=this.model.id.toString();e.effectAllowed="copy",e.setData("text",t),this.options.onDragStart&&this.options.onDragStart(t)},onEnterKey:function(e){this.simulateDragDropEvent(e,{onEnterKey:!0})},remove:function(){this.el.removeEventListener("dragend",this.proxiedOnDragEnd),this.el.removeEventListener("dragstart",this.proxiedOnDragStart),Backbone.View.prototype.remove.call(this)},simulateDragDropEvent:function(e,t){var i,n=this.el,o="#appdiv > div.content-panel > div > div > div > div.worksheet > div:first-child",t=this.createEvent("dragstart",t),a=(this.dispatchEvent(n,"dragstart",t),this.createEvent(i="dragover",{})),a=(a.dataTransfer=t.dataTransfer,this.dispatchEvent($(o)[0],i,a),this.createEvent("drop")),o=(a.dataTransfer=t.dataTransfer,this.dispatchEvent($(o)[0],"drop",a),this.createEvent(i="dragend",{}));o.dataTransfer=t.dataTransfer,this.dispatchEvent(n,i,o)}}),ComponentDialog=Backbone.View.extend({$img:null,$fileInput:null,$uploadBtn:null,appModel:null,className:"component-dialog",dataView:null,propertiesView:null,isModelChanged:!1,initialize:function(e){var i,n,o,a=this;this.appModel=e.appModel,this.updateFn=e.updateFn,n=[{text:t("Save"),click:$.proxy(a.onSaveButtonClick,a),icon:"fa fa-floppy-o"},{text:t("Cancel"),click:$.proxy(a.onCancelButtonClick,a),icon:"fa fa-times"}],o=(e.model?"Edit":"Add")+" Widget",e.model?(this.editModel=new Backbone.Model(e.model.attributes),n.splice(1,0,{text:t("Delete"),click:$.proxy(a.onDeleteButtonClick,a),icon:"fa fa-trash-o"})):(i=QuickBase.Helpers.getGUID(),this.editModel=new Backbone.Model({id:i,componentName:t("my component"),componentDescription:t("A description of my component"),appKey:"",listViewThumb:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAYAAACXpx/YAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTMzQURFOTkxOEY2MTFFNUFDMEJBRDUyMDNDODMyQkMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTMzQURFOUExOEY2MTFFNUFDMEJBRDUyMDNDODMyQkMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBMzNBREU5NzE4RjYxMUU1QUMwQkFENTIwM0M4MzJCQyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBMzNBREU5ODE4RjYxMUU1QUMwQkFENTIwM0M4MzJCQyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pnt3JAMAABOnSURBVHja7FxpdBzVlb61dFV19d6tVrd2ybJWLxLeMGAgGAM2sTMD5kDOTAJkYRlmCXNmmJksJ2TCARKSyY+cnGGGGUMyYcZkbBaDccY2tsEsNtjyImwtXmTt6pa61Yt6qequrpp3qyVhvKnbBNkRfj7tLlVX1at637vf/e597xWlaRpMR6l7bLv+jdXNKTaDzWiA6kIR/EkK3BYBMurU90GOERZXWZ+dW2JawjI0p2S0TFxWkpKiRZ0i628bjA9GpUy/aKC6Nx8NddW5BX/fqOwXWEpJpDJQ4uBh48EAJNIq0FT2mlirwAAYmew2lhq3CHcv8YKqqrDp0AhUOgXgWBrG5AxQ5LwxKQNGloJURoUG8ixvd4zqJ1uMLJTaeTg+nICW3ghwDD3lMx388bLPtd1ZuEQFgRYMDEjhBNTOMsPNjW5QpgbZ7TDz91Ok3TSV/EUam6YE/NLPrXQb9YNSigq3zS+AaFKJEDCG/BH5+Ggsvf+YP/GyrKhHM6TyiZo0/V4omKmFvdQ3IKUz8MJ7fVBBrIQnVpImVkGdv1OkDSwTFnnWrmqnQzRp4ZPbaGl20WBzmgy2WW5jPU1Rawjg/0Ss/dHXDo08Jxg+sS6F1KnpPSZb8DITn1yY5QrAFyik4XVgkdYYAlahVdBBPhfKBFOlQtXS+m/a1AyBlpoh2+lM9mATzxgfuLHk6XZfbH1SUccYKlvJSESCuKQBTWcBZRnKZuToZpWcbDOyvWTfEGEFSSLUTn4bB526AnCuhSEOMZxIw8GeMPzF8iowEN+lnkMbEJdIk2MZuEijwtNSaSXhFTWCEaV3LoXsFGkha8kEOK+Va3hkRcUmr42vwXtYWO1IhuOp/nBc6RgISQf7Q1LLYEhuldOZbgQcz8Hj6MsUcPZyuRH0x51DMVj3bj84zTwB89MoojVaBZb/Sy/5MQcLPhdTGIj1/eeO409tb/UlRI7R6yi0m6Cq0KpvJwlgyxudf1XjEWtiREhhxzPxtNEqGGsqCqiaqyqta5ANYpIS90XktlMjiffJ37uMBmZfJKEMGVgVNO0KwBcsvlASghH5LMGFf3usvJOmKTFfcBnCCCJ50v/Y1vb4+n0jz3IcD3EVJpV078gYYDSRICpZyxS6sGpt3ORxv3qGrzcLrKlONCxuLLEsJtT96DWzHaOkc35wzBd/dSQiv0lcjB9pPENpVwA+IwyC2UQJN5XbzhI3SIOkYZ0sMUUtD4RJOAWxZEr+t7c7v/H2x0PrDZyR+FpKvwICnMmkdQA1vf4MtHQFt3x5YfE9U93n6fdHhJzzhnrX6hvqnKuDsbR/3Tu9jxI6f8lIWOIKwOcInY4RwXVwIAYEzEnPhvR5Y52zEKkVt3MpFKFlltZg/a62B366Y2R9uZgB3gC638UrZ5QUDATlye6CWuyN/b0b7lpS/FhDuWtuMpXJqR5kF2X8WI+N8xSYmCaOyrwk0HAF4LNBAQjGJDASuypzGCEzjqVEGtBr4SqByl3M8CQU2nmob8P2Vv9viy0ccMT25XHuRTDNWoLsS6Atj1cOhKaV5LNbWh995lvXb6UpmlHzcKro54lYTO9uG/ptQpJASdNXAD53QxFfTEIXhsQtiprNaCRTChSYudqcO4quujV48UPfs0fDNFh4DcY0A6F6Rbc4nkUBxYHhjBiaE3g42B3esadtcONNTeX35GrFEx1q/8nA3r5Ass3CsZdFJHVJM1kKMSNMIcaJuMFtZTxeRUsYIgDPKbaATRR0/yulVCi08ZU55x0o0OPpUUkdZlgGFCobyCjoy40sfKma+HmF0H6jC2LxJBTZ+Ulhh2CLHP0/clq9J1/2ae8L/85hYsn5bP5Sf6YALJOGtRnBUuQQbl1bZFlALM1gFZiuAgv3BgF5IJt6VMEXlcDMswQoPWQRPTa+OtfMEnYgTKA0ekyzomPyURQ82FEwgdVYYobqAhE6BseI0mVh+9FRuHVeoR5/I3tgjCxllACmPA3E0nNhaRRuJF5OtQ9EttmJZGd0iU6d1QEmbh81AEXNMICxoZLpDKrktd9eXvVUscNYi0l8ajzbtKDK8aPW7tB31+/tfwGfvjuYwHSj3iEKrXypTTQUqWo+CpqCRVX2tVsODb0h8gzYieV6zJzucSeyW2hlGPNaTUbYfSwII7EUUdYaNFfa3V8m5yDIuRQcWDjiGzt8uDd6gmXp86pvTJGSPqMPVCiZz9/Cp00FoEXKaQW+dk3pQ4+vbdxY7hJrdYqWsxSNDeky855bm4uev7bW9c/IbqFEGvpJXMwRoJwmrlbkWS4f0YNqe2WT9+7ZReZFfsIGmOhAP3lmH0FLMuh1GKDlVBi2HhmGYrtwD+7LPRsHcPDU6FtRKa3JpBOf/kkp2W8TR0OFywgVTh6SkgzHh6Mzx4Kt5OEaq+yLfnBH4y+RoKRzhDroM1E1P7B81g9jSSX2k80dP5tXZgWJdID6YksTNng+vR6tXeAY46/ubf7f773UetfJ4fiBIit3zmPT5Ni6IjPMKxLh+lrn6jULi+9KptS83E4sLr+9uMKqDy2eHkIhI+DHQjoQMreWofQQkJlJFO0xG+Chm2c9KXA0h1Z7XlAIfkTcwIM3V/9EU9Wj88rtW17b12+f7bV8VVXzrxcb3mM3Vv3sa81vv9Ey8C+HukZ/Q/Z1I2PgSBYCgEoZOxcBVFg+1/ONP11S9gxL04Z0Rs3ReikIjsmRQFRqNQusLhInG5jwcSSW1sHMaNM/SDFtANvM3PzmSucKKQerGB/RoR++tWZDYEz+/fdK59QX2oQ5spI/wticSI/Ef1u+edOsHw0vKPn7wVDio0BEai2wCl0lDmP8lqYi9yyPpabAwi9z24Q6dAO5gjvh6/2hZMdgKOnDzBk1XjHWW+Wxks00qHBpyrQBvKy24HaTwNAXst4zQSaWQJSzsJYaD3k+kwbQwzAdaLPLbF+ulcFytDS87jW1BcRPanreOXURnQgV9EAw3ioTJqD5rOrGfR4SKhi5S5vsmDaAr6l1zctXNeqC6g8sNM/MI2PJtdNdiCVODsdaZHK/FA4fEl9yc70HfGHpkk8YmDaAg/F0AVJZSoEZVZBd0Ic7RLbr6monEVgMfNwX0cXi5TB0OG0Ak1Ano2kw4woOaCRlRdl1xNfrCyeJErdiiDXJFPjQ2AEymgoqlR1MoWciwEpK7pmB+GZz3pqWPhFMxgdHk7DyqlIIxWSQCFU5zfzcMrdp1bJ6TxMOYPUH43s6ByPrY4lUcMYB/OZHp95c3lz+cL7WoV3mZo8ultCysGpOYWEwKvVjsoRnqab5la7H51c61wgcy542RffPhsPJx17cdfxvDveGNk3Hk00bW+xv796652j/+2Zh6kFwnIGB4QbOjcURpcu5YAfkDQz1lasrvt9Qal9UWmD+6b3La/curi28g6ZpFkMlpGj84JAnCc3K/3rNnJebK12rMxl15liwL5JM//x3795X7Lxta1mRszpF4uEz044IKsdSMByKD2zd2/bEyYHQ0fvXLH2l2GVxKxn1sgUZ7212ke3OcrflTj0VquLkvnMrcwzDSIdg/uGOec+Fx5Lzya7AjLBgVJcjodjJ1985fMPxHv+LaUWRyYMCWjR+G1gaguFY/6bdR57afaBzYUe3/98H4tR7g8F4C8tc/lNUs8kZWo+3p8qXo1WXu01F1zV47p0xFjxhoYTSBjtODX195/5jTzqtpls1iq4vLbAmDx/v35OU0zu7hkKjNzZVgkwZYXaxA6wiT/2xTD7PRy/gIzWUO1eSzV/MGIAnhBNHLDYSS3YMDEc6dhzogrU3zoGBQBS8TjOYBAPIKgtpioNTvghLDi+jYOYtLUkrGlQUmCpmlAV/SkgR8cQZWDAZOf0bKRwtPJxQoDuYAq/DiNTt8jjEkoyqzjiA0do5ljbMGBWdwyPr47cOVwEkiI8aiUo4KF9t5FjbZ2FoZAzMOVPjn8ulYGcORKXwjLXgM5MFCELniAKShtadwuwQlHtsc0wCe1G5Ykz2I0ukFRxwV1Lo9sjfgsAbJpWv+gfw7QgUDhem87weRn/D4fhxANfMBlhfOUA+cU3UR3sERtUzAgqJgeu8lusvSrETHx9Pyv4Tvb4X3z90cpuiUScbKgszu/Z3ehY3VjTVVXhvLy9yrTKLAne+cCZXcH3BSFefL7hjfk3Zn/OcQcw1nNMHKPoDW2FB+cwFGDM8JoGDAz0xoDkjAYYaBx3AyLNcdbH9aiXP9sew68OjPZt7h4KPaJraNzw6BrTBoE8X8o+OdbefGvowEBp7bue+9uaV1859uqbCuzKVyuQ9aIV0Tzpk5vnN++6TkvH3Nr/f/vsffPO2jSzD0FOpfuyAPf6ob097/yuPfGXBzPLBSJ04e9GAY6hhGXh7IRgEI+BiEsxgMeOr4otd5oYSl3l2PuPAOLHurQNd//fD59+6k7R9n8Cx4xRKZ1c5MFlhh590Wjn08lv7V7+68+B/GYX8l5hg3N7jjxw/MSx90B/OwM59na+++c6hv8Xbv5Cvx3thKA3WbWn57lut/TPHB6f1WYQUROIp2HMsAB+diEA8haAyMBqLfOrYuKRAc7X7ZrORpeNSbiaMDReMJELrXv/owXAslR4IxKCmxHHOqanoM5FK2/tCmW37Tz3YUFXUVF/pbZLzoGtkn0AkcdBtE1WKEmF4xAQ9Q4Ffnuzz26pKvT8GioaMvrBcm+zY2MFShEn2Hel5/GjX4K9N/OcuoqcP4OoSN+CC6329SeJfk0AzLNjE7Hg+dQaR4CzKq2s9a/KJjgSOgpff7XqpKyD3WWx2eK1lEBaOSlAokkY97ToMlQX3uH8MxtLEFVgs8ht7Op6or/RszCvMIwCf9I91ftwfApGEegajWZ86G47Gn9h7uHOQgPx3Lru5wcBmmzielFKBUHTPuweO/ZwGbbORx8l/iZkD8LL64pyyPahEjbxh1pyKgqVyOr/4t+XU6K4QAS0la/p7N945EQYzUeQrm4on1S5a6YmhMWBYAUoKRF3gDQbiu0fCiZDDKjpyHQCQFQ2cRnboziWVOuWPRmLk4ZK6pfqD4XWdPf7/HgklmjlGKye9OWky8scIxp24MtLrME9fODZdFXUMjOZ0XIKERysXVa2xmTkhmU94pOHrFjjRLvIgCuykWEspDAySti8IjEF3IAEtfg2iiVR2aiu+h4P8RyLkwANRyee2mwjAuQisbH0HukaOd/aN6kkaFFZXlZt16iZCC12G1OcP7VXkxF6KsFV9VUk2VTvNy1mmDWADTeWEEnG79ILZnq/nm7zCZlta612992jfb0Se/RQYfSNx6PWFwekqBAfNTAKE31r2RSu8wDFi7pPqKUgQZ7qo2u1vqnBlr0f+U5X0p+ZgGQjwtMoCAkzTlybJMm0Aex3ilMcohPbKCi1L68tdC/KNT5HOl9QXrbKYhFl9I9EutKpPYu2syHHbBX2K60RCYmI+VXOtu7mi0FqqKLnPg44lU9ENu9uDeJ8T86BxjvWfLK0EC3f5JAinz4JzGPIjoQ3Uljm/ZeIZKiblBzBajsPCm+68ruYf/3VTy0OigT4rseALRPRkyuwSJ3gcJti456Q+Oe7+2+b9mIQ9jJLJvU6iJcKNlYUhtPqJwRA9O6YLxswXD2AmM7Vi5DQVfD7/psER50Kb1dyECQFFX/aRm2XhUpPbF1ffd7Bz8FdDwdjHpy8CQ+tMpdIkXKPAYxfB6zTB3ctq4Ib55U9fM6fslnz8Pca5sYTcaxcNKbzHCbc6wQhUJg0sTX2xAI4nU1NTNAFyOBh9/b2W9q0kjlxZXe79qtdtv8VpNbsQLPTLymmx5bkUuEU08CsWVn3nld3t38ZEx8QLeUjMqo/B4qnjeWNuaUPJM9fNLftOvmodMR0MxiIbdncQQWc44xk0qCw0waJKG1BfpAXguYzk4DGYySL+Ug6GY5u2fdC6SZLT3hsX1V9P4saVLodlmafAPps3GGiGocYXkWdfXTQBOlbjsAgFhOZBB5jKHoOLv9B3ZlQK0umMfdXSmg1FTssKDJsuZl6frKj4op6zVyrSNPQEklDhEoH+Iq/wn5LSCdA8iS9jCck3Go5t6PUFNvQMjfI3La6v43nDYpHnl7gc1gXeAns1UasOzIihrZJ4dHjHh22/3tfepwOMwMsarSdWdBqX07D2S41PVnmsK8aki/OVuDKysdwV/8XDK86pjjGrFo7GYcO2oM4qDHMF4CmtGpMJFEXLBKDW4dFoqz84ti6WSMC1TTXuYCQ6a9UNCwsH/KOpD1raDg+NJHwYi2bVMw0mPf4cp2FGhdICc8Nnuifyj6hnJSGlx1fyn13MJiMQFwNt7Scu6dTfyx7gMxMMGJKwJATiiXXKaRZV8Ug8IY+gmsU8L47/suMmg/tcJg6uqrRPxqcK+f1Ud+/3Z3mtLzhs1jojj0Iu67/x+NzA0Fc/MjhZ8HzxLa5PumlJPRRYeNj5URtol+j1ln9UAJ/Pwica+XyzNk5/WwayQTIp73lpy/sLrmqsuo5Y4srqMs91doupzmIS7XgtnsOJAuMditbfkal/9CyUll0uahZ5M2bB6AtoC7yX6xc3YqXgGw7pObMrAH8ORYNPFilO0Dax1EQymdq+9YMj2+srPWA1G4ujyVRpTam7cSAQKZ0/u7SK5bjCWCzpcNhEMxF5AnETHDmXkWQ5tqf11Ibh0djUE/MpnDLMQmRMApfdCNM9QfT/BRgAj7qO9qX403UAAAAASUVORK5CYII="})),this.editModel.schema={componentName:{title:t("Name"),type:"Text",validators:["required"]},componentDescription:{title:t("Description"),type:"Text"},appKey:{title:t("Url"),type:"Text",validators:["required"]}},this.$dialog=a.$el.dialog(_.extend({appendTo:e.container,title:o,classes:{"ui-dialog":"quick-dash edit-component-dialog"},resizable:!1,height:"auto",width:"auto",modal:!0,autoOpen:!0,buttons:n,drag:function(){a.form&&a.form.validate()},open:function(){$('<i class="fa fa-plus" />').insertBefore(a.$el.parent().find(".ui-dialog-title")),a.form=new BBForm({model:a.editModel}).render(),a.$el.html(T.ComponentDialog(a.editModel.toJSON())),a.$el.find(".form").append(a.form.el),a.initializeEvents(),a.$fileInput=a.$el.find(".file-input"),a.$uploadBtn=a.$el.find(".upload-btn"),a.$img=a.$el.find("img"),a.$fileInput.on("change",$.proxy(a.onFileInput,a)),a.$uploadBtn.button({icon:"fa fa-upload",text:!0}).click($.proxy(a.onUploadClick,a))},close:function(){a.remove()}},this.options))},initializeEvents:function(){this.listenTo(this.editModel,"change",this.onModelCopyChanged)},onCancelButtonClick:function(){this.$el.dialog("close"),this.remove()},onDeleteButtonClick:function(){var e=this;QuickBase.DeltaClientLib.deleteComponent(e.editModel.get("id"),function(){e.updateFn(),e.onCancelButtonClick()},function(e){alert("Todo set component error"+JSON.stringify(e))})},onFileInput:function(e){var t,i=this;0<e.target.files.length&&((t=new FileReader).onload=function(e){e=e.target.result;i.$img.attr("src",e),i.editModel.set("listViewThumb",e)},t.readAsDataURL(e.target.files[0]))},onModelCopyChanged:function(e){this.isModelChanged||(this.isModelChanged=!0,this.setSaveEnabled(this.isModelChanged))},onSaveButtonClick:function(){var e=this;e.editModel&&!e.form.validate()&&_.defer(function(){e.isModelChanged=!1,e.setSaveEnabled(e.isModelChanged),e.form.commit(),QuickBase.DeltaClientLib.setComponent(e.editModel.get("id"),e.editModel.get("componentName"),e.editModel.get("componentDescription"),e.editModel.toJSON(),function(){e.updateFn(),e.onCancelButtonClick()},function(e){alert("Todo set component error"+JSON.stringify(e))}),Log.Info("Save Component",JSON.stringify(e.editModel))})},onUploadClick:function(){this.$fileInput.click()},remove:function(){this.editModel&&(this.stopListening(this.editModel),this.editModel=null),QuickBase.ErrorTooltip.clearAll(),Backbone.View.prototype.remove.call(this)},setSaveEnabled:function(e){this.$el.next().find("button:nth-of-type(1)").button({disabled:!e})}}),ComponentsPanel=Backbone.View.extend({ITEM_HEIGHT:34,componentViews:null,sortedComponents:null,viewModel:null,initialize:function(e){this.componentViews={},this.options=e,this.sortedComponents=[],this.dialogContainer=e.dialogContainer,this.viewModel=e.viewModel,this.$el.html(T.ComponentsPanel({isLite:e.isLite})),this.$pinButton=this.$(".pin-button"),this.$componentsList=this.$el.find(".components-list"),this.$componentsListClone={},this.$clearSearch=this.$el.find(".fa-times"),this.$scrollUp=this.$el.find(".scroll-up"),this.$scrollDown=this.$el.find(".scroll-down"),this.$searchInput=this.$el.find(".search-box input"),this.$addLink=this.$el.find("a.add"),this.initializeEvents(),this.onModelReset(this.model),String.prototype.includes||(String.prototype.includes=function(){"use strict";return-1!==String.prototype.indexOf.apply(this,arguments)})},initializeEvents:function(){var t=this;this.listenTo(this.model,"add",this.onModelAdd),this.listenTo(this.model,"remove",this.onModelRemove),this.listenTo(this.model,"reset",this.onModelReset),this.listenTo(this.viewModel,"change:componentsPinned",this.onComponentsPinnedChanged),this.$addLink.click(function(){t.onComponentEdit()}),this.$clearSearch.on("click",function(){t.$searchInput.val("").trigger("input"),t.$searchInput.focus()}),this.$clearSearch.on("keyup",function(e){13===e.keyCode&&(t.$searchInput.val("").trigger("input"),t.$searchInput.focus())}),this.$componentsList.on("scroll",function(){t.$scrollUp.toggle(0!==t.$componentsList.scrollTop()),t.$scrollDown.toggle(t.$componentsList.scrollTop()+t.$componentsList.innerHeight()<t.$componentsList[0].scrollHeight)}),this.$pinButton.on("click",function(){t.viewModel.set("componentsPinned",!t.viewModel.get("componentsPinned"))}),this.$pinButton.on("keyup",function(e){13===e.keyCode&&t.viewModel.set("componentsPinned",!t.viewModel.get("componentsPinned"))}),this.$scrollDown.on("click",function(){t.onScrollDown()}),this.$scrollDown.on("keyup",function(e){13===e.keyCode&&t.onScrollDown()}),this.$scrollUp.on("click",function(){t.onScrollUp()}),this.$scrollUp.on("keyup",function(e){13===e.keyCode&&t.onScrollUp()}),this.$searchInput.on("input",function(){t.onSearchInputEvent()}),this.$searchInput.on("keydown",function(e){27===e.keyCode&&(t.$searchInput.val(""),t.onSearchInputEvent())})},applyHighlight:function(e,t){e.html(t)},detachAll:function(){var e;for(key in this.componentViews)this.componentViews.hasOwnProperty(key)&&(_.isUndefined(this.componentViews[key].options.sort)?(e=this.sortedComponents.length,this.sortedComponents[+e]=this.componentViews[key].$el.detach()):this.sortedComponents[this.componentViews[key].options.sort]=this.componentViews[key].$el.detach())},highlight:function(e,o){var a=this,s=e.item.$el,l=e.matches;this.unhighlight(s);try{_.each(["name","description"],function(e){var t=s.find("."+e),i=t.text(),n=new RegExp("("+o+")","gi"),i=i.replace(n,"<mark>$1</mark>");a.applyHighlight(t,i),!i.includes("<mark>")&&"description"!=e&&l.length&&_.each(l,function(e){i=a.highlightFuzzyMatches(i,e)})})}catch(e){}},highlightFuzzyMatches:function(e,t){for(var i,n,o=t.indices,a=(t.value,e),s=o.length-1;0<=s;s--)t.key.includes("componentDescription")||(n=o[s][0],i=o[s][1]+"<mark>".length+1,a=(a=a.substr(0,n)+"<mark>"+a.substr(n)).substr(0,i)+"</mark>"+a.substr(i));return a||e},highlightTags:function(e,t){_.each(e.find(".ui-widget-content"),function(e){-1<$(e).html().toLowerCase().indexOf(t.toLowerCase())?$(e).addClass("marked"):$(e).removeClass("marked")})},unhighlight:function(e){e.find("mark").contents().unwrap()},onSearchInputEvent:function(){var e=this.$searchInput.val();this.$clearSearch.toggle(!_.isEmpty(e)),this.filter(this.$searchInput.val())},filter:function(t){if(t){this.detachAll();var e=_.map(this.componentViews,function(e,t){return e}),e=new Fuse(e,{distance:100,includeMatches:!0,includeScore:!0,keys:["model.attributes.componentName","model.attributes.componentDescription","model.attributes.tags"],location:0,maxPatternLength:32,minMatchCharLength:2,shouldSort:!0,threshold:.6}),i=t.toLowerCase(),e=e.search(t.toLowerCase()),n=_.map(e,function(e){return e.item.el}),n=_.flatten(_.map(n,_.bind(function(t){return _.filter(this.sortedComponents,function(e){return"component-header"!==e[0].className&&e[0]===t})},this)));_.each(n,_.bind(function(e){this.$componentsList.append(e)},this)),_.each(e,_.bind(function(e){this.highlight(e,t),e.item.$el.removeClass("showTags"),_.some(e.item.model.get("tags"),function(e){return-1<e.indexOf(i)})&&(e.item.$el.addClass("showTags"),this.highlightTags(e.item.$el,t))},this))}else{for(key in this.componentViews)this.componentViews.hasOwnProperty(key)&&(this.unhighlight(this.componentViews[key].$el),this.componentViews[key].$el.removeClass("showTags"));_.each(this.sortedComponents,_.bind(function(e){this.$componentsList.append(e)},this))}},onComponentEdit:function(e){var t=this;new ComponentDialog({container:t.dialogContainer,updateFn:function(){t.updateUserComponents()},model:e})},onComponentsPinnedChanged:function(){var e=this;this.viewModel.get("componentsPinned")?(this.$pinButton.find("i").removeClass("fa-caret-right").addClass("fa-caret-left"),this.$el.removeClass("unpinned"),_.delay(function(){e.$searchInput.focus()},100)):(this.$pinButton.find("i").removeClass("fa-caret-left").addClass("fa-caret-right"),this.$el.addClass("unpinned"))},onModelAdd:function(e){var t,i=this,n=(/^data/gi.test(e.get("listViewThumb"))&&(t=e.get("listViewThumb"),e.set("listViewThumb",'<img src="'+e.get("listViewThumb")+'" />')),e.attributes.class),o="component-header"===n,o=new ComponentListView({attributes:{draggable:!o,class:o?n:"component"},model:e,dblclick:e.get("user")?function(e){i.onComponentEdit(e)}:void 0,onDragEnd:this.options.onDragEnd,onDragStart:this.options.onDragStart,sort:e.get("index")});this.componentViews[e.id]=o,this.$componentsList.append(o.el),t&&e.set("listViewThumb",t)},onModelRemove:function(e){var t=this.componentViews[e.id];t&&(t.remove(),delete this.componentViews[e.id])},onModelReset:function(e,t){var i=this,n=0;t&&t.previousModels&&_.each(t.previousModels,function(e){i.onModelRemove(e)}),e.each(function(e){e.get("hidden")||(e.set("index",n++),i.onModelAdd(e))})},onScrollDown:function(){this.$componentsList.scrollTop(this.$componentsList.scrollTop()+this.ITEM_HEIGHT)},onScrollUp:function(){this.$componentsList.scrollTop(this.$componentsList.scrollTop()-this.ITEM_HEIGHT)},updateUserComponents:function(){var t=this;QuickBase.DeltaClientLib.getComponents(function(e){t.model.remove(t.model.where({user:!0})),_.each(e,function(e){e=$.parseJSON(e.dataJSON);e.user=!0,t.model.add(e)})},function(e){Log.Error("DeltaClientLib.getComponents: Error",e)})}}),AppRouter=Backbone.Router.extend({createNewDashboardIfNotFound:!1,model:null,previousRoutes:null,viewModel:null,app:null,routes:{":dashboardId(/)(:screenId)":"onDashboard"},initialize:function(e){this.model=e.model,this.viewModel=e.viewModel,this.dialogContainer=e.dialogContainer,this.createNewDashboardIfNotFound=e.createNewDashboardIfNotFound,this.app=e.app,this.previousRoutes=[],this.model.get("onNavigate")&&(this.navigate=this.model.get("onNavigate")),this.initializeEvents()},initializeEvents:function(){this.on("route",function(){this.previousRoutes.push(Backbone.history.fragment)})},getViewstateFromQueryString:function(e){e=/(^|&)([^&;]+?)(&|;|$)/.exec(e);return e?JSON.parse(decodeURIComponent(e[2])):null},navigateToDash:function(e,t,i){var n,o,a=this,s=this.viewModel.get("selectedDocumentId"),l=this.model.get("documents").get(e);!l&&this.createNewDashboardIfNotFound?this.app.createDashboard(e,new URL(document.location.href).searchParams.get("title")).then(function(e){a.navigateToDash(e,t,i)}).catch(function(){Log.Error("dashboard NOT found (???)"),a.navigate(a.model.get("documents").first().id,{trigger:!0})}):l?(n=(o=new URLSearchParams(i)).get("page"),o=o.get("viewstate"),o=this.getViewstateFromQueryString(o),this.viewModel.set("incomingViewState",o,{silent:!0}),this.viewModel.set("page",n,{silent:!0}),s===e&&o&&this.viewModel.trigger("processIncomingViewState",l),this.viewModel.set({selectedDocumentId:e,selectedScreenId:t})):(Log.Error("dashboard NOT found (?)"),s?Log.Error("dashboard doesn't exist or user doesnt have required permissions. (2)"):0<this.model.get("documents").length?this.navigate(this.model.get("documents").first().id,{trigger:!0}):(Log.Error("dashboard doesn't exist or user doesnt have required permissions. (1)"),$(document).find(".loadingScreen").css({display:"none"}),this.dialog=$("<div>The Selected dashboard does not exist or user does not have required permissions or no dashboards are permissioned to this user.</div>").dialog({autoOpen:!0,height:350,width:350,modal:!0,title:"Error loading Dashboard"})))},onDashboard:function(t,i,n){var e=this.viewModel.get("selectedDocumentId"),o=this.model.get("documents").get(e);if(o){var a=[];if(_.each(QuickBase.ComponentView.getInstances(),function(e){e=e.beforeRemove();e&&e.callback&&a.push(e)}),t!==e&&(o.get("wasChanged")||!_.isEmpty(a)))return this.model.get("embedded")?(o.save(),this.navigateToDash(t,i,n),void(this.previousRoutes=[Backbone.history.fragment])):void new QuickBase.AreYouSureDialog({components:a,container:this.dialogContainer,dashChanged:o.get("wasChanged"),model:o,userClass:"quick-dash"}).on("close",function(e){"cancel"===e?(this.previousRoutes.pop(),this.navigate(_.last(this.previousRoutes),{replace:!0}),this.onNavCancel&&(this.onNavCancel(),this.onNavCancel=null)):(this.navigateToDash(t,i,n),this.previousRoutes=[Backbone.history.fragment])}.bind(this))}this.navigateToDash(t,i,n)}}),ContentPanel=Backbone.View.extend({$contentPanel:null,$el:null,appModel:null,contentToolbar:null,currentWidgetCopy:null,documentView:null,keyIndex:0,widgetsView:[],viewModel:null,CSS_COPIED:"copied",CSS_NOT_COPIED:"not-copied",KEYCODE_C:67,KEYCODE_DEL:46,KEYCODE_V:86,KEYCODE_X:88,initialize:function(e){var i=this;this.appModel=e.appModel,this.viewModel=e.viewModel,this.$el.toggleClass("open",this.appModel.get("showBreadcrumbs")),this.listenTo(this.viewModel,"change:isInspecting",this.onIsInspectingChanged),this.listenTo(this.viewModel,"change:selectedDocumentId",this.onSelectedDocumentChanged),this.listenTo(this.viewModel,"change:selectedScreenId",this.onSelectedScreenChanged),this.listenTo(this.appModel,"change:propertiesPinned",this.onPropertiesPinnedChanged),this.listenTo(this.viewModel,"change:componentsPinned",this.onComponentsPinnedChanged),this.listenTo(this.appModel,"change:showBreadcrumbs",this.onResize),this.listenTo(this.viewModel,"processIncomingViewState",function(e){this.processIncomingViewState(e)}),this.$el.on("keydown",this.onKeyDown.bind(this)),this.$el.on("focusout",function(e){i.keyIndex=0,i.widgetsView=[i.documentView.screenView.widgets]}),this.listenTo(this.viewModel,"change:selectedWidget",function(e){e._previousAttributes.selectedWidget&&(e=(e=e._previousAttributes.selectedWidgetView.$el.parent()).data("widgetid")?e:e.parent()).removeClass(this.CSS_COPIED),_.defer(function(){$(".content-panel:visible:last").focus()})}.bind(this)),this.showLoadingScreen(t("loading dashboard")+"...")},downloadDash:function(e){var n=this;e.fetch({success:function(e){var t;n.hideLoadingScreen(),e.get("screens").length<=0&&(t=new QuickBase.Screen({},{},e.get("screens")),e.get("screens").add(t),n.viewModel.set("selectedScreenId",t.id)),e.trigger("detail-downloaded"),e.trigger("view-state-init",n.appModel.get("embedded")),e.set("wasChanged",!1),n.resetDocumentView(e),n.processIncomingViewState(e)},error:function(e,i){n.hideLoadingScreen(),alert(i&&"string"==typeof i?i:t("connection error while downloading dashboard"))},silent:!0})},generateThumb:function(){this.documentView.screenView.regenerateThumb()},hideLoadingScreen:function(){this.$loadingScreen&&(this.$loadingScreen.$el.fadeOut(function(){$(this).remove()}),this.$loadingScreen=null)},onKeyDown:function(e){var t,i,n=this,o=this,a=e.keyCode;if($(e.target).hasClass("content-panel")){if(!this.appModel.get("userName"))return!1;if(a===this.KEYCODE_DEL)this.removeSelectedWidget();else if(e.ctrlKey||e.metaKey)switch(a){case this.KEYCODE_V:this.viewModel.get("buildMode")&&($(document).one("paste",$.proxy(this.onPaste,this)),this.$el.attr("contenteditable",!0),this.$el.focus());break;case this.KEYCODE_C:case this.KEYCODE_X:this._copying||(this._copying=!0,this.onCopy(),this._copy&&this.copy(this._copy,function(e){var t,i=o.viewModel.get("selectedWidgetView");i&&!(t=i.$el.parent()).data("widgetid")&&(t=t.parent()),e?a===o.KEYCODE_X?o.removeSelectedWidget():t&&t.addClass(o.CSS_COPIED):t&&(t.addClass(o.CSS_NOT_COPIED),setTimeout(function(){t.removeClass(o.CSS_NOT_COPIED)},1e3)),o.$el.focus(),o._copying=!1}))}else"ArrowLeft"===e.key||"ArrowRight"===e.key?(e.preventDefault(),e.stopPropagation(),this.widgetsView.length||(this.widgetsView=[this.documentView.screenView.widgets]),t=this.widgetsView[this.widgetsView.length-1],this.viewModel.get("selectedWidget")&&-1<(i=t.findIndex(function(e){return e.widgetId===n.viewModel.get("selectedWidget").id}))&&this.keyIndex!==i&&(this.keyIndex=i),"ArrowLeft"===e.key?this.keyIndex=(this.keyIndex-1+t.length)%t.length:"ArrowRight"===e.key&&(this.keyIndex=(this.keyIndex+1)%t.length),this.setSelectedWidget(t[this.keyIndex])):this.viewModel.get("selectedWidget")&&(" "===e.key||"Enter"===e.key?(i=this.viewModel.get("selectedWidgetView"),-1!==["Panel","FlexPanel","OverlayPanel"].indexOf(i.key)&&null!=(t=i.app.widgets)&&t.length?this.addToWidgetsView(i.app.widgets):"Tabs"===i.key?this.addToWidgetsView([i.app.currentTabItem.widgetItem]):"Accordion"===i.key&&this.addToWidgetsView(i.app.getWidgets())):"Escape"===e.key&&1<this.widgetsView.length&&this.removeFromWidgetsView())}},addToWidgetsView:function(e){this.widgetsView.push(e),this.keyIndex=0,this.setSelectedWidget(e[0])},setSelectedWidget:function(e){this.viewModel.set("selectedWidget",e.model),this.viewModel.set("selectedWidgetView",e.view,{silent:!0})},removeFromWidgetsView:function(){this.widgetsView.pop();var t=this.viewModel.get("selectedWidget"),e=(this.viewModel.get("selectedWidget"),this.widgetsView[this.widgetsView.length-1]),i=null==(n=null==(n=null==(n=t.parent)?void 0:n.parent)?void 0:n.parent)?void 0:n.id,n=e.find(function(e){return e.widgetId===i});i=i||(null==(n=e.filter(function(e){return"Tabs"===e.view.key}).find(function(e){return e.view.app.currentTabItem.widgetItem.widgetId===t.id}))?void 0:n.widgetId),n&&this.setSelectedWidget(n)},onCopy:function(){var t,i,e,n={},o=this,a=this.viewModel.get("selectedWidget");a&&((e=this.viewModel.get("selectedWidgetView"))&&e.$el&&(0===(e=e.$el).height()&&(e=e.closest("[data-widgetid]")),n._widgetSize=[e.width(),e.height()]),n._widget=a.toJSON(),i=CopyPasteHelpers.getComponentViewStates(a.attributes.component),n._dataSources=_.extend(CopyPasteHelpers.getComponentDataSources(a.attributes.component,i,o.documentView.model.get("data")),CopyPasteHelpers.getMappingDataSources(i,o.documentView.model)),n._viewState={},_.each(i,function(e){(t=o.documentView.model.get("viewState").getByPath(e))&&(n._viewState[e]=t.toJSON(),"dict"===t.get("_type"))&&(n._viewState[e]._default=_.mapValues(t.get("_default"),function(e){var t;return e instanceof Backbone.Model?(_.includes(i,e.path)||n._viewState[e.path]||(t=o.documentView.model.get("viewState").getByPath(e.path))&&(n._viewState[e.path]=t.toJSON()),"<%"+e.path+"%>"):e}))}),this._copy=JSON.stringify(n))},onPaste:function(e){var t,i;if(e.stopPropagation(),e.preventDefault(),this.$el.removeAttr("contenteditable"),(e=e.originalEvent.clipboardData||window.clipboardData)&&(t=e.getData("Text"))){try{if(!(t=JSON.parse(t))._widget)return;this.appModel.set("copiedWidgetSize",t._widgetSize),i=t._widget,CopyPasteHelpers.mergeViewStates(t._viewState,this.documentView.model);var n={},o={};if(_.each(t._dataSources,function(e,t){"virtual"===e._dataType?o[t]=e:n[t]=e}),CopyPasteHelpers.mergeDataSources(n,this.documentView.model),CopyPasteHelpers.mergeDataSources(o,this.documentView.model),this.documentView.applyDataSources(),!i.component||!i.id||!i.layout)return void(i=null)}catch(e){return void console.log("something is wrong with the widget",e)}this.documentView&&i&&this.documentView.pasteWidget(new QuickBase.Widget(i))}},copy:function(e,t){var i,n;if(navigator.clipboard)navigator.clipboard.writeText(e).then(function(){$("window").focus(),t&&t(!0)},function(e){$("window").focus(),t&&t(!1)});else{(i=$(document.createElement("textarea"))).css({position:"absolute",width:0,height:0,top:0,left:0}),i[0].value=e,i.appendTo(this.$el),i[0].focus(),i[0].select();try{document.execCommand("SelectAll")&&(n=document.execCommand("copy",!1,null))}catch(e){console.log(e)}i.remove(),$("window").focus(),t&&t(n)}},processIncomingViewState:function(i){var e=this,t=this.viewModel.get("incomingViewState");t&&(_.each(t,function(e,t){".settings"!==t&&(t=i.get("viewState").getByPath(t))&&t.set("value",e)}),_.delay(function(){e.viewModel.unset("incomingViewState")},500))},resetDocumentView:function(e){this.documentView&&(this.documentView.remove(),this.documentView=null),this.documentView=new QuickBase.DocumentView({appModel:this.appModel,model:e,viewModel:this.viewModel}),this.$el.append(this.documentView.$el)},onIsInspectingChanged:function(){this.$el.toggleClass("inspecting",this.viewModel.get("isInspecting"))},onComponentsPinnedChanged:function(){var e=this;this.viewModel.get("componentsPinned")?(this.$el.removeClass("components-unpinned"),this.onResize()):(this.$el.addClass("components-unpinned"),_.defer(function(){e.onResize()}))},onPropertiesPinnedChanged:function(){var e=this;this.appModel.get("propertiesPinned")?(this.$el.removeClass("unpinned"),this.onResize()):(this.$el.addClass("unpinned"),_.defer(function(){e.onResize()}))},onResize:function(){this.$el.toggleClass("open",this.appModel.get("showBreadcrumbs")),this.documentView&&this.documentView.onResize()},onSelectedDocumentChanged:function(){var e;this.currentWidgetCopy=null,e=this.viewModel.get("selectedDocumentId"),this.documentView&&this.documentView.remove(),e&&((e=this.appModel.get("documents").get(e))?(this.showLoadingScreen(t("loading")+" "+e.get("name")+"..."),this.downloadDash(e)):this.viewModel.set("selectedDocumentId",null))},removeSelectedWidget:function(){var e=this.viewModel.get("selectedWidget");e&&e.trigger("removeWidget")},showLoadingScreen:function(e){this.$loadingScreen||this.appModel.get("embedded")||(this.$loadingScreen=new LoadingScreen({loadingText:e}),this.$loadingScreen.$el.appendTo($("body")))}}),AppModel=function(o){function e(e){var t,i=o.call(this,e)||this,n=[];for(t in e.versions)e.versions.hasOwnProperty(t)&&n.push({key:t,value:e.versions[t]});return i.set({api:e.api,components:new QuickBase.ComponentDefinitionCollection,documents:e.documents,PackageName:e.PackageName,paths:_.sortBy(n,"key"),publisherUrl:e.publisherUrl,websiteUrl:e.websiteUrl}),i.listenTo(i,"change:showBreadcrumbs",function(){return $.cookie("dashboard-breadcrumbs",i.get("showBreadcrumbs"),{expires:90,secure:!0,path:"/;SameSite=Strict"})}),i}return __extends(e,o),e.prototype.defaults=function(){return{api:null,CanExecuteQueries:!0,components:null,deltaClient:null,documents:null,language:"en",publisherUrl:null,smartDrop:!0,websiteUrl:null,userName:null,paths:null,propertiesPinned:!0,isHelpDialogTabbed:!0,showBreadcrumbs:"false"!==$.cookie("dashboard-breadcrumbs"),hasPermission:function(){return!0},dashEngine:null}},e}(Backbone.Model),DocumentImporter=function(e,t){this.appModel=e,this.viewModel=t},ViewstateAdapter=(_.extend(DocumentImporter.prototype,Backbone.Events,{doImport:function(e,t){function n(){var e;0===--i&&_.isFunction(t)&&(t(),s)&&o&&(r===o?a.viewModel.set("selectedDocumentId",o):(e=a.appModel.get("sendSignal"))&&e({type:"load",param:[o,c]}))}var o,a=this,i=e.length,s=!!this.appModel.get("embedded"),l={silent:s},r=a.viewModel.get("selectedDocumentId"),c=!1;_.each(e,_.bind(function(e){var t=e.data.id,i=this.appModel.get("documents").get(t);i&&"replace"===e.data.action?(this.appModel.get("documents").remove(t,l),s&&this.viewModel.set("selectedDocumentId",null),this.appModel.get("documents").add(e.data),(i=this.appModel.get("documents").get(t)).save(i.attributes,{success:function(){s&&(o=t),n()},error:function(e){QuickBase.Log.Error(e),n()}},this)):"add"===e.data.action?(this.appModel.get("documentAPI")&&(e.data.notSavedYet=!0),this.appModel.get("documents").add(e.data),i=this.appModel.get("documents").get(t),s&&a.appModel.get("documents").remove(t,l),i.save(i.attributes,{success:function(e){s&&(c=!0,o=e.id),n()},error:function(e){QuickBase.Log.Error(e),n()}})):n()},this))},importCheck:function(o,a){var s=this,l=[],r=_.cloneDeep(o),c=function(){var e,i,n;0===r.length?s.doImport(l,a):(i=r.splice(0,1)[0],s.appModel.get("documents").get(i.data.id)?e=new MessageDialog({title:t("Confirm Replace"),classes:{"ui-dialog":"replace-dash-dialog"},message:t('Dashboard "'+i.data.name+'" with id "'+i.data.id+'" already exists!<br><br>"Are you sure you would like to replace this dashboard?<br><br>'),check:t(" Apply this action to all existing Dashboards"),buttons:[{text:t("Replace"),click:function(){e.close(),e.$el.find('input[type="checkbox"]').is(":checked")?(_.each(o,function(e){n=s.appModel.get("documents").get(e.data.id),e.data.action=n?"replace":"action"}),l=l.concat(o),r=[]):(i.data.action="replace",l.push(i)),c()}},{text:t("Skip"),click:function(){e.close(),e.$el.find('input[type="checkbox"]').is(":checked")?r=[]:(i.data.action="skip",l.push(i)),c()}},{text:t("Cancel"),click:function(){e.close()}}]}):(i.data.action="add",l.push(i),c()))};c()},importFiles:function(l,r,c){var d,u=this,l=l||[],p=[];_.each(l,function(s){var e=new FileReader;e.onload=function(e){try{var t=e.target.result,i=void 0,n=void 0,o=void 0;"text/xml"===s.type?(a=$.parseXML(t),o=(n=$(a)).find("data"),(i=JSON.parse(o.text().replace(/&gt;/g,">").replace(/&gt;/g,"<").replace(/&amp;/g,"&"))).id=n.find("name").text()):i=JSON.parse(t),s.data=i,p.push(s),d=d||i.id,l.length===p.length&&u.importCheck(p,function(){_.isFunction(r)&&r(d)})}catch(e){var a="Import Error: parsing "+s.name;QuickBase.Log.Error(a),_.isFunction(c)&&c(a)}},e.readAsText(s)})}}),function(o){function e(e,t,i){var n=o.call(this)||this;return n.dashboardModel=null,n.sendSignal=e.get("sendSignal")||_.noop,n.appViewModel=t,n.listenTo(n.appViewModel,"change:selectedDocumentId",n.resetDashboardModel),n.contentPanel=i,n}return __extends(e,o),e.prototype.resetDashboardModel=function(){this.dashboardModel&&this.stopListeningToViewstateTreeChanges(this.dashboardModel.get("viewState")),this.dashboardModel=null},e.prototype.stopListeningToViewstateTreeChanges=function(e){this.stopListening(e)},e.prototype.startListeningToViewstateTreeChanges=function(e){this.listenTo(e,"change",function(e){e instanceof QuickBase.DocumentViewModel&&e.hasChanged("value")&&this.sendSignal({type:"viewState",param:{action:"valueChanged",path:e.path,value:e.get("value")}})})},e.prototype.getDashboardModel=function(){var e;return this.dashboardModel||(null!=(e=this.contentPanel.documentView)&&e.model?this.dashboardModel=this.contentPanel.documentView.model:console.error("Viewstate Adapter: dashboard not loaded")),this.dashboardModel},e.prototype.splitFullPath=function(e){e=/(.+\/)*(.*)/.exec(e);return[(e[1]||"").replace(/\/$/,""),e[2]]},e.prototype.getModelFromPath=function(e){var t=this.getDashboardModel().get("viewState");return e?t.getByPath(e):t},e.prototype.convertFromParameter=function(i){return Object.keys(i).reduce(function(e,t){return e[{type:"_type",default:"_default",listtype:"_listtype",viewType:"_viewType",rolling:"_rolling"}[t]||t]=i[t],e},{})},e.prototype.convertToParameter=function(i){return Object.keys(i).reduce(function(e,t){return e[{_type:"type",_default:"default",_listtype:"listtype",_viewType:"viewType",_rolling:"rolling"}[t]||t]=i[t],e},{})},e.prototype.convertViewStateTreeToParameterTree=function(e){function n(e){var i=e.toJSON(!0);return Object.keys(i).forEach(function(e){var t=i[e];t instanceof QuickBase.DocumentViewModel?i[e]=n(t):t instanceof Object&&(i[e]=o.convertToParameter(t))}),i}var o=this,e=n(e);return _.omit(e,[".settings"])},e.prototype.processSignal=function(e){var t;if("viewState"===e.type&&(t=this.getDashboardModel())){var i,n=t.get("viewState"),o=e.param||[],a=o[0],s=void 0,l=void 0,r=void 0,c=void 0;switch(e.action){case"change":(i=n.getByPath(a))&&i.set(this.convertFromParameter(o[1]));break;case"create":var s=(r=this.splitFullPath(a))[0],l=r[1],c=this.getModelFromPath(s),d=o[1]?this.convertFromParameter(o[1]):void 0;c.set(l,new QuickBase.DocumentViewModel(d,void 0)),c.trigger("materialChange"),d&&void 0!==(d=d.value)&&c.get(l).set("value",d),n.getViewStateList();break;case"delete":s=(r=this.splitFullPath(a))[0],l=r[1],(c=this.getModelFromPath(s)).unset(l),c.trigger("materialChange");break;case"rename":s=(r=this.splitFullPath(a))[0],l=r[1],c=this.getModelFromPath(s),i=c.get(l),c.unset(l);var u,p=o[1],d=this.splitFullPath(p)[1],h=(c.set(d,i),c.trigger("materialChange"),i.path);p!==h&&(i.path=p,u=new RegExp("^"+h),i.getViewStateList().forEach(function(e){e=e.model;e.path&&(e.path=e.path.replace(u,p))}),t.get("data").getTreeList().forEach(function(e){e.updateParameterPath("vs",h,p,i.isGroup())})),n.getViewStateList();break;case"getAll":d=this.convertViewStateTreeToParameterTree(n);return this.startListeningToViewstateTreeChanges(n),d}}},e}(CustomEvents)),DocumentViewModel=QuickBase.DocumentViewModel,CommandsProxy=function(n){function e(e,t){var i=n.call(this)||this;return i.sendSignal=e.get("sendSignal")||_.noop,i.appViewModel=t,i.listenTo(i.appViewModel,"change:commandIndex",i.sendChangesSignal.bind(i)),i}return __extends(e,n),e.prototype.sendChangesSignal=function(e){"RESET"!==e&&this.sendSignal({type:"commandIndex",param:{documentId:this.appViewModel.get("selectedDocumentId"),changes:{commandIndex:this.appViewModel.get("commandIndex"),commands:this.appViewModel.get("commands")}}})},e.prototype.applyChanges=function(t,e){e.commands.forEach(function(e){t.postCommand(null,e)}),e.commandIndex<e.commands.length-1&&this.appViewModel.goToCommandIndex(e.commandIndex)},e}(CustomEvents),Notificator=Backbone.View.extend({className:"notificator",initialize:function(e){this.appModel=e.appModel,this.render()},notify:function(e,t){this.$title.text(e),this.$items.append(t),this.$panel.fadeIn("slow")},onClose:function(){var e=this;this.$panel.fadeOut("slow",function(){e.$items.html("")})},render:function(){return this.$el.addClass(this.className),this.$el.html(T.Notificator()),this.$title=this.$(".title"),this.$items=this.$(".items"),this.$panel=this.$(".panel"),this.$close=this.$(".close-button"),this.$close.button({showLabel:!1,icon:"fa fa-times"}).click($.proxy(this.onClose,this)),this.$panel.hide(),this}}),FailedLoginsNotification=Backbone.View.extend({className:"failed-logins",initialize:function(e){this.appModel=e.appModel,this.render()},render:function(){var e=this.model.toJSON();return _.each(e.rows,function(e){var t=Tools.convertKDBTemporalToMoment(e.time);e.time=t.format("YYYY-MM-DD HH:mm:ss"),e.timeSort=t.valueOf()}),e.rows=_.sortBy(e.rows,"timeSort").reverse(),$(this.$el).css("max-height",$(".quick-base").height()/2),this.$el.addClass(this.className),this.$el.html(T.FailedLoginsNotification(e)),this}}),BreadcrumbsWrapper=Backbone.View.extend({initialize:function(e){var o=this;this.appModel=e.appModel,this.viewModel=e.viewModel,this.componentDefinition=Breadcrumbs.getComponentDefinition({websiteUrl:this.appModel.get("websiteUrl"),settingsModel:new Backbone.Model}),this.app=new Breadcrumbs({el:this.$el,websiteUrl:this.appModel.get("websiteUrl"),settingsModel:this.componentDefinition,api:{setProperty:function(e,t){var i,n=[];t?("Basic.Path"===e&&(n=t.split(",")),(i=o.currentPath?o.currentPath.items[n.length-1]:i)&&o.appModel.set("pendingSelectionWidgetId",i.widgetId)):(o.viewModel.set("selectedWidget",null),o.viewModel.set("selectedWidgetView",null,{silent:!0}))}},disableSortable:!0}),this.listenTo(this.viewModel,"change:selectedWidget",this.onSelectedWidgetChanged),this.listenTo(this.viewModel,"change:componentsPinned",this.onComponentsPinnedChanged),this.onSelectedWidgetChanged()},findWidget:function(e,t,i){if(i=i||{value:"",items:[]},e.includes(t)||t.get("component")&&e.includes(t.get("component")))return(component=this.appModel.get("components").get(t.get("component").get("definitionId"))||this.appModel.get("components").find({appKey:t.get("component").get("key")}))&&(i.value+=component.get("componentName")),i.items.push(t),i;for(var n=0;n<e.length;n+=1){var o=e.at(n),a=null,s=null;if(o.get("component")?(s=o.get("id"),o=o.get("component")):s=$("#"+o.get("containerId")).attr("data-widgetId"),(!(a=o.get("widgets"))||a.length<=0)&&(a=o.get("components")||a),o.widgetId=s,a){var s={value:"",items:[]},l=(s.value+=(null==(l=this.appModel.get("components").find({appKey:o.get("key")}))?void 0:l.get("componentName"))+",",s.items.push(o),this.findWidget(a,t));if(l&&l.value)return i.value+=s.value+l.value,i.items=i.items.concat(s.items.concat(l.items)),i}}},findWidgetFromPopups:function(e,t){var i,n=this;return e.each(function(e){if(i=n.findWidget(e.get("widgets"),t))return!1}),i},onComponentsPinnedChanged:function(e,t){this.$el.parent().toggleClass("left-open",t)},onSelectedWidgetChanged:function(){var e,t,i=this.viewModel.get("selectedWidget");i?(t=(e=this.appModel.get("documents").get(this.viewModel.get("selectedDocumentId"))).get("screens").get(this.viewModel.get("selectedScreenId")),(t=(t=this.findWidget(t.get("widgets"),i))||this.findWidgetFromPopups(e.get("popups"),i))&&t.value&&(this.currentPath=t,this.app.onSettingsChange({"Basic.Breakdown":t.value.split(","),"Basic.Path":t.value.split(",")}))):(this.currentPath=null,this.app.onSettingsChange({"Basic.Breakdown":[],"Basic.Path":[]}))}}),Tools=QuickBase.Tools,App=Backbone.View.extend({DOCUMENT_TITLE:{SEPARATOR:" - ",SUFFIX:"Dashboards"},THEMES:[{id:"kx-darkroom",name:"Dark"},{id:"kx-light",name:"Light"}],$documentDialogPanel:null,$dropzone:null,$environmentDialogPanel:null,$propertiesPanelDiv:null,componentsPanel:null,contentPanel:null,DeltaClientLogin:!1,dropzoneAdded:!1,environmentTheme:null,observer:null,propertiesPanel:null,toolbar:null,viewModel:null,appid:"dashboards",historyStarted:!1,initialize:function(t){var a=this,i=[32,99,1001,1002,1006,1010];-1!=document.location.href.indexOf("auth=saml")&&(this.saml=!0),QuickBase.Helpers.preventBackspaceBack(),QuickBase.DocumentCollection.requiredAccessLevel="update",s=-1!==document.location.pathname.indexOf(".")?document.location.pathname.substr(0,document.location.pathname.lastIndexOf("/")+1):document.location.pathname,t.hideToolbar&&this.$el.addClass("toolbarHidden"),t.embedded&&(this.$el.addClass("embedded"),i.push(1035),i.push(1019),i.push(10254),i.push(79),i.push(1013),i.push(1003)),t.embedded||(n=(o=t.isLite?QuickBase.DashClientLib:QuickBase.DeltaClientLib).documentSync,e=o.documentCollectionSync,t.documentAPI&&(n=QuickBase.DocumentSyncHelpers.buildDocumentSync(t.documentAPI,n),e=QuickBase.DocumentSyncHelpers.buildDocumentCollectionSync(t.documentAPI)),QuickBase.Document.prototype.sync=n,QuickBase.DocumentCollection.prototype.sync=e,QuickBase.Connection.prototype.sync=o.connectionSync,QuickBase.ConnectionCollection.prototype.sync=o.connectionCollectionSync,t.isLite?(_.extend(QuickBase.DocumentDataModel.prototype,o),QuickBase.DeltaClientLib.PIVOT_SOURCE_CODE=o.PIVOT_SOURCE_CODE):(QuickBase.ConnectionGroup.prototype.sync=o.connectionGroupSync,QuickBase.ConnectionGroupCollection.prototype.sync=o.connectionGroupCollectionSync,QuickBase.Service.prototype.sync=o.servicesSync,QuickBase.ServiceCollection.prototype.sync=o.servicesCollectionSync));var n=(_.get(t,"PackageName","").match(/\d*\.\d*/g)||[])[0]||"",e="dashboards",o="//"+document.location.host+s,s=(t.isLite?"https://docs.kx.com/".concat(n?n+"/":""):"".concat(o.split("/edit")[0],"/docs/")).concat(e);this.model=new AppModel(_.extend(t,{api:"".concat(o,"api/"),websiteUrl:o,saml:this.saml,documents:QuickBase.DocumentCollection.singleton||new QuickBase.DocumentCollection,components:t.isLite?_.filter(t.components,function(e){return-1==i.indexOf(e.id)}):t.components,connections:new QuickBase.ConnectionCollection,connectionGroups:t.isLite?null:new QuickBase.ConnectionGroupCollection,services:t.isLite?null:new QuickBase.ServiceCollection,DocsUrl:s})),QuickBase.Helpers.setCalendarPath(this.model.get("paths")),t.isLite&&this.$el.addClass("is-lite"),this.viewModel=new QuickBase.AppViewModel(_.pick(t,"buildMode")),this.documentImporter=new DocumentImporter(this.model,this.viewModel),this.model.documentImporter=this.documentImporter,"FSBL"in window&&this.finsembleInitEvents(),this.$el.addClass("quick-dash quick-base main-app buildMode"),n=function(e){a.$el.html(T.app()),a.$notificationsDiv=a.$(".notifications-div"),a.notificator=new Notificator({el:a.$notificationsDiv}),a.$documentDialogPanel=a.$el.find("> .dialog-panel .document"),a.$environmentDialogPanel=a.$el.find("> .dialog-panel .environment"),$.extend($.ui.dialog.prototype.options,{appendTo:a.$documentDialogPanel}),a.toolbar=new MainToolbar({el:a.$el.find("> .toolbar"),appModel:a.model,dialogContainer:a.$environmentDialogPanel,themes:a.THEMES,viewModel:a.viewModel}),a.componentsPanel=new ComponentsPanel({el:a.$el.find("> .components-panel"),dialogContainer:a.$environmentDialogPanel,model:a.model.get("components"),onDragEnd:function(){$(".ui-dialog-content:visible>.content-panel").removeClass("outlined"),a.contentPanel.$el.removeClass("outlined"),a.model.unset("draggedComponentId")},onDragStart:function(e){var t=$(".ui-dialog-content:visible>.content-panel");(t.length?t:a.contentPanel.$el).addClass("outlined"),a.model.set("draggedComponentId",e)},viewModel:a.viewModel,isLite:a.model.get("isLite")}),a.propertiesPanel=new PropertiesPanel({el:a.$el.find("> .properties-panel"),appModel:a.model,dialogContainer:a.$environmentDialogPanel,viewModel:a.viewModel}),a.listenTo(a.viewModel,"screenshot",function(){a.contentPanel.generateThumb()}),a.listenTo(a.toolbar,"openDataDialog",function(){a.propertiesPanel.showDataDialog()}),a.listenTo(a.toolbar,"openConnectionsDialog",function(){a.propertiesPanel.showConnectionsDialog()}),a.listenTo(a.toolbar,"openViewStateDialog",function(){a.propertiesPanel.showViewStateDialog()}),a.listenTo(a.toolbar,"showDocumentGraph",function(){a.propertiesPanel.showDocumentGraph()}),a.contentPanel=new ContentPanel({el:a.$el.find("> .content-panel"),appModel:a.model,deltaClient:a.deltaClient,viewModel:a.viewModel,websiteUrl:a.model.get("websiteUrl")}),a.propertiesPanel.initializeDocumentChangeEvent(),t.embedded&&(a.viewstateAdapter=new ViewstateAdapter(a.model,a.viewModel,a.contentPanel),a.commandsProxy=new CommandsProxy(a.model,a.viewModel)),a.$breadcrumbs=a.$el.find("> .breadcrumbs-div"),a.$breadcrumbs.hide(),a.onDashboardThemeChanged(),a.setThemeFromCookie(),a.model.get("hideToolbar")&&a.onHideToolbarChange(),a.viewModel.get("buildMode")||a.onBuildModeChange(null,!1),"MutationObserver"in window&&(a.observer=new MutationObserver(function(e){for(var t=0;t<e.length;t++){var i=e[t].addedNodes;if(i)for(var n=0;n<i.length;n++){var o=i[n];"ui-datepicker-div"===o.id?a.$documentDialogPanel[0].appendChild(o):_.isString(o.className)&&-1!==o.className.indexOf("select2-container")&&(-1!==o.className.indexOf("select2-container--document-selector")||-1!==o.className.indexOf("select2-container--dashboards-properties")||-1!==o.className.indexOf("select2--environment")?a.$environmentDialogPanel:a.$documentDialogPanel)[0].appendChild(o)}}}),a.observer.observe(document.querySelector("body"),{attributes:!1,childList:!0,characterData:!1})),a.model.get("components").reset(t.components),t.deltaToken=t.deltaToken||$.cookie("deltaToken"),a.model.get("isLite")?t.embedded||(QuickBase.DashClient.client=t.dashClient||new QuickBase.DashClient(t),QuickBase.DeltaClientLib=QuickBase.DashClient):a.saml?a.initializeDeltaClient(null,null,function(e){alert(e)},null,!0):t&&t.delta?(a.model.set({userName:t.delta.username,DeltaClientHost:t.delta.options.host,DeltaClientPort:t.delta.options.port,DeltaClientSecure:t.delta.options.secure,DeltaClientFromUrl:t.delta.options.fromURL}),QuickBase.DeltaClientLib.initializeDeltaClientCopy(t.delta.client,a.model.get("DeltaClientHost"),a.model.get("DeltaClientPort"),a.model.get("DeltaClientSecure"),a.model.get("DeltaClientFromUrl"),t.delta.username,t.delta.password,null,function(e){alert(e)},a.appid)):t.deltaToken||t.credentials?($(QuickBase.DeltaClientLib).one("DeltaClientLogin",function(e){a.model.set("userName",QuickBase.DeltaClientLib.deltaClient.user()),t.deltaToken&&$.cookie("deltaToken",t.deltaToken,{expires:30,path:"/;SameSite=Strict",secure:"https:"===_.get(window,"location.protocol")})}),a.initializeDeltaClient(t.credentials?t.credentials.username:null,t.credentials?t.credentials.password:null,null,t.deltaToken)):a.showLogin(),a.initializeEvents(),a.fixSelect2DialogIssue(),a.model.get("isLite")&&t.dashClient&&($(t.dashClient).trigger("DeltaClientConnect"),$(t.dashClient).trigger("DeltaClientLogin")),t.onInitialized&&t.onInitialized(a)};try{QuickBase.InitializeQuickbase(n)}catch(e){Log.Error("error loading quickbase",e),t.embedded||(window.t=function(e){return e}),n()}QuickBase.Dash.DashEngine.activator(this.model,this.viewModel)},initializeEvents:function(){var o=this,a=this.model.get("isLite")?QuickBase.DashClient.client:QuickBase.DeltaClientLib;$(window).resize($.proxy(this.onResize,this)),this.listenTo(this.toolbar,"themeChange",this.setThemeFromCookie),this.listenTo(this.model.get("documents"),"remove",this.onDocumentRemoved),$(a).one("DeltaClientConnect",function(){o.contentPanel.hideLoadingScreen(),$(a).on("DeltaClientConnect",function(){o.contentPanel.hideLoadingScreen();var e=o.getCurrentDocument();e&&e.get("data").getTreeList().forEach(function(e){e.start()})})}),$(a).on("DeltaClientDisconnect",function(e,i){var n=o.getCurrentDocument();i=i?_.startCase(i)+": ":"",o.contentPanel.showLoadingScreen(i+t("reconnecting...")),n&&o.getCurrentDocument().get("data").getTreeList().forEach(function(e){e.stop()})}),$(a).one("DeltaClientLogin",$.proxy(this.onDeltaClientLogin,this)),this.listenTo(this.viewModel,"change:buildMode",this.onBuildModeChange),this.listenTo(this.model,"change:hideToolbar",this.onHideToolbarChange),this.listenTo(this.viewModel,"change:DashboardTheme",this.onDashboardThemeChanged),this.listenTo(this.viewModel,"change:selectedDocumentId",this.onSelectedDocumentChanged),this.listenTo(this.model,"change:showBreadcrumbs",this.onShowBreadcrumbs),this.$el.on("dragenter",_.bind(this.onDragEnter,this)),"FSBL"in window||(window.onbeforeunload=function(e){var t=o.getCurrentDocument(),i="There are unsaved changes in this dashboard.",n=!1;if(n=t&&(t.get("data").getTreeList().forEach(function(e){e.stop()}),t.get("wasChanged")||_.some(QuickBase.ComponentView.getInstances(),function(e){return e.beforeRemove()}))?!0:n)return(e||window.event).returnValue=i;a&&a.ws&&a.ws.close()})},initializeDeltaClient:function(i,n,o,a,s,e){var l=this;QuickBase.DeltaClientLib.initializeDeltaClient(l.model.get("DeltaClientHost"),l.model.get("DeltaClientPort"),l.model.get("DeltaClientSecure"),l.model.get("DeltaClientFromUrl"),i,n,null,function(e){var t;_.isFunction(o)?o(e):(t=_.isString(e)?e.toLowerCase():null,"loginRequired"===e?l.showLogin():"userSessionLimit"===e?l.showForceLoginPrompt(function(){l.initializeDeltaClient(i,n,o,a,s,!0)}):(t&&_.some(["login","token","session","websocket"]),l.showLogin(e)))},a,l.appid,!0,!!s,!!e)},initializeDropzone:function(){this.$dropzone=$("<form />"),this.$dropzone.addClass("simpleDropzone"),this.$dropzone.appendTo(this.$el),this.dropzone=new DropzoneView({el:this.$dropzone,documentImporter:this.model.documentImporter,router:this.router}),this.dropzoneAdded=!0},createDashboard:function(e,t){return this.toolbar.createDashboard(e,t)},finsembleInitEvents:function(){function t(){return QuickBase.DeltaClientLib.deltaClient}this.listenTo(this.model.get("documents"),"update",function(){var e=this.model.get("documents").map(function(e){return _.pick(e.toJSON(),["name","id"])});window.finApi.applyUserConfig(window.finApi.generateConfig(e,!0))}),this.listenTo(this.viewModel,"change:selectedDocumentId",function(){var e=this.viewModel.get("selectedDocumentId");e&&(e=this.model.get("documents").get(e),window.finApi.deltaClientGetter=t,window.finApi.initApi(e,this.viewModel))})},fixSelect2DialogIssue:function(){var t;$.ui&&$.ui.dialog&&$.ui.dialog.prototype._allowInteraction&&(t=$.ui.dialog.prototype._allowInteraction,$.ui.dialog.prototype._allowInteraction=function(e){return!!$(e.target).closest(".select2-dropdown").length||t.apply(this,arguments)})},getAPIPrefix:function(){return"file:"===location.protocol||"FSBL"in window?"http://localhost:10001/api/":"/api/"},getCurrentDocument:function(){var t=this.viewModel.get("selectedDocumentId");return this.model.get("documents").find(function(e){return e.id===t})},loadUrl:function(e){Backbone.history.loadUrl(e)},loadDashboardById:function(e,t){this.historyStarted&&!this.model.get("embedded")?Backbone.history.loadUrl("#"+e+(t?"/"+t:"")):(this.viewModel.set("selectedDocumentId",e),t&&this.viewModel.set("selectedScreenId",t))},onBuildModeChange:function(e,t){this.$el.toggleClass("buildMode",t),this.contentPanel.onResize(),BBForm.ErrorTooltip.clearAll()},onDashboardThemeChanged:function(){var t=this.viewModel.get("DashboardTheme")||$.cookie("dashboard-theme")||this.THEMES[0].id;_.each([this.contentPanel.$el,this.$documentDialogPanel],function(e){if(e&&(e.removeClass("Dark Light kx-darkroom kx-light"),"None"!==t))switch(e.addClass(t),t){case"Dark":e.addClass("kx-darkroom"),$("#appdiv").css("background","#222222");break;case"Light":e.addClass("kx-light"),$("#appdiv").css("background","#f0f0f0")}})},onDocumentsFetched:function(e){var t,i;Log.Log("Dash Documents Complete"),this.model.get("isFinsembleLiteAuth")?window.finApi.applyUserConfig(window.finApi.generateConfig(JSON.stringify(e))):(this.router=new AppRouter({dialogContainer:this.$environmentDialogPanel,model:this.model,viewModel:this.viewModel,createNewDashboardIfNotFound:this.model.get("createNewDashboardIfNotFound"),app:this}),this.model.set("router",this.router),(e=this.model.get("pushStateBase"))&&((t=document.createElement("base")).setAttribute("href",e+"edit/"),document.getElementsByTagName("head")[0].appendChild(t)),Backbone.history.start(e?{pushState:!!e,root:e+"edit/"}:void 0),this.historyStarted=!0,Backbone.history.fragment.length<=0&&((t=this.viewModel.get("selectedDocumentId"))||0<(e=this.model.get("documents").getSortedDocuments()).length&&(t=e[0].id),t?this.router.navigate(t,{trigger:!0}):(Log.Error("this user doesn't have any dashboards"),(i=new QuickBase.Document({name:"My New Dashboard (1)",creationDate:(new Date).toUTCString()})).save(null,{success:function(e,t){this.model.get("documents").add(i),this.viewModel.set("selectedDocumentId",i.id)}.bind(this),error:function(e,t){MainToolbar.ShowError_unableToCreateNewDashboard(t),$(document).find(".loadingScreen").css({display:"none"})}}))),this.onShowBreadcrumbs())},onDeltaClientLogin:function(){var t=this,e=(this.model.set("ClientLoginTimestamp",Date.now()),Log.Log("Dash Documents Fetch"),this.model.get("embedded")?(this.router=new AppRouter({dialogContainer:this.$environmentDialogPanel,model:this.model,viewModel:this.viewModel,createNewDashboardIfNotFound:this.model.get("createNewDashboardIfNotFound"),app:this}),this.model.set("router",this.router),Backbone.history.fragment||(Backbone.History.started||Backbone.history.start(void 0),this.historyStarted=!0),this.onShowBreadcrumbs()):this.model.get("documents").fetch({success:$.proxy(this.onDocumentsFetched,this),error:function(){alert("document fetch error")},reset:!0}),this.model.get("isLite")),i=this.model.get("embedded"),i=e&&!i;!e?(this.model.set("userName",QuickBase.DeltaClientLib.username),this.componentsPanel.updateUserComponents(),this.onPopulateDeltaClientInformation(),QuickBase.DeltaClientLib.showLastLoginAttempts&&this.onShowLastLoginAttempts(),e="true"==QuickBase.DeltaClientLib.getDashboardProperty("hideQueryEditor"),this.model.set("CanExecuteQueries",!e)):i&&(i=(e=this.model.get("connections"))&&!_.isEmpty(e.models)?_.first(e.models):"html5evalcongroup",QuickBase.DeltaClientLib.getQueryData("q",i,".dash.u",[],function(e){e=_.get(e,"rows.0.symbol","User");t.model.set("userName","default"===e?"User":e)},function(e){t.model.set("userName","User")}),this.model.set("userName","User"))},onDragEnter:function(e){document.getElementById("appdiv");this.dropzoneAdded||this.initializeDropzone(),_.includes(e.originalEvent.dataTransfer.types,"Files")&&(void 0===e.originalEvent.dataTransfer.items||_.some(e.originalEvent.dataTransfer.items,function(e){return _.includes(["application/json","text/xml"],e.type)}))&&(this.$el.addClass("dragging"),e.preventDefault())},onHideToolbarChange:function(){var e=this.model.get("hideToolbar");this.$el.toggleClass("hideToolbar",!!e),this.toolbar.toggleTitle(e),this.onResize({target:window})},onPopulateDeltaClientInformation:function(){var t=this;QuickBase.DeltaClientLib.getAPIQueryData("kdb",void 0,".ui.controlDetails",[],function(e){t.model.set("dashboardControlDetails",e.rows.reduce(function(e,t){return e[t.Property]=_.isArray(t.Value)?t.Value.join(""):t.Value,e},{}))},function(e){console.log("Error Fetching Delta Client Information:",e)},100,!1)},onDocumentRemoved:function(e){var e=e.id;this.viewModel.get("selectedDocumentId")===e&&((e=this.model.get("documents").first())?(e=e.id,this.viewModel.set("selectedDocumentId",e)):this.viewModel.set("selectedDocumentId",null))},onResize:function(e){e.target===window&&(this.contentPanel.onResize(),this.toolbar.onResize())},onSelectedDocumentChanged:function(){var e,t,i=this.model.get("documents").get(this.viewModel.get("selectedDocumentId")),n=this.model.get("documents").get(this.viewModel.previous("selectedDocumentId"));n&&this.stopListening(n),i?(e=i.get("name")+this.DOCUMENT_TITLE.SEPARATOR+this.DOCUMENT_TITLE.SUFFIX,n=i.get("name"),i.get("viewState").viewStates&&1===(t=i.get("viewState").viewStates.filter(function(e){return"_settings/dashboardTitle"===e.path})).length&&t[0].model.set("value",n)):e=this.DOCUMENT_TITLE.SUFFIX,this.model.get("embedded")||$(document).attr("title",e),this.listenTo(i,"change:name",this.onSelectedDocumentChanged)},onShowBreadcrumbs:function(){this.model.get("showBreadcrumbs")?(this.$breadcrumbs.show(),this.breadcrumbs=new BreadcrumbsWrapper({appModel:this.model,viewModel:this.viewModel}),this.breadcrumbs.$el.appendTo(this.$breadcrumbs)):this.breadcrumbs&&(this.$breadcrumbs.hide(),this.breadcrumbs.remove())},onShowLastLoginAttempts:function(){var e,t=QuickBase.DeltaClientLib.showLastLoginAttempts,i="",n=this;if("failures"===t||"true"===t)e=".session.getFailedLoginsUI",i="Unsuccessful login attempts:";else{if("all"!==t)return;e=".session.getLoginsUI",i="Last 10 login attempts:"}QuickBase.DeltaClientLib.getAPIQueryData("kdb",void 0,e,[],function(e){var e=_.filter(e.rows,function(e){return e.machineID&&0<e.machineID.length});0<e.length&&(e=new FailedLoginsNotification({appModel:n.model,model:new Backbone.Model({rows:e})}),n.notificator.notify(i,e.$el))},function(e){console.log("show last login attempts error:",e)},100,!1)},processSignal:function(e){var t,i=this;if("viewState"===e.type&&this.viewstateAdapter)return this.viewstateAdapter.processSignal(e);this.commandsProxy&&"changes"===e.type&&"apply"===e.action&&this.listenToOnce(this.viewModel,"change:selectedScreenId",function(){i.commandsProxy.applyChanges(i.getCurrentDocument(),e.param)}),"document"===e.type&&"rename"===e.action&&((t=this.getCurrentDocument()).set("name",e.param.name),t.set("title",e.param.title))},remove:function(){this.observer.disconnect(),Backbone.View.prototype.remove.call(this)},setThemeFromCookie:function(){var t=this,i=_.map(this.THEMES,function(e){return e.id}).join(" ").concat(" Dark Light");this.environmentTheme=$.cookie("dashboard-theme")||this.THEMES[0].id,_.each([this.toolbar.$el,this.componentsPanel.$el,this.propertiesPanel.$el,this.$environmentDialogPanel,this.$notificationsDiv,this.$breadcrumbs],function(e){e&&e.removeClass(i).addClass(t.environmentTheme)}),_.includes(t.THEMES,this.environmentTheme)&&require(["css!"+this.environmentTheme])},showForceLoginPrompt:function(e){QuickBase.ConfirmDialog.ShowConfirm({dialogTitle:"Session Limit exceeded",renderTemplate:function(){return t("User session limit has been reached, terminate oldest open session?")},callback:e,cancelBtnCallback:this.showLogin.bind(this),container:this.$environmentDialogPanel})},showLogin:function(e){var o=this;new QuickBase.LoginDialog({appModel:this.model,container:this.$environmentDialogPanel,errorMessage:e,doLogin:function(t,i,n){o.initializeDeltaClient(t,i,function(e){"loginRequired"===e?o.showLogin():"userSessionLimit"===e?o.showForceLoginPrompt(function(){o.initializeDeltaClient(t,i,n,null,null,!0)}):n(e)})}})},addMissingDashboard:function(t){if(!this.model.get("documents").some(function(e){return e.id===t.id}))return this.model.get("documents").add(t)}});return App});